[
    {
        "id": "32897074461",
        "type": "ForkEvent",
        "actor": {
            "id": 84474609,
            "login": "ijacobs-cpa",
            "display_login": "ijacobs-cpa",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ijacobs-cpa",
            "avatar_url": "https://avatars.githubusercontent.com/u/84474609?"
        },
        "repo": {
            "id": 46273445,
            "name": "transloadit/uppy",
            "url": "https://api.github.com/repos/transloadit/uppy"
        },
        "payload": {
            "forkee": {
                "id": 710757891,
                "node_id": "R_kgDOKl1OAw",
                "name": "uppy",
                "full_name": "ijacobs-cpa/uppy",
                "private": false,
                "owner": {
                    "login": "ijacobs-cpa",
                    "id": 84474609,
                    "node_id": "MDQ6VXNlcjg0NDc0NjA5",
                    "avatar_url": "https://avatars.githubusercontent.com/u/84474609?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/ijacobs-cpa",
                    "html_url": "https://github.com/ijacobs-cpa",
                    "followers_url": "https://api.github.com/users/ijacobs-cpa/followers",
                    "following_url": "https://api.github.com/users/ijacobs-cpa/following{/other_user}",
                    "gists_url": "https://api.github.com/users/ijacobs-cpa/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/ijacobs-cpa/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/ijacobs-cpa/subscriptions",
                    "organizations_url": "https://api.github.com/users/ijacobs-cpa/orgs",
                    "repos_url": "https://api.github.com/users/ijacobs-cpa/repos",
                    "events_url": "https://api.github.com/users/ijacobs-cpa/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/ijacobs-cpa/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "html_url": "https://github.com/ijacobs-cpa/uppy",
                "description": "The next open source file uploader for web browsers :dog: ",
                "fork": true,
                "url": "https://api.github.com/repos/ijacobs-cpa/uppy",
                "forks_url": "https://api.github.com/repos/ijacobs-cpa/uppy/forks",
                "keys_url": "https://api.github.com/repos/ijacobs-cpa/uppy/keys{/key_id}",
                "collaborators_url": "https://api.github.com/repos/ijacobs-cpa/uppy/collaborators{/collaborator}",
                "teams_url": "https://api.github.com/repos/ijacobs-cpa/uppy/teams",
                "hooks_url": "https://api.github.com/repos/ijacobs-cpa/uppy/hooks",
                "issue_events_url": "https://api.github.com/repos/ijacobs-cpa/uppy/issues/events{/number}",
                "events_url": "https://api.github.com/repos/ijacobs-cpa/uppy/events",
                "assignees_url": "https://api.github.com/repos/ijacobs-cpa/uppy/assignees{/user}",
                "branches_url": "https://api.github.com/repos/ijacobs-cpa/uppy/branches{/branch}",
                "tags_url": "https://api.github.com/repos/ijacobs-cpa/uppy/tags",
                "blobs_url": "https://api.github.com/repos/ijacobs-cpa/uppy/git/blobs{/sha}",
                "git_tags_url": "https://api.github.com/repos/ijacobs-cpa/uppy/git/tags{/sha}",
                "git_refs_url": "https://api.github.com/repos/ijacobs-cpa/uppy/git/refs{/sha}",
                "trees_url": "https://api.github.com/repos/ijacobs-cpa/uppy/git/trees{/sha}",
                "statuses_url": "https://api.github.com/repos/ijacobs-cpa/uppy/statuses/{sha}",
                "languages_url": "https://api.github.com/repos/ijacobs-cpa/uppy/languages",
                "stargazers_url": "https://api.github.com/repos/ijacobs-cpa/uppy/stargazers",
                "contributors_url": "https://api.github.com/repos/ijacobs-cpa/uppy/contributors",
                "subscribers_url": "https://api.github.com/repos/ijacobs-cpa/uppy/subscribers",
                "subscription_url": "https://api.github.com/repos/ijacobs-cpa/uppy/subscription",
                "commits_url": "https://api.github.com/repos/ijacobs-cpa/uppy/commits{/sha}",
                "git_commits_url": "https://api.github.com/repos/ijacobs-cpa/uppy/git/commits{/sha}",
                "comments_url": "https://api.github.com/repos/ijacobs-cpa/uppy/comments{/number}",
                "issue_comment_url": "https://api.github.com/repos/ijacobs-cpa/uppy/issues/comments{/number}",
                "contents_url": "https://api.github.com/repos/ijacobs-cpa/uppy/contents/{+path}",
                "compare_url": "https://api.github.com/repos/ijacobs-cpa/uppy/compare/{base}...{head}",
                "merges_url": "https://api.github.com/repos/ijacobs-cpa/uppy/merges",
                "archive_url": "https://api.github.com/repos/ijacobs-cpa/uppy/{archive_format}{/ref}",
                "downloads_url": "https://api.github.com/repos/ijacobs-cpa/uppy/downloads",
                "issues_url": "https://api.github.com/repos/ijacobs-cpa/uppy/issues{/number}",
                "pulls_url": "https://api.github.com/repos/ijacobs-cpa/uppy/pulls{/number}",
                "milestones_url": "https://api.github.com/repos/ijacobs-cpa/uppy/milestones{/number}",
                "notifications_url": "https://api.github.com/repos/ijacobs-cpa/uppy/notifications{?since,all,participating}",
                "labels_url": "https://api.github.com/repos/ijacobs-cpa/uppy/labels{/name}",
                "releases_url": "https://api.github.com/repos/ijacobs-cpa/uppy/releases{/id}",
                "deployments_url": "https://api.github.com/repos/ijacobs-cpa/uppy/deployments",
                "created_at": "2023-10-27T11:26:47Z",
                "updated_at": "2023-10-27T11:26:47Z",
                "pushed_at": "2023-10-25T15:17:29Z",
                "git_url": "git://github.com/ijacobs-cpa/uppy.git",
                "ssh_url": "git@github.com:ijacobs-cpa/uppy.git",
                "clone_url": "https://github.com/ijacobs-cpa/uppy.git",
                "svn_url": "https://github.com/ijacobs-cpa/uppy",
                "homepage": "https://uppy.io",
                "size": 389980,
                "stargazers_count": 0,
                "watchers_count": 0,
                "language": null,
                "has_issues": false,
                "has_projects": true,
                "has_downloads": true,
                "has_wiki": false,
                "has_pages": false,
                "has_discussions": false,
                "forks_count": 0,
                "mirror_url": null,
                "archived": false,
                "disabled": false,
                "open_issues_count": 0,
                "license": null,
                "allow_forking": true,
                "is_template": false,
                "web_commit_signoff_required": false,
                "topics": [],
                "visibility": "public",
                "forks": 0,
                "open_issues": 0,
                "watchers": 0,
                "default_branch": "main",
                "public": true
            }
        },
        "public": true,
        "created_at": "2023-10-27T11:26:48Z",
        "org": {
            "id": 125754,
            "login": "transloadit",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/transloadit",
            "avatar_url": "https://avatars.githubusercontent.com/u/125754?"
        }
    },
    {
        "id": "32892364575",
        "type": "WatchEvent",
        "actor": {
            "id": 94522077,
            "login": "Avengers428",
            "display_login": "Avengers428",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Avengers428",
            "avatar_url": "https://avatars.githubusercontent.com/u/94522077?"
        },
        "repo": {
            "id": 46273445,
            "name": "transloadit/uppy",
            "url": "https://api.github.com/repos/transloadit/uppy"
        },
        "payload": {
            "action": "started"
        },
        "public": true,
        "created_at": "2023-10-27T08:23:21Z",
        "org": {
            "id": 125754,
            "login": "transloadit",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/transloadit",
            "avatar_url": "https://avatars.githubusercontent.com/u/125754?"
        }
    },
    {
        "id": "32887579219",
        "type": "IssueCommentEvent",
        "actor": {
            "id": 2108452,
            "login": "nfour",
            "display_login": "nfour",
            "gravatar_id": "",
            "url": "https://api.github.com/users/nfour",
            "avatar_url": "https://avatars.githubusercontent.com/u/2108452?"
        },
        "repo": {
            "id": 46273445,
            "name": "transloadit/uppy",
            "url": "https://api.github.com/repos/transloadit/uppy"
        },
        "payload": {
            "action": "created",
            "issue": {
                "url": "https://api.github.com/repos/transloadit/uppy/issues/4755",
                "repository_url": "https://api.github.com/repos/transloadit/uppy",
                "labels_url": "https://api.github.com/repos/transloadit/uppy/issues/4755/labels{/name}",
                "comments_url": "https://api.github.com/repos/transloadit/uppy/issues/4755/comments",
                "events_url": "https://api.github.com/repos/transloadit/uppy/issues/4755/events",
                "html_url": "https://github.com/transloadit/uppy/issues/4755",
                "id": 1955129872,
                "node_id": "I_kwDOAsITpc50iOoQ",
                "number": 4755,
                "title": "Missing singleFileFullScreen in DashboardOptions ",
                "user": {
                    "login": "nfour",
                    "id": 2108452,
                    "node_id": "MDQ6VXNlcjIxMDg0NTI=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/2108452?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/nfour",
                    "html_url": "https://github.com/nfour",
                    "followers_url": "https://api.github.com/users/nfour/followers",
                    "following_url": "https://api.github.com/users/nfour/following{/other_user}",
                    "gists_url": "https://api.github.com/users/nfour/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/nfour/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/nfour/subscriptions",
                    "organizations_url": "https://api.github.com/users/nfour/orgs",
                    "repos_url": "https://api.github.com/users/nfour/repos",
                    "events_url": "https://api.github.com/users/nfour/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/nfour/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "labels": [
                    {
                        "id": 287347640,
                        "node_id": "MDU6TGFiZWwyODczNDc2NDA=",
                        "url": "https://api.github.com/repos/transloadit/uppy/labels/Bug",
                        "name": "Bug",
                        "color": "d93f0b",
                        "default": false,
                        "description": ""
                    }
                ],
                "state": "open",
                "locked": false,
                "assignee": {
                    "login": "arturi",
                    "id": 1199054,
                    "node_id": "MDQ6VXNlcjExOTkwNTQ=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/1199054?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/arturi",
                    "html_url": "https://github.com/arturi",
                    "followers_url": "https://api.github.com/users/arturi/followers",
                    "following_url": "https://api.github.com/users/arturi/following{/other_user}",
                    "gists_url": "https://api.github.com/users/arturi/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/arturi/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/arturi/subscriptions",
                    "organizations_url": "https://api.github.com/users/arturi/orgs",
                    "repos_url": "https://api.github.com/users/arturi/repos",
                    "events_url": "https://api.github.com/users/arturi/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/arturi/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "assignees": [
                    {
                        "login": "arturi",
                        "id": 1199054,
                        "node_id": "MDQ6VXNlcjExOTkwNTQ=",
                        "avatar_url": "https://avatars.githubusercontent.com/u/1199054?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/arturi",
                        "html_url": "https://github.com/arturi",
                        "followers_url": "https://api.github.com/users/arturi/followers",
                        "following_url": "https://api.github.com/users/arturi/following{/other_user}",
                        "gists_url": "https://api.github.com/users/arturi/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/arturi/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/arturi/subscriptions",
                        "organizations_url": "https://api.github.com/users/arturi/orgs",
                        "repos_url": "https://api.github.com/users/arturi/repos",
                        "events_url": "https://api.github.com/users/arturi/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/arturi/received_events",
                        "type": "User",
                        "site_admin": false
                    }
                ],
                "milestone": null,
                "comments": 2,
                "created_at": "2023-10-20T23:26:24Z",
                "updated_at": "2023-10-27T03:59:04Z",
                "closed_at": null,
                "author_association": "NONE",
                "active_lock_reason": null,
                "body": "### Initial checklist\r\n\r\n- [X] I understand this is a bug report and questions should be posted in the [Community Forum](https://community.transloadit.com/)\r\n- [X] I searched [issues](https://github.com/transloadit/uppy/issues?q=is%3Aissue) and couldn\u2019t find anything (or linked relevant results below)\r\n\r\n### Link to runnable example\r\n\r\n_No response_\r\n\r\n### Steps to reproduce\r\n\r\nProduce react:\r\n\r\n```tsx\r\n<Dashboard\r\n        fileManagerSelectionType=\"files\"\r\n        centerSingleFile={false}\r\n        hideUploadButton\r\n        singleFileFullScreen={false}\r\n        uppy={uppy}\r\n      />\r\n```\r\n\r\n### Expected behavior\r\n\r\nsingleFileFullScreen doesnt error\r\n\r\n### Actual behavior\r\n\r\n![image](https://github.com/transloadit/uppy/assets/2108452/ae60bf21-0ab5-4a4a-83bf-45577d4d6769)\r\n\r\nThe property correctly configures the Dashboard, its just the TS definition.\r\n\r\nSeems to be missing from DashboardOptions definition in `@uppy/dashboard@3.6.0`",
                "reactions": {
                    "url": "https://api.github.com/repos/transloadit/uppy/issues/4755/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "timeline_url": "https://api.github.com/repos/transloadit/uppy/issues/4755/timeline",
                "performed_via_github_app": null,
                "state_reason": null
            },
            "comment": {
                "url": "https://api.github.com/repos/transloadit/uppy/issues/comments/1782252123",
                "html_url": "https://github.com/transloadit/uppy/issues/4755#issuecomment-1782252123",
                "issue_url": "https://api.github.com/repos/transloadit/uppy/issues/4755",
                "id": 1782252123,
                "node_id": "IC_kwDOAsITpc5qOwJb",
                "user": {
                    "login": "nfour",
                    "id": 2108452,
                    "node_id": "MDQ6VXNlcjIxMDg0NTI=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/2108452?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/nfour",
                    "html_url": "https://github.com/nfour",
                    "followers_url": "https://api.github.com/users/nfour/followers",
                    "following_url": "https://api.github.com/users/nfour/following{/other_user}",
                    "gists_url": "https://api.github.com/users/nfour/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/nfour/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/nfour/subscriptions",
                    "organizations_url": "https://api.github.com/users/nfour/orgs",
                    "repos_url": "https://api.github.com/users/nfour/repos",
                    "events_url": "https://api.github.com/users/nfour/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/nfour/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "created_at": "2023-10-27T03:59:04Z",
                "updated_at": "2023-10-27T03:59:04Z",
                "author_association": "NONE",
                "body": "The TS definition does not provide the property, thus you have to use a hack to make it ignore the type if you wish to configure this option. Internally, uppy understands the option and passes it through.",
                "reactions": {
                    "url": "https://api.github.com/repos/transloadit/uppy/issues/comments/1782252123/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "performed_via_github_app": null
            }
        },
        "public": true,
        "created_at": "2023-10-27T03:59:04Z",
        "org": {
            "id": 125754,
            "login": "transloadit",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/transloadit",
            "avatar_url": "https://avatars.githubusercontent.com/u/125754?"
        }
    },
    {
        "id": "32886805610",
        "type": "WatchEvent",
        "actor": {
            "id": 33856234,
            "login": "llooll2345",
            "display_login": "llooll2345",
            "gravatar_id": "",
            "url": "https://api.github.com/users/llooll2345",
            "avatar_url": "https://avatars.githubusercontent.com/u/33856234?"
        },
        "repo": {
            "id": 46273445,
            "name": "transloadit/uppy",
            "url": "https://api.github.com/repos/transloadit/uppy"
        },
        "payload": {
            "action": "started"
        },
        "public": true,
        "created_at": "2023-10-27T02:55:20Z",
        "org": {
            "id": 125754,
            "login": "transloadit",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/transloadit",
            "avatar_url": "https://avatars.githubusercontent.com/u/125754?"
        }
    },
    {
        "id": "32886587330",
        "type": "WatchEvent",
        "actor": {
            "id": 124185383,
            "login": "akumarujon",
            "display_login": "akumarujon",
            "gravatar_id": "",
            "url": "https://api.github.com/users/akumarujon",
            "avatar_url": "https://avatars.githubusercontent.com/u/124185383?"
        },
        "repo": {
            "id": 46273445,
            "name": "transloadit/uppy",
            "url": "https://api.github.com/repos/transloadit/uppy"
        },
        "payload": {
            "action": "started"
        },
        "public": true,
        "created_at": "2023-10-27T02:37:24Z",
        "org": {
            "id": 125754,
            "login": "transloadit",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/transloadit",
            "avatar_url": "https://avatars.githubusercontent.com/u/125754?"
        }
    },
    {
        "id": "32886222643",
        "type": "IssueCommentEvent",
        "actor": {
            "id": 402547,
            "login": "mifi",
            "display_login": "mifi",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mifi",
            "avatar_url": "https://avatars.githubusercontent.com/u/402547?"
        },
        "repo": {
            "id": 46273445,
            "name": "transloadit/uppy",
            "url": "https://api.github.com/repos/transloadit/uppy"
        },
        "payload": {
            "action": "created",
            "issue": {
                "url": "https://api.github.com/repos/transloadit/uppy/issues/4763",
                "repository_url": "https://api.github.com/repos/transloadit/uppy",
                "labels_url": "https://api.github.com/repos/transloadit/uppy/issues/4763/labels{/name}",
                "comments_url": "https://api.github.com/repos/transloadit/uppy/issues/4763/comments",
                "events_url": "https://api.github.com/repos/transloadit/uppy/issues/4763/events",
                "html_url": "https://github.com/transloadit/uppy/issues/4763",
                "id": 1960444250,
                "node_id": "I_kwDOAsITpc502gFa",
                "number": 4763,
                "title": "dynamic S3 bucket doesnt work with Google Drive provider",
                "user": {
                    "login": "ivadenis",
                    "id": 3453508,
                    "node_id": "MDQ6VXNlcjM0NTM1MDg=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/3453508?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/ivadenis",
                    "html_url": "https://github.com/ivadenis",
                    "followers_url": "https://api.github.com/users/ivadenis/followers",
                    "following_url": "https://api.github.com/users/ivadenis/following{/other_user}",
                    "gists_url": "https://api.github.com/users/ivadenis/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/ivadenis/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/ivadenis/subscriptions",
                    "organizations_url": "https://api.github.com/users/ivadenis/orgs",
                    "repos_url": "https://api.github.com/users/ivadenis/repos",
                    "events_url": "https://api.github.com/users/ivadenis/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/ivadenis/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "labels": [
                    {
                        "id": 287347640,
                        "node_id": "MDU6TGFiZWwyODczNDc2NDA=",
                        "url": "https://api.github.com/repos/transloadit/uppy/labels/Bug",
                        "name": "Bug",
                        "color": "d93f0b",
                        "default": false,
                        "description": ""
                    }
                ],
                "state": "open",
                "locked": false,
                "assignee": {
                    "login": "mifi",
                    "id": 402547,
                    "node_id": "MDQ6VXNlcjQwMjU0Nw==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/402547?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/mifi",
                    "html_url": "https://github.com/mifi",
                    "followers_url": "https://api.github.com/users/mifi/followers",
                    "following_url": "https://api.github.com/users/mifi/following{/other_user}",
                    "gists_url": "https://api.github.com/users/mifi/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/mifi/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/mifi/subscriptions",
                    "organizations_url": "https://api.github.com/users/mifi/orgs",
                    "repos_url": "https://api.github.com/users/mifi/repos",
                    "events_url": "https://api.github.com/users/mifi/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/mifi/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "assignees": [
                    {
                        "login": "mifi",
                        "id": 402547,
                        "node_id": "MDQ6VXNlcjQwMjU0Nw==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/402547?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/mifi",
                        "html_url": "https://github.com/mifi",
                        "followers_url": "https://api.github.com/users/mifi/followers",
                        "following_url": "https://api.github.com/users/mifi/following{/other_user}",
                        "gists_url": "https://api.github.com/users/mifi/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/mifi/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/mifi/subscriptions",
                        "organizations_url": "https://api.github.com/users/mifi/orgs",
                        "repos_url": "https://api.github.com/users/mifi/repos",
                        "events_url": "https://api.github.com/users/mifi/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/mifi/received_events",
                        "type": "User",
                        "site_admin": false
                    }
                ],
                "milestone": null,
                "comments": 5,
                "created_at": "2023-10-25T03:10:35Z",
                "updated_at": "2023-10-27T02:08:57Z",
                "closed_at": null,
                "author_association": "NONE",
                "active_lock_reason": null,
                "body": "### Initial checklist\n\n- [X] I understand this is a bug report and questions should be posted in the [Community Forum](https://community.transloadit.com/)\n- [X] I searched [issues](https://github.com/transloadit/uppy/issues?q=is%3Aissue) and couldn\u2019t find anything (or linked relevant results below)\n\n### Link to runnable example\n\n_No response_\n\n### Steps to reproduce\n\nIm trying to set a bucket for S3 clien in companion dynamically based on the metadata set from the client. However, when upload is done through Google Drive (or any other provider), `bucket` function property on the companion does not receive any arguments.\r\n\r\n<img width=\"1019\" alt=\"Screenshot 2023-10-24 at 8 05 32\u202fPM\" src=\"https://github.com/transloadit/uppy/assets/3453508/42748201-7dda-453a-ae79-1651bac61677\">\r\n\r\n\r\nthis is my rought setup\r\n\r\nUI: \r\n```\r\nuppy.setMeta(s3Object);\r\n\r\nuppy.use(GoogleDrive, {\r\n  companionUrl: COMPANION_URL\r\n})\r\n\r\nuppy.use(Dashboard, {\r\n  inline: true,\r\n  target: 'body',\r\n  plugins: ['GoogleDrive'],\r\n})\r\n\r\nuppy.use(AwsS3, {\r\n  companionUrl: COMPANION_URL,\r\n  shouldUseMultipart: true,\r\n})\r\n```\r\n\r\nCompanion:\r\n```\r\nconst options = {\r\n  providerOptions: {\r\n    drive: {\r\n      key: process.env.COMPANION_GOOGLE_KEY,\r\n      secret: process.env.COMPANION_GOOGLE_SECRET,\r\n    },\r\n  },\r\n  s3: {\r\n    getKey: (req, filename, metadata) => {\r\n      return `${crypto.randomUUID()}-${filename}`;\r\n    },\r\n    bucket: (req) => {\r\n      // req is undefined\r\n      return process.env.COMPANION_AWS_BUCKET;\r\n    },\r\n    secret: process.env.COMPANION_AWS_SECRET,\r\n    region: process.env.COMPANION_AWS_REGION,\r\n  },\r\n  server: { host: process.env.COMPANION_DOMAIN },\r\n  filePath: DATA_DIR,\r\n  secret: SECRET,\r\n  debug: true,\r\n}\r\n\r\nconst { app: companionApp } = companion.app(options)\r\n```\r\n\r\n\r\nI actually traced down the issue to this line:\r\n\r\nhttps://github.com/transloadit/uppy/blob/main/packages/%40uppy/companion/src/server/Uploader.js#L658\r\n\r\n```\r\nUploader.js\r\nconst params = {\r\n      Bucket: getBucket(options.bucket), // <------\r\n      Key: options.getKey(null, filename, this.options.metadata),\r\n      ContentType: this.options.metadata.type,\r\n      Metadata: rfc2047EncodeMetadata(this.options.metadata),\r\n      Body: stream,\r\n    }\r\n```\r\n\r\nit doesn't seem that a request object is passed down to `getBucket` util.\r\n\r\nIn fact, it would be very helpful if `getBucket` passed `this.options.metadata` as a second argument (similar to `getKey`).\r\n\r\n\n\n### Expected behavior\n\nBucket property as a function should receive a request object when used with server-to-server providers.\r\nAdditionally, it would be nice if it could receive `options.metadata` just like `getKey`.\r\n\r\n```\r\n bucket: (req) => {\r\n      ....\r\n},\r\n```\n\n### Actual behavior\n\nargument `req` of function property `bucket` on companion is undefined.",
                "reactions": {
                    "url": "https://api.github.com/repos/transloadit/uppy/issues/4763/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "timeline_url": "https://api.github.com/repos/transloadit/uppy/issues/4763/timeline",
                "performed_via_github_app": null,
                "state_reason": null
            },
            "comment": {
                "url": "https://api.github.com/repos/transloadit/uppy/issues/comments/1782178026",
                "html_url": "https://github.com/transloadit/uppy/issues/4763#issuecomment-1782178026",
                "issue_url": "https://api.github.com/repos/transloadit/uppy/issues/4763",
                "id": 1782178026,
                "node_id": "IC_kwDOAsITpc5qOeDq",
                "user": {
                    "login": "mifi",
                    "id": 402547,
                    "node_id": "MDQ6VXNlcjQwMjU0Nw==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/402547?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/mifi",
                    "html_url": "https://github.com/mifi",
                    "followers_url": "https://api.github.com/users/mifi/followers",
                    "following_url": "https://api.github.com/users/mifi/following{/other_user}",
                    "gists_url": "https://api.github.com/users/mifi/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/mifi/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/mifi/subscriptions",
                    "organizations_url": "https://api.github.com/users/mifi/orgs",
                    "repos_url": "https://api.github.com/users/mifi/repos",
                    "events_url": "https://api.github.com/users/mifi/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/mifi/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "created_at": "2023-10-27T02:08:56Z",
                "updated_at": "2023-10-27T02:08:56Z",
                "author_association": "CONTRIBUTOR",
                "body": "Ok, so if I understand you correctly, you want to pass some side-metadata that should not be stored on the uploaded file, only to be used by companion, passed into getBucket/getKey? @arturi @Murderlon wdyt, does it make sense to invent such a new concept of side-metadata? And what should we name it?\r\n\r\nalso, how/when do you want to be able to attach this metadata in Uppy? On a per file-basis, right?",
                "reactions": {
                    "url": "https://api.github.com/repos/transloadit/uppy/issues/comments/1782178026/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "performed_via_github_app": null
            }
        },
        "public": true,
        "created_at": "2023-10-27T02:08:57Z",
        "org": {
            "id": 125754,
            "login": "transloadit",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/transloadit",
            "avatar_url": "https://avatars.githubusercontent.com/u/125754?"
        }
    },
    {
        "id": "32883830617",
        "type": "IssueCommentEvent",
        "actor": {
            "id": 41365655,
            "login": "yafkari",
            "display_login": "yafkari",
            "gravatar_id": "",
            "url": "https://api.github.com/users/yafkari",
            "avatar_url": "https://avatars.githubusercontent.com/u/41365655?"
        },
        "repo": {
            "id": 46273445,
            "name": "transloadit/uppy",
            "url": "https://api.github.com/repos/transloadit/uppy"
        },
        "payload": {
            "action": "created",
            "issue": {
                "url": "https://api.github.com/repos/transloadit/uppy/issues/2596",
                "repository_url": "https://api.github.com/repos/transloadit/uppy",
                "labels_url": "https://api.github.com/repos/transloadit/uppy/issues/2596/labels{/name}",
                "comments_url": "https://api.github.com/repos/transloadit/uppy/issues/2596/comments",
                "events_url": "https://api.github.com/repos/transloadit/uppy/issues/2596/events",
                "html_url": "https://github.com/transloadit/uppy/issues/2596",
                "id": 727863955,
                "node_id": "MDU6SXNzdWU3Mjc4NjM5NTU=",
                "number": 2596,
                "title": "mkv file type not supported",
                "user": {
                    "login": "masudhossain",
                    "id": 16615124,
                    "node_id": "MDQ6VXNlcjE2NjE1MTI0",
                    "avatar_url": "https://avatars.githubusercontent.com/u/16615124?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/masudhossain",
                    "html_url": "https://github.com/masudhossain",
                    "followers_url": "https://api.github.com/users/masudhossain/followers",
                    "following_url": "https://api.github.com/users/masudhossain/following{/other_user}",
                    "gists_url": "https://api.github.com/users/masudhossain/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/masudhossain/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/masudhossain/subscriptions",
                    "organizations_url": "https://api.github.com/users/masudhossain/orgs",
                    "repos_url": "https://api.github.com/users/masudhossain/repos",
                    "events_url": "https://api.github.com/users/masudhossain/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/masudhossain/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "labels": [
                    {
                        "id": 287347645,
                        "node_id": "MDU6TGFiZWwyODczNDc2NDU=",
                        "url": "https://api.github.com/repos/transloadit/uppy/labels/Question",
                        "name": "Question",
                        "color": "c5def5",
                        "default": false,
                        "description": ""
                    }
                ],
                "state": "closed",
                "locked": false,
                "assignee": {
                    "login": "goto-bus-stop",
                    "id": 1006268,
                    "node_id": "MDQ6VXNlcjEwMDYyNjg=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/1006268?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/goto-bus-stop",
                    "html_url": "https://github.com/goto-bus-stop",
                    "followers_url": "https://api.github.com/users/goto-bus-stop/followers",
                    "following_url": "https://api.github.com/users/goto-bus-stop/following{/other_user}",
                    "gists_url": "https://api.github.com/users/goto-bus-stop/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/goto-bus-stop/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/goto-bus-stop/subscriptions",
                    "organizations_url": "https://api.github.com/users/goto-bus-stop/orgs",
                    "repos_url": "https://api.github.com/users/goto-bus-stop/repos",
                    "events_url": "https://api.github.com/users/goto-bus-stop/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/goto-bus-stop/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "assignees": [
                    {
                        "login": "goto-bus-stop",
                        "id": 1006268,
                        "node_id": "MDQ6VXNlcjEwMDYyNjg=",
                        "avatar_url": "https://avatars.githubusercontent.com/u/1006268?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/goto-bus-stop",
                        "html_url": "https://github.com/goto-bus-stop",
                        "followers_url": "https://api.github.com/users/goto-bus-stop/followers",
                        "following_url": "https://api.github.com/users/goto-bus-stop/following{/other_user}",
                        "gists_url": "https://api.github.com/users/goto-bus-stop/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/goto-bus-stop/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/goto-bus-stop/subscriptions",
                        "organizations_url": "https://api.github.com/users/goto-bus-stop/orgs",
                        "repos_url": "https://api.github.com/users/goto-bus-stop/repos",
                        "events_url": "https://api.github.com/users/goto-bus-stop/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/goto-bus-stop/received_events",
                        "type": "User",
                        "site_admin": false
                    }
                ],
                "milestone": null,
                "comments": 2,
                "created_at": "2020-10-23T03:32:25Z",
                "updated_at": "2023-10-26T23:00:57Z",
                "closed_at": "2020-11-03T10:23:10Z",
                "author_association": "NONE",
                "active_lock_reason": null,
                "body": "Noticed that doing `allowedFileTypes: ['image/*', 'video/*']` does not allow mkv files to be uploaded. Even doing `allowedFileTypes: ['image/*', 'video/*', 'mkv']` does not work. ",
                "reactions": {
                    "url": "https://api.github.com/repos/transloadit/uppy/issues/2596/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "timeline_url": "https://api.github.com/repos/transloadit/uppy/issues/2596/timeline",
                "performed_via_github_app": null,
                "state_reason": "completed"
            },
            "comment": {
                "url": "https://api.github.com/repos/transloadit/uppy/issues/comments/1782019944",
                "html_url": "https://github.com/transloadit/uppy/issues/2596#issuecomment-1782019944",
                "issue_url": "https://api.github.com/repos/transloadit/uppy/issues/2596",
                "id": 1782019944,
                "node_id": "IC_kwDOAsITpc5qN3do",
                "user": {
                    "login": "yafkari",
                    "id": 41365655,
                    "node_id": "MDQ6VXNlcjQxMzY1NjU1",
                    "avatar_url": "https://avatars.githubusercontent.com/u/41365655?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/yafkari",
                    "html_url": "https://github.com/yafkari",
                    "followers_url": "https://api.github.com/users/yafkari/followers",
                    "following_url": "https://api.github.com/users/yafkari/following{/other_user}",
                    "gists_url": "https://api.github.com/users/yafkari/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/yafkari/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/yafkari/subscriptions",
                    "organizations_url": "https://api.github.com/users/yafkari/orgs",
                    "repos_url": "https://api.github.com/users/yafkari/repos",
                    "events_url": "https://api.github.com/users/yafkari/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/yafkari/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "created_at": "2023-10-26T23:00:56Z",
                "updated_at": "2023-10-26T23:00:56Z",
                "author_association": "NONE",
                "body": "But why does .mkv is not included in \"video/*\"? \r\n\r\nIt corresponds to \"video/x-matroska\" if I am not wrong? No?",
                "reactions": {
                    "url": "https://api.github.com/repos/transloadit/uppy/issues/comments/1782019944/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "performed_via_github_app": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T23:00:57Z",
        "org": {
            "id": 125754,
            "login": "transloadit",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/transloadit",
            "avatar_url": "https://avatars.githubusercontent.com/u/125754?"
        }
    },
    {
        "id": "32881993888",
        "type": "ForkEvent",
        "actor": {
            "id": 70377003,
            "login": "abdulmoiz-bit",
            "display_login": "abdulmoiz-bit",
            "gravatar_id": "",
            "url": "https://api.github.com/users/abdulmoiz-bit",
            "avatar_url": "https://avatars.githubusercontent.com/u/70377003?"
        },
        "repo": {
            "id": 46273445,
            "name": "transloadit/uppy",
            "url": "https://api.github.com/repos/transloadit/uppy"
        },
        "payload": {
            "forkee": {
                "id": 710512934,
                "node_id": "R_kgDOKlmRJg",
                "name": "uppy",
                "full_name": "abdulmoiz-bit/uppy",
                "private": false,
                "owner": {
                    "login": "abdulmoiz-bit",
                    "id": 70377003,
                    "node_id": "MDQ6VXNlcjcwMzc3MDAz",
                    "avatar_url": "https://avatars.githubusercontent.com/u/70377003?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/abdulmoiz-bit",
                    "html_url": "https://github.com/abdulmoiz-bit",
                    "followers_url": "https://api.github.com/users/abdulmoiz-bit/followers",
                    "following_url": "https://api.github.com/users/abdulmoiz-bit/following{/other_user}",
                    "gists_url": "https://api.github.com/users/abdulmoiz-bit/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/abdulmoiz-bit/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/abdulmoiz-bit/subscriptions",
                    "organizations_url": "https://api.github.com/users/abdulmoiz-bit/orgs",
                    "repos_url": "https://api.github.com/users/abdulmoiz-bit/repos",
                    "events_url": "https://api.github.com/users/abdulmoiz-bit/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/abdulmoiz-bit/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "html_url": "https://github.com/abdulmoiz-bit/uppy",
                "description": "The next open source file uploader for web browsers :dog: ",
                "fork": true,
                "url": "https://api.github.com/repos/abdulmoiz-bit/uppy",
                "forks_url": "https://api.github.com/repos/abdulmoiz-bit/uppy/forks",
                "keys_url": "https://api.github.com/repos/abdulmoiz-bit/uppy/keys{/key_id}",
                "collaborators_url": "https://api.github.com/repos/abdulmoiz-bit/uppy/collaborators{/collaborator}",
                "teams_url": "https://api.github.com/repos/abdulmoiz-bit/uppy/teams",
                "hooks_url": "https://api.github.com/repos/abdulmoiz-bit/uppy/hooks",
                "issue_events_url": "https://api.github.com/repos/abdulmoiz-bit/uppy/issues/events{/number}",
                "events_url": "https://api.github.com/repos/abdulmoiz-bit/uppy/events",
                "assignees_url": "https://api.github.com/repos/abdulmoiz-bit/uppy/assignees{/user}",
                "branches_url": "https://api.github.com/repos/abdulmoiz-bit/uppy/branches{/branch}",
                "tags_url": "https://api.github.com/repos/abdulmoiz-bit/uppy/tags",
                "blobs_url": "https://api.github.com/repos/abdulmoiz-bit/uppy/git/blobs{/sha}",
                "git_tags_url": "https://api.github.com/repos/abdulmoiz-bit/uppy/git/tags{/sha}",
                "git_refs_url": "https://api.github.com/repos/abdulmoiz-bit/uppy/git/refs{/sha}",
                "trees_url": "https://api.github.com/repos/abdulmoiz-bit/uppy/git/trees{/sha}",
                "statuses_url": "https://api.github.com/repos/abdulmoiz-bit/uppy/statuses/{sha}",
                "languages_url": "https://api.github.com/repos/abdulmoiz-bit/uppy/languages",
                "stargazers_url": "https://api.github.com/repos/abdulmoiz-bit/uppy/stargazers",
                "contributors_url": "https://api.github.com/repos/abdulmoiz-bit/uppy/contributors",
                "subscribers_url": "https://api.github.com/repos/abdulmoiz-bit/uppy/subscribers",
                "subscription_url": "https://api.github.com/repos/abdulmoiz-bit/uppy/subscription",
                "commits_url": "https://api.github.com/repos/abdulmoiz-bit/uppy/commits{/sha}",
                "git_commits_url": "https://api.github.com/repos/abdulmoiz-bit/uppy/git/commits{/sha}",
                "comments_url": "https://api.github.com/repos/abdulmoiz-bit/uppy/comments{/number}",
                "issue_comment_url": "https://api.github.com/repos/abdulmoiz-bit/uppy/issues/comments{/number}",
                "contents_url": "https://api.github.com/repos/abdulmoiz-bit/uppy/contents/{+path}",
                "compare_url": "https://api.github.com/repos/abdulmoiz-bit/uppy/compare/{base}...{head}",
                "merges_url": "https://api.github.com/repos/abdulmoiz-bit/uppy/merges",
                "archive_url": "https://api.github.com/repos/abdulmoiz-bit/uppy/{archive_format}{/ref}",
                "downloads_url": "https://api.github.com/repos/abdulmoiz-bit/uppy/downloads",
                "issues_url": "https://api.github.com/repos/abdulmoiz-bit/uppy/issues{/number}",
                "pulls_url": "https://api.github.com/repos/abdulmoiz-bit/uppy/pulls{/number}",
                "milestones_url": "https://api.github.com/repos/abdulmoiz-bit/uppy/milestones{/number}",
                "notifications_url": "https://api.github.com/repos/abdulmoiz-bit/uppy/notifications{?since,all,participating}",
                "labels_url": "https://api.github.com/repos/abdulmoiz-bit/uppy/labels{/name}",
                "releases_url": "https://api.github.com/repos/abdulmoiz-bit/uppy/releases{/id}",
                "deployments_url": "https://api.github.com/repos/abdulmoiz-bit/uppy/deployments",
                "created_at": "2023-10-26T21:10:57Z",
                "updated_at": "2023-10-26T21:10:57Z",
                "pushed_at": "2023-10-25T15:17:29Z",
                "git_url": "git://github.com/abdulmoiz-bit/uppy.git",
                "ssh_url": "git@github.com:abdulmoiz-bit/uppy.git",
                "clone_url": "https://github.com/abdulmoiz-bit/uppy.git",
                "svn_url": "https://github.com/abdulmoiz-bit/uppy",
                "homepage": "https://uppy.io",
                "size": 389980,
                "stargazers_count": 0,
                "watchers_count": 0,
                "language": null,
                "has_issues": false,
                "has_projects": true,
                "has_downloads": true,
                "has_wiki": false,
                "has_pages": false,
                "has_discussions": false,
                "forks_count": 0,
                "mirror_url": null,
                "archived": false,
                "disabled": false,
                "open_issues_count": 0,
                "license": null,
                "allow_forking": true,
                "is_template": false,
                "web_commit_signoff_required": false,
                "topics": [],
                "visibility": "public",
                "forks": 0,
                "open_issues": 0,
                "watchers": 0,
                "default_branch": "main",
                "public": true
            }
        },
        "public": true,
        "created_at": "2023-10-26T21:10:58Z",
        "org": {
            "id": 125754,
            "login": "transloadit",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/transloadit",
            "avatar_url": "https://avatars.githubusercontent.com/u/125754?"
        }
    },
    {
        "id": "32881823076",
        "type": "IssueCommentEvent",
        "actor": {
            "id": 3453508,
            "login": "ivadenis",
            "display_login": "ivadenis",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ivadenis",
            "avatar_url": "https://avatars.githubusercontent.com/u/3453508?"
        },
        "repo": {
            "id": 46273445,
            "name": "transloadit/uppy",
            "url": "https://api.github.com/repos/transloadit/uppy"
        },
        "payload": {
            "action": "created",
            "issue": {
                "url": "https://api.github.com/repos/transloadit/uppy/issues/4763",
                "repository_url": "https://api.github.com/repos/transloadit/uppy",
                "labels_url": "https://api.github.com/repos/transloadit/uppy/issues/4763/labels{/name}",
                "comments_url": "https://api.github.com/repos/transloadit/uppy/issues/4763/comments",
                "events_url": "https://api.github.com/repos/transloadit/uppy/issues/4763/events",
                "html_url": "https://github.com/transloadit/uppy/issues/4763",
                "id": 1960444250,
                "node_id": "I_kwDOAsITpc502gFa",
                "number": 4763,
                "title": "dynamic S3 bucket doesnt work with Google Drive provider",
                "user": {
                    "login": "ivadenis",
                    "id": 3453508,
                    "node_id": "MDQ6VXNlcjM0NTM1MDg=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/3453508?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/ivadenis",
                    "html_url": "https://github.com/ivadenis",
                    "followers_url": "https://api.github.com/users/ivadenis/followers",
                    "following_url": "https://api.github.com/users/ivadenis/following{/other_user}",
                    "gists_url": "https://api.github.com/users/ivadenis/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/ivadenis/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/ivadenis/subscriptions",
                    "organizations_url": "https://api.github.com/users/ivadenis/orgs",
                    "repos_url": "https://api.github.com/users/ivadenis/repos",
                    "events_url": "https://api.github.com/users/ivadenis/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/ivadenis/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "labels": [
                    {
                        "id": 287347640,
                        "node_id": "MDU6TGFiZWwyODczNDc2NDA=",
                        "url": "https://api.github.com/repos/transloadit/uppy/labels/Bug",
                        "name": "Bug",
                        "color": "d93f0b",
                        "default": false,
                        "description": ""
                    }
                ],
                "state": "open",
                "locked": false,
                "assignee": {
                    "login": "mifi",
                    "id": 402547,
                    "node_id": "MDQ6VXNlcjQwMjU0Nw==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/402547?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/mifi",
                    "html_url": "https://github.com/mifi",
                    "followers_url": "https://api.github.com/users/mifi/followers",
                    "following_url": "https://api.github.com/users/mifi/following{/other_user}",
                    "gists_url": "https://api.github.com/users/mifi/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/mifi/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/mifi/subscriptions",
                    "organizations_url": "https://api.github.com/users/mifi/orgs",
                    "repos_url": "https://api.github.com/users/mifi/repos",
                    "events_url": "https://api.github.com/users/mifi/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/mifi/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "assignees": [
                    {
                        "login": "mifi",
                        "id": 402547,
                        "node_id": "MDQ6VXNlcjQwMjU0Nw==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/402547?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/mifi",
                        "html_url": "https://github.com/mifi",
                        "followers_url": "https://api.github.com/users/mifi/followers",
                        "following_url": "https://api.github.com/users/mifi/following{/other_user}",
                        "gists_url": "https://api.github.com/users/mifi/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/mifi/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/mifi/subscriptions",
                        "organizations_url": "https://api.github.com/users/mifi/orgs",
                        "repos_url": "https://api.github.com/users/mifi/repos",
                        "events_url": "https://api.github.com/users/mifi/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/mifi/received_events",
                        "type": "User",
                        "site_admin": false
                    }
                ],
                "milestone": null,
                "comments": 4,
                "created_at": "2023-10-25T03:10:35Z",
                "updated_at": "2023-10-26T21:02:40Z",
                "closed_at": null,
                "author_association": "NONE",
                "active_lock_reason": null,
                "body": "### Initial checklist\n\n- [X] I understand this is a bug report and questions should be posted in the [Community Forum](https://community.transloadit.com/)\n- [X] I searched [issues](https://github.com/transloadit/uppy/issues?q=is%3Aissue) and couldn\u2019t find anything (or linked relevant results below)\n\n### Link to runnable example\n\n_No response_\n\n### Steps to reproduce\n\nIm trying to set a bucket for S3 clien in companion dynamically based on the metadata set from the client. However, when upload is done through Google Drive (or any other provider), `bucket` function property on the companion does not receive any arguments.\r\n\r\n<img width=\"1019\" alt=\"Screenshot 2023-10-24 at 8 05 32\u202fPM\" src=\"https://github.com/transloadit/uppy/assets/3453508/42748201-7dda-453a-ae79-1651bac61677\">\r\n\r\n\r\nthis is my rought setup\r\n\r\nUI: \r\n```\r\nuppy.setMeta(s3Object);\r\n\r\nuppy.use(GoogleDrive, {\r\n  companionUrl: COMPANION_URL\r\n})\r\n\r\nuppy.use(Dashboard, {\r\n  inline: true,\r\n  target: 'body',\r\n  plugins: ['GoogleDrive'],\r\n})\r\n\r\nuppy.use(AwsS3, {\r\n  companionUrl: COMPANION_URL,\r\n  shouldUseMultipart: true,\r\n})\r\n```\r\n\r\nCompanion:\r\n```\r\nconst options = {\r\n  providerOptions: {\r\n    drive: {\r\n      key: process.env.COMPANION_GOOGLE_KEY,\r\n      secret: process.env.COMPANION_GOOGLE_SECRET,\r\n    },\r\n  },\r\n  s3: {\r\n    getKey: (req, filename, metadata) => {\r\n      return `${crypto.randomUUID()}-${filename}`;\r\n    },\r\n    bucket: (req) => {\r\n      // req is undefined\r\n      return process.env.COMPANION_AWS_BUCKET;\r\n    },\r\n    secret: process.env.COMPANION_AWS_SECRET,\r\n    region: process.env.COMPANION_AWS_REGION,\r\n  },\r\n  server: { host: process.env.COMPANION_DOMAIN },\r\n  filePath: DATA_DIR,\r\n  secret: SECRET,\r\n  debug: true,\r\n}\r\n\r\nconst { app: companionApp } = companion.app(options)\r\n```\r\n\r\n\r\nI actually traced down the issue to this line:\r\n\r\nhttps://github.com/transloadit/uppy/blob/main/packages/%40uppy/companion/src/server/Uploader.js#L658\r\n\r\n```\r\nUploader.js\r\nconst params = {\r\n      Bucket: getBucket(options.bucket), // <------\r\n      Key: options.getKey(null, filename, this.options.metadata),\r\n      ContentType: this.options.metadata.type,\r\n      Metadata: rfc2047EncodeMetadata(this.options.metadata),\r\n      Body: stream,\r\n    }\r\n```\r\n\r\nit doesn't seem that a request object is passed down to `getBucket` util.\r\n\r\nIn fact, it would be very helpful if `getBucket` passed `this.options.metadata` as a second argument (similar to `getKey`).\r\n\r\n\n\n### Expected behavior\n\nBucket property as a function should receive a request object when used with server-to-server providers.\r\nAdditionally, it would be nice if it could receive `options.metadata` just like `getKey`.\r\n\r\n```\r\n bucket: (req) => {\r\n      ....\r\n},\r\n```\n\n### Actual behavior\n\nargument `req` of function property `bucket` on companion is undefined.",
                "reactions": {
                    "url": "https://api.github.com/repos/transloadit/uppy/issues/4763/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "timeline_url": "https://api.github.com/repos/transloadit/uppy/issues/4763/timeline",
                "performed_via_github_app": null,
                "state_reason": null
            },
            "comment": {
                "url": "https://api.github.com/repos/transloadit/uppy/issues/comments/1781890343",
                "html_url": "https://github.com/transloadit/uppy/issues/4763#issuecomment-1781890343",
                "issue_url": "https://api.github.com/repos/transloadit/uppy/issues/4763",
                "id": 1781890343,
                "node_id": "IC_kwDOAsITpc5qNX0n",
                "user": {
                    "login": "ivadenis",
                    "id": 3453508,
                    "node_id": "MDQ6VXNlcjM0NTM1MDg=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/3453508?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/ivadenis",
                    "html_url": "https://github.com/ivadenis",
                    "followers_url": "https://api.github.com/users/ivadenis/followers",
                    "following_url": "https://api.github.com/users/ivadenis/following{/other_user}",
                    "gists_url": "https://api.github.com/users/ivadenis/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/ivadenis/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/ivadenis/subscriptions",
                    "organizations_url": "https://api.github.com/users/ivadenis/orgs",
                    "repos_url": "https://api.github.com/users/ivadenis/repos",
                    "events_url": "https://api.github.com/users/ivadenis/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/ivadenis/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "created_at": "2023-10-26T21:02:40Z",
                "updated_at": "2023-10-26T21:02:40Z",
                "author_association": "NONE",
                "body": "@mifi you are describing slightly different issue. Im not trying to set metadata on the s3 object itself, but pass some meta info down to `bucket` function prop as an argument. Similar way how `getKey` prop works.\r\n\r\nWe dont have to pass a bucket name explicitly, but I could chose a bucket based on the metadata that is passed from the UI.\r\n\r\n",
                "reactions": {
                    "url": "https://api.github.com/repos/transloadit/uppy/issues/comments/1781890343/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "performed_via_github_app": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T21:02:41Z",
        "org": {
            "id": 125754,
            "login": "transloadit",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/transloadit",
            "avatar_url": "https://avatars.githubusercontent.com/u/125754?"
        }
    },
    {
        "id": "32881126522",
        "type": "WatchEvent",
        "actor": {
            "id": 105889121,
            "login": "AlandSleman",
            "display_login": "AlandSleman",
            "gravatar_id": "",
            "url": "https://api.github.com/users/AlandSleman",
            "avatar_url": "https://avatars.githubusercontent.com/u/105889121?"
        },
        "repo": {
            "id": 46273445,
            "name": "transloadit/uppy",
            "url": "https://api.github.com/repos/transloadit/uppy"
        },
        "payload": {
            "action": "started"
        },
        "public": true,
        "created_at": "2023-10-26T20:29:31Z",
        "org": {
            "id": 125754,
            "login": "transloadit",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/transloadit",
            "avatar_url": "https://avatars.githubusercontent.com/u/125754?"
        }
    },
    {
        "id": "32866408537",
        "type": "PullRequestReviewEvent",
        "actor": {
            "id": 9060226,
            "login": "Murderlon",
            "display_login": "Murderlon",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Murderlon",
            "avatar_url": "https://avatars.githubusercontent.com/u/9060226?"
        },
        "repo": {
            "id": 46273445,
            "name": "transloadit/uppy",
            "url": "https://api.github.com/repos/transloadit/uppy"
        },
        "payload": {
            "action": "created",
            "review": {
                "id": 1699391701,
                "node_id": "PRR_kwDOAsITpc5lSqjV",
                "user": {
                    "login": "Murderlon",
                    "id": 9060226,
                    "node_id": "MDQ6VXNlcjkwNjAyMjY=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/9060226?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/Murderlon",
                    "html_url": "https://github.com/Murderlon",
                    "followers_url": "https://api.github.com/users/Murderlon/followers",
                    "following_url": "https://api.github.com/users/Murderlon/following{/other_user}",
                    "gists_url": "https://api.github.com/users/Murderlon/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/Murderlon/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/Murderlon/subscriptions",
                    "organizations_url": "https://api.github.com/users/Murderlon/orgs",
                    "repos_url": "https://api.github.com/users/Murderlon/repos",
                    "events_url": "https://api.github.com/users/Murderlon/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/Murderlon/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": null,
                "commit_id": "a0501a940e732891215297aecf2613c847fbdc24",
                "submitted_at": "2023-10-26T11:45:13Z",
                "state": "commented",
                "html_url": "https://github.com/transloadit/uppy/pull/4734#pullrequestreview-1699391701",
                "pull_request_url": "https://api.github.com/repos/transloadit/uppy/pulls/4734",
                "author_association": "MEMBER",
                "_links": {
                    "html": {
                        "href": "https://github.com/transloadit/uppy/pull/4734#pullrequestreview-1699391701"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734"
                    }
                }
            },
            "pull_request": {
                "url": "https://api.github.com/repos/transloadit/uppy/pulls/4734",
                "id": 1556257466,
                "node_id": "PR_kwDOAsITpc5cwpq6",
                "html_url": "https://github.com/transloadit/uppy/pull/4734",
                "diff_url": "https://github.com/transloadit/uppy/pull/4734.diff",
                "patch_url": "https://github.com/transloadit/uppy/pull/4734.patch",
                "issue_url": "https://api.github.com/repos/transloadit/uppy/issues/4734",
                "number": 4734,
                "state": "open",
                "locked": false,
                "title": "Companion+client stability fixes, error handling and retry",
                "user": {
                    "login": "mifi",
                    "id": 402547,
                    "node_id": "MDQ6VXNlcjQwMjU0Nw==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/402547?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/mifi",
                    "html_url": "https://github.com/mifi",
                    "followers_url": "https://api.github.com/users/mifi/followers",
                    "following_url": "https://api.github.com/users/mifi/following{/other_user}",
                    "gists_url": "https://api.github.com/users/mifi/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/mifi/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/mifi/subscriptions",
                    "organizations_url": "https://api.github.com/users/mifi/orgs",
                    "repos_url": "https://api.github.com/users/mifi/repos",
                    "events_url": "https://api.github.com/users/mifi/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/mifi/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "- [respond with 500 if unhandled upload error](https://github.com/transloadit/uppy/commit/4f52551fe8af63032f6ac2d909ef60d1d89c90bd) \r\n 400 seems inappropriate\r\n- [fix companion download error](https://github.com/transloadit/uppy/commit/7bd5042adbad44f26b083ba01f7a64c782b19a73) \r\n  - respond with correct response code when calling /get and request to the upstream server fails\r\n  - also add a unit test for this\r\n- [forward 429 from provider](https://github.com/transloadit/uppy/commit/3fa992b23b7de675cad046daa41f064bb8cdf02c) \r\n  allows us to retry it\r\n- [add a way to test refresh tokens](https://github.com/transloadit/uppy/commit/aad9ae9d3e875cba6410618721470138448ff4cc)\r\n- [fix race condtiion with refreshing token](https://github.com/transloadit/uppy/commit/863b60e83a53c7c2e458bb0b8a39670ba94415e7) that would cause many `refresh-token` calls to be made concurrently, possibly causing problems\r\n- [implement retry and fix socket](https://github.com/transloadit/uppy/commit/7124ef484b6eda82df9c126efe6973c2427e92b8) \r\n  - Make sure we don't instantiate a new Provider for every file uploaded (reuse the original provider instead) - this caused the refresh token synchronization not to work\r\n  - Retry most errors when uploading (`/get`) using companion, but for HTTP, only retry certain HTTP status codes\r\n  - Reimplement the websocket code to be more stable and retry as well\r\n  - if no websocket messages have been received in 5 minutes, fail the upload, so the upload doesn't get stuck forever in case something goes bad, TODO should this should be solved in the UI instead?\r\n- [remove useFastRemoteRetry](https://github.com/transloadit/uppy/commit/8612d5d5ace5e7ec32db73e3632ec964657aff06) \r\n  - because it isn't supported in Companion as far as I can tell, and the option effectively doesn't do anything at all",
                "created_at": "2023-10-13T17:28:55Z",
                "updated_at": "2023-10-26T11:45:13Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "7c1c899a01eb66e45e7af9fd8b7f0bbd6748faa8",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/transloadit/uppy/pulls/4734/commits",
                "review_comments_url": "https://api.github.com/repos/transloadit/uppy/pulls/4734/comments",
                "review_comment_url": "https://api.github.com/repos/transloadit/uppy/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/transloadit/uppy/issues/4734/comments",
                "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/a0501a940e732891215297aecf2613c847fbdc24",
                "head": {
                    "label": "transloadit:companion-fixes",
                    "ref": "companion-fixes",
                    "sha": "a0501a940e732891215297aecf2613c847fbdc24",
                    "user": {
                        "login": "transloadit",
                        "id": 125754,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/transloadit",
                        "html_url": "https://github.com/transloadit",
                        "followers_url": "https://api.github.com/users/transloadit/followers",
                        "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                        "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                        "organizations_url": "https://api.github.com/users/transloadit/orgs",
                        "repos_url": "https://api.github.com/users/transloadit/repos",
                        "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/transloadit/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 46273445,
                        "node_id": "MDEwOlJlcG9zaXRvcnk0NjI3MzQ0NQ==",
                        "name": "uppy",
                        "full_name": "transloadit/uppy",
                        "private": false,
                        "owner": {
                            "login": "transloadit",
                            "id": 125754,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/transloadit",
                            "html_url": "https://github.com/transloadit",
                            "followers_url": "https://api.github.com/users/transloadit/followers",
                            "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                            "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                            "organizations_url": "https://api.github.com/users/transloadit/orgs",
                            "repos_url": "https://api.github.com/users/transloadit/repos",
                            "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/transloadit/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/transloadit/uppy",
                        "description": "The next open source file uploader for web browsers :dog: ",
                        "fork": false,
                        "url": "https://api.github.com/repos/transloadit/uppy",
                        "forks_url": "https://api.github.com/repos/transloadit/uppy/forks",
                        "keys_url": "https://api.github.com/repos/transloadit/uppy/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/transloadit/uppy/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/transloadit/uppy/teams",
                        "hooks_url": "https://api.github.com/repos/transloadit/uppy/hooks",
                        "issue_events_url": "https://api.github.com/repos/transloadit/uppy/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/transloadit/uppy/events",
                        "assignees_url": "https://api.github.com/repos/transloadit/uppy/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/transloadit/uppy/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/transloadit/uppy/tags",
                        "blobs_url": "https://api.github.com/repos/transloadit/uppy/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/transloadit/uppy/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/transloadit/uppy/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/transloadit/uppy/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/transloadit/uppy/languages",
                        "stargazers_url": "https://api.github.com/repos/transloadit/uppy/stargazers",
                        "contributors_url": "https://api.github.com/repos/transloadit/uppy/contributors",
                        "subscribers_url": "https://api.github.com/repos/transloadit/uppy/subscribers",
                        "subscription_url": "https://api.github.com/repos/transloadit/uppy/subscription",
                        "commits_url": "https://api.github.com/repos/transloadit/uppy/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/transloadit/uppy/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/transloadit/uppy/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/transloadit/uppy/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/transloadit/uppy/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/transloadit/uppy/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/transloadit/uppy/merges",
                        "archive_url": "https://api.github.com/repos/transloadit/uppy/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/transloadit/uppy/downloads",
                        "issues_url": "https://api.github.com/repos/transloadit/uppy/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/transloadit/uppy/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/transloadit/uppy/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/transloadit/uppy/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/transloadit/uppy/labels{/name}",
                        "releases_url": "https://api.github.com/repos/transloadit/uppy/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/transloadit/uppy/deployments",
                        "created_at": "2015-11-16T12:32:33Z",
                        "updated_at": "2023-10-26T10:03:44Z",
                        "pushed_at": "2023-10-25T15:17:29Z",
                        "git_url": "git://github.com/transloadit/uppy.git",
                        "ssh_url": "git@github.com:transloadit/uppy.git",
                        "clone_url": "https://github.com/transloadit/uppy.git",
                        "svn_url": "https://github.com/transloadit/uppy",
                        "homepage": "https://uppy.io",
                        "size": 389980,
                        "stargazers_count": 27488,
                        "watchers_count": 27488,
                        "language": "JavaScript",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": true,
                        "has_discussions": false,
                        "forks_count": 1934,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 168,
                        "license": {
                            "key": "mit",
                            "name": "MIT License",
                            "spdx_id": "MIT",
                            "url": "https://api.github.com/licenses/mit",
                            "node_id": "MDc6TGljZW5zZTEz"
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "dropbox",
                            "encoding",
                            "file-uploader",
                            "file-uploads",
                            "files",
                            "hacktoberfest",
                            "instagram",
                            "javascript",
                            "mit",
                            "modular",
                            "open-source",
                            "pick-files",
                            "resumable",
                            "transloadit",
                            "tus",
                            "uploader",
                            "uppy",
                            "webbrowser"
                        ],
                        "visibility": "public",
                        "forks": 1934,
                        "open_issues": 168,
                        "watchers": 27488,
                        "default_branch": "main"
                    }
                },
                "base": {
                    "label": "transloadit:main",
                    "ref": "main",
                    "sha": "8b252086f5e2769e0a2e95c22ac48b63b9ecfbd1",
                    "user": {
                        "login": "transloadit",
                        "id": 125754,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/transloadit",
                        "html_url": "https://github.com/transloadit",
                        "followers_url": "https://api.github.com/users/transloadit/followers",
                        "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                        "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                        "organizations_url": "https://api.github.com/users/transloadit/orgs",
                        "repos_url": "https://api.github.com/users/transloadit/repos",
                        "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/transloadit/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 46273445,
                        "node_id": "MDEwOlJlcG9zaXRvcnk0NjI3MzQ0NQ==",
                        "name": "uppy",
                        "full_name": "transloadit/uppy",
                        "private": false,
                        "owner": {
                            "login": "transloadit",
                            "id": 125754,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/transloadit",
                            "html_url": "https://github.com/transloadit",
                            "followers_url": "https://api.github.com/users/transloadit/followers",
                            "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                            "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                            "organizations_url": "https://api.github.com/users/transloadit/orgs",
                            "repos_url": "https://api.github.com/users/transloadit/repos",
                            "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/transloadit/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/transloadit/uppy",
                        "description": "The next open source file uploader for web browsers :dog: ",
                        "fork": false,
                        "url": "https://api.github.com/repos/transloadit/uppy",
                        "forks_url": "https://api.github.com/repos/transloadit/uppy/forks",
                        "keys_url": "https://api.github.com/repos/transloadit/uppy/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/transloadit/uppy/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/transloadit/uppy/teams",
                        "hooks_url": "https://api.github.com/repos/transloadit/uppy/hooks",
                        "issue_events_url": "https://api.github.com/repos/transloadit/uppy/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/transloadit/uppy/events",
                        "assignees_url": "https://api.github.com/repos/transloadit/uppy/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/transloadit/uppy/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/transloadit/uppy/tags",
                        "blobs_url": "https://api.github.com/repos/transloadit/uppy/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/transloadit/uppy/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/transloadit/uppy/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/transloadit/uppy/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/transloadit/uppy/languages",
                        "stargazers_url": "https://api.github.com/repos/transloadit/uppy/stargazers",
                        "contributors_url": "https://api.github.com/repos/transloadit/uppy/contributors",
                        "subscribers_url": "https://api.github.com/repos/transloadit/uppy/subscribers",
                        "subscription_url": "https://api.github.com/repos/transloadit/uppy/subscription",
                        "commits_url": "https://api.github.com/repos/transloadit/uppy/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/transloadit/uppy/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/transloadit/uppy/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/transloadit/uppy/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/transloadit/uppy/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/transloadit/uppy/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/transloadit/uppy/merges",
                        "archive_url": "https://api.github.com/repos/transloadit/uppy/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/transloadit/uppy/downloads",
                        "issues_url": "https://api.github.com/repos/transloadit/uppy/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/transloadit/uppy/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/transloadit/uppy/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/transloadit/uppy/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/transloadit/uppy/labels{/name}",
                        "releases_url": "https://api.github.com/repos/transloadit/uppy/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/transloadit/uppy/deployments",
                        "created_at": "2015-11-16T12:32:33Z",
                        "updated_at": "2023-10-26T10:03:44Z",
                        "pushed_at": "2023-10-25T15:17:29Z",
                        "git_url": "git://github.com/transloadit/uppy.git",
                        "ssh_url": "git@github.com:transloadit/uppy.git",
                        "clone_url": "https://github.com/transloadit/uppy.git",
                        "svn_url": "https://github.com/transloadit/uppy",
                        "homepage": "https://uppy.io",
                        "size": 389980,
                        "stargazers_count": 27488,
                        "watchers_count": 27488,
                        "language": "JavaScript",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": true,
                        "has_discussions": false,
                        "forks_count": 1934,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 168,
                        "license": {
                            "key": "mit",
                            "name": "MIT License",
                            "spdx_id": "MIT",
                            "url": "https://api.github.com/licenses/mit",
                            "node_id": "MDc6TGljZW5zZTEz"
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "dropbox",
                            "encoding",
                            "file-uploader",
                            "file-uploads",
                            "files",
                            "hacktoberfest",
                            "instagram",
                            "javascript",
                            "mit",
                            "modular",
                            "open-source",
                            "pick-files",
                            "resumable",
                            "transloadit",
                            "tus",
                            "uploader",
                            "uppy",
                            "webbrowser"
                        ],
                        "visibility": "public",
                        "forks": 1934,
                        "open_issues": 168,
                        "watchers": 27488,
                        "default_branch": "main"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734"
                    },
                    "html": {
                        "href": "https://github.com/transloadit/uppy/pull/4734"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/transloadit/uppy/issues/4734"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/transloadit/uppy/issues/4734/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/transloadit/uppy/statuses/a0501a940e732891215297aecf2613c847fbdc24"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T11:45:14Z",
        "org": {
            "id": 125754,
            "login": "transloadit",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/transloadit",
            "avatar_url": "https://avatars.githubusercontent.com/u/125754?"
        }
    },
    {
        "id": "32866408616",
        "type": "PullRequestReviewCommentEvent",
        "actor": {
            "id": 9060226,
            "login": "Murderlon",
            "display_login": "Murderlon",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Murderlon",
            "avatar_url": "https://avatars.githubusercontent.com/u/9060226?"
        },
        "repo": {
            "id": 46273445,
            "name": "transloadit/uppy",
            "url": "https://api.github.com/repos/transloadit/uppy"
        },
        "payload": {
            "action": "created",
            "comment": {
                "url": "https://api.github.com/repos/transloadit/uppy/pulls/comments/1373025458",
                "pull_request_review_id": 1699391701,
                "id": 1373025458,
                "node_id": "PRRC_kwDOAsITpc5R1rSy",
                "diff_hunk": "@@ -222,179 +240,273 @@ export default class RequestClient {\n     return this.request({ ...options, path, method: 'DELETE', data })\n   }\n \n+  /**\n+   * Remote uploading consists of two steps:\n+   * 1. #requestSocketToken which starts the download/upload in companion and returns a unique token for the upload.\n+   * Then companion will halt the upload until:\n+   * 2. #awaitRemoteFileUpload is called, which will open/ensure a websocket connection towards companion, with the\n+   * previously generated token provided. It returns a promise that will resolve/reject once the file has finished\n+   * uploading or is otherwise done (failed, canceled)\n+   * \n+   * @param {*} file \n+   * @param {*} reqBody \n+   * @param {*} options \n+   * @returns \n+   */\n   async uploadRemoteFile (file, reqBody, options = {}) {\n     try {\n-      if (file.serverToken) {\n-        return await this.connectToServerSocket(file, this.getQueue())\n-      }\n-      const queueRequestSocketToken = this.getQueue().wrapPromiseFunction(\n-        this.#requestSocketToken,\n-        { priority: -1 },\n-      )\n-      const serverToken = await queueRequestSocketToken(file, reqBody).abortOn(\n-        options.signal,\n-      )\n-\n-      if (!this.uppy.getState().files[file.id]) return undefined\n-\n-      this.uppy.setFileState(file.id, { serverToken })\n-      return await this.connectToServerSocket(\n-        this.uppy.getFile(file.id),\n-        this.getQueue(),\n-      )\n+      const { signal, getQueue } = options\n+\n+      return await pRetry(async () => {\n+        // if we already have a serverToken, assume that we are resuming the existing server upload id\n+        const existingServerToken = this.uppy.getFile(file.id)?.serverToken;\n+        if (existingServerToken != null) {\n+          this.uppy.log(`Connecting to exiting websocket ${existingServerToken}`)\n+          return this.#awaitRemoteFileUpload({ file, queue: getQueue(), signal })\n+        }\n+\n+        const queueRequestSocketToken = getQueue().wrapPromiseFunction(async (...args) => {\n+          try {\n+            return await this.#requestSocketToken(...args)\n+          } catch (outerErr) {\n+            // throwing AbortError will cause p-retry to stop retrying\n+            if (outerErr instanceof AuthError) throw new AbortError(outerErr)\n+\n+            if (outerErr.cause == null) throw outerErr\n+            const err = outerErr.cause\n+\n+            const isRetryableHttpError = () => (\n+              [408, 409, 429, 418, 423].includes(err.statusCode)\n+              || (err.statusCode >= 500 && err.statusCode <= 599 && ![501, 505].includes(err.statusCode))\n+            )\n+            if (err instanceof HttpError && !isRetryableHttpError()) throw new AbortError(err);\n+  \n+            // p-retry will retry most other errors,\n+            // but it will not retry TypeError (except network error TypeErrors)\n+            throw err\n+          }\n+        }, { priority: -1 })\n+\n+        const serverToken = await queueRequestSocketToken(file, reqBody).abortOn(signal)\n+\n+        if (!this.uppy.getFile(file.id)) return undefined // has file since been removed?\n+\n+        this.uppy.setFileState(file.id, { serverToken })\n+\n+        return this.#awaitRemoteFileUpload({\n+          file: this.uppy.getFile(file.id), // re-fetching file because it might have changed in the meantime\n+          queue: getQueue(),\n+          signal\n+        })\n+      }, { retries: retryCount, signal, onFailedAttempt: (err) => this.uppy.log(`Retrying upload due to: ${err.message}`, 'warning') });\n     } catch (err) {\n+      // this is a bit confusing, but an error with name 'AbortError' (from `signal`) is not the same as `p-retry` AbortError\n       if (err?.cause?.name === 'AbortError') {\n         // The file upload was aborted, it\u2019s not an error\n         return undefined\n       }\n \n-      this.uppy.setFileState(file.id, { serverToken: undefined })\n       this.uppy.emit('upload-error', file, err)\n       throw err\n     }\n   }\n \n-  #requestSocketToken = async (file, postBody) => {\n+  #requestSocketToken = async (file, postBody, signal) => {\n     if (file.remote.url == null) {\n       throw new Error('Cannot connect to an undefined URL')\n     }\n \n     const res = await this.post(file.remote.url, {\n       ...file.remote.body,\n       ...postBody,\n-    })\n+    }, signal)\n \n     return res.token\n   }\n \n   /**\n-   * @param {UppyFile} file\n+   * This method will ensure a websocket for the specified file and returns a promise that resolves\n+   * when the file has finished downloading, or rejects if it fails.\n+   * It will retry if the websocket gets disconnected\n+   * \n+   * @param {{ file: UppyFile, queue: RateLimitedQueue, signal: AbortSignal }} file\n    */\n-  async connectToServerSocket (file, queue) {\n-    return new Promise((resolve, reject) => {\n-      const token = file.serverToken\n-      const host = getSocketHost(file.remote.companionUrl)\n-      const socket = new Socket({\n-        target: `${host}/api/${token}`,\n-        autoOpen: false,\n-      })\n-      const eventManager = new EventManager(this.uppy)\n+  async #awaitRemoteFileUpload ({ file, queue, signal }) {\n+    const eventManager = new EventManager(this.uppy)\n \n-      let queuedRequest\n-\n-      eventManager.onFileRemove(file.id, () => {\n-        socket.send('cancel', {})\n-        queuedRequest.abort()\n-        resolve(`upload ${file.id} was removed`)\n-      })\n-\n-      eventManager.onPause(file.id, (isPaused) => {\n-        if (isPaused) {\n-          // Remove this file from the queue so another file can start in its place.\n-          socket.send('pause', {})\n-          queuedRequest.abort()\n-        } else {\n-          // Resuming an upload should be queued, else you could pause and then\n-          // resume a queued upload to make it skip the queue.\n-          queuedRequest.abort()\n-          queuedRequest = queue.run(() => {\n-            socket.open()\n-            socket.send('resume', {})\n-\n-            return () => {}\n-          })\n-        }\n-      })\n-\n-      eventManager.onPauseAll(file.id, () => {\n-        socket.send('pause', {})\n-        queuedRequest.abort()\n-      })\n-\n-      eventManager.onCancelAll(file.id, ({ reason } = {}) => {\n-        if (reason === 'user') {\n-          socket.send('cancel', {})\n-          queuedRequest.abort()\n+    try {\n+      return await new Promise((resolve, reject) => {\n+        const token = file.serverToken\n+        const host = getSocketHost(file.remote.companionUrl)\n+\n+        /** @type {WebSocket} */\n+        let socket\n+        /** @type {AbortController?} */\n+        let socketAbortController\n+        let activityTimeout\n+\n+        let { isPaused } = file\n+\n+        const socketSend = (action, payload) => {\n+          if (socket == null || socket.readyState !== socket.OPEN) {\n+            this.uppy.log(`Cannot send \"${action}\" to socket ${file.id} because the socket state was ${String(socket?.readyState)}`, 'warning')\n+            return\n+          }\n+\n+          socket.send(JSON.stringify({\n+            action,\n+            payload: payload ?? {},\n+          }))    \n+        };\n+\n+        function sendState() {\n+          if (isPaused) socketSend('pause')\n+          else socketSend('resume')\n         }\n-        resolve(`upload ${file.id} was canceled`)\n-      })\n \n-      eventManager.onResumeAll(file.id, () => {\n-        queuedRequest.abort()\n-        if (file.error) {\n-          socket.send('pause', {})\n+        const createWebsocket = async () => {\n+          if (socketAbortController) socketAbortController.abort()\n+          socketAbortController = new AbortController()\n+\n+          const onFatalError = (err) => {\n+            // Remove the serverToken so that a new one will be created for the retry.\n+            this.uppy.setFileState(file.id, { serverToken: null })\n+            socketAbortController?.abort?.()\n+            reject(err)\n+          }\n+  \n+          // todo instead implement the ability for users to cancel / retry *currently uploading files* in the UI\n+          function resetActivityTimeout() {\n+            clearTimeout(activityTimeout)\n+            if (isPaused) return\n+            activityTimeout = setTimeout(() => onFatalError(new Error('Timeout waiting for message from Companion socket')), socketActivityTimeoutMs)\n+          }\n+\n+          try {\n+            await queue.wrapPromiseFunction(async () => {\n+              // eslint-disable-next-line promise/param-names\n+              const reconnectWebsocket = async () => new Promise((resolveSocket, rejectSocket) => {\n+                socket = new WebSocket(`${host}/api/${token}`)\n+\n+                resetActivityTimeout()\n+\n+                socket.addEventListener('close', () => {\n+                  socket = undefined\n+                  rejectSocket(new Error('Socket closed unexpectedly'))\n+                })\n+\n+                socket.addEventListener('error', (error) => {\n+                  this.uppy.log(`Companion socket error ${JSON.stringify(error)}, closing socket`, 'warning')\n+                  socket.close() // will 'close' event to be emitted\n+                })\n+\n+                socket.addEventListener('open', () => {\n+                  sendState()\n+                })\n+\n+                socket.addEventListener('message', (e) => {\n+                  resetActivityTimeout()\n+\n+                  try {\n+                    const { action, payload } = JSON.parse(e.data)\n+            \n+                    switch (action) {\n+                      case 'progress': {\n+                        emitSocketProgress(this, payload, file)\n+                        break;\n+                      }\n+                      case 'success': {\n+                        this.uppy.emit('upload-success', file, { uploadURL: payload.url })\n+                        socketAbortController?.abort?.()\n+                        resolve()\n+                        break;\n+                      }\n+                      case 'error': {\n+                        const { message } = payload.error\n+                        throw Object.assign(new Error(message), { cause: payload.error })\n+                      }\n+                        default:\n+                          this.uppy.log(`Companion socket unknown action ${action}`, 'warning')\n+                    }\n+                  } catch (err) {\n+                    onFatalError(err)\n+                  }\n+                })\n+\n+                const closeSocket = () => {\n+                  this.uppy.log(`Closing socket ${file.id}`, 'info')\n+                  clearTimeout(activityTimeout)\n+                  if (socket) socket.close()\n+                  socket = undefined\n+                }\n+        \n+                socketAbortController.signal.addEventListener('abort', () => {\n+                  closeSocket()\n+                })\n+              })\n+\n+              await pRetry(reconnectWebsocket, {\n+                retries: retryCount,\n+                signal: socketAbortController.signal,\n+                onFailedAttempt: () => this.uppy.log(`Retrying websocket ${file.id}`, 'info'),\n+              });\n+            })().abortOn(socketAbortController.signal);\n+          } catch (err) {\n+            if (socketAbortController.signal.aborted) return\n+            onFatalError(err)\n+          }\n         }\n-        queuedRequest = queue.run(() => {\n-          socket.open()\n-          socket.send('resume', {})\n \n-          return () => {}\n-        })\n-      })\n-\n-      eventManager.onRetry(file.id, () => {\n-        // Only do the retry if the upload is actually in progress;\n-        // else we could try to send these messages when the upload is still queued.\n-        // We may need a better check for this since the socket may also be closed\n-        // for other reasons, like network failures.\n-        if (socket.isOpen) {\n-          socket.send('pause', {})\n-          socket.send('resume', {})\n+        const pause = (newPausedState) => {\n+          isPaused = newPausedState\n+          if (socket) sendState()\n+\n+          if (newPausedState) {\n+            // Remove this file from the queue so another file can start in its place.\n+            socketAbortController?.abort?.() // close socket to free up the request for other uploads\n+          } else {\n+            // Resuming an upload should be queued, else you could pause and then\n+            // resume a queued upload to make it skip the queue.\n+            createWebsocket()\n+          }\n         }\n-      })\n \n-      eventManager.onRetryAll(file.id, () => {\n-        // See the comment in the onRetry() call\n-        if (socket.isOpen) {\n-          socket.send('pause', {})\n-          socket.send('resume', {})\n+        const withErrorHandling = (fn, event) => {\n+          try {\n+            fn()\n+          } catch (err) {\n+            this.uppy.log(`Error while handling ${event} event for file ${file.id}: ${err.message}`, 'error')\n+          }\n         }\n-      })\n-\n-      socket.on('progress', (progressData) => emitSocketProgress(this, progressData, file))\n \n-      socket.on('error', (errData) => {\n-        const { message } = errData.error\n-        const error = Object.assign(new Error(message), {\n-          cause: errData.error,\n+        eventManager.onPause(file.id, (newPausedState) => withErrorHandling(() => pause(newPausedState), 'pause'))\n+        eventManager.onPauseAll(file.id, () => withErrorHandling(() => pause(true), 'pause-all'))\n+        eventManager.onResumeAll(file.id, () => withErrorHandling(() => pause(false), 'resume-all'))\n+\n+        eventManager.onFileRemove(file.id, () => withErrorHandling(() => {\n+          socketSend('cancel')\n+          socketAbortController?.abort?.()\n+          this.uppy.log(`upload ${file.id} was removed`, 'info')\n+          resolve()\n+        }, 'file-removed'))\n+\n+        eventManager.onCancelAll(file.id, ({ reason } = {}) => withErrorHandling(() => {\n+          if (reason === 'user') {\n+            socketSend('cancel')\n+          }\n+          socketAbortController?.abort?.()\n+          this.uppy.log(`upload ${file.id} was canceled`, 'info')\n+          resolve()\n+        }, 'cancel-all'))",
                "path": "packages/@uppy/companion-client/src/RequestClient.js",
                "commit_id": "a0501a940e732891215297aecf2613c847fbdc24",
                "original_commit_id": "a0501a940e732891215297aecf2613c847fbdc24",
                "user": {
                    "login": "Murderlon",
                    "id": 9060226,
                    "node_id": "MDQ6VXNlcjkwNjAyMjY=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/9060226?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/Murderlon",
                    "html_url": "https://github.com/Murderlon",
                    "followers_url": "https://api.github.com/users/Murderlon/followers",
                    "following_url": "https://api.github.com/users/Murderlon/following{/other_user}",
                    "gists_url": "https://api.github.com/users/Murderlon/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/Murderlon/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/Murderlon/subscriptions",
                    "organizations_url": "https://api.github.com/users/Murderlon/orgs",
                    "repos_url": "https://api.github.com/users/Murderlon/repos",
                    "events_url": "https://api.github.com/users/Murderlon/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/Murderlon/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "I'm also thinking it's probably better to specifically check for something that might be undefined and model around that accordingly, rather than wrapping everything in a `try`/`catch`. imo `try`/`catch` should only be used for promises, not type errors.",
                "created_at": "2023-10-26T11:45:13Z",
                "updated_at": "2023-10-26T11:45:13Z",
                "html_url": "https://github.com/transloadit/uppy/pull/4734#discussion_r1373025458",
                "pull_request_url": "https://api.github.com/repos/transloadit/uppy/pulls/4734",
                "author_association": "MEMBER",
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/comments/1373025458"
                    },
                    "html": {
                        "href": "https://github.com/transloadit/uppy/pull/4734#discussion_r1373025458"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734"
                    }
                },
                "reactions": {
                    "url": "https://api.github.com/repos/transloadit/uppy/pulls/comments/1373025458/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "start_line": 482,
                "original_start_line": 482,
                "start_side": "RIGHT",
                "line": 500,
                "original_line": 500,
                "side": "RIGHT",
                "in_reply_to_id": 1372909302,
                "original_position": 452,
                "position": 452,
                "subject_type": "line"
            },
            "pull_request": {
                "url": "https://api.github.com/repos/transloadit/uppy/pulls/4734",
                "id": 1556257466,
                "node_id": "PR_kwDOAsITpc5cwpq6",
                "html_url": "https://github.com/transloadit/uppy/pull/4734",
                "diff_url": "https://github.com/transloadit/uppy/pull/4734.diff",
                "patch_url": "https://github.com/transloadit/uppy/pull/4734.patch",
                "issue_url": "https://api.github.com/repos/transloadit/uppy/issues/4734",
                "number": 4734,
                "state": "open",
                "locked": false,
                "title": "Companion+client stability fixes, error handling and retry",
                "user": {
                    "login": "mifi",
                    "id": 402547,
                    "node_id": "MDQ6VXNlcjQwMjU0Nw==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/402547?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/mifi",
                    "html_url": "https://github.com/mifi",
                    "followers_url": "https://api.github.com/users/mifi/followers",
                    "following_url": "https://api.github.com/users/mifi/following{/other_user}",
                    "gists_url": "https://api.github.com/users/mifi/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/mifi/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/mifi/subscriptions",
                    "organizations_url": "https://api.github.com/users/mifi/orgs",
                    "repos_url": "https://api.github.com/users/mifi/repos",
                    "events_url": "https://api.github.com/users/mifi/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/mifi/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "- [respond with 500 if unhandled upload error](https://github.com/transloadit/uppy/commit/4f52551fe8af63032f6ac2d909ef60d1d89c90bd) \r\n 400 seems inappropriate\r\n- [fix companion download error](https://github.com/transloadit/uppy/commit/7bd5042adbad44f26b083ba01f7a64c782b19a73) \r\n  - respond with correct response code when calling /get and request to the upstream server fails\r\n  - also add a unit test for this\r\n- [forward 429 from provider](https://github.com/transloadit/uppy/commit/3fa992b23b7de675cad046daa41f064bb8cdf02c) \r\n  allows us to retry it\r\n- [add a way to test refresh tokens](https://github.com/transloadit/uppy/commit/aad9ae9d3e875cba6410618721470138448ff4cc)\r\n- [fix race condtiion with refreshing token](https://github.com/transloadit/uppy/commit/863b60e83a53c7c2e458bb0b8a39670ba94415e7) that would cause many `refresh-token` calls to be made concurrently, possibly causing problems\r\n- [implement retry and fix socket](https://github.com/transloadit/uppy/commit/7124ef484b6eda82df9c126efe6973c2427e92b8) \r\n  - Make sure we don't instantiate a new Provider for every file uploaded (reuse the original provider instead) - this caused the refresh token synchronization not to work\r\n  - Retry most errors when uploading (`/get`) using companion, but for HTTP, only retry certain HTTP status codes\r\n  - Reimplement the websocket code to be more stable and retry as well\r\n  - if no websocket messages have been received in 5 minutes, fail the upload, so the upload doesn't get stuck forever in case something goes bad, TODO should this should be solved in the UI instead?\r\n- [remove useFastRemoteRetry](https://github.com/transloadit/uppy/commit/8612d5d5ace5e7ec32db73e3632ec964657aff06) \r\n  - because it isn't supported in Companion as far as I can tell, and the option effectively doesn't do anything at all",
                "created_at": "2023-10-13T17:28:55Z",
                "updated_at": "2023-10-26T11:45:13Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "7c1c899a01eb66e45e7af9fd8b7f0bbd6748faa8",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/transloadit/uppy/pulls/4734/commits",
                "review_comments_url": "https://api.github.com/repos/transloadit/uppy/pulls/4734/comments",
                "review_comment_url": "https://api.github.com/repos/transloadit/uppy/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/transloadit/uppy/issues/4734/comments",
                "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/a0501a940e732891215297aecf2613c847fbdc24",
                "head": {
                    "label": "transloadit:companion-fixes",
                    "ref": "companion-fixes",
                    "sha": "a0501a940e732891215297aecf2613c847fbdc24",
                    "user": {
                        "login": "transloadit",
                        "id": 125754,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/transloadit",
                        "html_url": "https://github.com/transloadit",
                        "followers_url": "https://api.github.com/users/transloadit/followers",
                        "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                        "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                        "organizations_url": "https://api.github.com/users/transloadit/orgs",
                        "repos_url": "https://api.github.com/users/transloadit/repos",
                        "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/transloadit/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 46273445,
                        "node_id": "MDEwOlJlcG9zaXRvcnk0NjI3MzQ0NQ==",
                        "name": "uppy",
                        "full_name": "transloadit/uppy",
                        "private": false,
                        "owner": {
                            "login": "transloadit",
                            "id": 125754,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/transloadit",
                            "html_url": "https://github.com/transloadit",
                            "followers_url": "https://api.github.com/users/transloadit/followers",
                            "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                            "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                            "organizations_url": "https://api.github.com/users/transloadit/orgs",
                            "repos_url": "https://api.github.com/users/transloadit/repos",
                            "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/transloadit/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/transloadit/uppy",
                        "description": "The next open source file uploader for web browsers :dog: ",
                        "fork": false,
                        "url": "https://api.github.com/repos/transloadit/uppy",
                        "forks_url": "https://api.github.com/repos/transloadit/uppy/forks",
                        "keys_url": "https://api.github.com/repos/transloadit/uppy/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/transloadit/uppy/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/transloadit/uppy/teams",
                        "hooks_url": "https://api.github.com/repos/transloadit/uppy/hooks",
                        "issue_events_url": "https://api.github.com/repos/transloadit/uppy/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/transloadit/uppy/events",
                        "assignees_url": "https://api.github.com/repos/transloadit/uppy/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/transloadit/uppy/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/transloadit/uppy/tags",
                        "blobs_url": "https://api.github.com/repos/transloadit/uppy/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/transloadit/uppy/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/transloadit/uppy/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/transloadit/uppy/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/transloadit/uppy/languages",
                        "stargazers_url": "https://api.github.com/repos/transloadit/uppy/stargazers",
                        "contributors_url": "https://api.github.com/repos/transloadit/uppy/contributors",
                        "subscribers_url": "https://api.github.com/repos/transloadit/uppy/subscribers",
                        "subscription_url": "https://api.github.com/repos/transloadit/uppy/subscription",
                        "commits_url": "https://api.github.com/repos/transloadit/uppy/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/transloadit/uppy/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/transloadit/uppy/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/transloadit/uppy/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/transloadit/uppy/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/transloadit/uppy/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/transloadit/uppy/merges",
                        "archive_url": "https://api.github.com/repos/transloadit/uppy/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/transloadit/uppy/downloads",
                        "issues_url": "https://api.github.com/repos/transloadit/uppy/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/transloadit/uppy/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/transloadit/uppy/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/transloadit/uppy/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/transloadit/uppy/labels{/name}",
                        "releases_url": "https://api.github.com/repos/transloadit/uppy/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/transloadit/uppy/deployments",
                        "created_at": "2015-11-16T12:32:33Z",
                        "updated_at": "2023-10-26T10:03:44Z",
                        "pushed_at": "2023-10-25T15:17:29Z",
                        "git_url": "git://github.com/transloadit/uppy.git",
                        "ssh_url": "git@github.com:transloadit/uppy.git",
                        "clone_url": "https://github.com/transloadit/uppy.git",
                        "svn_url": "https://github.com/transloadit/uppy",
                        "homepage": "https://uppy.io",
                        "size": 389980,
                        "stargazers_count": 27488,
                        "watchers_count": 27488,
                        "language": "JavaScript",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": true,
                        "has_discussions": false,
                        "forks_count": 1934,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 168,
                        "license": {
                            "key": "mit",
                            "name": "MIT License",
                            "spdx_id": "MIT",
                            "url": "https://api.github.com/licenses/mit",
                            "node_id": "MDc6TGljZW5zZTEz"
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "dropbox",
                            "encoding",
                            "file-uploader",
                            "file-uploads",
                            "files",
                            "hacktoberfest",
                            "instagram",
                            "javascript",
                            "mit",
                            "modular",
                            "open-source",
                            "pick-files",
                            "resumable",
                            "transloadit",
                            "tus",
                            "uploader",
                            "uppy",
                            "webbrowser"
                        ],
                        "visibility": "public",
                        "forks": 1934,
                        "open_issues": 168,
                        "watchers": 27488,
                        "default_branch": "main"
                    }
                },
                "base": {
                    "label": "transloadit:main",
                    "ref": "main",
                    "sha": "8b252086f5e2769e0a2e95c22ac48b63b9ecfbd1",
                    "user": {
                        "login": "transloadit",
                        "id": 125754,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/transloadit",
                        "html_url": "https://github.com/transloadit",
                        "followers_url": "https://api.github.com/users/transloadit/followers",
                        "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                        "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                        "organizations_url": "https://api.github.com/users/transloadit/orgs",
                        "repos_url": "https://api.github.com/users/transloadit/repos",
                        "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/transloadit/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 46273445,
                        "node_id": "MDEwOlJlcG9zaXRvcnk0NjI3MzQ0NQ==",
                        "name": "uppy",
                        "full_name": "transloadit/uppy",
                        "private": false,
                        "owner": {
                            "login": "transloadit",
                            "id": 125754,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/transloadit",
                            "html_url": "https://github.com/transloadit",
                            "followers_url": "https://api.github.com/users/transloadit/followers",
                            "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                            "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                            "organizations_url": "https://api.github.com/users/transloadit/orgs",
                            "repos_url": "https://api.github.com/users/transloadit/repos",
                            "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/transloadit/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/transloadit/uppy",
                        "description": "The next open source file uploader for web browsers :dog: ",
                        "fork": false,
                        "url": "https://api.github.com/repos/transloadit/uppy",
                        "forks_url": "https://api.github.com/repos/transloadit/uppy/forks",
                        "keys_url": "https://api.github.com/repos/transloadit/uppy/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/transloadit/uppy/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/transloadit/uppy/teams",
                        "hooks_url": "https://api.github.com/repos/transloadit/uppy/hooks",
                        "issue_events_url": "https://api.github.com/repos/transloadit/uppy/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/transloadit/uppy/events",
                        "assignees_url": "https://api.github.com/repos/transloadit/uppy/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/transloadit/uppy/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/transloadit/uppy/tags",
                        "blobs_url": "https://api.github.com/repos/transloadit/uppy/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/transloadit/uppy/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/transloadit/uppy/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/transloadit/uppy/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/transloadit/uppy/languages",
                        "stargazers_url": "https://api.github.com/repos/transloadit/uppy/stargazers",
                        "contributors_url": "https://api.github.com/repos/transloadit/uppy/contributors",
                        "subscribers_url": "https://api.github.com/repos/transloadit/uppy/subscribers",
                        "subscription_url": "https://api.github.com/repos/transloadit/uppy/subscription",
                        "commits_url": "https://api.github.com/repos/transloadit/uppy/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/transloadit/uppy/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/transloadit/uppy/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/transloadit/uppy/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/transloadit/uppy/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/transloadit/uppy/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/transloadit/uppy/merges",
                        "archive_url": "https://api.github.com/repos/transloadit/uppy/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/transloadit/uppy/downloads",
                        "issues_url": "https://api.github.com/repos/transloadit/uppy/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/transloadit/uppy/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/transloadit/uppy/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/transloadit/uppy/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/transloadit/uppy/labels{/name}",
                        "releases_url": "https://api.github.com/repos/transloadit/uppy/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/transloadit/uppy/deployments",
                        "created_at": "2015-11-16T12:32:33Z",
                        "updated_at": "2023-10-26T10:03:44Z",
                        "pushed_at": "2023-10-25T15:17:29Z",
                        "git_url": "git://github.com/transloadit/uppy.git",
                        "ssh_url": "git@github.com:transloadit/uppy.git",
                        "clone_url": "https://github.com/transloadit/uppy.git",
                        "svn_url": "https://github.com/transloadit/uppy",
                        "homepage": "https://uppy.io",
                        "size": 389980,
                        "stargazers_count": 27488,
                        "watchers_count": 27488,
                        "language": "JavaScript",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": true,
                        "has_discussions": false,
                        "forks_count": 1934,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 168,
                        "license": {
                            "key": "mit",
                            "name": "MIT License",
                            "spdx_id": "MIT",
                            "url": "https://api.github.com/licenses/mit",
                            "node_id": "MDc6TGljZW5zZTEz"
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "dropbox",
                            "encoding",
                            "file-uploader",
                            "file-uploads",
                            "files",
                            "hacktoberfest",
                            "instagram",
                            "javascript",
                            "mit",
                            "modular",
                            "open-source",
                            "pick-files",
                            "resumable",
                            "transloadit",
                            "tus",
                            "uploader",
                            "uppy",
                            "webbrowser"
                        ],
                        "visibility": "public",
                        "forks": 1934,
                        "open_issues": 168,
                        "watchers": 27488,
                        "default_branch": "main"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734"
                    },
                    "html": {
                        "href": "https://github.com/transloadit/uppy/pull/4734"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/transloadit/uppy/issues/4734"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/transloadit/uppy/issues/4734/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/transloadit/uppy/statuses/a0501a940e732891215297aecf2613c847fbdc24"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T11:45:13Z",
        "org": {
            "id": 125754,
            "login": "transloadit",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/transloadit",
            "avatar_url": "https://avatars.githubusercontent.com/u/125754?"
        }
    },
    {
        "id": "32866278042",
        "type": "PullRequestReviewCommentEvent",
        "actor": {
            "id": 402547,
            "login": "mifi",
            "display_login": "mifi",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mifi",
            "avatar_url": "https://avatars.githubusercontent.com/u/402547?"
        },
        "repo": {
            "id": 46273445,
            "name": "transloadit/uppy",
            "url": "https://api.github.com/repos/transloadit/uppy"
        },
        "payload": {
            "action": "created",
            "comment": {
                "url": "https://api.github.com/repos/transloadit/uppy/pulls/comments/1373019456",
                "pull_request_review_id": 1699380562,
                "id": 1373019456,
                "node_id": "PRRC_kwDOAsITpc5R1p1A",
                "diff_hunk": "@@ -222,179 +240,273 @@ export default class RequestClient {\n     return this.request({ ...options, path, method: 'DELETE', data })\n   }\n \n+  /**\n+   * Remote uploading consists of two steps:\n+   * 1. #requestSocketToken which starts the download/upload in companion and returns a unique token for the upload.\n+   * Then companion will halt the upload until:\n+   * 2. #awaitRemoteFileUpload is called, which will open/ensure a websocket connection towards companion, with the\n+   * previously generated token provided. It returns a promise that will resolve/reject once the file has finished\n+   * uploading or is otherwise done (failed, canceled)\n+   * \n+   * @param {*} file \n+   * @param {*} reqBody \n+   * @param {*} options \n+   * @returns \n+   */\n   async uploadRemoteFile (file, reqBody, options = {}) {\n     try {\n-      if (file.serverToken) {\n-        return await this.connectToServerSocket(file, this.getQueue())\n-      }\n-      const queueRequestSocketToken = this.getQueue().wrapPromiseFunction(\n-        this.#requestSocketToken,\n-        { priority: -1 },\n-      )\n-      const serverToken = await queueRequestSocketToken(file, reqBody).abortOn(\n-        options.signal,\n-      )\n-\n-      if (!this.uppy.getState().files[file.id]) return undefined\n-\n-      this.uppy.setFileState(file.id, { serverToken })\n-      return await this.connectToServerSocket(\n-        this.uppy.getFile(file.id),\n-        this.getQueue(),\n-      )\n+      const { signal, getQueue } = options\n+\n+      return await pRetry(async () => {\n+        // if we already have a serverToken, assume that we are resuming the existing server upload id\n+        const existingServerToken = this.uppy.getFile(file.id)?.serverToken;\n+        if (existingServerToken != null) {\n+          this.uppy.log(`Connecting to exiting websocket ${existingServerToken}`)\n+          return this.#awaitRemoteFileUpload({ file, queue: getQueue(), signal })\n+        }\n+\n+        const queueRequestSocketToken = getQueue().wrapPromiseFunction(async (...args) => {\n+          try {\n+            return await this.#requestSocketToken(...args)\n+          } catch (outerErr) {\n+            // throwing AbortError will cause p-retry to stop retrying\n+            if (outerErr instanceof AuthError) throw new AbortError(outerErr)\n+\n+            if (outerErr.cause == null) throw outerErr\n+            const err = outerErr.cause\n+\n+            const isRetryableHttpError = () => (\n+              [408, 409, 429, 418, 423].includes(err.statusCode)\n+              || (err.statusCode >= 500 && err.statusCode <= 599 && ![501, 505].includes(err.statusCode))\n+            )\n+            if (err instanceof HttpError && !isRetryableHttpError()) throw new AbortError(err);\n+  \n+            // p-retry will retry most other errors,\n+            // but it will not retry TypeError (except network error TypeErrors)\n+            throw err\n+          }\n+        }, { priority: -1 })\n+\n+        const serverToken = await queueRequestSocketToken(file, reqBody).abortOn(signal)\n+\n+        if (!this.uppy.getFile(file.id)) return undefined // has file since been removed?\n+\n+        this.uppy.setFileState(file.id, { serverToken })\n+\n+        return this.#awaitRemoteFileUpload({\n+          file: this.uppy.getFile(file.id), // re-fetching file because it might have changed in the meantime\n+          queue: getQueue(),\n+          signal\n+        })\n+      }, { retries: retryCount, signal, onFailedAttempt: (err) => this.uppy.log(`Retrying upload due to: ${err.message}`, 'warning') });\n     } catch (err) {\n+      // this is a bit confusing, but an error with name 'AbortError' (from `signal`) is not the same as `p-retry` AbortError\n       if (err?.cause?.name === 'AbortError') {\n         // The file upload was aborted, it\u2019s not an error\n         return undefined\n       }\n \n-      this.uppy.setFileState(file.id, { serverToken: undefined })\n       this.uppy.emit('upload-error', file, err)\n       throw err\n     }\n   }\n \n-  #requestSocketToken = async (file, postBody) => {\n+  #requestSocketToken = async (file, postBody, signal) => {\n     if (file.remote.url == null) {\n       throw new Error('Cannot connect to an undefined URL')\n     }\n \n     const res = await this.post(file.remote.url, {\n       ...file.remote.body,\n       ...postBody,\n-    })\n+    }, signal)\n \n     return res.token\n   }\n \n   /**\n-   * @param {UppyFile} file\n+   * This method will ensure a websocket for the specified file and returns a promise that resolves\n+   * when the file has finished downloading, or rejects if it fails.\n+   * It will retry if the websocket gets disconnected\n+   * \n+   * @param {{ file: UppyFile, queue: RateLimitedQueue, signal: AbortSignal }} file\n    */\n-  async connectToServerSocket (file, queue) {\n-    return new Promise((resolve, reject) => {\n-      const token = file.serverToken\n-      const host = getSocketHost(file.remote.companionUrl)\n-      const socket = new Socket({\n-        target: `${host}/api/${token}`,\n-        autoOpen: false,\n-      })\n-      const eventManager = new EventManager(this.uppy)\n+  async #awaitRemoteFileUpload ({ file, queue, signal }) {\n+    const eventManager = new EventManager(this.uppy)\n \n-      let queuedRequest\n-\n-      eventManager.onFileRemove(file.id, () => {\n-        socket.send('cancel', {})\n-        queuedRequest.abort()\n-        resolve(`upload ${file.id} was removed`)\n-      })\n-\n-      eventManager.onPause(file.id, (isPaused) => {\n-        if (isPaused) {\n-          // Remove this file from the queue so another file can start in its place.\n-          socket.send('pause', {})\n-          queuedRequest.abort()\n-        } else {\n-          // Resuming an upload should be queued, else you could pause and then\n-          // resume a queued upload to make it skip the queue.\n-          queuedRequest.abort()\n-          queuedRequest = queue.run(() => {\n-            socket.open()\n-            socket.send('resume', {})\n-\n-            return () => {}\n-          })\n-        }\n-      })\n-\n-      eventManager.onPauseAll(file.id, () => {\n-        socket.send('pause', {})\n-        queuedRequest.abort()\n-      })\n-\n-      eventManager.onCancelAll(file.id, ({ reason } = {}) => {\n-        if (reason === 'user') {\n-          socket.send('cancel', {})\n-          queuedRequest.abort()\n+    try {\n+      return await new Promise((resolve, reject) => {\n+        const token = file.serverToken\n+        const host = getSocketHost(file.remote.companionUrl)\n+\n+        /** @type {WebSocket} */\n+        let socket\n+        /** @type {AbortController?} */\n+        let socketAbortController\n+        let activityTimeout\n+\n+        let { isPaused } = file\n+\n+        const socketSend = (action, payload) => {\n+          if (socket == null || socket.readyState !== socket.OPEN) {\n+            this.uppy.log(`Cannot send \"${action}\" to socket ${file.id} because the socket state was ${String(socket?.readyState)}`, 'warning')\n+            return\n+          }\n+\n+          socket.send(JSON.stringify({\n+            action,\n+            payload: payload ?? {},\n+          }))    \n+        };\n+\n+        function sendState() {\n+          if (isPaused) socketSend('pause')\n+          else socketSend('resume')\n         }\n-        resolve(`upload ${file.id} was canceled`)\n-      })\n \n-      eventManager.onResumeAll(file.id, () => {\n-        queuedRequest.abort()\n-        if (file.error) {\n-          socket.send('pause', {})\n+        const createWebsocket = async () => {\n+          if (socketAbortController) socketAbortController.abort()\n+          socketAbortController = new AbortController()\n+\n+          const onFatalError = (err) => {\n+            // Remove the serverToken so that a new one will be created for the retry.\n+            this.uppy.setFileState(file.id, { serverToken: null })\n+            socketAbortController?.abort?.()\n+            reject(err)\n+          }\n+  \n+          // todo instead implement the ability for users to cancel / retry *currently uploading files* in the UI\n+          function resetActivityTimeout() {\n+            clearTimeout(activityTimeout)\n+            if (isPaused) return\n+            activityTimeout = setTimeout(() => onFatalError(new Error('Timeout waiting for message from Companion socket')), socketActivityTimeoutMs)\n+          }\n+\n+          try {\n+            await queue.wrapPromiseFunction(async () => {\n+              // eslint-disable-next-line promise/param-names\n+              const reconnectWebsocket = async () => new Promise((resolveSocket, rejectSocket) => {\n+                socket = new WebSocket(`${host}/api/${token}`)\n+\n+                resetActivityTimeout()\n+\n+                socket.addEventListener('close', () => {\n+                  socket = undefined\n+                  rejectSocket(new Error('Socket closed unexpectedly'))\n+                })\n+\n+                socket.addEventListener('error', (error) => {\n+                  this.uppy.log(`Companion socket error ${JSON.stringify(error)}, closing socket`, 'warning')\n+                  socket.close() // will 'close' event to be emitted\n+                })\n+\n+                socket.addEventListener('open', () => {\n+                  sendState()\n+                })\n+\n+                socket.addEventListener('message', (e) => {\n+                  resetActivityTimeout()\n+\n+                  try {\n+                    const { action, payload } = JSON.parse(e.data)\n+            \n+                    switch (action) {\n+                      case 'progress': {\n+                        emitSocketProgress(this, payload, file)\n+                        break;\n+                      }\n+                      case 'success': {\n+                        this.uppy.emit('upload-success', file, { uploadURL: payload.url })\n+                        socketAbortController?.abort?.()\n+                        resolve()\n+                        break;\n+                      }\n+                      case 'error': {\n+                        const { message } = payload.error\n+                        throw Object.assign(new Error(message), { cause: payload.error })\n+                      }\n+                        default:\n+                          this.uppy.log(`Companion socket unknown action ${action}`, 'warning')\n+                    }\n+                  } catch (err) {\n+                    onFatalError(err)\n+                  }\n+                })\n+\n+                const closeSocket = () => {\n+                  this.uppy.log(`Closing socket ${file.id}`, 'info')\n+                  clearTimeout(activityTimeout)\n+                  if (socket) socket.close()\n+                  socket = undefined\n+                }\n+        \n+                socketAbortController.signal.addEventListener('abort', () => {\n+                  closeSocket()\n+                })\n+              })\n+\n+              await pRetry(reconnectWebsocket, {\n+                retries: retryCount,\n+                signal: socketAbortController.signal,\n+                onFailedAttempt: () => this.uppy.log(`Retrying websocket ${file.id}`, 'info'),\n+              });\n+            })().abortOn(socketAbortController.signal);\n+          } catch (err) {\n+            if (socketAbortController.signal.aborted) return\n+            onFatalError(err)\n+          }\n         }\n-        queuedRequest = queue.run(() => {\n-          socket.open()\n-          socket.send('resume', {})\n \n-          return () => {}\n-        })\n-      })\n-\n-      eventManager.onRetry(file.id, () => {\n-        // Only do the retry if the upload is actually in progress;\n-        // else we could try to send these messages when the upload is still queued.\n-        // We may need a better check for this since the socket may also be closed\n-        // for other reasons, like network failures.\n-        if (socket.isOpen) {\n-          socket.send('pause', {})\n-          socket.send('resume', {})\n+        const pause = (newPausedState) => {\n+          isPaused = newPausedState\n+          if (socket) sendState()\n+\n+          if (newPausedState) {\n+            // Remove this file from the queue so another file can start in its place.\n+            socketAbortController?.abort?.() // close socket to free up the request for other uploads\n+          } else {\n+            // Resuming an upload should be queued, else you could pause and then\n+            // resume a queued upload to make it skip the queue.\n+            createWebsocket()\n+          }\n         }\n-      })\n \n-      eventManager.onRetryAll(file.id, () => {\n-        // See the comment in the onRetry() call\n-        if (socket.isOpen) {\n-          socket.send('pause', {})\n-          socket.send('resume', {})\n+        const withErrorHandling = (fn, event) => {\n+          try {\n+            fn()\n+          } catch (err) {\n+            this.uppy.log(`Error while handling ${event} event for file ${file.id}: ${err.message}`, 'error')\n+          }\n         }\n-      })\n-\n-      socket.on('progress', (progressData) => emitSocketProgress(this, progressData, file))\n \n-      socket.on('error', (errData) => {\n-        const { message } = errData.error\n-        const error = Object.assign(new Error(message), {\n-          cause: errData.error,\n+        eventManager.onPause(file.id, (newPausedState) => withErrorHandling(() => pause(newPausedState), 'pause'))\n+        eventManager.onPauseAll(file.id, () => withErrorHandling(() => pause(true), 'pause-all'))\n+        eventManager.onResumeAll(file.id, () => withErrorHandling(() => pause(false), 'resume-all'))\n+\n+        eventManager.onFileRemove(file.id, () => withErrorHandling(() => {\n+          socketSend('cancel')\n+          socketAbortController?.abort?.()\n+          this.uppy.log(`upload ${file.id} was removed`, 'info')\n+          resolve()\n+        }, 'file-removed'))\n+\n+        eventManager.onCancelAll(file.id, ({ reason } = {}) => withErrorHandling(() => {\n+          if (reason === 'user') {\n+            socketSend('cancel')\n+          }\n+          socketAbortController?.abort?.()\n+          this.uppy.log(`upload ${file.id} was canceled`, 'info')\n+          resolve()\n+        }, 'cancel-all'))",
                "path": "packages/@uppy/companion-client/src/RequestClient.js",
                "commit_id": "a0501a940e732891215297aecf2613c847fbdc24",
                "original_commit_id": "a0501a940e732891215297aecf2613c847fbdc24",
                "user": {
                    "login": "mifi",
                    "id": 402547,
                    "node_id": "MDQ6VXNlcjQwMjU0Nw==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/402547?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/mifi",
                    "html_url": "https://github.com/mifi",
                    "followers_url": "https://api.github.com/users/mifi/followers",
                    "following_url": "https://api.github.com/users/mifi/following{/other_user}",
                    "gists_url": "https://api.github.com/users/mifi/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/mifi/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/mifi/subscriptions",
                    "organizations_url": "https://api.github.com/users/mifi/orgs",
                    "repos_url": "https://api.github.com/users/mifi/repos",
                    "events_url": "https://api.github.com/users/mifi/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/mifi/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "Sure i can refactor away eventmanager too. I just thought it was a new abstraction that was recently added so I didnt want to touch it",
                "created_at": "2023-10-26T11:40:05Z",
                "updated_at": "2023-10-26T11:40:06Z",
                "html_url": "https://github.com/transloadit/uppy/pull/4734#discussion_r1373019456",
                "pull_request_url": "https://api.github.com/repos/transloadit/uppy/pulls/4734",
                "author_association": "CONTRIBUTOR",
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/comments/1373019456"
                    },
                    "html": {
                        "href": "https://github.com/transloadit/uppy/pull/4734#discussion_r1373019456"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734"
                    }
                },
                "reactions": {
                    "url": "https://api.github.com/repos/transloadit/uppy/pulls/comments/1373019456/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "start_line": 482,
                "original_start_line": 482,
                "start_side": "RIGHT",
                "line": 500,
                "original_line": 500,
                "side": "RIGHT",
                "in_reply_to_id": 1372909302,
                "original_position": 452,
                "position": 452,
                "subject_type": "line"
            },
            "pull_request": {
                "url": "https://api.github.com/repos/transloadit/uppy/pulls/4734",
                "id": 1556257466,
                "node_id": "PR_kwDOAsITpc5cwpq6",
                "html_url": "https://github.com/transloadit/uppy/pull/4734",
                "diff_url": "https://github.com/transloadit/uppy/pull/4734.diff",
                "patch_url": "https://github.com/transloadit/uppy/pull/4734.patch",
                "issue_url": "https://api.github.com/repos/transloadit/uppy/issues/4734",
                "number": 4734,
                "state": "open",
                "locked": false,
                "title": "Companion+client stability fixes, error handling and retry",
                "user": {
                    "login": "mifi",
                    "id": 402547,
                    "node_id": "MDQ6VXNlcjQwMjU0Nw==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/402547?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/mifi",
                    "html_url": "https://github.com/mifi",
                    "followers_url": "https://api.github.com/users/mifi/followers",
                    "following_url": "https://api.github.com/users/mifi/following{/other_user}",
                    "gists_url": "https://api.github.com/users/mifi/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/mifi/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/mifi/subscriptions",
                    "organizations_url": "https://api.github.com/users/mifi/orgs",
                    "repos_url": "https://api.github.com/users/mifi/repos",
                    "events_url": "https://api.github.com/users/mifi/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/mifi/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "- [respond with 500 if unhandled upload error](https://github.com/transloadit/uppy/commit/4f52551fe8af63032f6ac2d909ef60d1d89c90bd) \r\n 400 seems inappropriate\r\n- [fix companion download error](https://github.com/transloadit/uppy/commit/7bd5042adbad44f26b083ba01f7a64c782b19a73) \r\n  - respond with correct response code when calling /get and request to the upstream server fails\r\n  - also add a unit test for this\r\n- [forward 429 from provider](https://github.com/transloadit/uppy/commit/3fa992b23b7de675cad046daa41f064bb8cdf02c) \r\n  allows us to retry it\r\n- [add a way to test refresh tokens](https://github.com/transloadit/uppy/commit/aad9ae9d3e875cba6410618721470138448ff4cc)\r\n- [fix race condtiion with refreshing token](https://github.com/transloadit/uppy/commit/863b60e83a53c7c2e458bb0b8a39670ba94415e7) that would cause many `refresh-token` calls to be made concurrently, possibly causing problems\r\n- [implement retry and fix socket](https://github.com/transloadit/uppy/commit/7124ef484b6eda82df9c126efe6973c2427e92b8) \r\n  - Make sure we don't instantiate a new Provider for every file uploaded (reuse the original provider instead) - this caused the refresh token synchronization not to work\r\n  - Retry most errors when uploading (`/get`) using companion, but for HTTP, only retry certain HTTP status codes\r\n  - Reimplement the websocket code to be more stable and retry as well\r\n  - if no websocket messages have been received in 5 minutes, fail the upload, so the upload doesn't get stuck forever in case something goes bad, TODO should this should be solved in the UI instead?\r\n- [remove useFastRemoteRetry](https://github.com/transloadit/uppy/commit/8612d5d5ace5e7ec32db73e3632ec964657aff06) \r\n  - because it isn't supported in Companion as far as I can tell, and the option effectively doesn't do anything at all",
                "created_at": "2023-10-13T17:28:55Z",
                "updated_at": "2023-10-26T11:40:06Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "7c1c899a01eb66e45e7af9fd8b7f0bbd6748faa8",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/transloadit/uppy/pulls/4734/commits",
                "review_comments_url": "https://api.github.com/repos/transloadit/uppy/pulls/4734/comments",
                "review_comment_url": "https://api.github.com/repos/transloadit/uppy/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/transloadit/uppy/issues/4734/comments",
                "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/a0501a940e732891215297aecf2613c847fbdc24",
                "head": {
                    "label": "transloadit:companion-fixes",
                    "ref": "companion-fixes",
                    "sha": "a0501a940e732891215297aecf2613c847fbdc24",
                    "user": {
                        "login": "transloadit",
                        "id": 125754,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/transloadit",
                        "html_url": "https://github.com/transloadit",
                        "followers_url": "https://api.github.com/users/transloadit/followers",
                        "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                        "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                        "organizations_url": "https://api.github.com/users/transloadit/orgs",
                        "repos_url": "https://api.github.com/users/transloadit/repos",
                        "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/transloadit/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 46273445,
                        "node_id": "MDEwOlJlcG9zaXRvcnk0NjI3MzQ0NQ==",
                        "name": "uppy",
                        "full_name": "transloadit/uppy",
                        "private": false,
                        "owner": {
                            "login": "transloadit",
                            "id": 125754,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/transloadit",
                            "html_url": "https://github.com/transloadit",
                            "followers_url": "https://api.github.com/users/transloadit/followers",
                            "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                            "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                            "organizations_url": "https://api.github.com/users/transloadit/orgs",
                            "repos_url": "https://api.github.com/users/transloadit/repos",
                            "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/transloadit/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/transloadit/uppy",
                        "description": "The next open source file uploader for web browsers :dog: ",
                        "fork": false,
                        "url": "https://api.github.com/repos/transloadit/uppy",
                        "forks_url": "https://api.github.com/repos/transloadit/uppy/forks",
                        "keys_url": "https://api.github.com/repos/transloadit/uppy/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/transloadit/uppy/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/transloadit/uppy/teams",
                        "hooks_url": "https://api.github.com/repos/transloadit/uppy/hooks",
                        "issue_events_url": "https://api.github.com/repos/transloadit/uppy/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/transloadit/uppy/events",
                        "assignees_url": "https://api.github.com/repos/transloadit/uppy/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/transloadit/uppy/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/transloadit/uppy/tags",
                        "blobs_url": "https://api.github.com/repos/transloadit/uppy/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/transloadit/uppy/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/transloadit/uppy/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/transloadit/uppy/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/transloadit/uppy/languages",
                        "stargazers_url": "https://api.github.com/repos/transloadit/uppy/stargazers",
                        "contributors_url": "https://api.github.com/repos/transloadit/uppy/contributors",
                        "subscribers_url": "https://api.github.com/repos/transloadit/uppy/subscribers",
                        "subscription_url": "https://api.github.com/repos/transloadit/uppy/subscription",
                        "commits_url": "https://api.github.com/repos/transloadit/uppy/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/transloadit/uppy/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/transloadit/uppy/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/transloadit/uppy/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/transloadit/uppy/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/transloadit/uppy/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/transloadit/uppy/merges",
                        "archive_url": "https://api.github.com/repos/transloadit/uppy/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/transloadit/uppy/downloads",
                        "issues_url": "https://api.github.com/repos/transloadit/uppy/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/transloadit/uppy/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/transloadit/uppy/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/transloadit/uppy/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/transloadit/uppy/labels{/name}",
                        "releases_url": "https://api.github.com/repos/transloadit/uppy/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/transloadit/uppy/deployments",
                        "created_at": "2015-11-16T12:32:33Z",
                        "updated_at": "2023-10-26T10:03:44Z",
                        "pushed_at": "2023-10-25T15:17:29Z",
                        "git_url": "git://github.com/transloadit/uppy.git",
                        "ssh_url": "git@github.com:transloadit/uppy.git",
                        "clone_url": "https://github.com/transloadit/uppy.git",
                        "svn_url": "https://github.com/transloadit/uppy",
                        "homepage": "https://uppy.io",
                        "size": 389980,
                        "stargazers_count": 27488,
                        "watchers_count": 27488,
                        "language": "JavaScript",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": true,
                        "has_discussions": false,
                        "forks_count": 1934,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 168,
                        "license": {
                            "key": "mit",
                            "name": "MIT License",
                            "spdx_id": "MIT",
                            "url": "https://api.github.com/licenses/mit",
                            "node_id": "MDc6TGljZW5zZTEz"
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "dropbox",
                            "encoding",
                            "file-uploader",
                            "file-uploads",
                            "files",
                            "hacktoberfest",
                            "instagram",
                            "javascript",
                            "mit",
                            "modular",
                            "open-source",
                            "pick-files",
                            "resumable",
                            "transloadit",
                            "tus",
                            "uploader",
                            "uppy",
                            "webbrowser"
                        ],
                        "visibility": "public",
                        "forks": 1934,
                        "open_issues": 168,
                        "watchers": 27488,
                        "default_branch": "main"
                    }
                },
                "base": {
                    "label": "transloadit:main",
                    "ref": "main",
                    "sha": "8b252086f5e2769e0a2e95c22ac48b63b9ecfbd1",
                    "user": {
                        "login": "transloadit",
                        "id": 125754,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/transloadit",
                        "html_url": "https://github.com/transloadit",
                        "followers_url": "https://api.github.com/users/transloadit/followers",
                        "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                        "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                        "organizations_url": "https://api.github.com/users/transloadit/orgs",
                        "repos_url": "https://api.github.com/users/transloadit/repos",
                        "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/transloadit/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 46273445,
                        "node_id": "MDEwOlJlcG9zaXRvcnk0NjI3MzQ0NQ==",
                        "name": "uppy",
                        "full_name": "transloadit/uppy",
                        "private": false,
                        "owner": {
                            "login": "transloadit",
                            "id": 125754,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/transloadit",
                            "html_url": "https://github.com/transloadit",
                            "followers_url": "https://api.github.com/users/transloadit/followers",
                            "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                            "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                            "organizations_url": "https://api.github.com/users/transloadit/orgs",
                            "repos_url": "https://api.github.com/users/transloadit/repos",
                            "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/transloadit/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/transloadit/uppy",
                        "description": "The next open source file uploader for web browsers :dog: ",
                        "fork": false,
                        "url": "https://api.github.com/repos/transloadit/uppy",
                        "forks_url": "https://api.github.com/repos/transloadit/uppy/forks",
                        "keys_url": "https://api.github.com/repos/transloadit/uppy/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/transloadit/uppy/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/transloadit/uppy/teams",
                        "hooks_url": "https://api.github.com/repos/transloadit/uppy/hooks",
                        "issue_events_url": "https://api.github.com/repos/transloadit/uppy/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/transloadit/uppy/events",
                        "assignees_url": "https://api.github.com/repos/transloadit/uppy/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/transloadit/uppy/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/transloadit/uppy/tags",
                        "blobs_url": "https://api.github.com/repos/transloadit/uppy/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/transloadit/uppy/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/transloadit/uppy/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/transloadit/uppy/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/transloadit/uppy/languages",
                        "stargazers_url": "https://api.github.com/repos/transloadit/uppy/stargazers",
                        "contributors_url": "https://api.github.com/repos/transloadit/uppy/contributors",
                        "subscribers_url": "https://api.github.com/repos/transloadit/uppy/subscribers",
                        "subscription_url": "https://api.github.com/repos/transloadit/uppy/subscription",
                        "commits_url": "https://api.github.com/repos/transloadit/uppy/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/transloadit/uppy/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/transloadit/uppy/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/transloadit/uppy/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/transloadit/uppy/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/transloadit/uppy/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/transloadit/uppy/merges",
                        "archive_url": "https://api.github.com/repos/transloadit/uppy/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/transloadit/uppy/downloads",
                        "issues_url": "https://api.github.com/repos/transloadit/uppy/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/transloadit/uppy/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/transloadit/uppy/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/transloadit/uppy/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/transloadit/uppy/labels{/name}",
                        "releases_url": "https://api.github.com/repos/transloadit/uppy/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/transloadit/uppy/deployments",
                        "created_at": "2015-11-16T12:32:33Z",
                        "updated_at": "2023-10-26T10:03:44Z",
                        "pushed_at": "2023-10-25T15:17:29Z",
                        "git_url": "git://github.com/transloadit/uppy.git",
                        "ssh_url": "git@github.com:transloadit/uppy.git",
                        "clone_url": "https://github.com/transloadit/uppy.git",
                        "svn_url": "https://github.com/transloadit/uppy",
                        "homepage": "https://uppy.io",
                        "size": 389980,
                        "stargazers_count": 27488,
                        "watchers_count": 27488,
                        "language": "JavaScript",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": true,
                        "has_discussions": false,
                        "forks_count": 1934,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 168,
                        "license": {
                            "key": "mit",
                            "name": "MIT License",
                            "spdx_id": "MIT",
                            "url": "https://api.github.com/licenses/mit",
                            "node_id": "MDc6TGljZW5zZTEz"
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "dropbox",
                            "encoding",
                            "file-uploader",
                            "file-uploads",
                            "files",
                            "hacktoberfest",
                            "instagram",
                            "javascript",
                            "mit",
                            "modular",
                            "open-source",
                            "pick-files",
                            "resumable",
                            "transloadit",
                            "tus",
                            "uploader",
                            "uppy",
                            "webbrowser"
                        ],
                        "visibility": "public",
                        "forks": 1934,
                        "open_issues": 168,
                        "watchers": 27488,
                        "default_branch": "main"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734"
                    },
                    "html": {
                        "href": "https://github.com/transloadit/uppy/pull/4734"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/transloadit/uppy/issues/4734"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/transloadit/uppy/issues/4734/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/transloadit/uppy/statuses/a0501a940e732891215297aecf2613c847fbdc24"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T11:40:05Z",
        "org": {
            "id": 125754,
            "login": "transloadit",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/transloadit",
            "avatar_url": "https://avatars.githubusercontent.com/u/125754?"
        }
    },
    {
        "id": "32866277954",
        "type": "PullRequestReviewEvent",
        "actor": {
            "id": 402547,
            "login": "mifi",
            "display_login": "mifi",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mifi",
            "avatar_url": "https://avatars.githubusercontent.com/u/402547?"
        },
        "repo": {
            "id": 46273445,
            "name": "transloadit/uppy",
            "url": "https://api.github.com/repos/transloadit/uppy"
        },
        "payload": {
            "action": "created",
            "review": {
                "id": 1699380562,
                "node_id": "PRR_kwDOAsITpc5lSn1S",
                "user": {
                    "login": "mifi",
                    "id": 402547,
                    "node_id": "MDQ6VXNlcjQwMjU0Nw==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/402547?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/mifi",
                    "html_url": "https://github.com/mifi",
                    "followers_url": "https://api.github.com/users/mifi/followers",
                    "following_url": "https://api.github.com/users/mifi/following{/other_user}",
                    "gists_url": "https://api.github.com/users/mifi/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/mifi/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/mifi/subscriptions",
                    "organizations_url": "https://api.github.com/users/mifi/orgs",
                    "repos_url": "https://api.github.com/users/mifi/repos",
                    "events_url": "https://api.github.com/users/mifi/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/mifi/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": null,
                "commit_id": "a0501a940e732891215297aecf2613c847fbdc24",
                "submitted_at": "2023-10-26T11:40:06Z",
                "state": "commented",
                "html_url": "https://github.com/transloadit/uppy/pull/4734#pullrequestreview-1699380562",
                "pull_request_url": "https://api.github.com/repos/transloadit/uppy/pulls/4734",
                "author_association": "CONTRIBUTOR",
                "_links": {
                    "html": {
                        "href": "https://github.com/transloadit/uppy/pull/4734#pullrequestreview-1699380562"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734"
                    }
                }
            },
            "pull_request": {
                "url": "https://api.github.com/repos/transloadit/uppy/pulls/4734",
                "id": 1556257466,
                "node_id": "PR_kwDOAsITpc5cwpq6",
                "html_url": "https://github.com/transloadit/uppy/pull/4734",
                "diff_url": "https://github.com/transloadit/uppy/pull/4734.diff",
                "patch_url": "https://github.com/transloadit/uppy/pull/4734.patch",
                "issue_url": "https://api.github.com/repos/transloadit/uppy/issues/4734",
                "number": 4734,
                "state": "open",
                "locked": false,
                "title": "Companion+client stability fixes, error handling and retry",
                "user": {
                    "login": "mifi",
                    "id": 402547,
                    "node_id": "MDQ6VXNlcjQwMjU0Nw==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/402547?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/mifi",
                    "html_url": "https://github.com/mifi",
                    "followers_url": "https://api.github.com/users/mifi/followers",
                    "following_url": "https://api.github.com/users/mifi/following{/other_user}",
                    "gists_url": "https://api.github.com/users/mifi/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/mifi/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/mifi/subscriptions",
                    "organizations_url": "https://api.github.com/users/mifi/orgs",
                    "repos_url": "https://api.github.com/users/mifi/repos",
                    "events_url": "https://api.github.com/users/mifi/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/mifi/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "- [respond with 500 if unhandled upload error](https://github.com/transloadit/uppy/commit/4f52551fe8af63032f6ac2d909ef60d1d89c90bd) \r\n 400 seems inappropriate\r\n- [fix companion download error](https://github.com/transloadit/uppy/commit/7bd5042adbad44f26b083ba01f7a64c782b19a73) \r\n  - respond with correct response code when calling /get and request to the upstream server fails\r\n  - also add a unit test for this\r\n- [forward 429 from provider](https://github.com/transloadit/uppy/commit/3fa992b23b7de675cad046daa41f064bb8cdf02c) \r\n  allows us to retry it\r\n- [add a way to test refresh tokens](https://github.com/transloadit/uppy/commit/aad9ae9d3e875cba6410618721470138448ff4cc)\r\n- [fix race condtiion with refreshing token](https://github.com/transloadit/uppy/commit/863b60e83a53c7c2e458bb0b8a39670ba94415e7) that would cause many `refresh-token` calls to be made concurrently, possibly causing problems\r\n- [implement retry and fix socket](https://github.com/transloadit/uppy/commit/7124ef484b6eda82df9c126efe6973c2427e92b8) \r\n  - Make sure we don't instantiate a new Provider for every file uploaded (reuse the original provider instead) - this caused the refresh token synchronization not to work\r\n  - Retry most errors when uploading (`/get`) using companion, but for HTTP, only retry certain HTTP status codes\r\n  - Reimplement the websocket code to be more stable and retry as well\r\n  - if no websocket messages have been received in 5 minutes, fail the upload, so the upload doesn't get stuck forever in case something goes bad, TODO should this should be solved in the UI instead?\r\n- [remove useFastRemoteRetry](https://github.com/transloadit/uppy/commit/8612d5d5ace5e7ec32db73e3632ec964657aff06) \r\n  - because it isn't supported in Companion as far as I can tell, and the option effectively doesn't do anything at all",
                "created_at": "2023-10-13T17:28:55Z",
                "updated_at": "2023-10-26T11:40:06Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "7c1c899a01eb66e45e7af9fd8b7f0bbd6748faa8",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/transloadit/uppy/pulls/4734/commits",
                "review_comments_url": "https://api.github.com/repos/transloadit/uppy/pulls/4734/comments",
                "review_comment_url": "https://api.github.com/repos/transloadit/uppy/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/transloadit/uppy/issues/4734/comments",
                "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/a0501a940e732891215297aecf2613c847fbdc24",
                "head": {
                    "label": "transloadit:companion-fixes",
                    "ref": "companion-fixes",
                    "sha": "a0501a940e732891215297aecf2613c847fbdc24",
                    "user": {
                        "login": "transloadit",
                        "id": 125754,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/transloadit",
                        "html_url": "https://github.com/transloadit",
                        "followers_url": "https://api.github.com/users/transloadit/followers",
                        "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                        "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                        "organizations_url": "https://api.github.com/users/transloadit/orgs",
                        "repos_url": "https://api.github.com/users/transloadit/repos",
                        "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/transloadit/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 46273445,
                        "node_id": "MDEwOlJlcG9zaXRvcnk0NjI3MzQ0NQ==",
                        "name": "uppy",
                        "full_name": "transloadit/uppy",
                        "private": false,
                        "owner": {
                            "login": "transloadit",
                            "id": 125754,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/transloadit",
                            "html_url": "https://github.com/transloadit",
                            "followers_url": "https://api.github.com/users/transloadit/followers",
                            "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                            "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                            "organizations_url": "https://api.github.com/users/transloadit/orgs",
                            "repos_url": "https://api.github.com/users/transloadit/repos",
                            "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/transloadit/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/transloadit/uppy",
                        "description": "The next open source file uploader for web browsers :dog: ",
                        "fork": false,
                        "url": "https://api.github.com/repos/transloadit/uppy",
                        "forks_url": "https://api.github.com/repos/transloadit/uppy/forks",
                        "keys_url": "https://api.github.com/repos/transloadit/uppy/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/transloadit/uppy/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/transloadit/uppy/teams",
                        "hooks_url": "https://api.github.com/repos/transloadit/uppy/hooks",
                        "issue_events_url": "https://api.github.com/repos/transloadit/uppy/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/transloadit/uppy/events",
                        "assignees_url": "https://api.github.com/repos/transloadit/uppy/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/transloadit/uppy/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/transloadit/uppy/tags",
                        "blobs_url": "https://api.github.com/repos/transloadit/uppy/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/transloadit/uppy/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/transloadit/uppy/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/transloadit/uppy/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/transloadit/uppy/languages",
                        "stargazers_url": "https://api.github.com/repos/transloadit/uppy/stargazers",
                        "contributors_url": "https://api.github.com/repos/transloadit/uppy/contributors",
                        "subscribers_url": "https://api.github.com/repos/transloadit/uppy/subscribers",
                        "subscription_url": "https://api.github.com/repos/transloadit/uppy/subscription",
                        "commits_url": "https://api.github.com/repos/transloadit/uppy/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/transloadit/uppy/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/transloadit/uppy/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/transloadit/uppy/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/transloadit/uppy/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/transloadit/uppy/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/transloadit/uppy/merges",
                        "archive_url": "https://api.github.com/repos/transloadit/uppy/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/transloadit/uppy/downloads",
                        "issues_url": "https://api.github.com/repos/transloadit/uppy/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/transloadit/uppy/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/transloadit/uppy/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/transloadit/uppy/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/transloadit/uppy/labels{/name}",
                        "releases_url": "https://api.github.com/repos/transloadit/uppy/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/transloadit/uppy/deployments",
                        "created_at": "2015-11-16T12:32:33Z",
                        "updated_at": "2023-10-26T10:03:44Z",
                        "pushed_at": "2023-10-25T15:17:29Z",
                        "git_url": "git://github.com/transloadit/uppy.git",
                        "ssh_url": "git@github.com:transloadit/uppy.git",
                        "clone_url": "https://github.com/transloadit/uppy.git",
                        "svn_url": "https://github.com/transloadit/uppy",
                        "homepage": "https://uppy.io",
                        "size": 389980,
                        "stargazers_count": 27488,
                        "watchers_count": 27488,
                        "language": "JavaScript",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": true,
                        "has_discussions": false,
                        "forks_count": 1934,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 168,
                        "license": {
                            "key": "mit",
                            "name": "MIT License",
                            "spdx_id": "MIT",
                            "url": "https://api.github.com/licenses/mit",
                            "node_id": "MDc6TGljZW5zZTEz"
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "dropbox",
                            "encoding",
                            "file-uploader",
                            "file-uploads",
                            "files",
                            "hacktoberfest",
                            "instagram",
                            "javascript",
                            "mit",
                            "modular",
                            "open-source",
                            "pick-files",
                            "resumable",
                            "transloadit",
                            "tus",
                            "uploader",
                            "uppy",
                            "webbrowser"
                        ],
                        "visibility": "public",
                        "forks": 1934,
                        "open_issues": 168,
                        "watchers": 27488,
                        "default_branch": "main"
                    }
                },
                "base": {
                    "label": "transloadit:main",
                    "ref": "main",
                    "sha": "8b252086f5e2769e0a2e95c22ac48b63b9ecfbd1",
                    "user": {
                        "login": "transloadit",
                        "id": 125754,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/transloadit",
                        "html_url": "https://github.com/transloadit",
                        "followers_url": "https://api.github.com/users/transloadit/followers",
                        "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                        "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                        "organizations_url": "https://api.github.com/users/transloadit/orgs",
                        "repos_url": "https://api.github.com/users/transloadit/repos",
                        "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/transloadit/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 46273445,
                        "node_id": "MDEwOlJlcG9zaXRvcnk0NjI3MzQ0NQ==",
                        "name": "uppy",
                        "full_name": "transloadit/uppy",
                        "private": false,
                        "owner": {
                            "login": "transloadit",
                            "id": 125754,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/transloadit",
                            "html_url": "https://github.com/transloadit",
                            "followers_url": "https://api.github.com/users/transloadit/followers",
                            "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                            "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                            "organizations_url": "https://api.github.com/users/transloadit/orgs",
                            "repos_url": "https://api.github.com/users/transloadit/repos",
                            "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/transloadit/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/transloadit/uppy",
                        "description": "The next open source file uploader for web browsers :dog: ",
                        "fork": false,
                        "url": "https://api.github.com/repos/transloadit/uppy",
                        "forks_url": "https://api.github.com/repos/transloadit/uppy/forks",
                        "keys_url": "https://api.github.com/repos/transloadit/uppy/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/transloadit/uppy/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/transloadit/uppy/teams",
                        "hooks_url": "https://api.github.com/repos/transloadit/uppy/hooks",
                        "issue_events_url": "https://api.github.com/repos/transloadit/uppy/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/transloadit/uppy/events",
                        "assignees_url": "https://api.github.com/repos/transloadit/uppy/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/transloadit/uppy/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/transloadit/uppy/tags",
                        "blobs_url": "https://api.github.com/repos/transloadit/uppy/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/transloadit/uppy/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/transloadit/uppy/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/transloadit/uppy/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/transloadit/uppy/languages",
                        "stargazers_url": "https://api.github.com/repos/transloadit/uppy/stargazers",
                        "contributors_url": "https://api.github.com/repos/transloadit/uppy/contributors",
                        "subscribers_url": "https://api.github.com/repos/transloadit/uppy/subscribers",
                        "subscription_url": "https://api.github.com/repos/transloadit/uppy/subscription",
                        "commits_url": "https://api.github.com/repos/transloadit/uppy/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/transloadit/uppy/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/transloadit/uppy/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/transloadit/uppy/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/transloadit/uppy/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/transloadit/uppy/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/transloadit/uppy/merges",
                        "archive_url": "https://api.github.com/repos/transloadit/uppy/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/transloadit/uppy/downloads",
                        "issues_url": "https://api.github.com/repos/transloadit/uppy/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/transloadit/uppy/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/transloadit/uppy/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/transloadit/uppy/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/transloadit/uppy/labels{/name}",
                        "releases_url": "https://api.github.com/repos/transloadit/uppy/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/transloadit/uppy/deployments",
                        "created_at": "2015-11-16T12:32:33Z",
                        "updated_at": "2023-10-26T10:03:44Z",
                        "pushed_at": "2023-10-25T15:17:29Z",
                        "git_url": "git://github.com/transloadit/uppy.git",
                        "ssh_url": "git@github.com:transloadit/uppy.git",
                        "clone_url": "https://github.com/transloadit/uppy.git",
                        "svn_url": "https://github.com/transloadit/uppy",
                        "homepage": "https://uppy.io",
                        "size": 389980,
                        "stargazers_count": 27488,
                        "watchers_count": 27488,
                        "language": "JavaScript",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": true,
                        "has_discussions": false,
                        "forks_count": 1934,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 168,
                        "license": {
                            "key": "mit",
                            "name": "MIT License",
                            "spdx_id": "MIT",
                            "url": "https://api.github.com/licenses/mit",
                            "node_id": "MDc6TGljZW5zZTEz"
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "dropbox",
                            "encoding",
                            "file-uploader",
                            "file-uploads",
                            "files",
                            "hacktoberfest",
                            "instagram",
                            "javascript",
                            "mit",
                            "modular",
                            "open-source",
                            "pick-files",
                            "resumable",
                            "transloadit",
                            "tus",
                            "uploader",
                            "uppy",
                            "webbrowser"
                        ],
                        "visibility": "public",
                        "forks": 1934,
                        "open_issues": 168,
                        "watchers": 27488,
                        "default_branch": "main"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734"
                    },
                    "html": {
                        "href": "https://github.com/transloadit/uppy/pull/4734"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/transloadit/uppy/issues/4734"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/transloadit/uppy/issues/4734/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/transloadit/uppy/statuses/a0501a940e732891215297aecf2613c847fbdc24"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T11:40:06Z",
        "org": {
            "id": 125754,
            "login": "transloadit",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/transloadit",
            "avatar_url": "https://avatars.githubusercontent.com/u/125754?"
        }
    },
    {
        "id": "32866227122",
        "type": "PullRequestReviewCommentEvent",
        "actor": {
            "id": 402547,
            "login": "mifi",
            "display_login": "mifi",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mifi",
            "avatar_url": "https://avatars.githubusercontent.com/u/402547?"
        },
        "repo": {
            "id": 46273445,
            "name": "transloadit/uppy",
            "url": "https://api.github.com/repos/transloadit/uppy"
        },
        "payload": {
            "action": "created",
            "comment": {
                "url": "https://api.github.com/repos/transloadit/uppy/pulls/comments/1373017302",
                "pull_request_review_id": 1699377046,
                "id": 1373017302,
                "node_id": "PRRC_kwDOAsITpc5R1pTW",
                "diff_hunk": "@@ -222,179 +240,273 @@ export default class RequestClient {\n     return this.request({ ...options, path, method: 'DELETE', data })\n   }\n \n+  /**\n+   * Remote uploading consists of two steps:\n+   * 1. #requestSocketToken which starts the download/upload in companion and returns a unique token for the upload.\n+   * Then companion will halt the upload until:\n+   * 2. #awaitRemoteFileUpload is called, which will open/ensure a websocket connection towards companion, with the\n+   * previously generated token provided. It returns a promise that will resolve/reject once the file has finished\n+   * uploading or is otherwise done (failed, canceled)\n+   * \n+   * @param {*} file \n+   * @param {*} reqBody \n+   * @param {*} options \n+   * @returns \n+   */\n   async uploadRemoteFile (file, reqBody, options = {}) {\n     try {\n-      if (file.serverToken) {\n-        return await this.connectToServerSocket(file, this.getQueue())\n-      }\n-      const queueRequestSocketToken = this.getQueue().wrapPromiseFunction(\n-        this.#requestSocketToken,\n-        { priority: -1 },\n-      )\n-      const serverToken = await queueRequestSocketToken(file, reqBody).abortOn(\n-        options.signal,\n-      )\n-\n-      if (!this.uppy.getState().files[file.id]) return undefined\n-\n-      this.uppy.setFileState(file.id, { serverToken })\n-      return await this.connectToServerSocket(\n-        this.uppy.getFile(file.id),\n-        this.getQueue(),\n-      )\n+      const { signal, getQueue } = options\n+\n+      return await pRetry(async () => {\n+        // if we already have a serverToken, assume that we are resuming the existing server upload id\n+        const existingServerToken = this.uppy.getFile(file.id)?.serverToken;\n+        if (existingServerToken != null) {\n+          this.uppy.log(`Connecting to exiting websocket ${existingServerToken}`)\n+          return this.#awaitRemoteFileUpload({ file, queue: getQueue(), signal })\n+        }\n+\n+        const queueRequestSocketToken = getQueue().wrapPromiseFunction(async (...args) => {\n+          try {\n+            return await this.#requestSocketToken(...args)\n+          } catch (outerErr) {\n+            // throwing AbortError will cause p-retry to stop retrying\n+            if (outerErr instanceof AuthError) throw new AbortError(outerErr)\n+\n+            if (outerErr.cause == null) throw outerErr\n+            const err = outerErr.cause\n+\n+            const isRetryableHttpError = () => (\n+              [408, 409, 429, 418, 423].includes(err.statusCode)\n+              || (err.statusCode >= 500 && err.statusCode <= 599 && ![501, 505].includes(err.statusCode))\n+            )\n+            if (err instanceof HttpError && !isRetryableHttpError()) throw new AbortError(err);\n+  \n+            // p-retry will retry most other errors,\n+            // but it will not retry TypeError (except network error TypeErrors)\n+            throw err\n+          }\n+        }, { priority: -1 })\n+\n+        const serverToken = await queueRequestSocketToken(file, reqBody).abortOn(signal)\n+\n+        if (!this.uppy.getFile(file.id)) return undefined // has file since been removed?\n+\n+        this.uppy.setFileState(file.id, { serverToken })\n+\n+        return this.#awaitRemoteFileUpload({\n+          file: this.uppy.getFile(file.id), // re-fetching file because it might have changed in the meantime\n+          queue: getQueue(),\n+          signal\n+        })\n+      }, { retries: retryCount, signal, onFailedAttempt: (err) => this.uppy.log(`Retrying upload due to: ${err.message}`, 'warning') });\n     } catch (err) {\n+      // this is a bit confusing, but an error with name 'AbortError' (from `signal`) is not the same as `p-retry` AbortError\n       if (err?.cause?.name === 'AbortError') {\n         // The file upload was aborted, it\u2019s not an error\n         return undefined\n       }\n \n-      this.uppy.setFileState(file.id, { serverToken: undefined })\n       this.uppy.emit('upload-error', file, err)\n       throw err\n     }\n   }\n \n-  #requestSocketToken = async (file, postBody) => {\n+  #requestSocketToken = async (file, postBody, signal) => {\n     if (file.remote.url == null) {\n       throw new Error('Cannot connect to an undefined URL')\n     }\n \n     const res = await this.post(file.remote.url, {\n       ...file.remote.body,\n       ...postBody,\n-    })\n+    }, signal)\n \n     return res.token\n   }\n \n   /**\n-   * @param {UppyFile} file\n+   * This method will ensure a websocket for the specified file and returns a promise that resolves\n+   * when the file has finished downloading, or rejects if it fails.\n+   * It will retry if the websocket gets disconnected\n+   * \n+   * @param {{ file: UppyFile, queue: RateLimitedQueue, signal: AbortSignal }} file\n    */\n-  async connectToServerSocket (file, queue) {\n-    return new Promise((resolve, reject) => {\n-      const token = file.serverToken\n-      const host = getSocketHost(file.remote.companionUrl)\n-      const socket = new Socket({\n-        target: `${host}/api/${token}`,\n-        autoOpen: false,\n-      })\n-      const eventManager = new EventManager(this.uppy)\n+  async #awaitRemoteFileUpload ({ file, queue, signal }) {\n+    const eventManager = new EventManager(this.uppy)\n \n-      let queuedRequest\n-\n-      eventManager.onFileRemove(file.id, () => {\n-        socket.send('cancel', {})\n-        queuedRequest.abort()\n-        resolve(`upload ${file.id} was removed`)\n-      })\n-\n-      eventManager.onPause(file.id, (isPaused) => {\n-        if (isPaused) {\n-          // Remove this file from the queue so another file can start in its place.\n-          socket.send('pause', {})\n-          queuedRequest.abort()\n-        } else {\n-          // Resuming an upload should be queued, else you could pause and then\n-          // resume a queued upload to make it skip the queue.\n-          queuedRequest.abort()\n-          queuedRequest = queue.run(() => {\n-            socket.open()\n-            socket.send('resume', {})\n-\n-            return () => {}\n-          })\n-        }\n-      })\n-\n-      eventManager.onPauseAll(file.id, () => {\n-        socket.send('pause', {})\n-        queuedRequest.abort()\n-      })\n-\n-      eventManager.onCancelAll(file.id, ({ reason } = {}) => {\n-        if (reason === 'user') {\n-          socket.send('cancel', {})\n-          queuedRequest.abort()\n+    try {\n+      return await new Promise((resolve, reject) => {\n+        const token = file.serverToken\n+        const host = getSocketHost(file.remote.companionUrl)\n+\n+        /** @type {WebSocket} */\n+        let socket\n+        /** @type {AbortController?} */\n+        let socketAbortController\n+        let activityTimeout\n+\n+        let { isPaused } = file\n+\n+        const socketSend = (action, payload) => {\n+          if (socket == null || socket.readyState !== socket.OPEN) {\n+            this.uppy.log(`Cannot send \"${action}\" to socket ${file.id} because the socket state was ${String(socket?.readyState)}`, 'warning')\n+            return\n+          }\n+\n+          socket.send(JSON.stringify({\n+            action,\n+            payload: payload ?? {},\n+          }))    \n+        };\n+\n+        function sendState() {\n+          if (isPaused) socketSend('pause')\n+          else socketSend('resume')\n         }\n-        resolve(`upload ${file.id} was canceled`)\n-      })\n \n-      eventManager.onResumeAll(file.id, () => {\n-        queuedRequest.abort()\n-        if (file.error) {\n-          socket.send('pause', {})\n+        const createWebsocket = async () => {\n+          if (socketAbortController) socketAbortController.abort()\n+          socketAbortController = new AbortController()\n+\n+          const onFatalError = (err) => {\n+            // Remove the serverToken so that a new one will be created for the retry.\n+            this.uppy.setFileState(file.id, { serverToken: null })\n+            socketAbortController?.abort?.()\n+            reject(err)\n+          }\n+  \n+          // todo instead implement the ability for users to cancel / retry *currently uploading files* in the UI\n+          function resetActivityTimeout() {\n+            clearTimeout(activityTimeout)\n+            if (isPaused) return\n+            activityTimeout = setTimeout(() => onFatalError(new Error('Timeout waiting for message from Companion socket')), socketActivityTimeoutMs)\n+          }\n+\n+          try {\n+            await queue.wrapPromiseFunction(async () => {\n+              // eslint-disable-next-line promise/param-names\n+              const reconnectWebsocket = async () => new Promise((resolveSocket, rejectSocket) => {\n+                socket = new WebSocket(`${host}/api/${token}`)\n+\n+                resetActivityTimeout()\n+\n+                socket.addEventListener('close', () => {\n+                  socket = undefined\n+                  rejectSocket(new Error('Socket closed unexpectedly'))\n+                })\n+\n+                socket.addEventListener('error', (error) => {\n+                  this.uppy.log(`Companion socket error ${JSON.stringify(error)}, closing socket`, 'warning')\n+                  socket.close() // will 'close' event to be emitted\n+                })\n+\n+                socket.addEventListener('open', () => {\n+                  sendState()\n+                })\n+\n+                socket.addEventListener('message', (e) => {\n+                  resetActivityTimeout()\n+\n+                  try {\n+                    const { action, payload } = JSON.parse(e.data)\n+            \n+                    switch (action) {\n+                      case 'progress': {\n+                        emitSocketProgress(this, payload, file)\n+                        break;\n+                      }\n+                      case 'success': {\n+                        this.uppy.emit('upload-success', file, { uploadURL: payload.url })\n+                        socketAbortController?.abort?.()\n+                        resolve()\n+                        break;\n+                      }\n+                      case 'error': {\n+                        const { message } = payload.error\n+                        throw Object.assign(new Error(message), { cause: payload.error })\n+                      }\n+                        default:\n+                          this.uppy.log(`Companion socket unknown action ${action}`, 'warning')\n+                    }\n+                  } catch (err) {\n+                    onFatalError(err)\n+                  }\n+                })\n+\n+                const closeSocket = () => {\n+                  this.uppy.log(`Closing socket ${file.id}`, 'info')\n+                  clearTimeout(activityTimeout)\n+                  if (socket) socket.close()\n+                  socket = undefined\n+                }\n+        \n+                socketAbortController.signal.addEventListener('abort', () => {\n+                  closeSocket()\n+                })\n+              })\n+\n+              await pRetry(reconnectWebsocket, {\n+                retries: retryCount,\n+                signal: socketAbortController.signal,\n+                onFailedAttempt: () => this.uppy.log(`Retrying websocket ${file.id}`, 'info'),\n+              });\n+            })().abortOn(socketAbortController.signal);\n+          } catch (err) {\n+            if (socketAbortController.signal.aborted) return\n+            onFatalError(err)\n+          }\n         }\n-        queuedRequest = queue.run(() => {\n-          socket.open()\n-          socket.send('resume', {})\n \n-          return () => {}\n-        })\n-      })\n-\n-      eventManager.onRetry(file.id, () => {\n-        // Only do the retry if the upload is actually in progress;\n-        // else we could try to send these messages when the upload is still queued.\n-        // We may need a better check for this since the socket may also be closed\n-        // for other reasons, like network failures.\n-        if (socket.isOpen) {\n-          socket.send('pause', {})\n-          socket.send('resume', {})\n+        const pause = (newPausedState) => {\n+          isPaused = newPausedState\n+          if (socket) sendState()\n+\n+          if (newPausedState) {\n+            // Remove this file from the queue so another file can start in its place.\n+            socketAbortController?.abort?.() // close socket to free up the request for other uploads\n+          } else {\n+            // Resuming an upload should be queued, else you could pause and then\n+            // resume a queued upload to make it skip the queue.\n+            createWebsocket()\n+          }\n         }\n-      })\n \n-      eventManager.onRetryAll(file.id, () => {\n-        // See the comment in the onRetry() call\n-        if (socket.isOpen) {\n-          socket.send('pause', {})\n-          socket.send('resume', {})\n+        const withErrorHandling = (fn, event) => {\n+          try {\n+            fn()\n+          } catch (err) {\n+            this.uppy.log(`Error while handling ${event} event for file ${file.id}: ${err.message}`, 'error')\n+          }\n         }\n-      })\n-\n-      socket.on('progress', (progressData) => emitSocketProgress(this, progressData, file))\n \n-      socket.on('error', (errData) => {\n-        const { message } = errData.error\n-        const error = Object.assign(new Error(message), {\n-          cause: errData.error,\n+        eventManager.onPause(file.id, (newPausedState) => withErrorHandling(() => pause(newPausedState), 'pause'))\n+        eventManager.onPauseAll(file.id, () => withErrorHandling(() => pause(true), 'pause-all'))\n+        eventManager.onResumeAll(file.id, () => withErrorHandling(() => pause(false), 'resume-all'))\n+\n+        eventManager.onFileRemove(file.id, () => withErrorHandling(() => {\n+          socketSend('cancel')\n+          socketAbortController?.abort?.()\n+          this.uppy.log(`upload ${file.id} was removed`, 'info')\n+          resolve()\n+        }, 'file-removed'))\n+\n+        eventManager.onCancelAll(file.id, ({ reason } = {}) => withErrorHandling(() => {\n+          if (reason === 'user') {\n+            socketSend('cancel')\n+          }\n+          socketAbortController?.abort?.()\n+          this.uppy.log(`upload ${file.id} was canceled`, 'info')\n+          resolve()\n+        }, 'cancel-all'))",
                "path": "packages/@uppy/companion-client/src/RequestClient.js",
                "commit_id": "a0501a940e732891215297aecf2613c847fbdc24",
                "original_commit_id": "a0501a940e732891215297aecf2613c847fbdc24",
                "user": {
                    "login": "mifi",
                    "id": 402547,
                    "node_id": "MDQ6VXNlcjQwMjU0Nw==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/402547?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/mifi",
                    "html_url": "https://github.com/mifi",
                    "followers_url": "https://api.github.com/users/mifi/followers",
                    "following_url": "https://api.github.com/users/mifi/following{/other_user}",
                    "gists_url": "https://api.github.com/users/mifi/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/mifi/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/mifi/subscriptions",
                    "organizations_url": "https://api.github.com/users/mifi/orgs",
                    "repos_url": "https://api.github.com/users/mifi/repos",
                    "events_url": "https://api.github.com/users/mifi/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/mifi/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "If you dont think catching errors in an event handler is a good idea, we can discuss that, maybe it\u2019s not. I just thought that it would be nice because np reported that if they cancel all uploads, and a single file throws an error in the handler, it prevents all other files from canceling too",
                "created_at": "2023-10-26T11:38:04Z",
                "updated_at": "2023-10-26T11:38:05Z",
                "html_url": "https://github.com/transloadit/uppy/pull/4734#discussion_r1373017302",
                "pull_request_url": "https://api.github.com/repos/transloadit/uppy/pulls/4734",
                "author_association": "CONTRIBUTOR",
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/comments/1373017302"
                    },
                    "html": {
                        "href": "https://github.com/transloadit/uppy/pull/4734#discussion_r1373017302"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734"
                    }
                },
                "reactions": {
                    "url": "https://api.github.com/repos/transloadit/uppy/pulls/comments/1373017302/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "start_line": 482,
                "original_start_line": 482,
                "start_side": "RIGHT",
                "line": 500,
                "original_line": 500,
                "side": "RIGHT",
                "in_reply_to_id": 1372909302,
                "original_position": 452,
                "position": 452,
                "subject_type": "line"
            },
            "pull_request": {
                "url": "https://api.github.com/repos/transloadit/uppy/pulls/4734",
                "id": 1556257466,
                "node_id": "PR_kwDOAsITpc5cwpq6",
                "html_url": "https://github.com/transloadit/uppy/pull/4734",
                "diff_url": "https://github.com/transloadit/uppy/pull/4734.diff",
                "patch_url": "https://github.com/transloadit/uppy/pull/4734.patch",
                "issue_url": "https://api.github.com/repos/transloadit/uppy/issues/4734",
                "number": 4734,
                "state": "open",
                "locked": false,
                "title": "Companion+client stability fixes, error handling and retry",
                "user": {
                    "login": "mifi",
                    "id": 402547,
                    "node_id": "MDQ6VXNlcjQwMjU0Nw==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/402547?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/mifi",
                    "html_url": "https://github.com/mifi",
                    "followers_url": "https://api.github.com/users/mifi/followers",
                    "following_url": "https://api.github.com/users/mifi/following{/other_user}",
                    "gists_url": "https://api.github.com/users/mifi/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/mifi/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/mifi/subscriptions",
                    "organizations_url": "https://api.github.com/users/mifi/orgs",
                    "repos_url": "https://api.github.com/users/mifi/repos",
                    "events_url": "https://api.github.com/users/mifi/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/mifi/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "- [respond with 500 if unhandled upload error](https://github.com/transloadit/uppy/commit/4f52551fe8af63032f6ac2d909ef60d1d89c90bd) \r\n 400 seems inappropriate\r\n- [fix companion download error](https://github.com/transloadit/uppy/commit/7bd5042adbad44f26b083ba01f7a64c782b19a73) \r\n  - respond with correct response code when calling /get and request to the upstream server fails\r\n  - also add a unit test for this\r\n- [forward 429 from provider](https://github.com/transloadit/uppy/commit/3fa992b23b7de675cad046daa41f064bb8cdf02c) \r\n  allows us to retry it\r\n- [add a way to test refresh tokens](https://github.com/transloadit/uppy/commit/aad9ae9d3e875cba6410618721470138448ff4cc)\r\n- [fix race condtiion with refreshing token](https://github.com/transloadit/uppy/commit/863b60e83a53c7c2e458bb0b8a39670ba94415e7) that would cause many `refresh-token` calls to be made concurrently, possibly causing problems\r\n- [implement retry and fix socket](https://github.com/transloadit/uppy/commit/7124ef484b6eda82df9c126efe6973c2427e92b8) \r\n  - Make sure we don't instantiate a new Provider for every file uploaded (reuse the original provider instead) - this caused the refresh token synchronization not to work\r\n  - Retry most errors when uploading (`/get`) using companion, but for HTTP, only retry certain HTTP status codes\r\n  - Reimplement the websocket code to be more stable and retry as well\r\n  - if no websocket messages have been received in 5 minutes, fail the upload, so the upload doesn't get stuck forever in case something goes bad, TODO should this should be solved in the UI instead?\r\n- [remove useFastRemoteRetry](https://github.com/transloadit/uppy/commit/8612d5d5ace5e7ec32db73e3632ec964657aff06) \r\n  - because it isn't supported in Companion as far as I can tell, and the option effectively doesn't do anything at all",
                "created_at": "2023-10-13T17:28:55Z",
                "updated_at": "2023-10-26T11:38:05Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "7c1c899a01eb66e45e7af9fd8b7f0bbd6748faa8",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/transloadit/uppy/pulls/4734/commits",
                "review_comments_url": "https://api.github.com/repos/transloadit/uppy/pulls/4734/comments",
                "review_comment_url": "https://api.github.com/repos/transloadit/uppy/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/transloadit/uppy/issues/4734/comments",
                "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/a0501a940e732891215297aecf2613c847fbdc24",
                "head": {
                    "label": "transloadit:companion-fixes",
                    "ref": "companion-fixes",
                    "sha": "a0501a940e732891215297aecf2613c847fbdc24",
                    "user": {
                        "login": "transloadit",
                        "id": 125754,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/transloadit",
                        "html_url": "https://github.com/transloadit",
                        "followers_url": "https://api.github.com/users/transloadit/followers",
                        "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                        "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                        "organizations_url": "https://api.github.com/users/transloadit/orgs",
                        "repos_url": "https://api.github.com/users/transloadit/repos",
                        "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/transloadit/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 46273445,
                        "node_id": "MDEwOlJlcG9zaXRvcnk0NjI3MzQ0NQ==",
                        "name": "uppy",
                        "full_name": "transloadit/uppy",
                        "private": false,
                        "owner": {
                            "login": "transloadit",
                            "id": 125754,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/transloadit",
                            "html_url": "https://github.com/transloadit",
                            "followers_url": "https://api.github.com/users/transloadit/followers",
                            "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                            "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                            "organizations_url": "https://api.github.com/users/transloadit/orgs",
                            "repos_url": "https://api.github.com/users/transloadit/repos",
                            "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/transloadit/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/transloadit/uppy",
                        "description": "The next open source file uploader for web browsers :dog: ",
                        "fork": false,
                        "url": "https://api.github.com/repos/transloadit/uppy",
                        "forks_url": "https://api.github.com/repos/transloadit/uppy/forks",
                        "keys_url": "https://api.github.com/repos/transloadit/uppy/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/transloadit/uppy/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/transloadit/uppy/teams",
                        "hooks_url": "https://api.github.com/repos/transloadit/uppy/hooks",
                        "issue_events_url": "https://api.github.com/repos/transloadit/uppy/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/transloadit/uppy/events",
                        "assignees_url": "https://api.github.com/repos/transloadit/uppy/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/transloadit/uppy/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/transloadit/uppy/tags",
                        "blobs_url": "https://api.github.com/repos/transloadit/uppy/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/transloadit/uppy/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/transloadit/uppy/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/transloadit/uppy/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/transloadit/uppy/languages",
                        "stargazers_url": "https://api.github.com/repos/transloadit/uppy/stargazers",
                        "contributors_url": "https://api.github.com/repos/transloadit/uppy/contributors",
                        "subscribers_url": "https://api.github.com/repos/transloadit/uppy/subscribers",
                        "subscription_url": "https://api.github.com/repos/transloadit/uppy/subscription",
                        "commits_url": "https://api.github.com/repos/transloadit/uppy/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/transloadit/uppy/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/transloadit/uppy/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/transloadit/uppy/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/transloadit/uppy/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/transloadit/uppy/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/transloadit/uppy/merges",
                        "archive_url": "https://api.github.com/repos/transloadit/uppy/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/transloadit/uppy/downloads",
                        "issues_url": "https://api.github.com/repos/transloadit/uppy/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/transloadit/uppy/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/transloadit/uppy/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/transloadit/uppy/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/transloadit/uppy/labels{/name}",
                        "releases_url": "https://api.github.com/repos/transloadit/uppy/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/transloadit/uppy/deployments",
                        "created_at": "2015-11-16T12:32:33Z",
                        "updated_at": "2023-10-26T10:03:44Z",
                        "pushed_at": "2023-10-25T15:17:29Z",
                        "git_url": "git://github.com/transloadit/uppy.git",
                        "ssh_url": "git@github.com:transloadit/uppy.git",
                        "clone_url": "https://github.com/transloadit/uppy.git",
                        "svn_url": "https://github.com/transloadit/uppy",
                        "homepage": "https://uppy.io",
                        "size": 389980,
                        "stargazers_count": 27488,
                        "watchers_count": 27488,
                        "language": "JavaScript",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": true,
                        "has_discussions": false,
                        "forks_count": 1934,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 168,
                        "license": {
                            "key": "mit",
                            "name": "MIT License",
                            "spdx_id": "MIT",
                            "url": "https://api.github.com/licenses/mit",
                            "node_id": "MDc6TGljZW5zZTEz"
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "dropbox",
                            "encoding",
                            "file-uploader",
                            "file-uploads",
                            "files",
                            "hacktoberfest",
                            "instagram",
                            "javascript",
                            "mit",
                            "modular",
                            "open-source",
                            "pick-files",
                            "resumable",
                            "transloadit",
                            "tus",
                            "uploader",
                            "uppy",
                            "webbrowser"
                        ],
                        "visibility": "public",
                        "forks": 1934,
                        "open_issues": 168,
                        "watchers": 27488,
                        "default_branch": "main"
                    }
                },
                "base": {
                    "label": "transloadit:main",
                    "ref": "main",
                    "sha": "8b252086f5e2769e0a2e95c22ac48b63b9ecfbd1",
                    "user": {
                        "login": "transloadit",
                        "id": 125754,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/transloadit",
                        "html_url": "https://github.com/transloadit",
                        "followers_url": "https://api.github.com/users/transloadit/followers",
                        "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                        "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                        "organizations_url": "https://api.github.com/users/transloadit/orgs",
                        "repos_url": "https://api.github.com/users/transloadit/repos",
                        "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/transloadit/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 46273445,
                        "node_id": "MDEwOlJlcG9zaXRvcnk0NjI3MzQ0NQ==",
                        "name": "uppy",
                        "full_name": "transloadit/uppy",
                        "private": false,
                        "owner": {
                            "login": "transloadit",
                            "id": 125754,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/transloadit",
                            "html_url": "https://github.com/transloadit",
                            "followers_url": "https://api.github.com/users/transloadit/followers",
                            "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                            "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                            "organizations_url": "https://api.github.com/users/transloadit/orgs",
                            "repos_url": "https://api.github.com/users/transloadit/repos",
                            "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/transloadit/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/transloadit/uppy",
                        "description": "The next open source file uploader for web browsers :dog: ",
                        "fork": false,
                        "url": "https://api.github.com/repos/transloadit/uppy",
                        "forks_url": "https://api.github.com/repos/transloadit/uppy/forks",
                        "keys_url": "https://api.github.com/repos/transloadit/uppy/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/transloadit/uppy/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/transloadit/uppy/teams",
                        "hooks_url": "https://api.github.com/repos/transloadit/uppy/hooks",
                        "issue_events_url": "https://api.github.com/repos/transloadit/uppy/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/transloadit/uppy/events",
                        "assignees_url": "https://api.github.com/repos/transloadit/uppy/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/transloadit/uppy/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/transloadit/uppy/tags",
                        "blobs_url": "https://api.github.com/repos/transloadit/uppy/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/transloadit/uppy/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/transloadit/uppy/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/transloadit/uppy/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/transloadit/uppy/languages",
                        "stargazers_url": "https://api.github.com/repos/transloadit/uppy/stargazers",
                        "contributors_url": "https://api.github.com/repos/transloadit/uppy/contributors",
                        "subscribers_url": "https://api.github.com/repos/transloadit/uppy/subscribers",
                        "subscription_url": "https://api.github.com/repos/transloadit/uppy/subscription",
                        "commits_url": "https://api.github.com/repos/transloadit/uppy/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/transloadit/uppy/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/transloadit/uppy/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/transloadit/uppy/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/transloadit/uppy/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/transloadit/uppy/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/transloadit/uppy/merges",
                        "archive_url": "https://api.github.com/repos/transloadit/uppy/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/transloadit/uppy/downloads",
                        "issues_url": "https://api.github.com/repos/transloadit/uppy/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/transloadit/uppy/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/transloadit/uppy/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/transloadit/uppy/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/transloadit/uppy/labels{/name}",
                        "releases_url": "https://api.github.com/repos/transloadit/uppy/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/transloadit/uppy/deployments",
                        "created_at": "2015-11-16T12:32:33Z",
                        "updated_at": "2023-10-26T10:03:44Z",
                        "pushed_at": "2023-10-25T15:17:29Z",
                        "git_url": "git://github.com/transloadit/uppy.git",
                        "ssh_url": "git@github.com:transloadit/uppy.git",
                        "clone_url": "https://github.com/transloadit/uppy.git",
                        "svn_url": "https://github.com/transloadit/uppy",
                        "homepage": "https://uppy.io",
                        "size": 389980,
                        "stargazers_count": 27488,
                        "watchers_count": 27488,
                        "language": "JavaScript",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": true,
                        "has_discussions": false,
                        "forks_count": 1934,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 168,
                        "license": {
                            "key": "mit",
                            "name": "MIT License",
                            "spdx_id": "MIT",
                            "url": "https://api.github.com/licenses/mit",
                            "node_id": "MDc6TGljZW5zZTEz"
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "dropbox",
                            "encoding",
                            "file-uploader",
                            "file-uploads",
                            "files",
                            "hacktoberfest",
                            "instagram",
                            "javascript",
                            "mit",
                            "modular",
                            "open-source",
                            "pick-files",
                            "resumable",
                            "transloadit",
                            "tus",
                            "uploader",
                            "uppy",
                            "webbrowser"
                        ],
                        "visibility": "public",
                        "forks": 1934,
                        "open_issues": 168,
                        "watchers": 27488,
                        "default_branch": "main"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734"
                    },
                    "html": {
                        "href": "https://github.com/transloadit/uppy/pull/4734"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/transloadit/uppy/issues/4734"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/transloadit/uppy/issues/4734/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/transloadit/uppy/statuses/a0501a940e732891215297aecf2613c847fbdc24"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T11:38:04Z",
        "org": {
            "id": 125754,
            "login": "transloadit",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/transloadit",
            "avatar_url": "https://avatars.githubusercontent.com/u/125754?"
        }
    },
    {
        "id": "32866227007",
        "type": "PullRequestReviewEvent",
        "actor": {
            "id": 402547,
            "login": "mifi",
            "display_login": "mifi",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mifi",
            "avatar_url": "https://avatars.githubusercontent.com/u/402547?"
        },
        "repo": {
            "id": 46273445,
            "name": "transloadit/uppy",
            "url": "https://api.github.com/repos/transloadit/uppy"
        },
        "payload": {
            "action": "created",
            "review": {
                "id": 1699377046,
                "node_id": "PRR_kwDOAsITpc5lSm-W",
                "user": {
                    "login": "mifi",
                    "id": 402547,
                    "node_id": "MDQ6VXNlcjQwMjU0Nw==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/402547?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/mifi",
                    "html_url": "https://github.com/mifi",
                    "followers_url": "https://api.github.com/users/mifi/followers",
                    "following_url": "https://api.github.com/users/mifi/following{/other_user}",
                    "gists_url": "https://api.github.com/users/mifi/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/mifi/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/mifi/subscriptions",
                    "organizations_url": "https://api.github.com/users/mifi/orgs",
                    "repos_url": "https://api.github.com/users/mifi/repos",
                    "events_url": "https://api.github.com/users/mifi/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/mifi/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": null,
                "commit_id": "a0501a940e732891215297aecf2613c847fbdc24",
                "submitted_at": "2023-10-26T11:38:05Z",
                "state": "commented",
                "html_url": "https://github.com/transloadit/uppy/pull/4734#pullrequestreview-1699377046",
                "pull_request_url": "https://api.github.com/repos/transloadit/uppy/pulls/4734",
                "author_association": "CONTRIBUTOR",
                "_links": {
                    "html": {
                        "href": "https://github.com/transloadit/uppy/pull/4734#pullrequestreview-1699377046"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734"
                    }
                }
            },
            "pull_request": {
                "url": "https://api.github.com/repos/transloadit/uppy/pulls/4734",
                "id": 1556257466,
                "node_id": "PR_kwDOAsITpc5cwpq6",
                "html_url": "https://github.com/transloadit/uppy/pull/4734",
                "diff_url": "https://github.com/transloadit/uppy/pull/4734.diff",
                "patch_url": "https://github.com/transloadit/uppy/pull/4734.patch",
                "issue_url": "https://api.github.com/repos/transloadit/uppy/issues/4734",
                "number": 4734,
                "state": "open",
                "locked": false,
                "title": "Companion+client stability fixes, error handling and retry",
                "user": {
                    "login": "mifi",
                    "id": 402547,
                    "node_id": "MDQ6VXNlcjQwMjU0Nw==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/402547?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/mifi",
                    "html_url": "https://github.com/mifi",
                    "followers_url": "https://api.github.com/users/mifi/followers",
                    "following_url": "https://api.github.com/users/mifi/following{/other_user}",
                    "gists_url": "https://api.github.com/users/mifi/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/mifi/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/mifi/subscriptions",
                    "organizations_url": "https://api.github.com/users/mifi/orgs",
                    "repos_url": "https://api.github.com/users/mifi/repos",
                    "events_url": "https://api.github.com/users/mifi/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/mifi/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "- [respond with 500 if unhandled upload error](https://github.com/transloadit/uppy/commit/4f52551fe8af63032f6ac2d909ef60d1d89c90bd) \r\n 400 seems inappropriate\r\n- [fix companion download error](https://github.com/transloadit/uppy/commit/7bd5042adbad44f26b083ba01f7a64c782b19a73) \r\n  - respond with correct response code when calling /get and request to the upstream server fails\r\n  - also add a unit test for this\r\n- [forward 429 from provider](https://github.com/transloadit/uppy/commit/3fa992b23b7de675cad046daa41f064bb8cdf02c) \r\n  allows us to retry it\r\n- [add a way to test refresh tokens](https://github.com/transloadit/uppy/commit/aad9ae9d3e875cba6410618721470138448ff4cc)\r\n- [fix race condtiion with refreshing token](https://github.com/transloadit/uppy/commit/863b60e83a53c7c2e458bb0b8a39670ba94415e7) that would cause many `refresh-token` calls to be made concurrently, possibly causing problems\r\n- [implement retry and fix socket](https://github.com/transloadit/uppy/commit/7124ef484b6eda82df9c126efe6973c2427e92b8) \r\n  - Make sure we don't instantiate a new Provider for every file uploaded (reuse the original provider instead) - this caused the refresh token synchronization not to work\r\n  - Retry most errors when uploading (`/get`) using companion, but for HTTP, only retry certain HTTP status codes\r\n  - Reimplement the websocket code to be more stable and retry as well\r\n  - if no websocket messages have been received in 5 minutes, fail the upload, so the upload doesn't get stuck forever in case something goes bad, TODO should this should be solved in the UI instead?\r\n- [remove useFastRemoteRetry](https://github.com/transloadit/uppy/commit/8612d5d5ace5e7ec32db73e3632ec964657aff06) \r\n  - because it isn't supported in Companion as far as I can tell, and the option effectively doesn't do anything at all",
                "created_at": "2023-10-13T17:28:55Z",
                "updated_at": "2023-10-26T11:38:05Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "7c1c899a01eb66e45e7af9fd8b7f0bbd6748faa8",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/transloadit/uppy/pulls/4734/commits",
                "review_comments_url": "https://api.github.com/repos/transloadit/uppy/pulls/4734/comments",
                "review_comment_url": "https://api.github.com/repos/transloadit/uppy/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/transloadit/uppy/issues/4734/comments",
                "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/a0501a940e732891215297aecf2613c847fbdc24",
                "head": {
                    "label": "transloadit:companion-fixes",
                    "ref": "companion-fixes",
                    "sha": "a0501a940e732891215297aecf2613c847fbdc24",
                    "user": {
                        "login": "transloadit",
                        "id": 125754,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/transloadit",
                        "html_url": "https://github.com/transloadit",
                        "followers_url": "https://api.github.com/users/transloadit/followers",
                        "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                        "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                        "organizations_url": "https://api.github.com/users/transloadit/orgs",
                        "repos_url": "https://api.github.com/users/transloadit/repos",
                        "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/transloadit/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 46273445,
                        "node_id": "MDEwOlJlcG9zaXRvcnk0NjI3MzQ0NQ==",
                        "name": "uppy",
                        "full_name": "transloadit/uppy",
                        "private": false,
                        "owner": {
                            "login": "transloadit",
                            "id": 125754,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/transloadit",
                            "html_url": "https://github.com/transloadit",
                            "followers_url": "https://api.github.com/users/transloadit/followers",
                            "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                            "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                            "organizations_url": "https://api.github.com/users/transloadit/orgs",
                            "repos_url": "https://api.github.com/users/transloadit/repos",
                            "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/transloadit/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/transloadit/uppy",
                        "description": "The next open source file uploader for web browsers :dog: ",
                        "fork": false,
                        "url": "https://api.github.com/repos/transloadit/uppy",
                        "forks_url": "https://api.github.com/repos/transloadit/uppy/forks",
                        "keys_url": "https://api.github.com/repos/transloadit/uppy/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/transloadit/uppy/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/transloadit/uppy/teams",
                        "hooks_url": "https://api.github.com/repos/transloadit/uppy/hooks",
                        "issue_events_url": "https://api.github.com/repos/transloadit/uppy/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/transloadit/uppy/events",
                        "assignees_url": "https://api.github.com/repos/transloadit/uppy/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/transloadit/uppy/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/transloadit/uppy/tags",
                        "blobs_url": "https://api.github.com/repos/transloadit/uppy/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/transloadit/uppy/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/transloadit/uppy/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/transloadit/uppy/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/transloadit/uppy/languages",
                        "stargazers_url": "https://api.github.com/repos/transloadit/uppy/stargazers",
                        "contributors_url": "https://api.github.com/repos/transloadit/uppy/contributors",
                        "subscribers_url": "https://api.github.com/repos/transloadit/uppy/subscribers",
                        "subscription_url": "https://api.github.com/repos/transloadit/uppy/subscription",
                        "commits_url": "https://api.github.com/repos/transloadit/uppy/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/transloadit/uppy/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/transloadit/uppy/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/transloadit/uppy/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/transloadit/uppy/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/transloadit/uppy/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/transloadit/uppy/merges",
                        "archive_url": "https://api.github.com/repos/transloadit/uppy/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/transloadit/uppy/downloads",
                        "issues_url": "https://api.github.com/repos/transloadit/uppy/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/transloadit/uppy/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/transloadit/uppy/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/transloadit/uppy/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/transloadit/uppy/labels{/name}",
                        "releases_url": "https://api.github.com/repos/transloadit/uppy/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/transloadit/uppy/deployments",
                        "created_at": "2015-11-16T12:32:33Z",
                        "updated_at": "2023-10-26T10:03:44Z",
                        "pushed_at": "2023-10-25T15:17:29Z",
                        "git_url": "git://github.com/transloadit/uppy.git",
                        "ssh_url": "git@github.com:transloadit/uppy.git",
                        "clone_url": "https://github.com/transloadit/uppy.git",
                        "svn_url": "https://github.com/transloadit/uppy",
                        "homepage": "https://uppy.io",
                        "size": 389980,
                        "stargazers_count": 27488,
                        "watchers_count": 27488,
                        "language": "JavaScript",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": true,
                        "has_discussions": false,
                        "forks_count": 1934,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 168,
                        "license": {
                            "key": "mit",
                            "name": "MIT License",
                            "spdx_id": "MIT",
                            "url": "https://api.github.com/licenses/mit",
                            "node_id": "MDc6TGljZW5zZTEz"
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "dropbox",
                            "encoding",
                            "file-uploader",
                            "file-uploads",
                            "files",
                            "hacktoberfest",
                            "instagram",
                            "javascript",
                            "mit",
                            "modular",
                            "open-source",
                            "pick-files",
                            "resumable",
                            "transloadit",
                            "tus",
                            "uploader",
                            "uppy",
                            "webbrowser"
                        ],
                        "visibility": "public",
                        "forks": 1934,
                        "open_issues": 168,
                        "watchers": 27488,
                        "default_branch": "main"
                    }
                },
                "base": {
                    "label": "transloadit:main",
                    "ref": "main",
                    "sha": "8b252086f5e2769e0a2e95c22ac48b63b9ecfbd1",
                    "user": {
                        "login": "transloadit",
                        "id": 125754,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/transloadit",
                        "html_url": "https://github.com/transloadit",
                        "followers_url": "https://api.github.com/users/transloadit/followers",
                        "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                        "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                        "organizations_url": "https://api.github.com/users/transloadit/orgs",
                        "repos_url": "https://api.github.com/users/transloadit/repos",
                        "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/transloadit/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 46273445,
                        "node_id": "MDEwOlJlcG9zaXRvcnk0NjI3MzQ0NQ==",
                        "name": "uppy",
                        "full_name": "transloadit/uppy",
                        "private": false,
                        "owner": {
                            "login": "transloadit",
                            "id": 125754,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/transloadit",
                            "html_url": "https://github.com/transloadit",
                            "followers_url": "https://api.github.com/users/transloadit/followers",
                            "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                            "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                            "organizations_url": "https://api.github.com/users/transloadit/orgs",
                            "repos_url": "https://api.github.com/users/transloadit/repos",
                            "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/transloadit/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/transloadit/uppy",
                        "description": "The next open source file uploader for web browsers :dog: ",
                        "fork": false,
                        "url": "https://api.github.com/repos/transloadit/uppy",
                        "forks_url": "https://api.github.com/repos/transloadit/uppy/forks",
                        "keys_url": "https://api.github.com/repos/transloadit/uppy/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/transloadit/uppy/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/transloadit/uppy/teams",
                        "hooks_url": "https://api.github.com/repos/transloadit/uppy/hooks",
                        "issue_events_url": "https://api.github.com/repos/transloadit/uppy/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/transloadit/uppy/events",
                        "assignees_url": "https://api.github.com/repos/transloadit/uppy/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/transloadit/uppy/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/transloadit/uppy/tags",
                        "blobs_url": "https://api.github.com/repos/transloadit/uppy/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/transloadit/uppy/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/transloadit/uppy/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/transloadit/uppy/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/transloadit/uppy/languages",
                        "stargazers_url": "https://api.github.com/repos/transloadit/uppy/stargazers",
                        "contributors_url": "https://api.github.com/repos/transloadit/uppy/contributors",
                        "subscribers_url": "https://api.github.com/repos/transloadit/uppy/subscribers",
                        "subscription_url": "https://api.github.com/repos/transloadit/uppy/subscription",
                        "commits_url": "https://api.github.com/repos/transloadit/uppy/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/transloadit/uppy/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/transloadit/uppy/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/transloadit/uppy/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/transloadit/uppy/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/transloadit/uppy/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/transloadit/uppy/merges",
                        "archive_url": "https://api.github.com/repos/transloadit/uppy/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/transloadit/uppy/downloads",
                        "issues_url": "https://api.github.com/repos/transloadit/uppy/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/transloadit/uppy/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/transloadit/uppy/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/transloadit/uppy/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/transloadit/uppy/labels{/name}",
                        "releases_url": "https://api.github.com/repos/transloadit/uppy/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/transloadit/uppy/deployments",
                        "created_at": "2015-11-16T12:32:33Z",
                        "updated_at": "2023-10-26T10:03:44Z",
                        "pushed_at": "2023-10-25T15:17:29Z",
                        "git_url": "git://github.com/transloadit/uppy.git",
                        "ssh_url": "git@github.com:transloadit/uppy.git",
                        "clone_url": "https://github.com/transloadit/uppy.git",
                        "svn_url": "https://github.com/transloadit/uppy",
                        "homepage": "https://uppy.io",
                        "size": 389980,
                        "stargazers_count": 27488,
                        "watchers_count": 27488,
                        "language": "JavaScript",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": true,
                        "has_discussions": false,
                        "forks_count": 1934,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 168,
                        "license": {
                            "key": "mit",
                            "name": "MIT License",
                            "spdx_id": "MIT",
                            "url": "https://api.github.com/licenses/mit",
                            "node_id": "MDc6TGljZW5zZTEz"
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "dropbox",
                            "encoding",
                            "file-uploader",
                            "file-uploads",
                            "files",
                            "hacktoberfest",
                            "instagram",
                            "javascript",
                            "mit",
                            "modular",
                            "open-source",
                            "pick-files",
                            "resumable",
                            "transloadit",
                            "tus",
                            "uploader",
                            "uppy",
                            "webbrowser"
                        ],
                        "visibility": "public",
                        "forks": 1934,
                        "open_issues": 168,
                        "watchers": 27488,
                        "default_branch": "main"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734"
                    },
                    "html": {
                        "href": "https://github.com/transloadit/uppy/pull/4734"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/transloadit/uppy/issues/4734"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/transloadit/uppy/issues/4734/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/transloadit/uppy/statuses/a0501a940e732891215297aecf2613c847fbdc24"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T11:38:06Z",
        "org": {
            "id": 125754,
            "login": "transloadit",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/transloadit",
            "avatar_url": "https://avatars.githubusercontent.com/u/125754?"
        }
    },
    {
        "id": "32866199193",
        "type": "PullRequestReviewCommentEvent",
        "actor": {
            "id": 9060226,
            "login": "Murderlon",
            "display_login": "Murderlon",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Murderlon",
            "avatar_url": "https://avatars.githubusercontent.com/u/9060226?"
        },
        "repo": {
            "id": 46273445,
            "name": "transloadit/uppy",
            "url": "https://api.github.com/repos/transloadit/uppy"
        },
        "payload": {
            "action": "created",
            "comment": {
                "url": "https://api.github.com/repos/transloadit/uppy/pulls/comments/1373015887",
                "pull_request_review_id": 1699375344,
                "id": 1373015887,
                "node_id": "PRRC_kwDOAsITpc5R1o9P",
                "diff_hunk": "@@ -222,179 +240,273 @@ export default class RequestClient {\n     return this.request({ ...options, path, method: 'DELETE', data })\n   }\n \n+  /**\n+   * Remote uploading consists of two steps:\n+   * 1. #requestSocketToken which starts the download/upload in companion and returns a unique token for the upload.\n+   * Then companion will halt the upload until:\n+   * 2. #awaitRemoteFileUpload is called, which will open/ensure a websocket connection towards companion, with the\n+   * previously generated token provided. It returns a promise that will resolve/reject once the file has finished\n+   * uploading or is otherwise done (failed, canceled)\n+   * \n+   * @param {*} file \n+   * @param {*} reqBody \n+   * @param {*} options \n+   * @returns \n+   */\n   async uploadRemoteFile (file, reqBody, options = {}) {\n     try {\n-      if (file.serverToken) {\n-        return await this.connectToServerSocket(file, this.getQueue())\n-      }\n-      const queueRequestSocketToken = this.getQueue().wrapPromiseFunction(\n-        this.#requestSocketToken,\n-        { priority: -1 },\n-      )\n-      const serverToken = await queueRequestSocketToken(file, reqBody).abortOn(\n-        options.signal,\n-      )\n-\n-      if (!this.uppy.getState().files[file.id]) return undefined\n-\n-      this.uppy.setFileState(file.id, { serverToken })\n-      return await this.connectToServerSocket(\n-        this.uppy.getFile(file.id),\n-        this.getQueue(),\n-      )\n+      const { signal, getQueue } = options\n+\n+      return await pRetry(async () => {\n+        // if we already have a serverToken, assume that we are resuming the existing server upload id\n+        const existingServerToken = this.uppy.getFile(file.id)?.serverToken;\n+        if (existingServerToken != null) {\n+          this.uppy.log(`Connecting to exiting websocket ${existingServerToken}`)\n+          return this.#awaitRemoteFileUpload({ file, queue: getQueue(), signal })\n+        }\n+\n+        const queueRequestSocketToken = getQueue().wrapPromiseFunction(async (...args) => {\n+          try {\n+            return await this.#requestSocketToken(...args)\n+          } catch (outerErr) {\n+            // throwing AbortError will cause p-retry to stop retrying\n+            if (outerErr instanceof AuthError) throw new AbortError(outerErr)\n+\n+            if (outerErr.cause == null) throw outerErr\n+            const err = outerErr.cause\n+\n+            const isRetryableHttpError = () => (\n+              [408, 409, 429, 418, 423].includes(err.statusCode)\n+              || (err.statusCode >= 500 && err.statusCode <= 599 && ![501, 505].includes(err.statusCode))\n+            )\n+            if (err instanceof HttpError && !isRetryableHttpError()) throw new AbortError(err);\n+  \n+            // p-retry will retry most other errors,\n+            // but it will not retry TypeError (except network error TypeErrors)\n+            throw err\n+          }\n+        }, { priority: -1 })\n+\n+        const serverToken = await queueRequestSocketToken(file, reqBody).abortOn(signal)\n+\n+        if (!this.uppy.getFile(file.id)) return undefined // has file since been removed?\n+\n+        this.uppy.setFileState(file.id, { serverToken })\n+\n+        return this.#awaitRemoteFileUpload({\n+          file: this.uppy.getFile(file.id), // re-fetching file because it might have changed in the meantime\n+          queue: getQueue(),\n+          signal\n+        })\n+      }, { retries: retryCount, signal, onFailedAttempt: (err) => this.uppy.log(`Retrying upload due to: ${err.message}`, 'warning') });\n     } catch (err) {\n+      // this is a bit confusing, but an error with name 'AbortError' (from `signal`) is not the same as `p-retry` AbortError\n       if (err?.cause?.name === 'AbortError') {\n         // The file upload was aborted, it\u2019s not an error\n         return undefined\n       }\n \n-      this.uppy.setFileState(file.id, { serverToken: undefined })\n       this.uppy.emit('upload-error', file, err)\n       throw err\n     }\n   }\n \n-  #requestSocketToken = async (file, postBody) => {\n+  #requestSocketToken = async (file, postBody, signal) => {\n     if (file.remote.url == null) {\n       throw new Error('Cannot connect to an undefined URL')\n     }\n \n     const res = await this.post(file.remote.url, {\n       ...file.remote.body,\n       ...postBody,\n-    })\n+    }, signal)\n \n     return res.token\n   }\n \n   /**\n-   * @param {UppyFile} file\n+   * This method will ensure a websocket for the specified file and returns a promise that resolves\n+   * when the file has finished downloading, or rejects if it fails.\n+   * It will retry if the websocket gets disconnected\n+   * \n+   * @param {{ file: UppyFile, queue: RateLimitedQueue, signal: AbortSignal }} file\n    */\n-  async connectToServerSocket (file, queue) {\n-    return new Promise((resolve, reject) => {\n-      const token = file.serverToken\n-      const host = getSocketHost(file.remote.companionUrl)\n-      const socket = new Socket({\n-        target: `${host}/api/${token}`,\n-        autoOpen: false,\n-      })\n-      const eventManager = new EventManager(this.uppy)\n+  async #awaitRemoteFileUpload ({ file, queue, signal }) {\n+    const eventManager = new EventManager(this.uppy)\n \n-      let queuedRequest\n-\n-      eventManager.onFileRemove(file.id, () => {\n-        socket.send('cancel', {})\n-        queuedRequest.abort()\n-        resolve(`upload ${file.id} was removed`)\n-      })\n-\n-      eventManager.onPause(file.id, (isPaused) => {\n-        if (isPaused) {\n-          // Remove this file from the queue so another file can start in its place.\n-          socket.send('pause', {})\n-          queuedRequest.abort()\n-        } else {\n-          // Resuming an upload should be queued, else you could pause and then\n-          // resume a queued upload to make it skip the queue.\n-          queuedRequest.abort()\n-          queuedRequest = queue.run(() => {\n-            socket.open()\n-            socket.send('resume', {})\n-\n-            return () => {}\n-          })\n-        }\n-      })\n-\n-      eventManager.onPauseAll(file.id, () => {\n-        socket.send('pause', {})\n-        queuedRequest.abort()\n-      })\n-\n-      eventManager.onCancelAll(file.id, ({ reason } = {}) => {\n-        if (reason === 'user') {\n-          socket.send('cancel', {})\n-          queuedRequest.abort()\n+    try {\n+      return await new Promise((resolve, reject) => {\n+        const token = file.serverToken\n+        const host = getSocketHost(file.remote.companionUrl)\n+\n+        /** @type {WebSocket} */\n+        let socket\n+        /** @type {AbortController?} */\n+        let socketAbortController\n+        let activityTimeout\n+\n+        let { isPaused } = file\n+\n+        const socketSend = (action, payload) => {\n+          if (socket == null || socket.readyState !== socket.OPEN) {\n+            this.uppy.log(`Cannot send \"${action}\" to socket ${file.id} because the socket state was ${String(socket?.readyState)}`, 'warning')\n+            return\n+          }\n+\n+          socket.send(JSON.stringify({\n+            action,\n+            payload: payload ?? {},\n+          }))    \n+        };\n+\n+        function sendState() {\n+          if (isPaused) socketSend('pause')\n+          else socketSend('resume')\n         }\n-        resolve(`upload ${file.id} was canceled`)\n-      })\n \n-      eventManager.onResumeAll(file.id, () => {\n-        queuedRequest.abort()\n-        if (file.error) {\n-          socket.send('pause', {})\n+        const createWebsocket = async () => {\n+          if (socketAbortController) socketAbortController.abort()\n+          socketAbortController = new AbortController()\n+\n+          const onFatalError = (err) => {\n+            // Remove the serverToken so that a new one will be created for the retry.\n+            this.uppy.setFileState(file.id, { serverToken: null })\n+            socketAbortController?.abort?.()\n+            reject(err)\n+          }\n+  \n+          // todo instead implement the ability for users to cancel / retry *currently uploading files* in the UI\n+          function resetActivityTimeout() {\n+            clearTimeout(activityTimeout)\n+            if (isPaused) return\n+            activityTimeout = setTimeout(() => onFatalError(new Error('Timeout waiting for message from Companion socket')), socketActivityTimeoutMs)\n+          }\n+\n+          try {\n+            await queue.wrapPromiseFunction(async () => {\n+              // eslint-disable-next-line promise/param-names\n+              const reconnectWebsocket = async () => new Promise((resolveSocket, rejectSocket) => {\n+                socket = new WebSocket(`${host}/api/${token}`)\n+\n+                resetActivityTimeout()\n+\n+                socket.addEventListener('close', () => {\n+                  socket = undefined\n+                  rejectSocket(new Error('Socket closed unexpectedly'))\n+                })\n+\n+                socket.addEventListener('error', (error) => {\n+                  this.uppy.log(`Companion socket error ${JSON.stringify(error)}, closing socket`, 'warning')\n+                  socket.close() // will 'close' event to be emitted\n+                })\n+\n+                socket.addEventListener('open', () => {\n+                  sendState()\n+                })\n+\n+                socket.addEventListener('message', (e) => {\n+                  resetActivityTimeout()\n+\n+                  try {\n+                    const { action, payload } = JSON.parse(e.data)\n+            \n+                    switch (action) {\n+                      case 'progress': {\n+                        emitSocketProgress(this, payload, file)\n+                        break;\n+                      }\n+                      case 'success': {\n+                        this.uppy.emit('upload-success', file, { uploadURL: payload.url })\n+                        socketAbortController?.abort?.()\n+                        resolve()\n+                        break;\n+                      }\n+                      case 'error': {\n+                        const { message } = payload.error\n+                        throw Object.assign(new Error(message), { cause: payload.error })\n+                      }\n+                        default:\n+                          this.uppy.log(`Companion socket unknown action ${action}`, 'warning')\n+                    }\n+                  } catch (err) {\n+                    onFatalError(err)\n+                  }\n+                })\n+\n+                const closeSocket = () => {\n+                  this.uppy.log(`Closing socket ${file.id}`, 'info')\n+                  clearTimeout(activityTimeout)\n+                  if (socket) socket.close()\n+                  socket = undefined\n+                }\n+        \n+                socketAbortController.signal.addEventListener('abort', () => {\n+                  closeSocket()\n+                })\n+              })\n+\n+              await pRetry(reconnectWebsocket, {\n+                retries: retryCount,\n+                signal: socketAbortController.signal,\n+                onFailedAttempt: () => this.uppy.log(`Retrying websocket ${file.id}`, 'info'),\n+              });\n+            })().abortOn(socketAbortController.signal);\n+          } catch (err) {\n+            if (socketAbortController.signal.aborted) return\n+            onFatalError(err)\n+          }\n         }\n-        queuedRequest = queue.run(() => {\n-          socket.open()\n-          socket.send('resume', {})\n \n-          return () => {}\n-        })\n-      })\n-\n-      eventManager.onRetry(file.id, () => {\n-        // Only do the retry if the upload is actually in progress;\n-        // else we could try to send these messages when the upload is still queued.\n-        // We may need a better check for this since the socket may also be closed\n-        // for other reasons, like network failures.\n-        if (socket.isOpen) {\n-          socket.send('pause', {})\n-          socket.send('resume', {})\n+        const pause = (newPausedState) => {\n+          isPaused = newPausedState\n+          if (socket) sendState()\n+\n+          if (newPausedState) {\n+            // Remove this file from the queue so another file can start in its place.\n+            socketAbortController?.abort?.() // close socket to free up the request for other uploads\n+          } else {\n+            // Resuming an upload should be queued, else you could pause and then\n+            // resume a queued upload to make it skip the queue.\n+            createWebsocket()\n+          }\n         }\n-      })\n \n-      eventManager.onRetryAll(file.id, () => {\n-        // See the comment in the onRetry() call\n-        if (socket.isOpen) {\n-          socket.send('pause', {})\n-          socket.send('resume', {})\n+        const withErrorHandling = (fn, event) => {\n+          try {\n+            fn()\n+          } catch (err) {\n+            this.uppy.log(`Error while handling ${event} event for file ${file.id}: ${err.message}`, 'error')\n+          }\n         }\n-      })\n-\n-      socket.on('progress', (progressData) => emitSocketProgress(this, progressData, file))\n \n-      socket.on('error', (errData) => {\n-        const { message } = errData.error\n-        const error = Object.assign(new Error(message), {\n-          cause: errData.error,\n+        eventManager.onPause(file.id, (newPausedState) => withErrorHandling(() => pause(newPausedState), 'pause'))\n+        eventManager.onPauseAll(file.id, () => withErrorHandling(() => pause(true), 'pause-all'))\n+        eventManager.onResumeAll(file.id, () => withErrorHandling(() => pause(false), 'resume-all'))\n+\n+        eventManager.onFileRemove(file.id, () => withErrorHandling(() => {\n+          socketSend('cancel')\n+          socketAbortController?.abort?.()\n+          this.uppy.log(`upload ${file.id} was removed`, 'info')\n+          resolve()\n+        }, 'file-removed'))\n+\n+        eventManager.onCancelAll(file.id, ({ reason } = {}) => withErrorHandling(() => {\n+          if (reason === 'user') {\n+            socketSend('cancel')\n+          }\n+          socketAbortController?.abort?.()\n+          this.uppy.log(`upload ${file.id} was canceled`, 'info')\n+          resolve()\n+        }, 'cancel-all'))",
                "path": "packages/@uppy/companion-client/src/RequestClient.js",
                "commit_id": "a0501a940e732891215297aecf2613c847fbdc24",
                "original_commit_id": "a0501a940e732891215297aecf2613c847fbdc24",
                "user": {
                    "login": "Murderlon",
                    "id": 9060226,
                    "node_id": "MDQ6VXNlcjkwNjAyMjY=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/9060226?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/Murderlon",
                    "html_url": "https://github.com/Murderlon",
                    "followers_url": "https://api.github.com/users/Murderlon/followers",
                    "following_url": "https://api.github.com/users/Murderlon/following{/other_user}",
                    "gists_url": "https://api.github.com/users/Murderlon/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/Murderlon/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/Murderlon/subscriptions",
                    "organizations_url": "https://api.github.com/users/Murderlon/orgs",
                    "repos_url": "https://api.github.com/users/Murderlon/repos",
                    "events_url": "https://api.github.com/users/Murderlon/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/Murderlon/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "It doesn't handle errors thrown yet. But since we're moving away from `EventManager`, it would help a lot if you do it now instead of making it even harder after merging this with more conflicts. ",
                "created_at": "2023-10-26T11:37:00Z",
                "updated_at": "2023-10-26T11:37:00Z",
                "html_url": "https://github.com/transloadit/uppy/pull/4734#discussion_r1373015887",
                "pull_request_url": "https://api.github.com/repos/transloadit/uppy/pulls/4734",
                "author_association": "MEMBER",
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/comments/1373015887"
                    },
                    "html": {
                        "href": "https://github.com/transloadit/uppy/pull/4734#discussion_r1373015887"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734"
                    }
                },
                "reactions": {
                    "url": "https://api.github.com/repos/transloadit/uppy/pulls/comments/1373015887/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "start_line": 482,
                "original_start_line": 482,
                "start_side": "RIGHT",
                "line": 500,
                "original_line": 500,
                "side": "RIGHT",
                "in_reply_to_id": 1372909302,
                "original_position": 452,
                "position": 452,
                "subject_type": "line"
            },
            "pull_request": {
                "url": "https://api.github.com/repos/transloadit/uppy/pulls/4734",
                "id": 1556257466,
                "node_id": "PR_kwDOAsITpc5cwpq6",
                "html_url": "https://github.com/transloadit/uppy/pull/4734",
                "diff_url": "https://github.com/transloadit/uppy/pull/4734.diff",
                "patch_url": "https://github.com/transloadit/uppy/pull/4734.patch",
                "issue_url": "https://api.github.com/repos/transloadit/uppy/issues/4734",
                "number": 4734,
                "state": "open",
                "locked": false,
                "title": "Companion+client stability fixes, error handling and retry",
                "user": {
                    "login": "mifi",
                    "id": 402547,
                    "node_id": "MDQ6VXNlcjQwMjU0Nw==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/402547?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/mifi",
                    "html_url": "https://github.com/mifi",
                    "followers_url": "https://api.github.com/users/mifi/followers",
                    "following_url": "https://api.github.com/users/mifi/following{/other_user}",
                    "gists_url": "https://api.github.com/users/mifi/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/mifi/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/mifi/subscriptions",
                    "organizations_url": "https://api.github.com/users/mifi/orgs",
                    "repos_url": "https://api.github.com/users/mifi/repos",
                    "events_url": "https://api.github.com/users/mifi/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/mifi/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "- [respond with 500 if unhandled upload error](https://github.com/transloadit/uppy/commit/4f52551fe8af63032f6ac2d909ef60d1d89c90bd) \r\n 400 seems inappropriate\r\n- [fix companion download error](https://github.com/transloadit/uppy/commit/7bd5042adbad44f26b083ba01f7a64c782b19a73) \r\n  - respond with correct response code when calling /get and request to the upstream server fails\r\n  - also add a unit test for this\r\n- [forward 429 from provider](https://github.com/transloadit/uppy/commit/3fa992b23b7de675cad046daa41f064bb8cdf02c) \r\n  allows us to retry it\r\n- [add a way to test refresh tokens](https://github.com/transloadit/uppy/commit/aad9ae9d3e875cba6410618721470138448ff4cc)\r\n- [fix race condtiion with refreshing token](https://github.com/transloadit/uppy/commit/863b60e83a53c7c2e458bb0b8a39670ba94415e7) that would cause many `refresh-token` calls to be made concurrently, possibly causing problems\r\n- [implement retry and fix socket](https://github.com/transloadit/uppy/commit/7124ef484b6eda82df9c126efe6973c2427e92b8) \r\n  - Make sure we don't instantiate a new Provider for every file uploaded (reuse the original provider instead) - this caused the refresh token synchronization not to work\r\n  - Retry most errors when uploading (`/get`) using companion, but for HTTP, only retry certain HTTP status codes\r\n  - Reimplement the websocket code to be more stable and retry as well\r\n  - if no websocket messages have been received in 5 minutes, fail the upload, so the upload doesn't get stuck forever in case something goes bad, TODO should this should be solved in the UI instead?\r\n- [remove useFastRemoteRetry](https://github.com/transloadit/uppy/commit/8612d5d5ace5e7ec32db73e3632ec964657aff06) \r\n  - because it isn't supported in Companion as far as I can tell, and the option effectively doesn't do anything at all",
                "created_at": "2023-10-13T17:28:55Z",
                "updated_at": "2023-10-26T11:37:00Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "7c1c899a01eb66e45e7af9fd8b7f0bbd6748faa8",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/transloadit/uppy/pulls/4734/commits",
                "review_comments_url": "https://api.github.com/repos/transloadit/uppy/pulls/4734/comments",
                "review_comment_url": "https://api.github.com/repos/transloadit/uppy/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/transloadit/uppy/issues/4734/comments",
                "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/a0501a940e732891215297aecf2613c847fbdc24",
                "head": {
                    "label": "transloadit:companion-fixes",
                    "ref": "companion-fixes",
                    "sha": "a0501a940e732891215297aecf2613c847fbdc24",
                    "user": {
                        "login": "transloadit",
                        "id": 125754,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/transloadit",
                        "html_url": "https://github.com/transloadit",
                        "followers_url": "https://api.github.com/users/transloadit/followers",
                        "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                        "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                        "organizations_url": "https://api.github.com/users/transloadit/orgs",
                        "repos_url": "https://api.github.com/users/transloadit/repos",
                        "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/transloadit/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 46273445,
                        "node_id": "MDEwOlJlcG9zaXRvcnk0NjI3MzQ0NQ==",
                        "name": "uppy",
                        "full_name": "transloadit/uppy",
                        "private": false,
                        "owner": {
                            "login": "transloadit",
                            "id": 125754,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/transloadit",
                            "html_url": "https://github.com/transloadit",
                            "followers_url": "https://api.github.com/users/transloadit/followers",
                            "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                            "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                            "organizations_url": "https://api.github.com/users/transloadit/orgs",
                            "repos_url": "https://api.github.com/users/transloadit/repos",
                            "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/transloadit/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/transloadit/uppy",
                        "description": "The next open source file uploader for web browsers :dog: ",
                        "fork": false,
                        "url": "https://api.github.com/repos/transloadit/uppy",
                        "forks_url": "https://api.github.com/repos/transloadit/uppy/forks",
                        "keys_url": "https://api.github.com/repos/transloadit/uppy/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/transloadit/uppy/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/transloadit/uppy/teams",
                        "hooks_url": "https://api.github.com/repos/transloadit/uppy/hooks",
                        "issue_events_url": "https://api.github.com/repos/transloadit/uppy/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/transloadit/uppy/events",
                        "assignees_url": "https://api.github.com/repos/transloadit/uppy/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/transloadit/uppy/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/transloadit/uppy/tags",
                        "blobs_url": "https://api.github.com/repos/transloadit/uppy/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/transloadit/uppy/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/transloadit/uppy/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/transloadit/uppy/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/transloadit/uppy/languages",
                        "stargazers_url": "https://api.github.com/repos/transloadit/uppy/stargazers",
                        "contributors_url": "https://api.github.com/repos/transloadit/uppy/contributors",
                        "subscribers_url": "https://api.github.com/repos/transloadit/uppy/subscribers",
                        "subscription_url": "https://api.github.com/repos/transloadit/uppy/subscription",
                        "commits_url": "https://api.github.com/repos/transloadit/uppy/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/transloadit/uppy/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/transloadit/uppy/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/transloadit/uppy/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/transloadit/uppy/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/transloadit/uppy/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/transloadit/uppy/merges",
                        "archive_url": "https://api.github.com/repos/transloadit/uppy/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/transloadit/uppy/downloads",
                        "issues_url": "https://api.github.com/repos/transloadit/uppy/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/transloadit/uppy/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/transloadit/uppy/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/transloadit/uppy/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/transloadit/uppy/labels{/name}",
                        "releases_url": "https://api.github.com/repos/transloadit/uppy/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/transloadit/uppy/deployments",
                        "created_at": "2015-11-16T12:32:33Z",
                        "updated_at": "2023-10-26T10:03:44Z",
                        "pushed_at": "2023-10-25T15:17:29Z",
                        "git_url": "git://github.com/transloadit/uppy.git",
                        "ssh_url": "git@github.com:transloadit/uppy.git",
                        "clone_url": "https://github.com/transloadit/uppy.git",
                        "svn_url": "https://github.com/transloadit/uppy",
                        "homepage": "https://uppy.io",
                        "size": 389980,
                        "stargazers_count": 27488,
                        "watchers_count": 27488,
                        "language": "JavaScript",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": true,
                        "has_discussions": false,
                        "forks_count": 1934,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 168,
                        "license": {
                            "key": "mit",
                            "name": "MIT License",
                            "spdx_id": "MIT",
                            "url": "https://api.github.com/licenses/mit",
                            "node_id": "MDc6TGljZW5zZTEz"
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "dropbox",
                            "encoding",
                            "file-uploader",
                            "file-uploads",
                            "files",
                            "hacktoberfest",
                            "instagram",
                            "javascript",
                            "mit",
                            "modular",
                            "open-source",
                            "pick-files",
                            "resumable",
                            "transloadit",
                            "tus",
                            "uploader",
                            "uppy",
                            "webbrowser"
                        ],
                        "visibility": "public",
                        "forks": 1934,
                        "open_issues": 168,
                        "watchers": 27488,
                        "default_branch": "main"
                    }
                },
                "base": {
                    "label": "transloadit:main",
                    "ref": "main",
                    "sha": "8b252086f5e2769e0a2e95c22ac48b63b9ecfbd1",
                    "user": {
                        "login": "transloadit",
                        "id": 125754,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/transloadit",
                        "html_url": "https://github.com/transloadit",
                        "followers_url": "https://api.github.com/users/transloadit/followers",
                        "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                        "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                        "organizations_url": "https://api.github.com/users/transloadit/orgs",
                        "repos_url": "https://api.github.com/users/transloadit/repos",
                        "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/transloadit/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 46273445,
                        "node_id": "MDEwOlJlcG9zaXRvcnk0NjI3MzQ0NQ==",
                        "name": "uppy",
                        "full_name": "transloadit/uppy",
                        "private": false,
                        "owner": {
                            "login": "transloadit",
                            "id": 125754,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/transloadit",
                            "html_url": "https://github.com/transloadit",
                            "followers_url": "https://api.github.com/users/transloadit/followers",
                            "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                            "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                            "organizations_url": "https://api.github.com/users/transloadit/orgs",
                            "repos_url": "https://api.github.com/users/transloadit/repos",
                            "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/transloadit/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/transloadit/uppy",
                        "description": "The next open source file uploader for web browsers :dog: ",
                        "fork": false,
                        "url": "https://api.github.com/repos/transloadit/uppy",
                        "forks_url": "https://api.github.com/repos/transloadit/uppy/forks",
                        "keys_url": "https://api.github.com/repos/transloadit/uppy/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/transloadit/uppy/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/transloadit/uppy/teams",
                        "hooks_url": "https://api.github.com/repos/transloadit/uppy/hooks",
                        "issue_events_url": "https://api.github.com/repos/transloadit/uppy/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/transloadit/uppy/events",
                        "assignees_url": "https://api.github.com/repos/transloadit/uppy/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/transloadit/uppy/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/transloadit/uppy/tags",
                        "blobs_url": "https://api.github.com/repos/transloadit/uppy/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/transloadit/uppy/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/transloadit/uppy/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/transloadit/uppy/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/transloadit/uppy/languages",
                        "stargazers_url": "https://api.github.com/repos/transloadit/uppy/stargazers",
                        "contributors_url": "https://api.github.com/repos/transloadit/uppy/contributors",
                        "subscribers_url": "https://api.github.com/repos/transloadit/uppy/subscribers",
                        "subscription_url": "https://api.github.com/repos/transloadit/uppy/subscription",
                        "commits_url": "https://api.github.com/repos/transloadit/uppy/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/transloadit/uppy/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/transloadit/uppy/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/transloadit/uppy/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/transloadit/uppy/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/transloadit/uppy/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/transloadit/uppy/merges",
                        "archive_url": "https://api.github.com/repos/transloadit/uppy/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/transloadit/uppy/downloads",
                        "issues_url": "https://api.github.com/repos/transloadit/uppy/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/transloadit/uppy/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/transloadit/uppy/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/transloadit/uppy/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/transloadit/uppy/labels{/name}",
                        "releases_url": "https://api.github.com/repos/transloadit/uppy/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/transloadit/uppy/deployments",
                        "created_at": "2015-11-16T12:32:33Z",
                        "updated_at": "2023-10-26T10:03:44Z",
                        "pushed_at": "2023-10-25T15:17:29Z",
                        "git_url": "git://github.com/transloadit/uppy.git",
                        "ssh_url": "git@github.com:transloadit/uppy.git",
                        "clone_url": "https://github.com/transloadit/uppy.git",
                        "svn_url": "https://github.com/transloadit/uppy",
                        "homepage": "https://uppy.io",
                        "size": 389980,
                        "stargazers_count": 27488,
                        "watchers_count": 27488,
                        "language": "JavaScript",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": true,
                        "has_discussions": false,
                        "forks_count": 1934,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 168,
                        "license": {
                            "key": "mit",
                            "name": "MIT License",
                            "spdx_id": "MIT",
                            "url": "https://api.github.com/licenses/mit",
                            "node_id": "MDc6TGljZW5zZTEz"
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "dropbox",
                            "encoding",
                            "file-uploader",
                            "file-uploads",
                            "files",
                            "hacktoberfest",
                            "instagram",
                            "javascript",
                            "mit",
                            "modular",
                            "open-source",
                            "pick-files",
                            "resumable",
                            "transloadit",
                            "tus",
                            "uploader",
                            "uppy",
                            "webbrowser"
                        ],
                        "visibility": "public",
                        "forks": 1934,
                        "open_issues": 168,
                        "watchers": 27488,
                        "default_branch": "main"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734"
                    },
                    "html": {
                        "href": "https://github.com/transloadit/uppy/pull/4734"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/transloadit/uppy/issues/4734"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/transloadit/uppy/issues/4734/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/transloadit/uppy/statuses/a0501a940e732891215297aecf2613c847fbdc24"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T11:37:00Z",
        "org": {
            "id": 125754,
            "login": "transloadit",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/transloadit",
            "avatar_url": "https://avatars.githubusercontent.com/u/125754?"
        }
    },
    {
        "id": "32866199145",
        "type": "PullRequestReviewEvent",
        "actor": {
            "id": 9060226,
            "login": "Murderlon",
            "display_login": "Murderlon",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Murderlon",
            "avatar_url": "https://avatars.githubusercontent.com/u/9060226?"
        },
        "repo": {
            "id": 46273445,
            "name": "transloadit/uppy",
            "url": "https://api.github.com/repos/transloadit/uppy"
        },
        "payload": {
            "action": "created",
            "review": {
                "id": 1699375344,
                "node_id": "PRR_kwDOAsITpc5lSmjw",
                "user": {
                    "login": "Murderlon",
                    "id": 9060226,
                    "node_id": "MDQ6VXNlcjkwNjAyMjY=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/9060226?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/Murderlon",
                    "html_url": "https://github.com/Murderlon",
                    "followers_url": "https://api.github.com/users/Murderlon/followers",
                    "following_url": "https://api.github.com/users/Murderlon/following{/other_user}",
                    "gists_url": "https://api.github.com/users/Murderlon/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/Murderlon/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/Murderlon/subscriptions",
                    "organizations_url": "https://api.github.com/users/Murderlon/orgs",
                    "repos_url": "https://api.github.com/users/Murderlon/repos",
                    "events_url": "https://api.github.com/users/Murderlon/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/Murderlon/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": null,
                "commit_id": "a0501a940e732891215297aecf2613c847fbdc24",
                "submitted_at": "2023-10-26T11:37:00Z",
                "state": "commented",
                "html_url": "https://github.com/transloadit/uppy/pull/4734#pullrequestreview-1699375344",
                "pull_request_url": "https://api.github.com/repos/transloadit/uppy/pulls/4734",
                "author_association": "MEMBER",
                "_links": {
                    "html": {
                        "href": "https://github.com/transloadit/uppy/pull/4734#pullrequestreview-1699375344"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734"
                    }
                }
            },
            "pull_request": {
                "url": "https://api.github.com/repos/transloadit/uppy/pulls/4734",
                "id": 1556257466,
                "node_id": "PR_kwDOAsITpc5cwpq6",
                "html_url": "https://github.com/transloadit/uppy/pull/4734",
                "diff_url": "https://github.com/transloadit/uppy/pull/4734.diff",
                "patch_url": "https://github.com/transloadit/uppy/pull/4734.patch",
                "issue_url": "https://api.github.com/repos/transloadit/uppy/issues/4734",
                "number": 4734,
                "state": "open",
                "locked": false,
                "title": "Companion+client stability fixes, error handling and retry",
                "user": {
                    "login": "mifi",
                    "id": 402547,
                    "node_id": "MDQ6VXNlcjQwMjU0Nw==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/402547?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/mifi",
                    "html_url": "https://github.com/mifi",
                    "followers_url": "https://api.github.com/users/mifi/followers",
                    "following_url": "https://api.github.com/users/mifi/following{/other_user}",
                    "gists_url": "https://api.github.com/users/mifi/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/mifi/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/mifi/subscriptions",
                    "organizations_url": "https://api.github.com/users/mifi/orgs",
                    "repos_url": "https://api.github.com/users/mifi/repos",
                    "events_url": "https://api.github.com/users/mifi/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/mifi/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "- [respond with 500 if unhandled upload error](https://github.com/transloadit/uppy/commit/4f52551fe8af63032f6ac2d909ef60d1d89c90bd) \r\n 400 seems inappropriate\r\n- [fix companion download error](https://github.com/transloadit/uppy/commit/7bd5042adbad44f26b083ba01f7a64c782b19a73) \r\n  - respond with correct response code when calling /get and request to the upstream server fails\r\n  - also add a unit test for this\r\n- [forward 429 from provider](https://github.com/transloadit/uppy/commit/3fa992b23b7de675cad046daa41f064bb8cdf02c) \r\n  allows us to retry it\r\n- [add a way to test refresh tokens](https://github.com/transloadit/uppy/commit/aad9ae9d3e875cba6410618721470138448ff4cc)\r\n- [fix race condtiion with refreshing token](https://github.com/transloadit/uppy/commit/863b60e83a53c7c2e458bb0b8a39670ba94415e7) that would cause many `refresh-token` calls to be made concurrently, possibly causing problems\r\n- [implement retry and fix socket](https://github.com/transloadit/uppy/commit/7124ef484b6eda82df9c126efe6973c2427e92b8) \r\n  - Make sure we don't instantiate a new Provider for every file uploaded (reuse the original provider instead) - this caused the refresh token synchronization not to work\r\n  - Retry most errors when uploading (`/get`) using companion, but for HTTP, only retry certain HTTP status codes\r\n  - Reimplement the websocket code to be more stable and retry as well\r\n  - if no websocket messages have been received in 5 minutes, fail the upload, so the upload doesn't get stuck forever in case something goes bad, TODO should this should be solved in the UI instead?\r\n- [remove useFastRemoteRetry](https://github.com/transloadit/uppy/commit/8612d5d5ace5e7ec32db73e3632ec964657aff06) \r\n  - because it isn't supported in Companion as far as I can tell, and the option effectively doesn't do anything at all",
                "created_at": "2023-10-13T17:28:55Z",
                "updated_at": "2023-10-26T11:37:00Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "7c1c899a01eb66e45e7af9fd8b7f0bbd6748faa8",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/transloadit/uppy/pulls/4734/commits",
                "review_comments_url": "https://api.github.com/repos/transloadit/uppy/pulls/4734/comments",
                "review_comment_url": "https://api.github.com/repos/transloadit/uppy/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/transloadit/uppy/issues/4734/comments",
                "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/a0501a940e732891215297aecf2613c847fbdc24",
                "head": {
                    "label": "transloadit:companion-fixes",
                    "ref": "companion-fixes",
                    "sha": "a0501a940e732891215297aecf2613c847fbdc24",
                    "user": {
                        "login": "transloadit",
                        "id": 125754,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/transloadit",
                        "html_url": "https://github.com/transloadit",
                        "followers_url": "https://api.github.com/users/transloadit/followers",
                        "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                        "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                        "organizations_url": "https://api.github.com/users/transloadit/orgs",
                        "repos_url": "https://api.github.com/users/transloadit/repos",
                        "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/transloadit/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 46273445,
                        "node_id": "MDEwOlJlcG9zaXRvcnk0NjI3MzQ0NQ==",
                        "name": "uppy",
                        "full_name": "transloadit/uppy",
                        "private": false,
                        "owner": {
                            "login": "transloadit",
                            "id": 125754,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/transloadit",
                            "html_url": "https://github.com/transloadit",
                            "followers_url": "https://api.github.com/users/transloadit/followers",
                            "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                            "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                            "organizations_url": "https://api.github.com/users/transloadit/orgs",
                            "repos_url": "https://api.github.com/users/transloadit/repos",
                            "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/transloadit/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/transloadit/uppy",
                        "description": "The next open source file uploader for web browsers :dog: ",
                        "fork": false,
                        "url": "https://api.github.com/repos/transloadit/uppy",
                        "forks_url": "https://api.github.com/repos/transloadit/uppy/forks",
                        "keys_url": "https://api.github.com/repos/transloadit/uppy/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/transloadit/uppy/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/transloadit/uppy/teams",
                        "hooks_url": "https://api.github.com/repos/transloadit/uppy/hooks",
                        "issue_events_url": "https://api.github.com/repos/transloadit/uppy/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/transloadit/uppy/events",
                        "assignees_url": "https://api.github.com/repos/transloadit/uppy/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/transloadit/uppy/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/transloadit/uppy/tags",
                        "blobs_url": "https://api.github.com/repos/transloadit/uppy/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/transloadit/uppy/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/transloadit/uppy/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/transloadit/uppy/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/transloadit/uppy/languages",
                        "stargazers_url": "https://api.github.com/repos/transloadit/uppy/stargazers",
                        "contributors_url": "https://api.github.com/repos/transloadit/uppy/contributors",
                        "subscribers_url": "https://api.github.com/repos/transloadit/uppy/subscribers",
                        "subscription_url": "https://api.github.com/repos/transloadit/uppy/subscription",
                        "commits_url": "https://api.github.com/repos/transloadit/uppy/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/transloadit/uppy/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/transloadit/uppy/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/transloadit/uppy/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/transloadit/uppy/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/transloadit/uppy/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/transloadit/uppy/merges",
                        "archive_url": "https://api.github.com/repos/transloadit/uppy/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/transloadit/uppy/downloads",
                        "issues_url": "https://api.github.com/repos/transloadit/uppy/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/transloadit/uppy/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/transloadit/uppy/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/transloadit/uppy/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/transloadit/uppy/labels{/name}",
                        "releases_url": "https://api.github.com/repos/transloadit/uppy/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/transloadit/uppy/deployments",
                        "created_at": "2015-11-16T12:32:33Z",
                        "updated_at": "2023-10-26T10:03:44Z",
                        "pushed_at": "2023-10-25T15:17:29Z",
                        "git_url": "git://github.com/transloadit/uppy.git",
                        "ssh_url": "git@github.com:transloadit/uppy.git",
                        "clone_url": "https://github.com/transloadit/uppy.git",
                        "svn_url": "https://github.com/transloadit/uppy",
                        "homepage": "https://uppy.io",
                        "size": 389980,
                        "stargazers_count": 27488,
                        "watchers_count": 27488,
                        "language": "JavaScript",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": true,
                        "has_discussions": false,
                        "forks_count": 1934,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 168,
                        "license": {
                            "key": "mit",
                            "name": "MIT License",
                            "spdx_id": "MIT",
                            "url": "https://api.github.com/licenses/mit",
                            "node_id": "MDc6TGljZW5zZTEz"
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "dropbox",
                            "encoding",
                            "file-uploader",
                            "file-uploads",
                            "files",
                            "hacktoberfest",
                            "instagram",
                            "javascript",
                            "mit",
                            "modular",
                            "open-source",
                            "pick-files",
                            "resumable",
                            "transloadit",
                            "tus",
                            "uploader",
                            "uppy",
                            "webbrowser"
                        ],
                        "visibility": "public",
                        "forks": 1934,
                        "open_issues": 168,
                        "watchers": 27488,
                        "default_branch": "main"
                    }
                },
                "base": {
                    "label": "transloadit:main",
                    "ref": "main",
                    "sha": "8b252086f5e2769e0a2e95c22ac48b63b9ecfbd1",
                    "user": {
                        "login": "transloadit",
                        "id": 125754,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/transloadit",
                        "html_url": "https://github.com/transloadit",
                        "followers_url": "https://api.github.com/users/transloadit/followers",
                        "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                        "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                        "organizations_url": "https://api.github.com/users/transloadit/orgs",
                        "repos_url": "https://api.github.com/users/transloadit/repos",
                        "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/transloadit/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 46273445,
                        "node_id": "MDEwOlJlcG9zaXRvcnk0NjI3MzQ0NQ==",
                        "name": "uppy",
                        "full_name": "transloadit/uppy",
                        "private": false,
                        "owner": {
                            "login": "transloadit",
                            "id": 125754,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/transloadit",
                            "html_url": "https://github.com/transloadit",
                            "followers_url": "https://api.github.com/users/transloadit/followers",
                            "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                            "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                            "organizations_url": "https://api.github.com/users/transloadit/orgs",
                            "repos_url": "https://api.github.com/users/transloadit/repos",
                            "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/transloadit/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/transloadit/uppy",
                        "description": "The next open source file uploader for web browsers :dog: ",
                        "fork": false,
                        "url": "https://api.github.com/repos/transloadit/uppy",
                        "forks_url": "https://api.github.com/repos/transloadit/uppy/forks",
                        "keys_url": "https://api.github.com/repos/transloadit/uppy/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/transloadit/uppy/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/transloadit/uppy/teams",
                        "hooks_url": "https://api.github.com/repos/transloadit/uppy/hooks",
                        "issue_events_url": "https://api.github.com/repos/transloadit/uppy/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/transloadit/uppy/events",
                        "assignees_url": "https://api.github.com/repos/transloadit/uppy/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/transloadit/uppy/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/transloadit/uppy/tags",
                        "blobs_url": "https://api.github.com/repos/transloadit/uppy/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/transloadit/uppy/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/transloadit/uppy/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/transloadit/uppy/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/transloadit/uppy/languages",
                        "stargazers_url": "https://api.github.com/repos/transloadit/uppy/stargazers",
                        "contributors_url": "https://api.github.com/repos/transloadit/uppy/contributors",
                        "subscribers_url": "https://api.github.com/repos/transloadit/uppy/subscribers",
                        "subscription_url": "https://api.github.com/repos/transloadit/uppy/subscription",
                        "commits_url": "https://api.github.com/repos/transloadit/uppy/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/transloadit/uppy/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/transloadit/uppy/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/transloadit/uppy/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/transloadit/uppy/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/transloadit/uppy/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/transloadit/uppy/merges",
                        "archive_url": "https://api.github.com/repos/transloadit/uppy/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/transloadit/uppy/downloads",
                        "issues_url": "https://api.github.com/repos/transloadit/uppy/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/transloadit/uppy/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/transloadit/uppy/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/transloadit/uppy/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/transloadit/uppy/labels{/name}",
                        "releases_url": "https://api.github.com/repos/transloadit/uppy/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/transloadit/uppy/deployments",
                        "created_at": "2015-11-16T12:32:33Z",
                        "updated_at": "2023-10-26T10:03:44Z",
                        "pushed_at": "2023-10-25T15:17:29Z",
                        "git_url": "git://github.com/transloadit/uppy.git",
                        "ssh_url": "git@github.com:transloadit/uppy.git",
                        "clone_url": "https://github.com/transloadit/uppy.git",
                        "svn_url": "https://github.com/transloadit/uppy",
                        "homepage": "https://uppy.io",
                        "size": 389980,
                        "stargazers_count": 27488,
                        "watchers_count": 27488,
                        "language": "JavaScript",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": true,
                        "has_discussions": false,
                        "forks_count": 1934,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 168,
                        "license": {
                            "key": "mit",
                            "name": "MIT License",
                            "spdx_id": "MIT",
                            "url": "https://api.github.com/licenses/mit",
                            "node_id": "MDc6TGljZW5zZTEz"
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "dropbox",
                            "encoding",
                            "file-uploader",
                            "file-uploads",
                            "files",
                            "hacktoberfest",
                            "instagram",
                            "javascript",
                            "mit",
                            "modular",
                            "open-source",
                            "pick-files",
                            "resumable",
                            "transloadit",
                            "tus",
                            "uploader",
                            "uppy",
                            "webbrowser"
                        ],
                        "visibility": "public",
                        "forks": 1934,
                        "open_issues": 168,
                        "watchers": 27488,
                        "default_branch": "main"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734"
                    },
                    "html": {
                        "href": "https://github.com/transloadit/uppy/pull/4734"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/transloadit/uppy/issues/4734"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/transloadit/uppy/issues/4734/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/transloadit/uppy/statuses/a0501a940e732891215297aecf2613c847fbdc24"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T11:37:01Z",
        "org": {
            "id": 125754,
            "login": "transloadit",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/transloadit",
            "avatar_url": "https://avatars.githubusercontent.com/u/125754?"
        }
    },
    {
        "id": "32866081703",
        "type": "PullRequestReviewCommentEvent",
        "actor": {
            "id": 402547,
            "login": "mifi",
            "display_login": "mifi",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mifi",
            "avatar_url": "https://avatars.githubusercontent.com/u/402547?"
        },
        "repo": {
            "id": 46273445,
            "name": "transloadit/uppy",
            "url": "https://api.github.com/repos/transloadit/uppy"
        },
        "payload": {
            "action": "created",
            "comment": {
                "url": "https://api.github.com/repos/transloadit/uppy/pulls/comments/1373010799",
                "pull_request_review_id": 1699365102,
                "id": 1373010799,
                "node_id": "PRRC_kwDOAsITpc5R1ntv",
                "diff_hunk": "@@ -222,179 +240,273 @@ export default class RequestClient {\n     return this.request({ ...options, path, method: 'DELETE', data })\n   }\n \n+  /**\n+   * Remote uploading consists of two steps:\n+   * 1. #requestSocketToken which starts the download/upload in companion and returns a unique token for the upload.\n+   * Then companion will halt the upload until:\n+   * 2. #awaitRemoteFileUpload is called, which will open/ensure a websocket connection towards companion, with the\n+   * previously generated token provided. It returns a promise that will resolve/reject once the file has finished\n+   * uploading or is otherwise done (failed, canceled)\n+   * \n+   * @param {*} file \n+   * @param {*} reqBody \n+   * @param {*} options \n+   * @returns \n+   */\n   async uploadRemoteFile (file, reqBody, options = {}) {\n     try {\n-      if (file.serverToken) {\n-        return await this.connectToServerSocket(file, this.getQueue())\n-      }\n-      const queueRequestSocketToken = this.getQueue().wrapPromiseFunction(\n-        this.#requestSocketToken,\n-        { priority: -1 },\n-      )\n-      const serverToken = await queueRequestSocketToken(file, reqBody).abortOn(\n-        options.signal,\n-      )\n-\n-      if (!this.uppy.getState().files[file.id]) return undefined\n-\n-      this.uppy.setFileState(file.id, { serverToken })\n-      return await this.connectToServerSocket(\n-        this.uppy.getFile(file.id),\n-        this.getQueue(),\n-      )\n+      const { signal, getQueue } = options\n+\n+      return await pRetry(async () => {\n+        // if we already have a serverToken, assume that we are resuming the existing server upload id\n+        const existingServerToken = this.uppy.getFile(file.id)?.serverToken;\n+        if (existingServerToken != null) {\n+          this.uppy.log(`Connecting to exiting websocket ${existingServerToken}`)\n+          return this.#awaitRemoteFileUpload({ file, queue: getQueue(), signal })\n+        }\n+\n+        const queueRequestSocketToken = getQueue().wrapPromiseFunction(async (...args) => {\n+          try {\n+            return await this.#requestSocketToken(...args)\n+          } catch (outerErr) {\n+            // throwing AbortError will cause p-retry to stop retrying\n+            if (outerErr instanceof AuthError) throw new AbortError(outerErr)\n+\n+            if (outerErr.cause == null) throw outerErr\n+            const err = outerErr.cause\n+\n+            const isRetryableHttpError = () => (\n+              [408, 409, 429, 418, 423].includes(err.statusCode)\n+              || (err.statusCode >= 500 && err.statusCode <= 599 && ![501, 505].includes(err.statusCode))\n+            )\n+            if (err instanceof HttpError && !isRetryableHttpError()) throw new AbortError(err);\n+  \n+            // p-retry will retry most other errors,\n+            // but it will not retry TypeError (except network error TypeErrors)\n+            throw err\n+          }\n+        }, { priority: -1 })\n+\n+        const serverToken = await queueRequestSocketToken(file, reqBody).abortOn(signal)\n+\n+        if (!this.uppy.getFile(file.id)) return undefined // has file since been removed?\n+\n+        this.uppy.setFileState(file.id, { serverToken })\n+\n+        return this.#awaitRemoteFileUpload({\n+          file: this.uppy.getFile(file.id), // re-fetching file because it might have changed in the meantime\n+          queue: getQueue(),\n+          signal\n+        })\n+      }, { retries: retryCount, signal, onFailedAttempt: (err) => this.uppy.log(`Retrying upload due to: ${err.message}`, 'warning') });\n     } catch (err) {\n+      // this is a bit confusing, but an error with name 'AbortError' (from `signal`) is not the same as `p-retry` AbortError\n       if (err?.cause?.name === 'AbortError') {\n         // The file upload was aborted, it\u2019s not an error\n         return undefined\n       }\n \n-      this.uppy.setFileState(file.id, { serverToken: undefined })\n       this.uppy.emit('upload-error', file, err)\n       throw err\n     }\n   }\n \n-  #requestSocketToken = async (file, postBody) => {\n+  #requestSocketToken = async (file, postBody, signal) => {\n     if (file.remote.url == null) {\n       throw new Error('Cannot connect to an undefined URL')\n     }\n \n     const res = await this.post(file.remote.url, {\n       ...file.remote.body,\n       ...postBody,\n-    })\n+    }, signal)\n \n     return res.token\n   }\n \n   /**\n-   * @param {UppyFile} file\n+   * This method will ensure a websocket for the specified file and returns a promise that resolves\n+   * when the file has finished downloading, or rejects if it fails.\n+   * It will retry if the websocket gets disconnected\n+   * \n+   * @param {{ file: UppyFile, queue: RateLimitedQueue, signal: AbortSignal }} file\n    */\n-  async connectToServerSocket (file, queue) {\n-    return new Promise((resolve, reject) => {\n-      const token = file.serverToken\n-      const host = getSocketHost(file.remote.companionUrl)\n-      const socket = new Socket({\n-        target: `${host}/api/${token}`,\n-        autoOpen: false,\n-      })\n-      const eventManager = new EventManager(this.uppy)\n+  async #awaitRemoteFileUpload ({ file, queue, signal }) {\n+    const eventManager = new EventManager(this.uppy)\n \n-      let queuedRequest\n-\n-      eventManager.onFileRemove(file.id, () => {\n-        socket.send('cancel', {})\n-        queuedRequest.abort()\n-        resolve(`upload ${file.id} was removed`)\n-      })\n-\n-      eventManager.onPause(file.id, (isPaused) => {\n-        if (isPaused) {\n-          // Remove this file from the queue so another file can start in its place.\n-          socket.send('pause', {})\n-          queuedRequest.abort()\n-        } else {\n-          // Resuming an upload should be queued, else you could pause and then\n-          // resume a queued upload to make it skip the queue.\n-          queuedRequest.abort()\n-          queuedRequest = queue.run(() => {\n-            socket.open()\n-            socket.send('resume', {})\n-\n-            return () => {}\n-          })\n-        }\n-      })\n-\n-      eventManager.onPauseAll(file.id, () => {\n-        socket.send('pause', {})\n-        queuedRequest.abort()\n-      })\n-\n-      eventManager.onCancelAll(file.id, ({ reason } = {}) => {\n-        if (reason === 'user') {\n-          socket.send('cancel', {})\n-          queuedRequest.abort()\n+    try {\n+      return await new Promise((resolve, reject) => {\n+        const token = file.serverToken\n+        const host = getSocketHost(file.remote.companionUrl)\n+\n+        /** @type {WebSocket} */\n+        let socket\n+        /** @type {AbortController?} */\n+        let socketAbortController\n+        let activityTimeout\n+\n+        let { isPaused } = file\n+\n+        const socketSend = (action, payload) => {\n+          if (socket == null || socket.readyState !== socket.OPEN) {\n+            this.uppy.log(`Cannot send \"${action}\" to socket ${file.id} because the socket state was ${String(socket?.readyState)}`, 'warning')\n+            return\n+          }\n+\n+          socket.send(JSON.stringify({\n+            action,\n+            payload: payload ?? {},\n+          }))    \n+        };\n+\n+        function sendState() {\n+          if (isPaused) socketSend('pause')\n+          else socketSend('resume')\n         }\n-        resolve(`upload ${file.id} was canceled`)\n-      })\n \n-      eventManager.onResumeAll(file.id, () => {\n-        queuedRequest.abort()\n-        if (file.error) {\n-          socket.send('pause', {})\n+        const createWebsocket = async () => {\n+          if (socketAbortController) socketAbortController.abort()\n+          socketAbortController = new AbortController()\n+\n+          const onFatalError = (err) => {\n+            // Remove the serverToken so that a new one will be created for the retry.\n+            this.uppy.setFileState(file.id, { serverToken: null })\n+            socketAbortController?.abort?.()\n+            reject(err)\n+          }\n+  \n+          // todo instead implement the ability for users to cancel / retry *currently uploading files* in the UI\n+          function resetActivityTimeout() {\n+            clearTimeout(activityTimeout)\n+            if (isPaused) return\n+            activityTimeout = setTimeout(() => onFatalError(new Error('Timeout waiting for message from Companion socket')), socketActivityTimeoutMs)\n+          }\n+\n+          try {\n+            await queue.wrapPromiseFunction(async () => {\n+              // eslint-disable-next-line promise/param-names\n+              const reconnectWebsocket = async () => new Promise((resolveSocket, rejectSocket) => {\n+                socket = new WebSocket(`${host}/api/${token}`)\n+\n+                resetActivityTimeout()\n+\n+                socket.addEventListener('close', () => {\n+                  socket = undefined\n+                  rejectSocket(new Error('Socket closed unexpectedly'))\n+                })\n+\n+                socket.addEventListener('error', (error) => {\n+                  this.uppy.log(`Companion socket error ${JSON.stringify(error)}, closing socket`, 'warning')\n+                  socket.close() // will 'close' event to be emitted\n+                })\n+\n+                socket.addEventListener('open', () => {\n+                  sendState()\n+                })\n+\n+                socket.addEventListener('message', (e) => {\n+                  resetActivityTimeout()\n+\n+                  try {\n+                    const { action, payload } = JSON.parse(e.data)\n+            \n+                    switch (action) {\n+                      case 'progress': {\n+                        emitSocketProgress(this, payload, file)\n+                        break;\n+                      }\n+                      case 'success': {\n+                        this.uppy.emit('upload-success', file, { uploadURL: payload.url })\n+                        socketAbortController?.abort?.()\n+                        resolve()\n+                        break;\n+                      }\n+                      case 'error': {\n+                        const { message } = payload.error\n+                        throw Object.assign(new Error(message), { cause: payload.error })\n+                      }\n+                        default:\n+                          this.uppy.log(`Companion socket unknown action ${action}`, 'warning')\n+                    }\n+                  } catch (err) {\n+                    onFatalError(err)\n+                  }\n+                })\n+\n+                const closeSocket = () => {\n+                  this.uppy.log(`Closing socket ${file.id}`, 'info')\n+                  clearTimeout(activityTimeout)\n+                  if (socket) socket.close()\n+                  socket = undefined\n+                }\n+        \n+                socketAbortController.signal.addEventListener('abort', () => {\n+                  closeSocket()\n+                })\n+              })\n+\n+              await pRetry(reconnectWebsocket, {\n+                retries: retryCount,\n+                signal: socketAbortController.signal,\n+                onFailedAttempt: () => this.uppy.log(`Retrying websocket ${file.id}`, 'info'),\n+              });\n+            })().abortOn(socketAbortController.signal);\n+          } catch (err) {\n+            if (socketAbortController.signal.aborted) return\n+            onFatalError(err)\n+          }\n         }\n-        queuedRequest = queue.run(() => {\n-          socket.open()\n-          socket.send('resume', {})\n \n-          return () => {}\n-        })\n-      })\n-\n-      eventManager.onRetry(file.id, () => {\n-        // Only do the retry if the upload is actually in progress;\n-        // else we could try to send these messages when the upload is still queued.\n-        // We may need a better check for this since the socket may also be closed\n-        // for other reasons, like network failures.\n-        if (socket.isOpen) {\n-          socket.send('pause', {})\n-          socket.send('resume', {})\n+        const pause = (newPausedState) => {\n+          isPaused = newPausedState\n+          if (socket) sendState()\n+\n+          if (newPausedState) {\n+            // Remove this file from the queue so another file can start in its place.\n+            socketAbortController?.abort?.() // close socket to free up the request for other uploads\n+          } else {\n+            // Resuming an upload should be queued, else you could pause and then\n+            // resume a queued upload to make it skip the queue.\n+            createWebsocket()\n+          }\n         }\n-      })\n \n-      eventManager.onRetryAll(file.id, () => {\n-        // See the comment in the onRetry() call\n-        if (socket.isOpen) {\n-          socket.send('pause', {})\n-          socket.send('resume', {})\n+        const withErrorHandling = (fn, event) => {\n+          try {\n+            fn()\n+          } catch (err) {\n+            this.uppy.log(`Error while handling ${event} event for file ${file.id}: ${err.message}`, 'error')\n+          }\n         }\n-      })\n-\n-      socket.on('progress', (progressData) => emitSocketProgress(this, progressData, file))\n \n-      socket.on('error', (errData) => {\n-        const { message } = errData.error\n-        const error = Object.assign(new Error(message), {\n-          cause: errData.error,\n+        eventManager.onPause(file.id, (newPausedState) => withErrorHandling(() => pause(newPausedState), 'pause'))\n+        eventManager.onPauseAll(file.id, () => withErrorHandling(() => pause(true), 'pause-all'))\n+        eventManager.onResumeAll(file.id, () => withErrorHandling(() => pause(false), 'resume-all'))\n+\n+        eventManager.onFileRemove(file.id, () => withErrorHandling(() => {\n+          socketSend('cancel')\n+          socketAbortController?.abort?.()\n+          this.uppy.log(`upload ${file.id} was removed`, 'info')\n+          resolve()\n+        }, 'file-removed'))\n+\n+        eventManager.onCancelAll(file.id, ({ reason } = {}) => withErrorHandling(() => {\n+          if (reason === 'user') {\n+            socketSend('cancel')\n+          }\n+          socketAbortController?.abort?.()\n+          this.uppy.log(`upload ${file.id} was canceled`, 'info')\n+          resolve()\n+        }, 'cancel-all'))",
                "path": "packages/@uppy/companion-client/src/RequestClient.js",
                "commit_id": "a0501a940e732891215297aecf2613c847fbdc24",
                "original_commit_id": "a0501a940e732891215297aecf2613c847fbdc24",
                "user": {
                    "login": "mifi",
                    "id": 402547,
                    "node_id": "MDQ6VXNlcjQwMjU0Nw==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/402547?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/mifi",
                    "html_url": "https://github.com/mifi",
                    "followers_url": "https://api.github.com/users/mifi/followers",
                    "following_url": "https://api.github.com/users/mifi/following{/other_user}",
                    "gists_url": "https://api.github.com/users/mifi/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/mifi/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/mifi/subscriptions",
                    "organizations_url": "https://api.github.com/users/mifi/orgs",
                    "repos_url": "https://api.github.com/users/mifi/repos",
                    "events_url": "https://api.github.com/users/mifi/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/mifi/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "Sure we could add the capabilities check, but im not sure it belongs in this PR. It\u2019s not apparent to me how your code handles errors thrown in the event handlers, could you explain? For example if socket was null, it would crash the emit call in your code, no?",
                "created_at": "2023-10-26T11:32:23Z",
                "updated_at": "2023-10-26T11:32:23Z",
                "html_url": "https://github.com/transloadit/uppy/pull/4734#discussion_r1373010799",
                "pull_request_url": "https://api.github.com/repos/transloadit/uppy/pulls/4734",
                "author_association": "CONTRIBUTOR",
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/comments/1373010799"
                    },
                    "html": {
                        "href": "https://github.com/transloadit/uppy/pull/4734#discussion_r1373010799"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734"
                    }
                },
                "reactions": {
                    "url": "https://api.github.com/repos/transloadit/uppy/pulls/comments/1373010799/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "start_line": 482,
                "original_start_line": 482,
                "start_side": "RIGHT",
                "line": 500,
                "original_line": 500,
                "side": "RIGHT",
                "in_reply_to_id": 1372909302,
                "original_position": 452,
                "position": 452,
                "subject_type": "line"
            },
            "pull_request": {
                "url": "https://api.github.com/repos/transloadit/uppy/pulls/4734",
                "id": 1556257466,
                "node_id": "PR_kwDOAsITpc5cwpq6",
                "html_url": "https://github.com/transloadit/uppy/pull/4734",
                "diff_url": "https://github.com/transloadit/uppy/pull/4734.diff",
                "patch_url": "https://github.com/transloadit/uppy/pull/4734.patch",
                "issue_url": "https://api.github.com/repos/transloadit/uppy/issues/4734",
                "number": 4734,
                "state": "open",
                "locked": false,
                "title": "Companion+client stability fixes, error handling and retry",
                "user": {
                    "login": "mifi",
                    "id": 402547,
                    "node_id": "MDQ6VXNlcjQwMjU0Nw==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/402547?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/mifi",
                    "html_url": "https://github.com/mifi",
                    "followers_url": "https://api.github.com/users/mifi/followers",
                    "following_url": "https://api.github.com/users/mifi/following{/other_user}",
                    "gists_url": "https://api.github.com/users/mifi/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/mifi/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/mifi/subscriptions",
                    "organizations_url": "https://api.github.com/users/mifi/orgs",
                    "repos_url": "https://api.github.com/users/mifi/repos",
                    "events_url": "https://api.github.com/users/mifi/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/mifi/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "- [respond with 500 if unhandled upload error](https://github.com/transloadit/uppy/commit/4f52551fe8af63032f6ac2d909ef60d1d89c90bd) \r\n 400 seems inappropriate\r\n- [fix companion download error](https://github.com/transloadit/uppy/commit/7bd5042adbad44f26b083ba01f7a64c782b19a73) \r\n  - respond with correct response code when calling /get and request to the upstream server fails\r\n  - also add a unit test for this\r\n- [forward 429 from provider](https://github.com/transloadit/uppy/commit/3fa992b23b7de675cad046daa41f064bb8cdf02c) \r\n  allows us to retry it\r\n- [add a way to test refresh tokens](https://github.com/transloadit/uppy/commit/aad9ae9d3e875cba6410618721470138448ff4cc)\r\n- [fix race condtiion with refreshing token](https://github.com/transloadit/uppy/commit/863b60e83a53c7c2e458bb0b8a39670ba94415e7) that would cause many `refresh-token` calls to be made concurrently, possibly causing problems\r\n- [implement retry and fix socket](https://github.com/transloadit/uppy/commit/7124ef484b6eda82df9c126efe6973c2427e92b8) \r\n  - Make sure we don't instantiate a new Provider for every file uploaded (reuse the original provider instead) - this caused the refresh token synchronization not to work\r\n  - Retry most errors when uploading (`/get`) using companion, but for HTTP, only retry certain HTTP status codes\r\n  - Reimplement the websocket code to be more stable and retry as well\r\n  - if no websocket messages have been received in 5 minutes, fail the upload, so the upload doesn't get stuck forever in case something goes bad, TODO should this should be solved in the UI instead?\r\n- [remove useFastRemoteRetry](https://github.com/transloadit/uppy/commit/8612d5d5ace5e7ec32db73e3632ec964657aff06) \r\n  - because it isn't supported in Companion as far as I can tell, and the option effectively doesn't do anything at all",
                "created_at": "2023-10-13T17:28:55Z",
                "updated_at": "2023-10-26T11:32:23Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "7c1c899a01eb66e45e7af9fd8b7f0bbd6748faa8",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/transloadit/uppy/pulls/4734/commits",
                "review_comments_url": "https://api.github.com/repos/transloadit/uppy/pulls/4734/comments",
                "review_comment_url": "https://api.github.com/repos/transloadit/uppy/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/transloadit/uppy/issues/4734/comments",
                "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/a0501a940e732891215297aecf2613c847fbdc24",
                "head": {
                    "label": "transloadit:companion-fixes",
                    "ref": "companion-fixes",
                    "sha": "a0501a940e732891215297aecf2613c847fbdc24",
                    "user": {
                        "login": "transloadit",
                        "id": 125754,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/transloadit",
                        "html_url": "https://github.com/transloadit",
                        "followers_url": "https://api.github.com/users/transloadit/followers",
                        "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                        "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                        "organizations_url": "https://api.github.com/users/transloadit/orgs",
                        "repos_url": "https://api.github.com/users/transloadit/repos",
                        "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/transloadit/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 46273445,
                        "node_id": "MDEwOlJlcG9zaXRvcnk0NjI3MzQ0NQ==",
                        "name": "uppy",
                        "full_name": "transloadit/uppy",
                        "private": false,
                        "owner": {
                            "login": "transloadit",
                            "id": 125754,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/transloadit",
                            "html_url": "https://github.com/transloadit",
                            "followers_url": "https://api.github.com/users/transloadit/followers",
                            "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                            "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                            "organizations_url": "https://api.github.com/users/transloadit/orgs",
                            "repos_url": "https://api.github.com/users/transloadit/repos",
                            "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/transloadit/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/transloadit/uppy",
                        "description": "The next open source file uploader for web browsers :dog: ",
                        "fork": false,
                        "url": "https://api.github.com/repos/transloadit/uppy",
                        "forks_url": "https://api.github.com/repos/transloadit/uppy/forks",
                        "keys_url": "https://api.github.com/repos/transloadit/uppy/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/transloadit/uppy/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/transloadit/uppy/teams",
                        "hooks_url": "https://api.github.com/repos/transloadit/uppy/hooks",
                        "issue_events_url": "https://api.github.com/repos/transloadit/uppy/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/transloadit/uppy/events",
                        "assignees_url": "https://api.github.com/repos/transloadit/uppy/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/transloadit/uppy/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/transloadit/uppy/tags",
                        "blobs_url": "https://api.github.com/repos/transloadit/uppy/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/transloadit/uppy/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/transloadit/uppy/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/transloadit/uppy/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/transloadit/uppy/languages",
                        "stargazers_url": "https://api.github.com/repos/transloadit/uppy/stargazers",
                        "contributors_url": "https://api.github.com/repos/transloadit/uppy/contributors",
                        "subscribers_url": "https://api.github.com/repos/transloadit/uppy/subscribers",
                        "subscription_url": "https://api.github.com/repos/transloadit/uppy/subscription",
                        "commits_url": "https://api.github.com/repos/transloadit/uppy/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/transloadit/uppy/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/transloadit/uppy/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/transloadit/uppy/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/transloadit/uppy/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/transloadit/uppy/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/transloadit/uppy/merges",
                        "archive_url": "https://api.github.com/repos/transloadit/uppy/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/transloadit/uppy/downloads",
                        "issues_url": "https://api.github.com/repos/transloadit/uppy/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/transloadit/uppy/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/transloadit/uppy/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/transloadit/uppy/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/transloadit/uppy/labels{/name}",
                        "releases_url": "https://api.github.com/repos/transloadit/uppy/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/transloadit/uppy/deployments",
                        "created_at": "2015-11-16T12:32:33Z",
                        "updated_at": "2023-10-26T10:03:44Z",
                        "pushed_at": "2023-10-25T15:17:29Z",
                        "git_url": "git://github.com/transloadit/uppy.git",
                        "ssh_url": "git@github.com:transloadit/uppy.git",
                        "clone_url": "https://github.com/transloadit/uppy.git",
                        "svn_url": "https://github.com/transloadit/uppy",
                        "homepage": "https://uppy.io",
                        "size": 389980,
                        "stargazers_count": 27488,
                        "watchers_count": 27488,
                        "language": "JavaScript",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": true,
                        "has_discussions": false,
                        "forks_count": 1934,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 168,
                        "license": {
                            "key": "mit",
                            "name": "MIT License",
                            "spdx_id": "MIT",
                            "url": "https://api.github.com/licenses/mit",
                            "node_id": "MDc6TGljZW5zZTEz"
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "dropbox",
                            "encoding",
                            "file-uploader",
                            "file-uploads",
                            "files",
                            "hacktoberfest",
                            "instagram",
                            "javascript",
                            "mit",
                            "modular",
                            "open-source",
                            "pick-files",
                            "resumable",
                            "transloadit",
                            "tus",
                            "uploader",
                            "uppy",
                            "webbrowser"
                        ],
                        "visibility": "public",
                        "forks": 1934,
                        "open_issues": 168,
                        "watchers": 27488,
                        "default_branch": "main"
                    }
                },
                "base": {
                    "label": "transloadit:main",
                    "ref": "main",
                    "sha": "8b252086f5e2769e0a2e95c22ac48b63b9ecfbd1",
                    "user": {
                        "login": "transloadit",
                        "id": 125754,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/transloadit",
                        "html_url": "https://github.com/transloadit",
                        "followers_url": "https://api.github.com/users/transloadit/followers",
                        "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                        "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                        "organizations_url": "https://api.github.com/users/transloadit/orgs",
                        "repos_url": "https://api.github.com/users/transloadit/repos",
                        "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/transloadit/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 46273445,
                        "node_id": "MDEwOlJlcG9zaXRvcnk0NjI3MzQ0NQ==",
                        "name": "uppy",
                        "full_name": "transloadit/uppy",
                        "private": false,
                        "owner": {
                            "login": "transloadit",
                            "id": 125754,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/transloadit",
                            "html_url": "https://github.com/transloadit",
                            "followers_url": "https://api.github.com/users/transloadit/followers",
                            "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                            "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                            "organizations_url": "https://api.github.com/users/transloadit/orgs",
                            "repos_url": "https://api.github.com/users/transloadit/repos",
                            "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/transloadit/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/transloadit/uppy",
                        "description": "The next open source file uploader for web browsers :dog: ",
                        "fork": false,
                        "url": "https://api.github.com/repos/transloadit/uppy",
                        "forks_url": "https://api.github.com/repos/transloadit/uppy/forks",
                        "keys_url": "https://api.github.com/repos/transloadit/uppy/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/transloadit/uppy/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/transloadit/uppy/teams",
                        "hooks_url": "https://api.github.com/repos/transloadit/uppy/hooks",
                        "issue_events_url": "https://api.github.com/repos/transloadit/uppy/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/transloadit/uppy/events",
                        "assignees_url": "https://api.github.com/repos/transloadit/uppy/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/transloadit/uppy/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/transloadit/uppy/tags",
                        "blobs_url": "https://api.github.com/repos/transloadit/uppy/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/transloadit/uppy/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/transloadit/uppy/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/transloadit/uppy/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/transloadit/uppy/languages",
                        "stargazers_url": "https://api.github.com/repos/transloadit/uppy/stargazers",
                        "contributors_url": "https://api.github.com/repos/transloadit/uppy/contributors",
                        "subscribers_url": "https://api.github.com/repos/transloadit/uppy/subscribers",
                        "subscription_url": "https://api.github.com/repos/transloadit/uppy/subscription",
                        "commits_url": "https://api.github.com/repos/transloadit/uppy/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/transloadit/uppy/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/transloadit/uppy/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/transloadit/uppy/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/transloadit/uppy/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/transloadit/uppy/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/transloadit/uppy/merges",
                        "archive_url": "https://api.github.com/repos/transloadit/uppy/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/transloadit/uppy/downloads",
                        "issues_url": "https://api.github.com/repos/transloadit/uppy/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/transloadit/uppy/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/transloadit/uppy/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/transloadit/uppy/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/transloadit/uppy/labels{/name}",
                        "releases_url": "https://api.github.com/repos/transloadit/uppy/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/transloadit/uppy/deployments",
                        "created_at": "2015-11-16T12:32:33Z",
                        "updated_at": "2023-10-26T10:03:44Z",
                        "pushed_at": "2023-10-25T15:17:29Z",
                        "git_url": "git://github.com/transloadit/uppy.git",
                        "ssh_url": "git@github.com:transloadit/uppy.git",
                        "clone_url": "https://github.com/transloadit/uppy.git",
                        "svn_url": "https://github.com/transloadit/uppy",
                        "homepage": "https://uppy.io",
                        "size": 389980,
                        "stargazers_count": 27488,
                        "watchers_count": 27488,
                        "language": "JavaScript",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": true,
                        "has_discussions": false,
                        "forks_count": 1934,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 168,
                        "license": {
                            "key": "mit",
                            "name": "MIT License",
                            "spdx_id": "MIT",
                            "url": "https://api.github.com/licenses/mit",
                            "node_id": "MDc6TGljZW5zZTEz"
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "dropbox",
                            "encoding",
                            "file-uploader",
                            "file-uploads",
                            "files",
                            "hacktoberfest",
                            "instagram",
                            "javascript",
                            "mit",
                            "modular",
                            "open-source",
                            "pick-files",
                            "resumable",
                            "transloadit",
                            "tus",
                            "uploader",
                            "uppy",
                            "webbrowser"
                        ],
                        "visibility": "public",
                        "forks": 1934,
                        "open_issues": 168,
                        "watchers": 27488,
                        "default_branch": "main"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734"
                    },
                    "html": {
                        "href": "https://github.com/transloadit/uppy/pull/4734"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/transloadit/uppy/issues/4734"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/transloadit/uppy/issues/4734/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/transloadit/uppy/statuses/a0501a940e732891215297aecf2613c847fbdc24"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T11:32:23Z",
        "org": {
            "id": 125754,
            "login": "transloadit",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/transloadit",
            "avatar_url": "https://avatars.githubusercontent.com/u/125754?"
        }
    },
    {
        "id": "32866081611",
        "type": "PullRequestReviewEvent",
        "actor": {
            "id": 402547,
            "login": "mifi",
            "display_login": "mifi",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mifi",
            "avatar_url": "https://avatars.githubusercontent.com/u/402547?"
        },
        "repo": {
            "id": 46273445,
            "name": "transloadit/uppy",
            "url": "https://api.github.com/repos/transloadit/uppy"
        },
        "payload": {
            "action": "created",
            "review": {
                "id": 1699365102,
                "node_id": "PRR_kwDOAsITpc5lSkDu",
                "user": {
                    "login": "mifi",
                    "id": 402547,
                    "node_id": "MDQ6VXNlcjQwMjU0Nw==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/402547?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/mifi",
                    "html_url": "https://github.com/mifi",
                    "followers_url": "https://api.github.com/users/mifi/followers",
                    "following_url": "https://api.github.com/users/mifi/following{/other_user}",
                    "gists_url": "https://api.github.com/users/mifi/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/mifi/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/mifi/subscriptions",
                    "organizations_url": "https://api.github.com/users/mifi/orgs",
                    "repos_url": "https://api.github.com/users/mifi/repos",
                    "events_url": "https://api.github.com/users/mifi/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/mifi/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": null,
                "commit_id": "a0501a940e732891215297aecf2613c847fbdc24",
                "submitted_at": "2023-10-26T11:32:23Z",
                "state": "commented",
                "html_url": "https://github.com/transloadit/uppy/pull/4734#pullrequestreview-1699365102",
                "pull_request_url": "https://api.github.com/repos/transloadit/uppy/pulls/4734",
                "author_association": "CONTRIBUTOR",
                "_links": {
                    "html": {
                        "href": "https://github.com/transloadit/uppy/pull/4734#pullrequestreview-1699365102"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734"
                    }
                }
            },
            "pull_request": {
                "url": "https://api.github.com/repos/transloadit/uppy/pulls/4734",
                "id": 1556257466,
                "node_id": "PR_kwDOAsITpc5cwpq6",
                "html_url": "https://github.com/transloadit/uppy/pull/4734",
                "diff_url": "https://github.com/transloadit/uppy/pull/4734.diff",
                "patch_url": "https://github.com/transloadit/uppy/pull/4734.patch",
                "issue_url": "https://api.github.com/repos/transloadit/uppy/issues/4734",
                "number": 4734,
                "state": "open",
                "locked": false,
                "title": "Companion+client stability fixes, error handling and retry",
                "user": {
                    "login": "mifi",
                    "id": 402547,
                    "node_id": "MDQ6VXNlcjQwMjU0Nw==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/402547?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/mifi",
                    "html_url": "https://github.com/mifi",
                    "followers_url": "https://api.github.com/users/mifi/followers",
                    "following_url": "https://api.github.com/users/mifi/following{/other_user}",
                    "gists_url": "https://api.github.com/users/mifi/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/mifi/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/mifi/subscriptions",
                    "organizations_url": "https://api.github.com/users/mifi/orgs",
                    "repos_url": "https://api.github.com/users/mifi/repos",
                    "events_url": "https://api.github.com/users/mifi/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/mifi/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "- [respond with 500 if unhandled upload error](https://github.com/transloadit/uppy/commit/4f52551fe8af63032f6ac2d909ef60d1d89c90bd) \r\n 400 seems inappropriate\r\n- [fix companion download error](https://github.com/transloadit/uppy/commit/7bd5042adbad44f26b083ba01f7a64c782b19a73) \r\n  - respond with correct response code when calling /get and request to the upstream server fails\r\n  - also add a unit test for this\r\n- [forward 429 from provider](https://github.com/transloadit/uppy/commit/3fa992b23b7de675cad046daa41f064bb8cdf02c) \r\n  allows us to retry it\r\n- [add a way to test refresh tokens](https://github.com/transloadit/uppy/commit/aad9ae9d3e875cba6410618721470138448ff4cc)\r\n- [fix race condtiion with refreshing token](https://github.com/transloadit/uppy/commit/863b60e83a53c7c2e458bb0b8a39670ba94415e7) that would cause many `refresh-token` calls to be made concurrently, possibly causing problems\r\n- [implement retry and fix socket](https://github.com/transloadit/uppy/commit/7124ef484b6eda82df9c126efe6973c2427e92b8) \r\n  - Make sure we don't instantiate a new Provider for every file uploaded (reuse the original provider instead) - this caused the refresh token synchronization not to work\r\n  - Retry most errors when uploading (`/get`) using companion, but for HTTP, only retry certain HTTP status codes\r\n  - Reimplement the websocket code to be more stable and retry as well\r\n  - if no websocket messages have been received in 5 minutes, fail the upload, so the upload doesn't get stuck forever in case something goes bad, TODO should this should be solved in the UI instead?\r\n- [remove useFastRemoteRetry](https://github.com/transloadit/uppy/commit/8612d5d5ace5e7ec32db73e3632ec964657aff06) \r\n  - because it isn't supported in Companion as far as I can tell, and the option effectively doesn't do anything at all",
                "created_at": "2023-10-13T17:28:55Z",
                "updated_at": "2023-10-26T11:32:23Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "7c1c899a01eb66e45e7af9fd8b7f0bbd6748faa8",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/transloadit/uppy/pulls/4734/commits",
                "review_comments_url": "https://api.github.com/repos/transloadit/uppy/pulls/4734/comments",
                "review_comment_url": "https://api.github.com/repos/transloadit/uppy/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/transloadit/uppy/issues/4734/comments",
                "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/a0501a940e732891215297aecf2613c847fbdc24",
                "head": {
                    "label": "transloadit:companion-fixes",
                    "ref": "companion-fixes",
                    "sha": "a0501a940e732891215297aecf2613c847fbdc24",
                    "user": {
                        "login": "transloadit",
                        "id": 125754,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/transloadit",
                        "html_url": "https://github.com/transloadit",
                        "followers_url": "https://api.github.com/users/transloadit/followers",
                        "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                        "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                        "organizations_url": "https://api.github.com/users/transloadit/orgs",
                        "repos_url": "https://api.github.com/users/transloadit/repos",
                        "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/transloadit/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 46273445,
                        "node_id": "MDEwOlJlcG9zaXRvcnk0NjI3MzQ0NQ==",
                        "name": "uppy",
                        "full_name": "transloadit/uppy",
                        "private": false,
                        "owner": {
                            "login": "transloadit",
                            "id": 125754,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/transloadit",
                            "html_url": "https://github.com/transloadit",
                            "followers_url": "https://api.github.com/users/transloadit/followers",
                            "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                            "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                            "organizations_url": "https://api.github.com/users/transloadit/orgs",
                            "repos_url": "https://api.github.com/users/transloadit/repos",
                            "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/transloadit/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/transloadit/uppy",
                        "description": "The next open source file uploader for web browsers :dog: ",
                        "fork": false,
                        "url": "https://api.github.com/repos/transloadit/uppy",
                        "forks_url": "https://api.github.com/repos/transloadit/uppy/forks",
                        "keys_url": "https://api.github.com/repos/transloadit/uppy/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/transloadit/uppy/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/transloadit/uppy/teams",
                        "hooks_url": "https://api.github.com/repos/transloadit/uppy/hooks",
                        "issue_events_url": "https://api.github.com/repos/transloadit/uppy/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/transloadit/uppy/events",
                        "assignees_url": "https://api.github.com/repos/transloadit/uppy/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/transloadit/uppy/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/transloadit/uppy/tags",
                        "blobs_url": "https://api.github.com/repos/transloadit/uppy/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/transloadit/uppy/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/transloadit/uppy/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/transloadit/uppy/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/transloadit/uppy/languages",
                        "stargazers_url": "https://api.github.com/repos/transloadit/uppy/stargazers",
                        "contributors_url": "https://api.github.com/repos/transloadit/uppy/contributors",
                        "subscribers_url": "https://api.github.com/repos/transloadit/uppy/subscribers",
                        "subscription_url": "https://api.github.com/repos/transloadit/uppy/subscription",
                        "commits_url": "https://api.github.com/repos/transloadit/uppy/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/transloadit/uppy/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/transloadit/uppy/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/transloadit/uppy/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/transloadit/uppy/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/transloadit/uppy/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/transloadit/uppy/merges",
                        "archive_url": "https://api.github.com/repos/transloadit/uppy/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/transloadit/uppy/downloads",
                        "issues_url": "https://api.github.com/repos/transloadit/uppy/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/transloadit/uppy/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/transloadit/uppy/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/transloadit/uppy/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/transloadit/uppy/labels{/name}",
                        "releases_url": "https://api.github.com/repos/transloadit/uppy/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/transloadit/uppy/deployments",
                        "created_at": "2015-11-16T12:32:33Z",
                        "updated_at": "2023-10-26T10:03:44Z",
                        "pushed_at": "2023-10-25T15:17:29Z",
                        "git_url": "git://github.com/transloadit/uppy.git",
                        "ssh_url": "git@github.com:transloadit/uppy.git",
                        "clone_url": "https://github.com/transloadit/uppy.git",
                        "svn_url": "https://github.com/transloadit/uppy",
                        "homepage": "https://uppy.io",
                        "size": 389980,
                        "stargazers_count": 27488,
                        "watchers_count": 27488,
                        "language": "JavaScript",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": true,
                        "has_discussions": false,
                        "forks_count": 1934,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 168,
                        "license": {
                            "key": "mit",
                            "name": "MIT License",
                            "spdx_id": "MIT",
                            "url": "https://api.github.com/licenses/mit",
                            "node_id": "MDc6TGljZW5zZTEz"
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "dropbox",
                            "encoding",
                            "file-uploader",
                            "file-uploads",
                            "files",
                            "hacktoberfest",
                            "instagram",
                            "javascript",
                            "mit",
                            "modular",
                            "open-source",
                            "pick-files",
                            "resumable",
                            "transloadit",
                            "tus",
                            "uploader",
                            "uppy",
                            "webbrowser"
                        ],
                        "visibility": "public",
                        "forks": 1934,
                        "open_issues": 168,
                        "watchers": 27488,
                        "default_branch": "main"
                    }
                },
                "base": {
                    "label": "transloadit:main",
                    "ref": "main",
                    "sha": "8b252086f5e2769e0a2e95c22ac48b63b9ecfbd1",
                    "user": {
                        "login": "transloadit",
                        "id": 125754,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/transloadit",
                        "html_url": "https://github.com/transloadit",
                        "followers_url": "https://api.github.com/users/transloadit/followers",
                        "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                        "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                        "organizations_url": "https://api.github.com/users/transloadit/orgs",
                        "repos_url": "https://api.github.com/users/transloadit/repos",
                        "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/transloadit/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 46273445,
                        "node_id": "MDEwOlJlcG9zaXRvcnk0NjI3MzQ0NQ==",
                        "name": "uppy",
                        "full_name": "transloadit/uppy",
                        "private": false,
                        "owner": {
                            "login": "transloadit",
                            "id": 125754,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/transloadit",
                            "html_url": "https://github.com/transloadit",
                            "followers_url": "https://api.github.com/users/transloadit/followers",
                            "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                            "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                            "organizations_url": "https://api.github.com/users/transloadit/orgs",
                            "repos_url": "https://api.github.com/users/transloadit/repos",
                            "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/transloadit/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/transloadit/uppy",
                        "description": "The next open source file uploader for web browsers :dog: ",
                        "fork": false,
                        "url": "https://api.github.com/repos/transloadit/uppy",
                        "forks_url": "https://api.github.com/repos/transloadit/uppy/forks",
                        "keys_url": "https://api.github.com/repos/transloadit/uppy/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/transloadit/uppy/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/transloadit/uppy/teams",
                        "hooks_url": "https://api.github.com/repos/transloadit/uppy/hooks",
                        "issue_events_url": "https://api.github.com/repos/transloadit/uppy/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/transloadit/uppy/events",
                        "assignees_url": "https://api.github.com/repos/transloadit/uppy/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/transloadit/uppy/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/transloadit/uppy/tags",
                        "blobs_url": "https://api.github.com/repos/transloadit/uppy/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/transloadit/uppy/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/transloadit/uppy/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/transloadit/uppy/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/transloadit/uppy/languages",
                        "stargazers_url": "https://api.github.com/repos/transloadit/uppy/stargazers",
                        "contributors_url": "https://api.github.com/repos/transloadit/uppy/contributors",
                        "subscribers_url": "https://api.github.com/repos/transloadit/uppy/subscribers",
                        "subscription_url": "https://api.github.com/repos/transloadit/uppy/subscription",
                        "commits_url": "https://api.github.com/repos/transloadit/uppy/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/transloadit/uppy/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/transloadit/uppy/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/transloadit/uppy/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/transloadit/uppy/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/transloadit/uppy/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/transloadit/uppy/merges",
                        "archive_url": "https://api.github.com/repos/transloadit/uppy/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/transloadit/uppy/downloads",
                        "issues_url": "https://api.github.com/repos/transloadit/uppy/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/transloadit/uppy/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/transloadit/uppy/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/transloadit/uppy/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/transloadit/uppy/labels{/name}",
                        "releases_url": "https://api.github.com/repos/transloadit/uppy/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/transloadit/uppy/deployments",
                        "created_at": "2015-11-16T12:32:33Z",
                        "updated_at": "2023-10-26T10:03:44Z",
                        "pushed_at": "2023-10-25T15:17:29Z",
                        "git_url": "git://github.com/transloadit/uppy.git",
                        "ssh_url": "git@github.com:transloadit/uppy.git",
                        "clone_url": "https://github.com/transloadit/uppy.git",
                        "svn_url": "https://github.com/transloadit/uppy",
                        "homepage": "https://uppy.io",
                        "size": 389980,
                        "stargazers_count": 27488,
                        "watchers_count": 27488,
                        "language": "JavaScript",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": true,
                        "has_discussions": false,
                        "forks_count": 1934,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 168,
                        "license": {
                            "key": "mit",
                            "name": "MIT License",
                            "spdx_id": "MIT",
                            "url": "https://api.github.com/licenses/mit",
                            "node_id": "MDc6TGljZW5zZTEz"
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "dropbox",
                            "encoding",
                            "file-uploader",
                            "file-uploads",
                            "files",
                            "hacktoberfest",
                            "instagram",
                            "javascript",
                            "mit",
                            "modular",
                            "open-source",
                            "pick-files",
                            "resumable",
                            "transloadit",
                            "tus",
                            "uploader",
                            "uppy",
                            "webbrowser"
                        ],
                        "visibility": "public",
                        "forks": 1934,
                        "open_issues": 168,
                        "watchers": 27488,
                        "default_branch": "main"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734"
                    },
                    "html": {
                        "href": "https://github.com/transloadit/uppy/pull/4734"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/transloadit/uppy/issues/4734"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/transloadit/uppy/issues/4734/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/transloadit/uppy/statuses/a0501a940e732891215297aecf2613c847fbdc24"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T11:32:24Z",
        "org": {
            "id": 125754,
            "login": "transloadit",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/transloadit",
            "avatar_url": "https://avatars.githubusercontent.com/u/125754?"
        }
    },
    {
        "id": "32863668334",
        "type": "WatchEvent",
        "actor": {
            "id": 146912594,
            "login": "Chov314",
            "display_login": "Chov314",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Chov314",
            "avatar_url": "https://avatars.githubusercontent.com/u/146912594?"
        },
        "repo": {
            "id": 46273445,
            "name": "transloadit/uppy",
            "url": "https://api.github.com/repos/transloadit/uppy"
        },
        "payload": {
            "action": "started"
        },
        "public": true,
        "created_at": "2023-10-26T10:03:44Z",
        "org": {
            "id": 125754,
            "login": "transloadit",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/transloadit",
            "avatar_url": "https://avatars.githubusercontent.com/u/125754?"
        }
    },
    {
        "id": "32863580378",
        "type": "PullRequestReviewCommentEvent",
        "actor": {
            "id": 9060226,
            "login": "Murderlon",
            "display_login": "Murderlon",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Murderlon",
            "avatar_url": "https://avatars.githubusercontent.com/u/9060226?"
        },
        "repo": {
            "id": 46273445,
            "name": "transloadit/uppy",
            "url": "https://api.github.com/repos/transloadit/uppy"
        },
        "payload": {
            "action": "created",
            "comment": {
                "url": "https://api.github.com/repos/transloadit/uppy/pulls/comments/1372909302",
                "pull_request_review_id": 1699205055,
                "id": 1372909302,
                "node_id": "PRRC_kwDOAsITpc5R1O72",
                "diff_hunk": "@@ -222,179 +240,273 @@ export default class RequestClient {\n     return this.request({ ...options, path, method: 'DELETE', data })\n   }\n \n+  /**\n+   * Remote uploading consists of two steps:\n+   * 1. #requestSocketToken which starts the download/upload in companion and returns a unique token for the upload.\n+   * Then companion will halt the upload until:\n+   * 2. #awaitRemoteFileUpload is called, which will open/ensure a websocket connection towards companion, with the\n+   * previously generated token provided. It returns a promise that will resolve/reject once the file has finished\n+   * uploading or is otherwise done (failed, canceled)\n+   * \n+   * @param {*} file \n+   * @param {*} reqBody \n+   * @param {*} options \n+   * @returns \n+   */\n   async uploadRemoteFile (file, reqBody, options = {}) {\n     try {\n-      if (file.serverToken) {\n-        return await this.connectToServerSocket(file, this.getQueue())\n-      }\n-      const queueRequestSocketToken = this.getQueue().wrapPromiseFunction(\n-        this.#requestSocketToken,\n-        { priority: -1 },\n-      )\n-      const serverToken = await queueRequestSocketToken(file, reqBody).abortOn(\n-        options.signal,\n-      )\n-\n-      if (!this.uppy.getState().files[file.id]) return undefined\n-\n-      this.uppy.setFileState(file.id, { serverToken })\n-      return await this.connectToServerSocket(\n-        this.uppy.getFile(file.id),\n-        this.getQueue(),\n-      )\n+      const { signal, getQueue } = options\n+\n+      return await pRetry(async () => {\n+        // if we already have a serverToken, assume that we are resuming the existing server upload id\n+        const existingServerToken = this.uppy.getFile(file.id)?.serverToken;\n+        if (existingServerToken != null) {\n+          this.uppy.log(`Connecting to exiting websocket ${existingServerToken}`)\n+          return this.#awaitRemoteFileUpload({ file, queue: getQueue(), signal })\n+        }\n+\n+        const queueRequestSocketToken = getQueue().wrapPromiseFunction(async (...args) => {\n+          try {\n+            return await this.#requestSocketToken(...args)\n+          } catch (outerErr) {\n+            // throwing AbortError will cause p-retry to stop retrying\n+            if (outerErr instanceof AuthError) throw new AbortError(outerErr)\n+\n+            if (outerErr.cause == null) throw outerErr\n+            const err = outerErr.cause\n+\n+            const isRetryableHttpError = () => (\n+              [408, 409, 429, 418, 423].includes(err.statusCode)\n+              || (err.statusCode >= 500 && err.statusCode <= 599 && ![501, 505].includes(err.statusCode))\n+            )\n+            if (err instanceof HttpError && !isRetryableHttpError()) throw new AbortError(err);\n+  \n+            // p-retry will retry most other errors,\n+            // but it will not retry TypeError (except network error TypeErrors)\n+            throw err\n+          }\n+        }, { priority: -1 })\n+\n+        const serverToken = await queueRequestSocketToken(file, reqBody).abortOn(signal)\n+\n+        if (!this.uppy.getFile(file.id)) return undefined // has file since been removed?\n+\n+        this.uppy.setFileState(file.id, { serverToken })\n+\n+        return this.#awaitRemoteFileUpload({\n+          file: this.uppy.getFile(file.id), // re-fetching file because it might have changed in the meantime\n+          queue: getQueue(),\n+          signal\n+        })\n+      }, { retries: retryCount, signal, onFailedAttempt: (err) => this.uppy.log(`Retrying upload due to: ${err.message}`, 'warning') });\n     } catch (err) {\n+      // this is a bit confusing, but an error with name 'AbortError' (from `signal`) is not the same as `p-retry` AbortError\n       if (err?.cause?.name === 'AbortError') {\n         // The file upload was aborted, it\u2019s not an error\n         return undefined\n       }\n \n-      this.uppy.setFileState(file.id, { serverToken: undefined })\n       this.uppy.emit('upload-error', file, err)\n       throw err\n     }\n   }\n \n-  #requestSocketToken = async (file, postBody) => {\n+  #requestSocketToken = async (file, postBody, signal) => {\n     if (file.remote.url == null) {\n       throw new Error('Cannot connect to an undefined URL')\n     }\n \n     const res = await this.post(file.remote.url, {\n       ...file.remote.body,\n       ...postBody,\n-    })\n+    }, signal)\n \n     return res.token\n   }\n \n   /**\n-   * @param {UppyFile} file\n+   * This method will ensure a websocket for the specified file and returns a promise that resolves\n+   * when the file has finished downloading, or rejects if it fails.\n+   * It will retry if the websocket gets disconnected\n+   * \n+   * @param {{ file: UppyFile, queue: RateLimitedQueue, signal: AbortSignal }} file\n    */\n-  async connectToServerSocket (file, queue) {\n-    return new Promise((resolve, reject) => {\n-      const token = file.serverToken\n-      const host = getSocketHost(file.remote.companionUrl)\n-      const socket = new Socket({\n-        target: `${host}/api/${token}`,\n-        autoOpen: false,\n-      })\n-      const eventManager = new EventManager(this.uppy)\n+  async #awaitRemoteFileUpload ({ file, queue, signal }) {\n+    const eventManager = new EventManager(this.uppy)\n \n-      let queuedRequest\n-\n-      eventManager.onFileRemove(file.id, () => {\n-        socket.send('cancel', {})\n-        queuedRequest.abort()\n-        resolve(`upload ${file.id} was removed`)\n-      })\n-\n-      eventManager.onPause(file.id, (isPaused) => {\n-        if (isPaused) {\n-          // Remove this file from the queue so another file can start in its place.\n-          socket.send('pause', {})\n-          queuedRequest.abort()\n-        } else {\n-          // Resuming an upload should be queued, else you could pause and then\n-          // resume a queued upload to make it skip the queue.\n-          queuedRequest.abort()\n-          queuedRequest = queue.run(() => {\n-            socket.open()\n-            socket.send('resume', {})\n-\n-            return () => {}\n-          })\n-        }\n-      })\n-\n-      eventManager.onPauseAll(file.id, () => {\n-        socket.send('pause', {})\n-        queuedRequest.abort()\n-      })\n-\n-      eventManager.onCancelAll(file.id, ({ reason } = {}) => {\n-        if (reason === 'user') {\n-          socket.send('cancel', {})\n-          queuedRequest.abort()\n+    try {\n+      return await new Promise((resolve, reject) => {\n+        const token = file.serverToken\n+        const host = getSocketHost(file.remote.companionUrl)\n+\n+        /** @type {WebSocket} */\n+        let socket\n+        /** @type {AbortController?} */\n+        let socketAbortController\n+        let activityTimeout\n+\n+        let { isPaused } = file\n+\n+        const socketSend = (action, payload) => {\n+          if (socket == null || socket.readyState !== socket.OPEN) {\n+            this.uppy.log(`Cannot send \"${action}\" to socket ${file.id} because the socket state was ${String(socket?.readyState)}`, 'warning')\n+            return\n+          }\n+\n+          socket.send(JSON.stringify({\n+            action,\n+            payload: payload ?? {},\n+          }))    \n+        };\n+\n+        function sendState() {\n+          if (isPaused) socketSend('pause')\n+          else socketSend('resume')\n         }\n-        resolve(`upload ${file.id} was canceled`)\n-      })\n \n-      eventManager.onResumeAll(file.id, () => {\n-        queuedRequest.abort()\n-        if (file.error) {\n-          socket.send('pause', {})\n+        const createWebsocket = async () => {\n+          if (socketAbortController) socketAbortController.abort()\n+          socketAbortController = new AbortController()\n+\n+          const onFatalError = (err) => {\n+            // Remove the serverToken so that a new one will be created for the retry.\n+            this.uppy.setFileState(file.id, { serverToken: null })\n+            socketAbortController?.abort?.()\n+            reject(err)\n+          }\n+  \n+          // todo instead implement the ability for users to cancel / retry *currently uploading files* in the UI\n+          function resetActivityTimeout() {\n+            clearTimeout(activityTimeout)\n+            if (isPaused) return\n+            activityTimeout = setTimeout(() => onFatalError(new Error('Timeout waiting for message from Companion socket')), socketActivityTimeoutMs)\n+          }\n+\n+          try {\n+            await queue.wrapPromiseFunction(async () => {\n+              // eslint-disable-next-line promise/param-names\n+              const reconnectWebsocket = async () => new Promise((resolveSocket, rejectSocket) => {\n+                socket = new WebSocket(`${host}/api/${token}`)\n+\n+                resetActivityTimeout()\n+\n+                socket.addEventListener('close', () => {\n+                  socket = undefined\n+                  rejectSocket(new Error('Socket closed unexpectedly'))\n+                })\n+\n+                socket.addEventListener('error', (error) => {\n+                  this.uppy.log(`Companion socket error ${JSON.stringify(error)}, closing socket`, 'warning')\n+                  socket.close() // will 'close' event to be emitted\n+                })\n+\n+                socket.addEventListener('open', () => {\n+                  sendState()\n+                })\n+\n+                socket.addEventListener('message', (e) => {\n+                  resetActivityTimeout()\n+\n+                  try {\n+                    const { action, payload } = JSON.parse(e.data)\n+            \n+                    switch (action) {\n+                      case 'progress': {\n+                        emitSocketProgress(this, payload, file)\n+                        break;\n+                      }\n+                      case 'success': {\n+                        this.uppy.emit('upload-success', file, { uploadURL: payload.url })\n+                        socketAbortController?.abort?.()\n+                        resolve()\n+                        break;\n+                      }\n+                      case 'error': {\n+                        const { message } = payload.error\n+                        throw Object.assign(new Error(message), { cause: payload.error })\n+                      }\n+                        default:\n+                          this.uppy.log(`Companion socket unknown action ${action}`, 'warning')\n+                    }\n+                  } catch (err) {\n+                    onFatalError(err)\n+                  }\n+                })\n+\n+                const closeSocket = () => {\n+                  this.uppy.log(`Closing socket ${file.id}`, 'info')\n+                  clearTimeout(activityTimeout)\n+                  if (socket) socket.close()\n+                  socket = undefined\n+                }\n+        \n+                socketAbortController.signal.addEventListener('abort', () => {\n+                  closeSocket()\n+                })\n+              })\n+\n+              await pRetry(reconnectWebsocket, {\n+                retries: retryCount,\n+                signal: socketAbortController.signal,\n+                onFailedAttempt: () => this.uppy.log(`Retrying websocket ${file.id}`, 'info'),\n+              });\n+            })().abortOn(socketAbortController.signal);\n+          } catch (err) {\n+            if (socketAbortController.signal.aborted) return\n+            onFatalError(err)\n+          }\n         }\n-        queuedRequest = queue.run(() => {\n-          socket.open()\n-          socket.send('resume', {})\n \n-          return () => {}\n-        })\n-      })\n-\n-      eventManager.onRetry(file.id, () => {\n-        // Only do the retry if the upload is actually in progress;\n-        // else we could try to send these messages when the upload is still queued.\n-        // We may need a better check for this since the socket may also be closed\n-        // for other reasons, like network failures.\n-        if (socket.isOpen) {\n-          socket.send('pause', {})\n-          socket.send('resume', {})\n+        const pause = (newPausedState) => {\n+          isPaused = newPausedState\n+          if (socket) sendState()\n+\n+          if (newPausedState) {\n+            // Remove this file from the queue so another file can start in its place.\n+            socketAbortController?.abort?.() // close socket to free up the request for other uploads\n+          } else {\n+            // Resuming an upload should be queued, else you could pause and then\n+            // resume a queued upload to make it skip the queue.\n+            createWebsocket()\n+          }\n         }\n-      })\n \n-      eventManager.onRetryAll(file.id, () => {\n-        // See the comment in the onRetry() call\n-        if (socket.isOpen) {\n-          socket.send('pause', {})\n-          socket.send('resume', {})\n+        const withErrorHandling = (fn, event) => {\n+          try {\n+            fn()\n+          } catch (err) {\n+            this.uppy.log(`Error while handling ${event} event for file ${file.id}: ${err.message}`, 'error')\n+          }\n         }\n-      })\n-\n-      socket.on('progress', (progressData) => emitSocketProgress(this, progressData, file))\n \n-      socket.on('error', (errData) => {\n-        const { message } = errData.error\n-        const error = Object.assign(new Error(message), {\n-          cause: errData.error,\n+        eventManager.onPause(file.id, (newPausedState) => withErrorHandling(() => pause(newPausedState), 'pause'))\n+        eventManager.onPauseAll(file.id, () => withErrorHandling(() => pause(true), 'pause-all'))\n+        eventManager.onResumeAll(file.id, () => withErrorHandling(() => pause(false), 'resume-all'))\n+\n+        eventManager.onFileRemove(file.id, () => withErrorHandling(() => {\n+          socketSend('cancel')\n+          socketAbortController?.abort?.()\n+          this.uppy.log(`upload ${file.id} was removed`, 'info')\n+          resolve()\n+        }, 'file-removed'))\n+\n+        eventManager.onCancelAll(file.id, ({ reason } = {}) => withErrorHandling(() => {\n+          if (reason === 'user') {\n+            socketSend('cancel')\n+          }\n+          socketAbortController?.abort?.()\n+          this.uppy.log(`upload ${file.id} was canceled`, 'info')\n+          resolve()\n+        }, 'cancel-all'))",
                "path": "packages/@uppy/companion-client/src/RequestClient.js",
                "commit_id": "a0501a940e732891215297aecf2613c847fbdc24",
                "original_commit_id": "a0501a940e732891215297aecf2613c847fbdc24",
                "user": {
                    "login": "Murderlon",
                    "id": 9060226,
                    "node_id": "MDQ6VXNlcjkwNjAyMjY=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/9060226?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/Murderlon",
                    "html_url": "https://github.com/Murderlon",
                    "followers_url": "https://api.github.com/users/Murderlon/followers",
                    "following_url": "https://api.github.com/users/Murderlon/following{/other_user}",
                    "gists_url": "https://api.github.com/users/Murderlon/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/Murderlon/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/Murderlon/subscriptions",
                    "organizations_url": "https://api.github.com/users/Murderlon/orgs",
                    "repos_url": "https://api.github.com/users/Murderlon/repos",
                    "events_url": "https://api.github.com/users/Murderlon/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/Murderlon/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "EventManager was already the wrong abstraction and now we are doubling down on it with another `withErrorHandling` abstraction. I already refactored this away in #4745.\r\n\r\nCould use my refactored version and see if you even still need something like `withErrorHandling`? Also notice the if statements for certain events based on `capabilities`.\r\n\r\nhttps://github.com/transloadit/uppy/blob/92995e847ebbed790c63032f56ebed660e2099c5/packages/%40uppy/companion-client/src/RequestClient.js#L286-L345",
                "created_at": "2023-10-26T10:00:46Z",
                "updated_at": "2023-10-26T10:00:47Z",
                "html_url": "https://github.com/transloadit/uppy/pull/4734#discussion_r1372909302",
                "pull_request_url": "https://api.github.com/repos/transloadit/uppy/pulls/4734",
                "author_association": "MEMBER",
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/comments/1372909302"
                    },
                    "html": {
                        "href": "https://github.com/transloadit/uppy/pull/4734#discussion_r1372909302"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734"
                    }
                },
                "reactions": {
                    "url": "https://api.github.com/repos/transloadit/uppy/pulls/comments/1372909302/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "start_line": 482,
                "original_start_line": 482,
                "start_side": "RIGHT",
                "line": 500,
                "original_line": 500,
                "side": "RIGHT",
                "original_position": 452,
                "position": 452,
                "subject_type": "line"
            },
            "pull_request": {
                "url": "https://api.github.com/repos/transloadit/uppy/pulls/4734",
                "id": 1556257466,
                "node_id": "PR_kwDOAsITpc5cwpq6",
                "html_url": "https://github.com/transloadit/uppy/pull/4734",
                "diff_url": "https://github.com/transloadit/uppy/pull/4734.diff",
                "patch_url": "https://github.com/transloadit/uppy/pull/4734.patch",
                "issue_url": "https://api.github.com/repos/transloadit/uppy/issues/4734",
                "number": 4734,
                "state": "open",
                "locked": false,
                "title": "Companion+client stability fixes, error handling and retry",
                "user": {
                    "login": "mifi",
                    "id": 402547,
                    "node_id": "MDQ6VXNlcjQwMjU0Nw==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/402547?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/mifi",
                    "html_url": "https://github.com/mifi",
                    "followers_url": "https://api.github.com/users/mifi/followers",
                    "following_url": "https://api.github.com/users/mifi/following{/other_user}",
                    "gists_url": "https://api.github.com/users/mifi/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/mifi/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/mifi/subscriptions",
                    "organizations_url": "https://api.github.com/users/mifi/orgs",
                    "repos_url": "https://api.github.com/users/mifi/repos",
                    "events_url": "https://api.github.com/users/mifi/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/mifi/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "- [respond with 500 if unhandled upload error](https://github.com/transloadit/uppy/commit/4f52551fe8af63032f6ac2d909ef60d1d89c90bd) \r\n 400 seems inappropriate\r\n- [fix companion download error](https://github.com/transloadit/uppy/commit/7bd5042adbad44f26b083ba01f7a64c782b19a73) \r\n  - respond with correct response code when calling /get and request to the upstream server fails\r\n  - also add a unit test for this\r\n- [forward 429 from provider](https://github.com/transloadit/uppy/commit/3fa992b23b7de675cad046daa41f064bb8cdf02c) \r\n  allows us to retry it\r\n- [add a way to test refresh tokens](https://github.com/transloadit/uppy/commit/aad9ae9d3e875cba6410618721470138448ff4cc)\r\n- [fix race condtiion with refreshing token](https://github.com/transloadit/uppy/commit/863b60e83a53c7c2e458bb0b8a39670ba94415e7) that would cause many `refresh-token` calls to be made concurrently, possibly causing problems\r\n- [implement retry and fix socket](https://github.com/transloadit/uppy/commit/7124ef484b6eda82df9c126efe6973c2427e92b8) \r\n  - Make sure we don't instantiate a new Provider for every file uploaded (reuse the original provider instead) - this caused the refresh token synchronization not to work\r\n  - Retry most errors when uploading (`/get`) using companion, but for HTTP, only retry certain HTTP status codes\r\n  - Reimplement the websocket code to be more stable and retry as well\r\n  - if no websocket messages have been received in 5 minutes, fail the upload, so the upload doesn't get stuck forever in case something goes bad, TODO should this should be solved in the UI instead?\r\n- [remove useFastRemoteRetry](https://github.com/transloadit/uppy/commit/8612d5d5ace5e7ec32db73e3632ec964657aff06) \r\n  - because it isn't supported in Companion as far as I can tell, and the option effectively doesn't do anything at all",
                "created_at": "2023-10-13T17:28:55Z",
                "updated_at": "2023-10-26T10:00:47Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "7c1c899a01eb66e45e7af9fd8b7f0bbd6748faa8",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/transloadit/uppy/pulls/4734/commits",
                "review_comments_url": "https://api.github.com/repos/transloadit/uppy/pulls/4734/comments",
                "review_comment_url": "https://api.github.com/repos/transloadit/uppy/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/transloadit/uppy/issues/4734/comments",
                "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/a0501a940e732891215297aecf2613c847fbdc24",
                "head": {
                    "label": "transloadit:companion-fixes",
                    "ref": "companion-fixes",
                    "sha": "a0501a940e732891215297aecf2613c847fbdc24",
                    "user": {
                        "login": "transloadit",
                        "id": 125754,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/transloadit",
                        "html_url": "https://github.com/transloadit",
                        "followers_url": "https://api.github.com/users/transloadit/followers",
                        "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                        "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                        "organizations_url": "https://api.github.com/users/transloadit/orgs",
                        "repos_url": "https://api.github.com/users/transloadit/repos",
                        "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/transloadit/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 46273445,
                        "node_id": "MDEwOlJlcG9zaXRvcnk0NjI3MzQ0NQ==",
                        "name": "uppy",
                        "full_name": "transloadit/uppy",
                        "private": false,
                        "owner": {
                            "login": "transloadit",
                            "id": 125754,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/transloadit",
                            "html_url": "https://github.com/transloadit",
                            "followers_url": "https://api.github.com/users/transloadit/followers",
                            "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                            "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                            "organizations_url": "https://api.github.com/users/transloadit/orgs",
                            "repos_url": "https://api.github.com/users/transloadit/repos",
                            "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/transloadit/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/transloadit/uppy",
                        "description": "The next open source file uploader for web browsers :dog: ",
                        "fork": false,
                        "url": "https://api.github.com/repos/transloadit/uppy",
                        "forks_url": "https://api.github.com/repos/transloadit/uppy/forks",
                        "keys_url": "https://api.github.com/repos/transloadit/uppy/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/transloadit/uppy/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/transloadit/uppy/teams",
                        "hooks_url": "https://api.github.com/repos/transloadit/uppy/hooks",
                        "issue_events_url": "https://api.github.com/repos/transloadit/uppy/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/transloadit/uppy/events",
                        "assignees_url": "https://api.github.com/repos/transloadit/uppy/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/transloadit/uppy/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/transloadit/uppy/tags",
                        "blobs_url": "https://api.github.com/repos/transloadit/uppy/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/transloadit/uppy/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/transloadit/uppy/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/transloadit/uppy/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/transloadit/uppy/languages",
                        "stargazers_url": "https://api.github.com/repos/transloadit/uppy/stargazers",
                        "contributors_url": "https://api.github.com/repos/transloadit/uppy/contributors",
                        "subscribers_url": "https://api.github.com/repos/transloadit/uppy/subscribers",
                        "subscription_url": "https://api.github.com/repos/transloadit/uppy/subscription",
                        "commits_url": "https://api.github.com/repos/transloadit/uppy/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/transloadit/uppy/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/transloadit/uppy/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/transloadit/uppy/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/transloadit/uppy/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/transloadit/uppy/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/transloadit/uppy/merges",
                        "archive_url": "https://api.github.com/repos/transloadit/uppy/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/transloadit/uppy/downloads",
                        "issues_url": "https://api.github.com/repos/transloadit/uppy/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/transloadit/uppy/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/transloadit/uppy/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/transloadit/uppy/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/transloadit/uppy/labels{/name}",
                        "releases_url": "https://api.github.com/repos/transloadit/uppy/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/transloadit/uppy/deployments",
                        "created_at": "2015-11-16T12:32:33Z",
                        "updated_at": "2023-10-26T09:43:27Z",
                        "pushed_at": "2023-10-25T15:17:29Z",
                        "git_url": "git://github.com/transloadit/uppy.git",
                        "ssh_url": "git@github.com:transloadit/uppy.git",
                        "clone_url": "https://github.com/transloadit/uppy.git",
                        "svn_url": "https://github.com/transloadit/uppy",
                        "homepage": "https://uppy.io",
                        "size": 389980,
                        "stargazers_count": 27487,
                        "watchers_count": 27487,
                        "language": "JavaScript",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": true,
                        "has_discussions": false,
                        "forks_count": 1934,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 168,
                        "license": {
                            "key": "mit",
                            "name": "MIT License",
                            "spdx_id": "MIT",
                            "url": "https://api.github.com/licenses/mit",
                            "node_id": "MDc6TGljZW5zZTEz"
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "dropbox",
                            "encoding",
                            "file-uploader",
                            "file-uploads",
                            "files",
                            "hacktoberfest",
                            "instagram",
                            "javascript",
                            "mit",
                            "modular",
                            "open-source",
                            "pick-files",
                            "resumable",
                            "transloadit",
                            "tus",
                            "uploader",
                            "uppy",
                            "webbrowser"
                        ],
                        "visibility": "public",
                        "forks": 1934,
                        "open_issues": 168,
                        "watchers": 27487,
                        "default_branch": "main"
                    }
                },
                "base": {
                    "label": "transloadit:main",
                    "ref": "main",
                    "sha": "8b252086f5e2769e0a2e95c22ac48b63b9ecfbd1",
                    "user": {
                        "login": "transloadit",
                        "id": 125754,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/transloadit",
                        "html_url": "https://github.com/transloadit",
                        "followers_url": "https://api.github.com/users/transloadit/followers",
                        "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                        "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                        "organizations_url": "https://api.github.com/users/transloadit/orgs",
                        "repos_url": "https://api.github.com/users/transloadit/repos",
                        "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/transloadit/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 46273445,
                        "node_id": "MDEwOlJlcG9zaXRvcnk0NjI3MzQ0NQ==",
                        "name": "uppy",
                        "full_name": "transloadit/uppy",
                        "private": false,
                        "owner": {
                            "login": "transloadit",
                            "id": 125754,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/transloadit",
                            "html_url": "https://github.com/transloadit",
                            "followers_url": "https://api.github.com/users/transloadit/followers",
                            "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                            "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                            "organizations_url": "https://api.github.com/users/transloadit/orgs",
                            "repos_url": "https://api.github.com/users/transloadit/repos",
                            "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/transloadit/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/transloadit/uppy",
                        "description": "The next open source file uploader for web browsers :dog: ",
                        "fork": false,
                        "url": "https://api.github.com/repos/transloadit/uppy",
                        "forks_url": "https://api.github.com/repos/transloadit/uppy/forks",
                        "keys_url": "https://api.github.com/repos/transloadit/uppy/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/transloadit/uppy/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/transloadit/uppy/teams",
                        "hooks_url": "https://api.github.com/repos/transloadit/uppy/hooks",
                        "issue_events_url": "https://api.github.com/repos/transloadit/uppy/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/transloadit/uppy/events",
                        "assignees_url": "https://api.github.com/repos/transloadit/uppy/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/transloadit/uppy/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/transloadit/uppy/tags",
                        "blobs_url": "https://api.github.com/repos/transloadit/uppy/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/transloadit/uppy/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/transloadit/uppy/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/transloadit/uppy/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/transloadit/uppy/languages",
                        "stargazers_url": "https://api.github.com/repos/transloadit/uppy/stargazers",
                        "contributors_url": "https://api.github.com/repos/transloadit/uppy/contributors",
                        "subscribers_url": "https://api.github.com/repos/transloadit/uppy/subscribers",
                        "subscription_url": "https://api.github.com/repos/transloadit/uppy/subscription",
                        "commits_url": "https://api.github.com/repos/transloadit/uppy/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/transloadit/uppy/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/transloadit/uppy/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/transloadit/uppy/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/transloadit/uppy/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/transloadit/uppy/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/transloadit/uppy/merges",
                        "archive_url": "https://api.github.com/repos/transloadit/uppy/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/transloadit/uppy/downloads",
                        "issues_url": "https://api.github.com/repos/transloadit/uppy/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/transloadit/uppy/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/transloadit/uppy/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/transloadit/uppy/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/transloadit/uppy/labels{/name}",
                        "releases_url": "https://api.github.com/repos/transloadit/uppy/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/transloadit/uppy/deployments",
                        "created_at": "2015-11-16T12:32:33Z",
                        "updated_at": "2023-10-26T09:43:27Z",
                        "pushed_at": "2023-10-25T15:17:29Z",
                        "git_url": "git://github.com/transloadit/uppy.git",
                        "ssh_url": "git@github.com:transloadit/uppy.git",
                        "clone_url": "https://github.com/transloadit/uppy.git",
                        "svn_url": "https://github.com/transloadit/uppy",
                        "homepage": "https://uppy.io",
                        "size": 389980,
                        "stargazers_count": 27487,
                        "watchers_count": 27487,
                        "language": "JavaScript",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": true,
                        "has_discussions": false,
                        "forks_count": 1934,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 168,
                        "license": {
                            "key": "mit",
                            "name": "MIT License",
                            "spdx_id": "MIT",
                            "url": "https://api.github.com/licenses/mit",
                            "node_id": "MDc6TGljZW5zZTEz"
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "dropbox",
                            "encoding",
                            "file-uploader",
                            "file-uploads",
                            "files",
                            "hacktoberfest",
                            "instagram",
                            "javascript",
                            "mit",
                            "modular",
                            "open-source",
                            "pick-files",
                            "resumable",
                            "transloadit",
                            "tus",
                            "uploader",
                            "uppy",
                            "webbrowser"
                        ],
                        "visibility": "public",
                        "forks": 1934,
                        "open_issues": 168,
                        "watchers": 27487,
                        "default_branch": "main"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734"
                    },
                    "html": {
                        "href": "https://github.com/transloadit/uppy/pull/4734"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/transloadit/uppy/issues/4734"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/transloadit/uppy/issues/4734/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/transloadit/uppy/statuses/a0501a940e732891215297aecf2613c847fbdc24"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T10:00:46Z",
        "org": {
            "id": 125754,
            "login": "transloadit",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/transloadit",
            "avatar_url": "https://avatars.githubusercontent.com/u/125754?"
        }
    },
    {
        "id": "32863580262",
        "type": "PullRequestReviewEvent",
        "actor": {
            "id": 9060226,
            "login": "Murderlon",
            "display_login": "Murderlon",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Murderlon",
            "avatar_url": "https://avatars.githubusercontent.com/u/9060226?"
        },
        "repo": {
            "id": 46273445,
            "name": "transloadit/uppy",
            "url": "https://api.github.com/repos/transloadit/uppy"
        },
        "payload": {
            "action": "created",
            "review": {
                "id": 1699205055,
                "node_id": "PRR_kwDOAsITpc5lR8-_",
                "user": {
                    "login": "Murderlon",
                    "id": 9060226,
                    "node_id": "MDQ6VXNlcjkwNjAyMjY=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/9060226?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/Murderlon",
                    "html_url": "https://github.com/Murderlon",
                    "followers_url": "https://api.github.com/users/Murderlon/followers",
                    "following_url": "https://api.github.com/users/Murderlon/following{/other_user}",
                    "gists_url": "https://api.github.com/users/Murderlon/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/Murderlon/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/Murderlon/subscriptions",
                    "organizations_url": "https://api.github.com/users/Murderlon/orgs",
                    "repos_url": "https://api.github.com/users/Murderlon/repos",
                    "events_url": "https://api.github.com/users/Murderlon/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/Murderlon/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": null,
                "commit_id": "a0501a940e732891215297aecf2613c847fbdc24",
                "submitted_at": "2023-10-26T10:00:47Z",
                "state": "commented",
                "html_url": "https://github.com/transloadit/uppy/pull/4734#pullrequestreview-1699205055",
                "pull_request_url": "https://api.github.com/repos/transloadit/uppy/pulls/4734",
                "author_association": "MEMBER",
                "_links": {
                    "html": {
                        "href": "https://github.com/transloadit/uppy/pull/4734#pullrequestreview-1699205055"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734"
                    }
                }
            },
            "pull_request": {
                "url": "https://api.github.com/repos/transloadit/uppy/pulls/4734",
                "id": 1556257466,
                "node_id": "PR_kwDOAsITpc5cwpq6",
                "html_url": "https://github.com/transloadit/uppy/pull/4734",
                "diff_url": "https://github.com/transloadit/uppy/pull/4734.diff",
                "patch_url": "https://github.com/transloadit/uppy/pull/4734.patch",
                "issue_url": "https://api.github.com/repos/transloadit/uppy/issues/4734",
                "number": 4734,
                "state": "open",
                "locked": false,
                "title": "Companion+client stability fixes, error handling and retry",
                "user": {
                    "login": "mifi",
                    "id": 402547,
                    "node_id": "MDQ6VXNlcjQwMjU0Nw==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/402547?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/mifi",
                    "html_url": "https://github.com/mifi",
                    "followers_url": "https://api.github.com/users/mifi/followers",
                    "following_url": "https://api.github.com/users/mifi/following{/other_user}",
                    "gists_url": "https://api.github.com/users/mifi/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/mifi/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/mifi/subscriptions",
                    "organizations_url": "https://api.github.com/users/mifi/orgs",
                    "repos_url": "https://api.github.com/users/mifi/repos",
                    "events_url": "https://api.github.com/users/mifi/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/mifi/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "- [respond with 500 if unhandled upload error](https://github.com/transloadit/uppy/commit/4f52551fe8af63032f6ac2d909ef60d1d89c90bd) \r\n 400 seems inappropriate\r\n- [fix companion download error](https://github.com/transloadit/uppy/commit/7bd5042adbad44f26b083ba01f7a64c782b19a73) \r\n  - respond with correct response code when calling /get and request to the upstream server fails\r\n  - also add a unit test for this\r\n- [forward 429 from provider](https://github.com/transloadit/uppy/commit/3fa992b23b7de675cad046daa41f064bb8cdf02c) \r\n  allows us to retry it\r\n- [add a way to test refresh tokens](https://github.com/transloadit/uppy/commit/aad9ae9d3e875cba6410618721470138448ff4cc)\r\n- [fix race condtiion with refreshing token](https://github.com/transloadit/uppy/commit/863b60e83a53c7c2e458bb0b8a39670ba94415e7) that would cause many `refresh-token` calls to be made concurrently, possibly causing problems\r\n- [implement retry and fix socket](https://github.com/transloadit/uppy/commit/7124ef484b6eda82df9c126efe6973c2427e92b8) \r\n  - Make sure we don't instantiate a new Provider for every file uploaded (reuse the original provider instead) - this caused the refresh token synchronization not to work\r\n  - Retry most errors when uploading (`/get`) using companion, but for HTTP, only retry certain HTTP status codes\r\n  - Reimplement the websocket code to be more stable and retry as well\r\n  - if no websocket messages have been received in 5 minutes, fail the upload, so the upload doesn't get stuck forever in case something goes bad, TODO should this should be solved in the UI instead?\r\n- [remove useFastRemoteRetry](https://github.com/transloadit/uppy/commit/8612d5d5ace5e7ec32db73e3632ec964657aff06) \r\n  - because it isn't supported in Companion as far as I can tell, and the option effectively doesn't do anything at all",
                "created_at": "2023-10-13T17:28:55Z",
                "updated_at": "2023-10-26T10:00:47Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "7c1c899a01eb66e45e7af9fd8b7f0bbd6748faa8",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/transloadit/uppy/pulls/4734/commits",
                "review_comments_url": "https://api.github.com/repos/transloadit/uppy/pulls/4734/comments",
                "review_comment_url": "https://api.github.com/repos/transloadit/uppy/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/transloadit/uppy/issues/4734/comments",
                "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/a0501a940e732891215297aecf2613c847fbdc24",
                "head": {
                    "label": "transloadit:companion-fixes",
                    "ref": "companion-fixes",
                    "sha": "a0501a940e732891215297aecf2613c847fbdc24",
                    "user": {
                        "login": "transloadit",
                        "id": 125754,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/transloadit",
                        "html_url": "https://github.com/transloadit",
                        "followers_url": "https://api.github.com/users/transloadit/followers",
                        "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                        "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                        "organizations_url": "https://api.github.com/users/transloadit/orgs",
                        "repos_url": "https://api.github.com/users/transloadit/repos",
                        "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/transloadit/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 46273445,
                        "node_id": "MDEwOlJlcG9zaXRvcnk0NjI3MzQ0NQ==",
                        "name": "uppy",
                        "full_name": "transloadit/uppy",
                        "private": false,
                        "owner": {
                            "login": "transloadit",
                            "id": 125754,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/transloadit",
                            "html_url": "https://github.com/transloadit",
                            "followers_url": "https://api.github.com/users/transloadit/followers",
                            "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                            "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                            "organizations_url": "https://api.github.com/users/transloadit/orgs",
                            "repos_url": "https://api.github.com/users/transloadit/repos",
                            "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/transloadit/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/transloadit/uppy",
                        "description": "The next open source file uploader for web browsers :dog: ",
                        "fork": false,
                        "url": "https://api.github.com/repos/transloadit/uppy",
                        "forks_url": "https://api.github.com/repos/transloadit/uppy/forks",
                        "keys_url": "https://api.github.com/repos/transloadit/uppy/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/transloadit/uppy/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/transloadit/uppy/teams",
                        "hooks_url": "https://api.github.com/repos/transloadit/uppy/hooks",
                        "issue_events_url": "https://api.github.com/repos/transloadit/uppy/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/transloadit/uppy/events",
                        "assignees_url": "https://api.github.com/repos/transloadit/uppy/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/transloadit/uppy/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/transloadit/uppy/tags",
                        "blobs_url": "https://api.github.com/repos/transloadit/uppy/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/transloadit/uppy/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/transloadit/uppy/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/transloadit/uppy/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/transloadit/uppy/languages",
                        "stargazers_url": "https://api.github.com/repos/transloadit/uppy/stargazers",
                        "contributors_url": "https://api.github.com/repos/transloadit/uppy/contributors",
                        "subscribers_url": "https://api.github.com/repos/transloadit/uppy/subscribers",
                        "subscription_url": "https://api.github.com/repos/transloadit/uppy/subscription",
                        "commits_url": "https://api.github.com/repos/transloadit/uppy/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/transloadit/uppy/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/transloadit/uppy/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/transloadit/uppy/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/transloadit/uppy/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/transloadit/uppy/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/transloadit/uppy/merges",
                        "archive_url": "https://api.github.com/repos/transloadit/uppy/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/transloadit/uppy/downloads",
                        "issues_url": "https://api.github.com/repos/transloadit/uppy/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/transloadit/uppy/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/transloadit/uppy/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/transloadit/uppy/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/transloadit/uppy/labels{/name}",
                        "releases_url": "https://api.github.com/repos/transloadit/uppy/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/transloadit/uppy/deployments",
                        "created_at": "2015-11-16T12:32:33Z",
                        "updated_at": "2023-10-26T09:43:27Z",
                        "pushed_at": "2023-10-25T15:17:29Z",
                        "git_url": "git://github.com/transloadit/uppy.git",
                        "ssh_url": "git@github.com:transloadit/uppy.git",
                        "clone_url": "https://github.com/transloadit/uppy.git",
                        "svn_url": "https://github.com/transloadit/uppy",
                        "homepage": "https://uppy.io",
                        "size": 389980,
                        "stargazers_count": 27487,
                        "watchers_count": 27487,
                        "language": "JavaScript",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": true,
                        "has_discussions": false,
                        "forks_count": 1934,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 168,
                        "license": {
                            "key": "mit",
                            "name": "MIT License",
                            "spdx_id": "MIT",
                            "url": "https://api.github.com/licenses/mit",
                            "node_id": "MDc6TGljZW5zZTEz"
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "dropbox",
                            "encoding",
                            "file-uploader",
                            "file-uploads",
                            "files",
                            "hacktoberfest",
                            "instagram",
                            "javascript",
                            "mit",
                            "modular",
                            "open-source",
                            "pick-files",
                            "resumable",
                            "transloadit",
                            "tus",
                            "uploader",
                            "uppy",
                            "webbrowser"
                        ],
                        "visibility": "public",
                        "forks": 1934,
                        "open_issues": 168,
                        "watchers": 27487,
                        "default_branch": "main"
                    }
                },
                "base": {
                    "label": "transloadit:main",
                    "ref": "main",
                    "sha": "8b252086f5e2769e0a2e95c22ac48b63b9ecfbd1",
                    "user": {
                        "login": "transloadit",
                        "id": 125754,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/transloadit",
                        "html_url": "https://github.com/transloadit",
                        "followers_url": "https://api.github.com/users/transloadit/followers",
                        "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                        "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                        "organizations_url": "https://api.github.com/users/transloadit/orgs",
                        "repos_url": "https://api.github.com/users/transloadit/repos",
                        "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/transloadit/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 46273445,
                        "node_id": "MDEwOlJlcG9zaXRvcnk0NjI3MzQ0NQ==",
                        "name": "uppy",
                        "full_name": "transloadit/uppy",
                        "private": false,
                        "owner": {
                            "login": "transloadit",
                            "id": 125754,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/transloadit",
                            "html_url": "https://github.com/transloadit",
                            "followers_url": "https://api.github.com/users/transloadit/followers",
                            "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                            "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                            "organizations_url": "https://api.github.com/users/transloadit/orgs",
                            "repos_url": "https://api.github.com/users/transloadit/repos",
                            "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/transloadit/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/transloadit/uppy",
                        "description": "The next open source file uploader for web browsers :dog: ",
                        "fork": false,
                        "url": "https://api.github.com/repos/transloadit/uppy",
                        "forks_url": "https://api.github.com/repos/transloadit/uppy/forks",
                        "keys_url": "https://api.github.com/repos/transloadit/uppy/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/transloadit/uppy/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/transloadit/uppy/teams",
                        "hooks_url": "https://api.github.com/repos/transloadit/uppy/hooks",
                        "issue_events_url": "https://api.github.com/repos/transloadit/uppy/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/transloadit/uppy/events",
                        "assignees_url": "https://api.github.com/repos/transloadit/uppy/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/transloadit/uppy/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/transloadit/uppy/tags",
                        "blobs_url": "https://api.github.com/repos/transloadit/uppy/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/transloadit/uppy/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/transloadit/uppy/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/transloadit/uppy/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/transloadit/uppy/languages",
                        "stargazers_url": "https://api.github.com/repos/transloadit/uppy/stargazers",
                        "contributors_url": "https://api.github.com/repos/transloadit/uppy/contributors",
                        "subscribers_url": "https://api.github.com/repos/transloadit/uppy/subscribers",
                        "subscription_url": "https://api.github.com/repos/transloadit/uppy/subscription",
                        "commits_url": "https://api.github.com/repos/transloadit/uppy/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/transloadit/uppy/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/transloadit/uppy/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/transloadit/uppy/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/transloadit/uppy/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/transloadit/uppy/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/transloadit/uppy/merges",
                        "archive_url": "https://api.github.com/repos/transloadit/uppy/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/transloadit/uppy/downloads",
                        "issues_url": "https://api.github.com/repos/transloadit/uppy/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/transloadit/uppy/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/transloadit/uppy/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/transloadit/uppy/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/transloadit/uppy/labels{/name}",
                        "releases_url": "https://api.github.com/repos/transloadit/uppy/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/transloadit/uppy/deployments",
                        "created_at": "2015-11-16T12:32:33Z",
                        "updated_at": "2023-10-26T09:43:27Z",
                        "pushed_at": "2023-10-25T15:17:29Z",
                        "git_url": "git://github.com/transloadit/uppy.git",
                        "ssh_url": "git@github.com:transloadit/uppy.git",
                        "clone_url": "https://github.com/transloadit/uppy.git",
                        "svn_url": "https://github.com/transloadit/uppy",
                        "homepage": "https://uppy.io",
                        "size": 389980,
                        "stargazers_count": 27487,
                        "watchers_count": 27487,
                        "language": "JavaScript",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": true,
                        "has_discussions": false,
                        "forks_count": 1934,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 168,
                        "license": {
                            "key": "mit",
                            "name": "MIT License",
                            "spdx_id": "MIT",
                            "url": "https://api.github.com/licenses/mit",
                            "node_id": "MDc6TGljZW5zZTEz"
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "dropbox",
                            "encoding",
                            "file-uploader",
                            "file-uploads",
                            "files",
                            "hacktoberfest",
                            "instagram",
                            "javascript",
                            "mit",
                            "modular",
                            "open-source",
                            "pick-files",
                            "resumable",
                            "transloadit",
                            "tus",
                            "uploader",
                            "uppy",
                            "webbrowser"
                        ],
                        "visibility": "public",
                        "forks": 1934,
                        "open_issues": 168,
                        "watchers": 27487,
                        "default_branch": "main"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734"
                    },
                    "html": {
                        "href": "https://github.com/transloadit/uppy/pull/4734"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/transloadit/uppy/issues/4734"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/transloadit/uppy/issues/4734/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4734/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/transloadit/uppy/statuses/a0501a940e732891215297aecf2613c847fbdc24"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T10:00:47Z",
        "org": {
            "id": 125754,
            "login": "transloadit",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/transloadit",
            "avatar_url": "https://avatars.githubusercontent.com/u/125754?"
        }
    },
    {
        "id": "32863064950",
        "type": "WatchEvent",
        "actor": {
            "id": 17173951,
            "login": "henrysachs",
            "display_login": "henrysachs",
            "gravatar_id": "",
            "url": "https://api.github.com/users/henrysachs",
            "avatar_url": "https://avatars.githubusercontent.com/u/17173951?"
        },
        "repo": {
            "id": 46273445,
            "name": "transloadit/uppy",
            "url": "https://api.github.com/repos/transloadit/uppy"
        },
        "payload": {
            "action": "started"
        },
        "public": true,
        "created_at": "2023-10-26T09:43:27Z",
        "org": {
            "id": 125754,
            "login": "transloadit",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/transloadit",
            "avatar_url": "https://avatars.githubusercontent.com/u/125754?"
        }
    },
    {
        "id": "32861742571",
        "type": "WatchEvent",
        "actor": {
            "id": 91365763,
            "login": "Sevichecc",
            "display_login": "Sevichecc",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Sevichecc",
            "avatar_url": "https://avatars.githubusercontent.com/u/91365763?"
        },
        "repo": {
            "id": 46273445,
            "name": "transloadit/uppy",
            "url": "https://api.github.com/repos/transloadit/uppy"
        },
        "payload": {
            "action": "started"
        },
        "public": true,
        "created_at": "2023-10-26T08:59:19Z",
        "org": {
            "id": 125754,
            "login": "transloadit",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/transloadit",
            "avatar_url": "https://avatars.githubusercontent.com/u/125754?"
        }
    },
    {
        "id": "32859557972",
        "type": "PullRequestReviewCommentEvent",
        "actor": {
            "id": 402547,
            "login": "mifi",
            "display_login": "mifi",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mifi",
            "avatar_url": "https://avatars.githubusercontent.com/u/402547?"
        },
        "repo": {
            "id": 46273445,
            "name": "transloadit/uppy",
            "url": "https://api.github.com/repos/transloadit/uppy"
        },
        "payload": {
            "action": "created",
            "comment": {
                "url": "https://api.github.com/repos/transloadit/uppy/pulls/comments/1372727478",
                "pull_request_review_id": 1698928677,
                "id": 1372727478,
                "node_id": "PRRC_kwDOAsITpc5R0ii2",
                "diff_hunk": "@@ -111,7 +111,7 @@ export default class Provider extends RequestClient {\n       const authWindow = window.open(link, '_blank')\n       const handleToken = (e) => {\n         if (e.source !== authWindow) {\n-          this.uppy.log.warn('ignoring event from unknown source', e)\n+          this.uppy.log(`ignoring event from unknown source ${JSON.stringify(e.data)}`, 'warning')",
                "path": "packages/@uppy/companion-client/src/Provider.js",
                "commit_id": "c5d0f6f813dccbcff9693d66b9f93564a62e0e9b",
                "original_commit_id": "c5d0f6f813dccbcff9693d66b9f93564a62e0e9b",
                "user": {
                    "login": "mifi",
                    "id": 402547,
                    "node_id": "MDQ6VXNlcjQwMjU0Nw==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/402547?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/mifi",
                    "html_url": "https://github.com/mifi",
                    "followers_url": "https://api.github.com/users/mifi/followers",
                    "following_url": "https://api.github.com/users/mifi/following{/other_user}",
                    "gists_url": "https://api.github.com/users/mifi/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/mifi/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/mifi/subscriptions",
                    "organizations_url": "https://api.github.com/users/mifi/orgs",
                    "repos_url": "https://api.github.com/users/mifi/repos",
                    "events_url": "https://api.github.com/users/mifi/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/mifi/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "Btw we should really improve our uppy logger so that it can take an arbitrary number of arguments, each either objects, errors or strings. Then we don\u2019t have to manually do these things like json stringify when logging",
                "created_at": "2023-10-26T07:41:59Z",
                "updated_at": "2023-10-26T07:41:59Z",
                "html_url": "https://github.com/transloadit/uppy/pull/4766#discussion_r1372727478",
                "pull_request_url": "https://api.github.com/repos/transloadit/uppy/pulls/4766",
                "author_association": "CONTRIBUTOR",
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/comments/1372727478"
                    },
                    "html": {
                        "href": "https://github.com/transloadit/uppy/pull/4766#discussion_r1372727478"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4766"
                    }
                },
                "reactions": {
                    "url": "https://api.github.com/repos/transloadit/uppy/pulls/comments/1372727478/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "start_line": null,
                "original_start_line": null,
                "start_side": null,
                "line": 114,
                "original_line": 114,
                "side": "RIGHT",
                "in_reply_to_id": 1371972362,
                "original_position": 5,
                "position": 5,
                "subject_type": "line"
            },
            "pull_request": {
                "url": "https://api.github.com/repos/transloadit/uppy/pulls/4766",
                "id": 1573159986,
                "node_id": "PR_kwDOAsITpc5dxIQy",
                "html_url": "https://github.com/transloadit/uppy/pull/4766",
                "diff_url": "https://github.com/transloadit/uppy/pull/4766.diff",
                "patch_url": "https://github.com/transloadit/uppy/pull/4766.patch",
                "issue_url": "https://api.github.com/repos/transloadit/uppy/issues/4766",
                "number": 4766,
                "state": "open",
                "locked": false,
                "title": "@uppy/companion-client: fix log type error",
                "user": {
                    "login": "mifi",
                    "id": 402547,
                    "node_id": "MDQ6VXNlcjQwMjU0Nw==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/402547?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/mifi",
                    "html_url": "https://github.com/mifi",
                    "followers_url": "https://api.github.com/users/mifi/followers",
                    "following_url": "https://api.github.com/users/mifi/following{/other_user}",
                    "gists_url": "https://api.github.com/users/mifi/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/mifi/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/mifi/subscriptions",
                    "organizations_url": "https://api.github.com/users/mifi/orgs",
                    "repos_url": "https://api.github.com/users/mifi/repos",
                    "events_url": "https://api.github.com/users/mifi/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/mifi/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "fixes `this.uppy.log.warn is not a function`",
                "created_at": "2023-10-25T15:10:50Z",
                "updated_at": "2023-10-26T07:41:59Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "6629f42a35b3ff9282bcdf9004fd13beb2dd7f96",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/transloadit/uppy/pulls/4766/commits",
                "review_comments_url": "https://api.github.com/repos/transloadit/uppy/pulls/4766/comments",
                "review_comment_url": "https://api.github.com/repos/transloadit/uppy/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/transloadit/uppy/issues/4766/comments",
                "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/c5d0f6f813dccbcff9693d66b9f93564a62e0e9b",
                "head": {
                    "label": "transloadit:fix-logging-bug",
                    "ref": "fix-logging-bug",
                    "sha": "c5d0f6f813dccbcff9693d66b9f93564a62e0e9b",
                    "user": {
                        "login": "transloadit",
                        "id": 125754,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/transloadit",
                        "html_url": "https://github.com/transloadit",
                        "followers_url": "https://api.github.com/users/transloadit/followers",
                        "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                        "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                        "organizations_url": "https://api.github.com/users/transloadit/orgs",
                        "repos_url": "https://api.github.com/users/transloadit/repos",
                        "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/transloadit/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 46273445,
                        "node_id": "MDEwOlJlcG9zaXRvcnk0NjI3MzQ0NQ==",
                        "name": "uppy",
                        "full_name": "transloadit/uppy",
                        "private": false,
                        "owner": {
                            "login": "transloadit",
                            "id": 125754,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/transloadit",
                            "html_url": "https://github.com/transloadit",
                            "followers_url": "https://api.github.com/users/transloadit/followers",
                            "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                            "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                            "organizations_url": "https://api.github.com/users/transloadit/orgs",
                            "repos_url": "https://api.github.com/users/transloadit/repos",
                            "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/transloadit/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/transloadit/uppy",
                        "description": "The next open source file uploader for web browsers :dog: ",
                        "fork": false,
                        "url": "https://api.github.com/repos/transloadit/uppy",
                        "forks_url": "https://api.github.com/repos/transloadit/uppy/forks",
                        "keys_url": "https://api.github.com/repos/transloadit/uppy/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/transloadit/uppy/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/transloadit/uppy/teams",
                        "hooks_url": "https://api.github.com/repos/transloadit/uppy/hooks",
                        "issue_events_url": "https://api.github.com/repos/transloadit/uppy/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/transloadit/uppy/events",
                        "assignees_url": "https://api.github.com/repos/transloadit/uppy/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/transloadit/uppy/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/transloadit/uppy/tags",
                        "blobs_url": "https://api.github.com/repos/transloadit/uppy/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/transloadit/uppy/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/transloadit/uppy/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/transloadit/uppy/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/transloadit/uppy/languages",
                        "stargazers_url": "https://api.github.com/repos/transloadit/uppy/stargazers",
                        "contributors_url": "https://api.github.com/repos/transloadit/uppy/contributors",
                        "subscribers_url": "https://api.github.com/repos/transloadit/uppy/subscribers",
                        "subscription_url": "https://api.github.com/repos/transloadit/uppy/subscription",
                        "commits_url": "https://api.github.com/repos/transloadit/uppy/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/transloadit/uppy/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/transloadit/uppy/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/transloadit/uppy/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/transloadit/uppy/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/transloadit/uppy/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/transloadit/uppy/merges",
                        "archive_url": "https://api.github.com/repos/transloadit/uppy/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/transloadit/uppy/downloads",
                        "issues_url": "https://api.github.com/repos/transloadit/uppy/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/transloadit/uppy/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/transloadit/uppy/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/transloadit/uppy/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/transloadit/uppy/labels{/name}",
                        "releases_url": "https://api.github.com/repos/transloadit/uppy/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/transloadit/uppy/deployments",
                        "created_at": "2015-11-16T12:32:33Z",
                        "updated_at": "2023-10-26T07:17:22Z",
                        "pushed_at": "2023-10-25T15:17:29Z",
                        "git_url": "git://github.com/transloadit/uppy.git",
                        "ssh_url": "git@github.com:transloadit/uppy.git",
                        "clone_url": "https://github.com/transloadit/uppy.git",
                        "svn_url": "https://github.com/transloadit/uppy",
                        "homepage": "https://uppy.io",
                        "size": 389980,
                        "stargazers_count": 27486,
                        "watchers_count": 27486,
                        "language": "JavaScript",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": true,
                        "has_discussions": false,
                        "forks_count": 1934,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 168,
                        "license": {
                            "key": "mit",
                            "name": "MIT License",
                            "spdx_id": "MIT",
                            "url": "https://api.github.com/licenses/mit",
                            "node_id": "MDc6TGljZW5zZTEz"
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "dropbox",
                            "encoding",
                            "file-uploader",
                            "file-uploads",
                            "files",
                            "hacktoberfest",
                            "instagram",
                            "javascript",
                            "mit",
                            "modular",
                            "open-source",
                            "pick-files",
                            "resumable",
                            "transloadit",
                            "tus",
                            "uploader",
                            "uppy",
                            "webbrowser"
                        ],
                        "visibility": "public",
                        "forks": 1934,
                        "open_issues": 168,
                        "watchers": 27486,
                        "default_branch": "main"
                    }
                },
                "base": {
                    "label": "transloadit:main",
                    "ref": "main",
                    "sha": "12e08ada02b9080bd5e1d19526bdf8a2010e62a1",
                    "user": {
                        "login": "transloadit",
                        "id": 125754,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/transloadit",
                        "html_url": "https://github.com/transloadit",
                        "followers_url": "https://api.github.com/users/transloadit/followers",
                        "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                        "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                        "organizations_url": "https://api.github.com/users/transloadit/orgs",
                        "repos_url": "https://api.github.com/users/transloadit/repos",
                        "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/transloadit/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 46273445,
                        "node_id": "MDEwOlJlcG9zaXRvcnk0NjI3MzQ0NQ==",
                        "name": "uppy",
                        "full_name": "transloadit/uppy",
                        "private": false,
                        "owner": {
                            "login": "transloadit",
                            "id": 125754,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/transloadit",
                            "html_url": "https://github.com/transloadit",
                            "followers_url": "https://api.github.com/users/transloadit/followers",
                            "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                            "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                            "organizations_url": "https://api.github.com/users/transloadit/orgs",
                            "repos_url": "https://api.github.com/users/transloadit/repos",
                            "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/transloadit/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/transloadit/uppy",
                        "description": "The next open source file uploader for web browsers :dog: ",
                        "fork": false,
                        "url": "https://api.github.com/repos/transloadit/uppy",
                        "forks_url": "https://api.github.com/repos/transloadit/uppy/forks",
                        "keys_url": "https://api.github.com/repos/transloadit/uppy/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/transloadit/uppy/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/transloadit/uppy/teams",
                        "hooks_url": "https://api.github.com/repos/transloadit/uppy/hooks",
                        "issue_events_url": "https://api.github.com/repos/transloadit/uppy/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/transloadit/uppy/events",
                        "assignees_url": "https://api.github.com/repos/transloadit/uppy/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/transloadit/uppy/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/transloadit/uppy/tags",
                        "blobs_url": "https://api.github.com/repos/transloadit/uppy/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/transloadit/uppy/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/transloadit/uppy/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/transloadit/uppy/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/transloadit/uppy/languages",
                        "stargazers_url": "https://api.github.com/repos/transloadit/uppy/stargazers",
                        "contributors_url": "https://api.github.com/repos/transloadit/uppy/contributors",
                        "subscribers_url": "https://api.github.com/repos/transloadit/uppy/subscribers",
                        "subscription_url": "https://api.github.com/repos/transloadit/uppy/subscription",
                        "commits_url": "https://api.github.com/repos/transloadit/uppy/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/transloadit/uppy/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/transloadit/uppy/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/transloadit/uppy/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/transloadit/uppy/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/transloadit/uppy/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/transloadit/uppy/merges",
                        "archive_url": "https://api.github.com/repos/transloadit/uppy/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/transloadit/uppy/downloads",
                        "issues_url": "https://api.github.com/repos/transloadit/uppy/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/transloadit/uppy/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/transloadit/uppy/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/transloadit/uppy/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/transloadit/uppy/labels{/name}",
                        "releases_url": "https://api.github.com/repos/transloadit/uppy/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/transloadit/uppy/deployments",
                        "created_at": "2015-11-16T12:32:33Z",
                        "updated_at": "2023-10-26T07:17:22Z",
                        "pushed_at": "2023-10-25T15:17:29Z",
                        "git_url": "git://github.com/transloadit/uppy.git",
                        "ssh_url": "git@github.com:transloadit/uppy.git",
                        "clone_url": "https://github.com/transloadit/uppy.git",
                        "svn_url": "https://github.com/transloadit/uppy",
                        "homepage": "https://uppy.io",
                        "size": 389980,
                        "stargazers_count": 27486,
                        "watchers_count": 27486,
                        "language": "JavaScript",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": true,
                        "has_discussions": false,
                        "forks_count": 1934,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 168,
                        "license": {
                            "key": "mit",
                            "name": "MIT License",
                            "spdx_id": "MIT",
                            "url": "https://api.github.com/licenses/mit",
                            "node_id": "MDc6TGljZW5zZTEz"
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "dropbox",
                            "encoding",
                            "file-uploader",
                            "file-uploads",
                            "files",
                            "hacktoberfest",
                            "instagram",
                            "javascript",
                            "mit",
                            "modular",
                            "open-source",
                            "pick-files",
                            "resumable",
                            "transloadit",
                            "tus",
                            "uploader",
                            "uppy",
                            "webbrowser"
                        ],
                        "visibility": "public",
                        "forks": 1934,
                        "open_issues": 168,
                        "watchers": 27486,
                        "default_branch": "main"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4766"
                    },
                    "html": {
                        "href": "https://github.com/transloadit/uppy/pull/4766"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/transloadit/uppy/issues/4766"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/transloadit/uppy/issues/4766/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4766/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4766/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/transloadit/uppy/statuses/c5d0f6f813dccbcff9693d66b9f93564a62e0e9b"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T07:41:59Z",
        "org": {
            "id": 125754,
            "login": "transloadit",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/transloadit",
            "avatar_url": "https://avatars.githubusercontent.com/u/125754?"
        }
    },
    {
        "id": "32859557905",
        "type": "PullRequestReviewEvent",
        "actor": {
            "id": 402547,
            "login": "mifi",
            "display_login": "mifi",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mifi",
            "avatar_url": "https://avatars.githubusercontent.com/u/402547?"
        },
        "repo": {
            "id": 46273445,
            "name": "transloadit/uppy",
            "url": "https://api.github.com/repos/transloadit/uppy"
        },
        "payload": {
            "action": "created",
            "review": {
                "id": 1698928677,
                "node_id": "PRR_kwDOAsITpc5lQ5gl",
                "user": {
                    "login": "mifi",
                    "id": 402547,
                    "node_id": "MDQ6VXNlcjQwMjU0Nw==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/402547?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/mifi",
                    "html_url": "https://github.com/mifi",
                    "followers_url": "https://api.github.com/users/mifi/followers",
                    "following_url": "https://api.github.com/users/mifi/following{/other_user}",
                    "gists_url": "https://api.github.com/users/mifi/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/mifi/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/mifi/subscriptions",
                    "organizations_url": "https://api.github.com/users/mifi/orgs",
                    "repos_url": "https://api.github.com/users/mifi/repos",
                    "events_url": "https://api.github.com/users/mifi/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/mifi/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": null,
                "commit_id": "c5d0f6f813dccbcff9693d66b9f93564a62e0e9b",
                "submitted_at": "2023-10-26T07:41:59Z",
                "state": "commented",
                "html_url": "https://github.com/transloadit/uppy/pull/4766#pullrequestreview-1698928677",
                "pull_request_url": "https://api.github.com/repos/transloadit/uppy/pulls/4766",
                "author_association": "CONTRIBUTOR",
                "_links": {
                    "html": {
                        "href": "https://github.com/transloadit/uppy/pull/4766#pullrequestreview-1698928677"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4766"
                    }
                }
            },
            "pull_request": {
                "url": "https://api.github.com/repos/transloadit/uppy/pulls/4766",
                "id": 1573159986,
                "node_id": "PR_kwDOAsITpc5dxIQy",
                "html_url": "https://github.com/transloadit/uppy/pull/4766",
                "diff_url": "https://github.com/transloadit/uppy/pull/4766.diff",
                "patch_url": "https://github.com/transloadit/uppy/pull/4766.patch",
                "issue_url": "https://api.github.com/repos/transloadit/uppy/issues/4766",
                "number": 4766,
                "state": "open",
                "locked": false,
                "title": "@uppy/companion-client: fix log type error",
                "user": {
                    "login": "mifi",
                    "id": 402547,
                    "node_id": "MDQ6VXNlcjQwMjU0Nw==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/402547?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/mifi",
                    "html_url": "https://github.com/mifi",
                    "followers_url": "https://api.github.com/users/mifi/followers",
                    "following_url": "https://api.github.com/users/mifi/following{/other_user}",
                    "gists_url": "https://api.github.com/users/mifi/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/mifi/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/mifi/subscriptions",
                    "organizations_url": "https://api.github.com/users/mifi/orgs",
                    "repos_url": "https://api.github.com/users/mifi/repos",
                    "events_url": "https://api.github.com/users/mifi/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/mifi/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "fixes `this.uppy.log.warn is not a function`",
                "created_at": "2023-10-25T15:10:50Z",
                "updated_at": "2023-10-26T07:41:59Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "6629f42a35b3ff9282bcdf9004fd13beb2dd7f96",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/transloadit/uppy/pulls/4766/commits",
                "review_comments_url": "https://api.github.com/repos/transloadit/uppy/pulls/4766/comments",
                "review_comment_url": "https://api.github.com/repos/transloadit/uppy/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/transloadit/uppy/issues/4766/comments",
                "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/c5d0f6f813dccbcff9693d66b9f93564a62e0e9b",
                "head": {
                    "label": "transloadit:fix-logging-bug",
                    "ref": "fix-logging-bug",
                    "sha": "c5d0f6f813dccbcff9693d66b9f93564a62e0e9b",
                    "user": {
                        "login": "transloadit",
                        "id": 125754,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/transloadit",
                        "html_url": "https://github.com/transloadit",
                        "followers_url": "https://api.github.com/users/transloadit/followers",
                        "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                        "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                        "organizations_url": "https://api.github.com/users/transloadit/orgs",
                        "repos_url": "https://api.github.com/users/transloadit/repos",
                        "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/transloadit/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 46273445,
                        "node_id": "MDEwOlJlcG9zaXRvcnk0NjI3MzQ0NQ==",
                        "name": "uppy",
                        "full_name": "transloadit/uppy",
                        "private": false,
                        "owner": {
                            "login": "transloadit",
                            "id": 125754,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/transloadit",
                            "html_url": "https://github.com/transloadit",
                            "followers_url": "https://api.github.com/users/transloadit/followers",
                            "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                            "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                            "organizations_url": "https://api.github.com/users/transloadit/orgs",
                            "repos_url": "https://api.github.com/users/transloadit/repos",
                            "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/transloadit/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/transloadit/uppy",
                        "description": "The next open source file uploader for web browsers :dog: ",
                        "fork": false,
                        "url": "https://api.github.com/repos/transloadit/uppy",
                        "forks_url": "https://api.github.com/repos/transloadit/uppy/forks",
                        "keys_url": "https://api.github.com/repos/transloadit/uppy/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/transloadit/uppy/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/transloadit/uppy/teams",
                        "hooks_url": "https://api.github.com/repos/transloadit/uppy/hooks",
                        "issue_events_url": "https://api.github.com/repos/transloadit/uppy/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/transloadit/uppy/events",
                        "assignees_url": "https://api.github.com/repos/transloadit/uppy/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/transloadit/uppy/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/transloadit/uppy/tags",
                        "blobs_url": "https://api.github.com/repos/transloadit/uppy/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/transloadit/uppy/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/transloadit/uppy/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/transloadit/uppy/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/transloadit/uppy/languages",
                        "stargazers_url": "https://api.github.com/repos/transloadit/uppy/stargazers",
                        "contributors_url": "https://api.github.com/repos/transloadit/uppy/contributors",
                        "subscribers_url": "https://api.github.com/repos/transloadit/uppy/subscribers",
                        "subscription_url": "https://api.github.com/repos/transloadit/uppy/subscription",
                        "commits_url": "https://api.github.com/repos/transloadit/uppy/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/transloadit/uppy/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/transloadit/uppy/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/transloadit/uppy/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/transloadit/uppy/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/transloadit/uppy/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/transloadit/uppy/merges",
                        "archive_url": "https://api.github.com/repos/transloadit/uppy/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/transloadit/uppy/downloads",
                        "issues_url": "https://api.github.com/repos/transloadit/uppy/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/transloadit/uppy/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/transloadit/uppy/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/transloadit/uppy/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/transloadit/uppy/labels{/name}",
                        "releases_url": "https://api.github.com/repos/transloadit/uppy/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/transloadit/uppy/deployments",
                        "created_at": "2015-11-16T12:32:33Z",
                        "updated_at": "2023-10-26T07:17:22Z",
                        "pushed_at": "2023-10-25T15:17:29Z",
                        "git_url": "git://github.com/transloadit/uppy.git",
                        "ssh_url": "git@github.com:transloadit/uppy.git",
                        "clone_url": "https://github.com/transloadit/uppy.git",
                        "svn_url": "https://github.com/transloadit/uppy",
                        "homepage": "https://uppy.io",
                        "size": 389980,
                        "stargazers_count": 27486,
                        "watchers_count": 27486,
                        "language": "JavaScript",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": true,
                        "has_discussions": false,
                        "forks_count": 1934,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 168,
                        "license": {
                            "key": "mit",
                            "name": "MIT License",
                            "spdx_id": "MIT",
                            "url": "https://api.github.com/licenses/mit",
                            "node_id": "MDc6TGljZW5zZTEz"
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "dropbox",
                            "encoding",
                            "file-uploader",
                            "file-uploads",
                            "files",
                            "hacktoberfest",
                            "instagram",
                            "javascript",
                            "mit",
                            "modular",
                            "open-source",
                            "pick-files",
                            "resumable",
                            "transloadit",
                            "tus",
                            "uploader",
                            "uppy",
                            "webbrowser"
                        ],
                        "visibility": "public",
                        "forks": 1934,
                        "open_issues": 168,
                        "watchers": 27486,
                        "default_branch": "main"
                    }
                },
                "base": {
                    "label": "transloadit:main",
                    "ref": "main",
                    "sha": "12e08ada02b9080bd5e1d19526bdf8a2010e62a1",
                    "user": {
                        "login": "transloadit",
                        "id": 125754,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/transloadit",
                        "html_url": "https://github.com/transloadit",
                        "followers_url": "https://api.github.com/users/transloadit/followers",
                        "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                        "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                        "organizations_url": "https://api.github.com/users/transloadit/orgs",
                        "repos_url": "https://api.github.com/users/transloadit/repos",
                        "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/transloadit/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 46273445,
                        "node_id": "MDEwOlJlcG9zaXRvcnk0NjI3MzQ0NQ==",
                        "name": "uppy",
                        "full_name": "transloadit/uppy",
                        "private": false,
                        "owner": {
                            "login": "transloadit",
                            "id": 125754,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/transloadit",
                            "html_url": "https://github.com/transloadit",
                            "followers_url": "https://api.github.com/users/transloadit/followers",
                            "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                            "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                            "organizations_url": "https://api.github.com/users/transloadit/orgs",
                            "repos_url": "https://api.github.com/users/transloadit/repos",
                            "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/transloadit/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/transloadit/uppy",
                        "description": "The next open source file uploader for web browsers :dog: ",
                        "fork": false,
                        "url": "https://api.github.com/repos/transloadit/uppy",
                        "forks_url": "https://api.github.com/repos/transloadit/uppy/forks",
                        "keys_url": "https://api.github.com/repos/transloadit/uppy/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/transloadit/uppy/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/transloadit/uppy/teams",
                        "hooks_url": "https://api.github.com/repos/transloadit/uppy/hooks",
                        "issue_events_url": "https://api.github.com/repos/transloadit/uppy/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/transloadit/uppy/events",
                        "assignees_url": "https://api.github.com/repos/transloadit/uppy/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/transloadit/uppy/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/transloadit/uppy/tags",
                        "blobs_url": "https://api.github.com/repos/transloadit/uppy/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/transloadit/uppy/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/transloadit/uppy/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/transloadit/uppy/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/transloadit/uppy/languages",
                        "stargazers_url": "https://api.github.com/repos/transloadit/uppy/stargazers",
                        "contributors_url": "https://api.github.com/repos/transloadit/uppy/contributors",
                        "subscribers_url": "https://api.github.com/repos/transloadit/uppy/subscribers",
                        "subscription_url": "https://api.github.com/repos/transloadit/uppy/subscription",
                        "commits_url": "https://api.github.com/repos/transloadit/uppy/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/transloadit/uppy/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/transloadit/uppy/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/transloadit/uppy/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/transloadit/uppy/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/transloadit/uppy/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/transloadit/uppy/merges",
                        "archive_url": "https://api.github.com/repos/transloadit/uppy/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/transloadit/uppy/downloads",
                        "issues_url": "https://api.github.com/repos/transloadit/uppy/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/transloadit/uppy/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/transloadit/uppy/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/transloadit/uppy/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/transloadit/uppy/labels{/name}",
                        "releases_url": "https://api.github.com/repos/transloadit/uppy/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/transloadit/uppy/deployments",
                        "created_at": "2015-11-16T12:32:33Z",
                        "updated_at": "2023-10-26T07:17:22Z",
                        "pushed_at": "2023-10-25T15:17:29Z",
                        "git_url": "git://github.com/transloadit/uppy.git",
                        "ssh_url": "git@github.com:transloadit/uppy.git",
                        "clone_url": "https://github.com/transloadit/uppy.git",
                        "svn_url": "https://github.com/transloadit/uppy",
                        "homepage": "https://uppy.io",
                        "size": 389980,
                        "stargazers_count": 27486,
                        "watchers_count": 27486,
                        "language": "JavaScript",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": true,
                        "has_discussions": false,
                        "forks_count": 1934,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 168,
                        "license": {
                            "key": "mit",
                            "name": "MIT License",
                            "spdx_id": "MIT",
                            "url": "https://api.github.com/licenses/mit",
                            "node_id": "MDc6TGljZW5zZTEz"
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "dropbox",
                            "encoding",
                            "file-uploader",
                            "file-uploads",
                            "files",
                            "hacktoberfest",
                            "instagram",
                            "javascript",
                            "mit",
                            "modular",
                            "open-source",
                            "pick-files",
                            "resumable",
                            "transloadit",
                            "tus",
                            "uploader",
                            "uppy",
                            "webbrowser"
                        ],
                        "visibility": "public",
                        "forks": 1934,
                        "open_issues": 168,
                        "watchers": 27486,
                        "default_branch": "main"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4766"
                    },
                    "html": {
                        "href": "https://github.com/transloadit/uppy/pull/4766"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/transloadit/uppy/issues/4766"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/transloadit/uppy/issues/4766/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4766/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4766/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/transloadit/uppy/statuses/c5d0f6f813dccbcff9693d66b9f93564a62e0e9b"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T07:42:00Z",
        "org": {
            "id": 125754,
            "login": "transloadit",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/transloadit",
            "avatar_url": "https://avatars.githubusercontent.com/u/125754?"
        }
    },
    {
        "id": "32859438209",
        "type": "PullRequestReviewCommentEvent",
        "actor": {
            "id": 402547,
            "login": "mifi",
            "display_login": "mifi",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mifi",
            "avatar_url": "https://avatars.githubusercontent.com/u/402547?"
        },
        "repo": {
            "id": 46273445,
            "name": "transloadit/uppy",
            "url": "https://api.github.com/repos/transloadit/uppy"
        },
        "payload": {
            "action": "created",
            "comment": {
                "url": "https://api.github.com/repos/transloadit/uppy/pulls/comments/1372721934",
                "pull_request_review_id": 1698920655,
                "id": 1372721934,
                "node_id": "PRRC_kwDOAsITpc5R0hMO",
                "diff_hunk": "@@ -111,7 +111,7 @@ export default class Provider extends RequestClient {\n       const authWindow = window.open(link, '_blank')\n       const handleToken = (e) => {\n         if (e.source !== authWindow) {\n-          this.uppy.log.warn('ignoring event from unknown source', e)\n+          this.uppy.log(`ignoring event from unknown source ${JSON.stringify(e.data)}`, 'warning')",
                "path": "packages/@uppy/companion-client/src/Provider.js",
                "commit_id": "c5d0f6f813dccbcff9693d66b9f93564a62e0e9b",
                "original_commit_id": "c5d0f6f813dccbcff9693d66b9f93564a62e0e9b",
                "user": {
                    "login": "mifi",
                    "id": 402547,
                    "node_id": "MDQ6VXNlcjQwMjU0Nw==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/402547?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/mifi",
                    "html_url": "https://github.com/mifi",
                    "followers_url": "https://api.github.com/users/mifi/followers",
                    "following_url": "https://api.github.com/users/mifi/following{/other_user}",
                    "gists_url": "https://api.github.com/users/mifi/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/mifi/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/mifi/subscriptions",
                    "organizations_url": "https://api.github.com/users/mifi/orgs",
                    "repos_url": "https://api.github.com/users/mifi/repos",
                    "events_url": "https://api.github.com/users/mifi/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/mifi/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "I dont think that\u2019s going to help at all, because most things that are falsy will not cause JSON.stringify to fail afaik. What could make it fail however is circular references or BigInts anywhere in the tree",
                "created_at": "2023-10-26T07:37:17Z",
                "updated_at": "2023-10-26T07:37:17Z",
                "html_url": "https://github.com/transloadit/uppy/pull/4766#discussion_r1372721934",
                "pull_request_url": "https://api.github.com/repos/transloadit/uppy/pulls/4766",
                "author_association": "CONTRIBUTOR",
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/comments/1372721934"
                    },
                    "html": {
                        "href": "https://github.com/transloadit/uppy/pull/4766#discussion_r1372721934"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4766"
                    }
                },
                "reactions": {
                    "url": "https://api.github.com/repos/transloadit/uppy/pulls/comments/1372721934/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "start_line": null,
                "original_start_line": null,
                "start_side": null,
                "line": 114,
                "original_line": 114,
                "side": "RIGHT",
                "in_reply_to_id": 1371972362,
                "original_position": 5,
                "position": 5,
                "subject_type": "line"
            },
            "pull_request": {
                "url": "https://api.github.com/repos/transloadit/uppy/pulls/4766",
                "id": 1573159986,
                "node_id": "PR_kwDOAsITpc5dxIQy",
                "html_url": "https://github.com/transloadit/uppy/pull/4766",
                "diff_url": "https://github.com/transloadit/uppy/pull/4766.diff",
                "patch_url": "https://github.com/transloadit/uppy/pull/4766.patch",
                "issue_url": "https://api.github.com/repos/transloadit/uppy/issues/4766",
                "number": 4766,
                "state": "open",
                "locked": false,
                "title": "@uppy/companion-client: fix log type error",
                "user": {
                    "login": "mifi",
                    "id": 402547,
                    "node_id": "MDQ6VXNlcjQwMjU0Nw==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/402547?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/mifi",
                    "html_url": "https://github.com/mifi",
                    "followers_url": "https://api.github.com/users/mifi/followers",
                    "following_url": "https://api.github.com/users/mifi/following{/other_user}",
                    "gists_url": "https://api.github.com/users/mifi/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/mifi/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/mifi/subscriptions",
                    "organizations_url": "https://api.github.com/users/mifi/orgs",
                    "repos_url": "https://api.github.com/users/mifi/repos",
                    "events_url": "https://api.github.com/users/mifi/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/mifi/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "fixes `this.uppy.log.warn is not a function`",
                "created_at": "2023-10-25T15:10:50Z",
                "updated_at": "2023-10-26T07:37:17Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "6629f42a35b3ff9282bcdf9004fd13beb2dd7f96",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/transloadit/uppy/pulls/4766/commits",
                "review_comments_url": "https://api.github.com/repos/transloadit/uppy/pulls/4766/comments",
                "review_comment_url": "https://api.github.com/repos/transloadit/uppy/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/transloadit/uppy/issues/4766/comments",
                "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/c5d0f6f813dccbcff9693d66b9f93564a62e0e9b",
                "head": {
                    "label": "transloadit:fix-logging-bug",
                    "ref": "fix-logging-bug",
                    "sha": "c5d0f6f813dccbcff9693d66b9f93564a62e0e9b",
                    "user": {
                        "login": "transloadit",
                        "id": 125754,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/transloadit",
                        "html_url": "https://github.com/transloadit",
                        "followers_url": "https://api.github.com/users/transloadit/followers",
                        "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                        "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                        "organizations_url": "https://api.github.com/users/transloadit/orgs",
                        "repos_url": "https://api.github.com/users/transloadit/repos",
                        "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/transloadit/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 46273445,
                        "node_id": "MDEwOlJlcG9zaXRvcnk0NjI3MzQ0NQ==",
                        "name": "uppy",
                        "full_name": "transloadit/uppy",
                        "private": false,
                        "owner": {
                            "login": "transloadit",
                            "id": 125754,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/transloadit",
                            "html_url": "https://github.com/transloadit",
                            "followers_url": "https://api.github.com/users/transloadit/followers",
                            "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                            "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                            "organizations_url": "https://api.github.com/users/transloadit/orgs",
                            "repos_url": "https://api.github.com/users/transloadit/repos",
                            "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/transloadit/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/transloadit/uppy",
                        "description": "The next open source file uploader for web browsers :dog: ",
                        "fork": false,
                        "url": "https://api.github.com/repos/transloadit/uppy",
                        "forks_url": "https://api.github.com/repos/transloadit/uppy/forks",
                        "keys_url": "https://api.github.com/repos/transloadit/uppy/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/transloadit/uppy/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/transloadit/uppy/teams",
                        "hooks_url": "https://api.github.com/repos/transloadit/uppy/hooks",
                        "issue_events_url": "https://api.github.com/repos/transloadit/uppy/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/transloadit/uppy/events",
                        "assignees_url": "https://api.github.com/repos/transloadit/uppy/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/transloadit/uppy/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/transloadit/uppy/tags",
                        "blobs_url": "https://api.github.com/repos/transloadit/uppy/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/transloadit/uppy/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/transloadit/uppy/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/transloadit/uppy/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/transloadit/uppy/languages",
                        "stargazers_url": "https://api.github.com/repos/transloadit/uppy/stargazers",
                        "contributors_url": "https://api.github.com/repos/transloadit/uppy/contributors",
                        "subscribers_url": "https://api.github.com/repos/transloadit/uppy/subscribers",
                        "subscription_url": "https://api.github.com/repos/transloadit/uppy/subscription",
                        "commits_url": "https://api.github.com/repos/transloadit/uppy/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/transloadit/uppy/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/transloadit/uppy/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/transloadit/uppy/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/transloadit/uppy/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/transloadit/uppy/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/transloadit/uppy/merges",
                        "archive_url": "https://api.github.com/repos/transloadit/uppy/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/transloadit/uppy/downloads",
                        "issues_url": "https://api.github.com/repos/transloadit/uppy/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/transloadit/uppy/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/transloadit/uppy/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/transloadit/uppy/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/transloadit/uppy/labels{/name}",
                        "releases_url": "https://api.github.com/repos/transloadit/uppy/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/transloadit/uppy/deployments",
                        "created_at": "2015-11-16T12:32:33Z",
                        "updated_at": "2023-10-26T07:17:22Z",
                        "pushed_at": "2023-10-25T15:17:29Z",
                        "git_url": "git://github.com/transloadit/uppy.git",
                        "ssh_url": "git@github.com:transloadit/uppy.git",
                        "clone_url": "https://github.com/transloadit/uppy.git",
                        "svn_url": "https://github.com/transloadit/uppy",
                        "homepage": "https://uppy.io",
                        "size": 389980,
                        "stargazers_count": 27486,
                        "watchers_count": 27486,
                        "language": "JavaScript",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": true,
                        "has_discussions": false,
                        "forks_count": 1934,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 168,
                        "license": {
                            "key": "mit",
                            "name": "MIT License",
                            "spdx_id": "MIT",
                            "url": "https://api.github.com/licenses/mit",
                            "node_id": "MDc6TGljZW5zZTEz"
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "dropbox",
                            "encoding",
                            "file-uploader",
                            "file-uploads",
                            "files",
                            "hacktoberfest",
                            "instagram",
                            "javascript",
                            "mit",
                            "modular",
                            "open-source",
                            "pick-files",
                            "resumable",
                            "transloadit",
                            "tus",
                            "uploader",
                            "uppy",
                            "webbrowser"
                        ],
                        "visibility": "public",
                        "forks": 1934,
                        "open_issues": 168,
                        "watchers": 27486,
                        "default_branch": "main"
                    }
                },
                "base": {
                    "label": "transloadit:main",
                    "ref": "main",
                    "sha": "12e08ada02b9080bd5e1d19526bdf8a2010e62a1",
                    "user": {
                        "login": "transloadit",
                        "id": 125754,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/transloadit",
                        "html_url": "https://github.com/transloadit",
                        "followers_url": "https://api.github.com/users/transloadit/followers",
                        "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                        "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                        "organizations_url": "https://api.github.com/users/transloadit/orgs",
                        "repos_url": "https://api.github.com/users/transloadit/repos",
                        "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/transloadit/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 46273445,
                        "node_id": "MDEwOlJlcG9zaXRvcnk0NjI3MzQ0NQ==",
                        "name": "uppy",
                        "full_name": "transloadit/uppy",
                        "private": false,
                        "owner": {
                            "login": "transloadit",
                            "id": 125754,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/transloadit",
                            "html_url": "https://github.com/transloadit",
                            "followers_url": "https://api.github.com/users/transloadit/followers",
                            "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                            "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                            "organizations_url": "https://api.github.com/users/transloadit/orgs",
                            "repos_url": "https://api.github.com/users/transloadit/repos",
                            "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/transloadit/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/transloadit/uppy",
                        "description": "The next open source file uploader for web browsers :dog: ",
                        "fork": false,
                        "url": "https://api.github.com/repos/transloadit/uppy",
                        "forks_url": "https://api.github.com/repos/transloadit/uppy/forks",
                        "keys_url": "https://api.github.com/repos/transloadit/uppy/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/transloadit/uppy/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/transloadit/uppy/teams",
                        "hooks_url": "https://api.github.com/repos/transloadit/uppy/hooks",
                        "issue_events_url": "https://api.github.com/repos/transloadit/uppy/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/transloadit/uppy/events",
                        "assignees_url": "https://api.github.com/repos/transloadit/uppy/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/transloadit/uppy/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/transloadit/uppy/tags",
                        "blobs_url": "https://api.github.com/repos/transloadit/uppy/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/transloadit/uppy/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/transloadit/uppy/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/transloadit/uppy/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/transloadit/uppy/languages",
                        "stargazers_url": "https://api.github.com/repos/transloadit/uppy/stargazers",
                        "contributors_url": "https://api.github.com/repos/transloadit/uppy/contributors",
                        "subscribers_url": "https://api.github.com/repos/transloadit/uppy/subscribers",
                        "subscription_url": "https://api.github.com/repos/transloadit/uppy/subscription",
                        "commits_url": "https://api.github.com/repos/transloadit/uppy/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/transloadit/uppy/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/transloadit/uppy/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/transloadit/uppy/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/transloadit/uppy/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/transloadit/uppy/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/transloadit/uppy/merges",
                        "archive_url": "https://api.github.com/repos/transloadit/uppy/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/transloadit/uppy/downloads",
                        "issues_url": "https://api.github.com/repos/transloadit/uppy/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/transloadit/uppy/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/transloadit/uppy/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/transloadit/uppy/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/transloadit/uppy/labels{/name}",
                        "releases_url": "https://api.github.com/repos/transloadit/uppy/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/transloadit/uppy/deployments",
                        "created_at": "2015-11-16T12:32:33Z",
                        "updated_at": "2023-10-26T07:17:22Z",
                        "pushed_at": "2023-10-25T15:17:29Z",
                        "git_url": "git://github.com/transloadit/uppy.git",
                        "ssh_url": "git@github.com:transloadit/uppy.git",
                        "clone_url": "https://github.com/transloadit/uppy.git",
                        "svn_url": "https://github.com/transloadit/uppy",
                        "homepage": "https://uppy.io",
                        "size": 389980,
                        "stargazers_count": 27486,
                        "watchers_count": 27486,
                        "language": "JavaScript",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": true,
                        "has_discussions": false,
                        "forks_count": 1934,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 168,
                        "license": {
                            "key": "mit",
                            "name": "MIT License",
                            "spdx_id": "MIT",
                            "url": "https://api.github.com/licenses/mit",
                            "node_id": "MDc6TGljZW5zZTEz"
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "dropbox",
                            "encoding",
                            "file-uploader",
                            "file-uploads",
                            "files",
                            "hacktoberfest",
                            "instagram",
                            "javascript",
                            "mit",
                            "modular",
                            "open-source",
                            "pick-files",
                            "resumable",
                            "transloadit",
                            "tus",
                            "uploader",
                            "uppy",
                            "webbrowser"
                        ],
                        "visibility": "public",
                        "forks": 1934,
                        "open_issues": 168,
                        "watchers": 27486,
                        "default_branch": "main"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4766"
                    },
                    "html": {
                        "href": "https://github.com/transloadit/uppy/pull/4766"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/transloadit/uppy/issues/4766"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/transloadit/uppy/issues/4766/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4766/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4766/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/transloadit/uppy/statuses/c5d0f6f813dccbcff9693d66b9f93564a62e0e9b"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T07:37:17Z",
        "org": {
            "id": 125754,
            "login": "transloadit",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/transloadit",
            "avatar_url": "https://avatars.githubusercontent.com/u/125754?"
        }
    },
    {
        "id": "32859438172",
        "type": "PullRequestReviewEvent",
        "actor": {
            "id": 402547,
            "login": "mifi",
            "display_login": "mifi",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mifi",
            "avatar_url": "https://avatars.githubusercontent.com/u/402547?"
        },
        "repo": {
            "id": 46273445,
            "name": "transloadit/uppy",
            "url": "https://api.github.com/repos/transloadit/uppy"
        },
        "payload": {
            "action": "created",
            "review": {
                "id": 1698920655,
                "node_id": "PRR_kwDOAsITpc5lQ3jP",
                "user": {
                    "login": "mifi",
                    "id": 402547,
                    "node_id": "MDQ6VXNlcjQwMjU0Nw==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/402547?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/mifi",
                    "html_url": "https://github.com/mifi",
                    "followers_url": "https://api.github.com/users/mifi/followers",
                    "following_url": "https://api.github.com/users/mifi/following{/other_user}",
                    "gists_url": "https://api.github.com/users/mifi/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/mifi/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/mifi/subscriptions",
                    "organizations_url": "https://api.github.com/users/mifi/orgs",
                    "repos_url": "https://api.github.com/users/mifi/repos",
                    "events_url": "https://api.github.com/users/mifi/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/mifi/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": null,
                "commit_id": "c5d0f6f813dccbcff9693d66b9f93564a62e0e9b",
                "submitted_at": "2023-10-26T07:37:17Z",
                "state": "commented",
                "html_url": "https://github.com/transloadit/uppy/pull/4766#pullrequestreview-1698920655",
                "pull_request_url": "https://api.github.com/repos/transloadit/uppy/pulls/4766",
                "author_association": "CONTRIBUTOR",
                "_links": {
                    "html": {
                        "href": "https://github.com/transloadit/uppy/pull/4766#pullrequestreview-1698920655"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4766"
                    }
                }
            },
            "pull_request": {
                "url": "https://api.github.com/repos/transloadit/uppy/pulls/4766",
                "id": 1573159986,
                "node_id": "PR_kwDOAsITpc5dxIQy",
                "html_url": "https://github.com/transloadit/uppy/pull/4766",
                "diff_url": "https://github.com/transloadit/uppy/pull/4766.diff",
                "patch_url": "https://github.com/transloadit/uppy/pull/4766.patch",
                "issue_url": "https://api.github.com/repos/transloadit/uppy/issues/4766",
                "number": 4766,
                "state": "open",
                "locked": false,
                "title": "@uppy/companion-client: fix log type error",
                "user": {
                    "login": "mifi",
                    "id": 402547,
                    "node_id": "MDQ6VXNlcjQwMjU0Nw==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/402547?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/mifi",
                    "html_url": "https://github.com/mifi",
                    "followers_url": "https://api.github.com/users/mifi/followers",
                    "following_url": "https://api.github.com/users/mifi/following{/other_user}",
                    "gists_url": "https://api.github.com/users/mifi/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/mifi/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/mifi/subscriptions",
                    "organizations_url": "https://api.github.com/users/mifi/orgs",
                    "repos_url": "https://api.github.com/users/mifi/repos",
                    "events_url": "https://api.github.com/users/mifi/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/mifi/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "fixes `this.uppy.log.warn is not a function`",
                "created_at": "2023-10-25T15:10:50Z",
                "updated_at": "2023-10-26T07:37:17Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "6629f42a35b3ff9282bcdf9004fd13beb2dd7f96",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/transloadit/uppy/pulls/4766/commits",
                "review_comments_url": "https://api.github.com/repos/transloadit/uppy/pulls/4766/comments",
                "review_comment_url": "https://api.github.com/repos/transloadit/uppy/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/transloadit/uppy/issues/4766/comments",
                "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/c5d0f6f813dccbcff9693d66b9f93564a62e0e9b",
                "head": {
                    "label": "transloadit:fix-logging-bug",
                    "ref": "fix-logging-bug",
                    "sha": "c5d0f6f813dccbcff9693d66b9f93564a62e0e9b",
                    "user": {
                        "login": "transloadit",
                        "id": 125754,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/transloadit",
                        "html_url": "https://github.com/transloadit",
                        "followers_url": "https://api.github.com/users/transloadit/followers",
                        "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                        "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                        "organizations_url": "https://api.github.com/users/transloadit/orgs",
                        "repos_url": "https://api.github.com/users/transloadit/repos",
                        "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/transloadit/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 46273445,
                        "node_id": "MDEwOlJlcG9zaXRvcnk0NjI3MzQ0NQ==",
                        "name": "uppy",
                        "full_name": "transloadit/uppy",
                        "private": false,
                        "owner": {
                            "login": "transloadit",
                            "id": 125754,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/transloadit",
                            "html_url": "https://github.com/transloadit",
                            "followers_url": "https://api.github.com/users/transloadit/followers",
                            "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                            "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                            "organizations_url": "https://api.github.com/users/transloadit/orgs",
                            "repos_url": "https://api.github.com/users/transloadit/repos",
                            "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/transloadit/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/transloadit/uppy",
                        "description": "The next open source file uploader for web browsers :dog: ",
                        "fork": false,
                        "url": "https://api.github.com/repos/transloadit/uppy",
                        "forks_url": "https://api.github.com/repos/transloadit/uppy/forks",
                        "keys_url": "https://api.github.com/repos/transloadit/uppy/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/transloadit/uppy/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/transloadit/uppy/teams",
                        "hooks_url": "https://api.github.com/repos/transloadit/uppy/hooks",
                        "issue_events_url": "https://api.github.com/repos/transloadit/uppy/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/transloadit/uppy/events",
                        "assignees_url": "https://api.github.com/repos/transloadit/uppy/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/transloadit/uppy/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/transloadit/uppy/tags",
                        "blobs_url": "https://api.github.com/repos/transloadit/uppy/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/transloadit/uppy/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/transloadit/uppy/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/transloadit/uppy/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/transloadit/uppy/languages",
                        "stargazers_url": "https://api.github.com/repos/transloadit/uppy/stargazers",
                        "contributors_url": "https://api.github.com/repos/transloadit/uppy/contributors",
                        "subscribers_url": "https://api.github.com/repos/transloadit/uppy/subscribers",
                        "subscription_url": "https://api.github.com/repos/transloadit/uppy/subscription",
                        "commits_url": "https://api.github.com/repos/transloadit/uppy/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/transloadit/uppy/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/transloadit/uppy/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/transloadit/uppy/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/transloadit/uppy/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/transloadit/uppy/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/transloadit/uppy/merges",
                        "archive_url": "https://api.github.com/repos/transloadit/uppy/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/transloadit/uppy/downloads",
                        "issues_url": "https://api.github.com/repos/transloadit/uppy/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/transloadit/uppy/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/transloadit/uppy/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/transloadit/uppy/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/transloadit/uppy/labels{/name}",
                        "releases_url": "https://api.github.com/repos/transloadit/uppy/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/transloadit/uppy/deployments",
                        "created_at": "2015-11-16T12:32:33Z",
                        "updated_at": "2023-10-26T07:17:22Z",
                        "pushed_at": "2023-10-25T15:17:29Z",
                        "git_url": "git://github.com/transloadit/uppy.git",
                        "ssh_url": "git@github.com:transloadit/uppy.git",
                        "clone_url": "https://github.com/transloadit/uppy.git",
                        "svn_url": "https://github.com/transloadit/uppy",
                        "homepage": "https://uppy.io",
                        "size": 389980,
                        "stargazers_count": 27486,
                        "watchers_count": 27486,
                        "language": "JavaScript",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": true,
                        "has_discussions": false,
                        "forks_count": 1934,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 168,
                        "license": {
                            "key": "mit",
                            "name": "MIT License",
                            "spdx_id": "MIT",
                            "url": "https://api.github.com/licenses/mit",
                            "node_id": "MDc6TGljZW5zZTEz"
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "dropbox",
                            "encoding",
                            "file-uploader",
                            "file-uploads",
                            "files",
                            "hacktoberfest",
                            "instagram",
                            "javascript",
                            "mit",
                            "modular",
                            "open-source",
                            "pick-files",
                            "resumable",
                            "transloadit",
                            "tus",
                            "uploader",
                            "uppy",
                            "webbrowser"
                        ],
                        "visibility": "public",
                        "forks": 1934,
                        "open_issues": 168,
                        "watchers": 27486,
                        "default_branch": "main"
                    }
                },
                "base": {
                    "label": "transloadit:main",
                    "ref": "main",
                    "sha": "12e08ada02b9080bd5e1d19526bdf8a2010e62a1",
                    "user": {
                        "login": "transloadit",
                        "id": 125754,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/transloadit",
                        "html_url": "https://github.com/transloadit",
                        "followers_url": "https://api.github.com/users/transloadit/followers",
                        "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                        "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                        "organizations_url": "https://api.github.com/users/transloadit/orgs",
                        "repos_url": "https://api.github.com/users/transloadit/repos",
                        "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/transloadit/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 46273445,
                        "node_id": "MDEwOlJlcG9zaXRvcnk0NjI3MzQ0NQ==",
                        "name": "uppy",
                        "full_name": "transloadit/uppy",
                        "private": false,
                        "owner": {
                            "login": "transloadit",
                            "id": 125754,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/transloadit",
                            "html_url": "https://github.com/transloadit",
                            "followers_url": "https://api.github.com/users/transloadit/followers",
                            "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                            "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                            "organizations_url": "https://api.github.com/users/transloadit/orgs",
                            "repos_url": "https://api.github.com/users/transloadit/repos",
                            "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/transloadit/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/transloadit/uppy",
                        "description": "The next open source file uploader for web browsers :dog: ",
                        "fork": false,
                        "url": "https://api.github.com/repos/transloadit/uppy",
                        "forks_url": "https://api.github.com/repos/transloadit/uppy/forks",
                        "keys_url": "https://api.github.com/repos/transloadit/uppy/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/transloadit/uppy/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/transloadit/uppy/teams",
                        "hooks_url": "https://api.github.com/repos/transloadit/uppy/hooks",
                        "issue_events_url": "https://api.github.com/repos/transloadit/uppy/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/transloadit/uppy/events",
                        "assignees_url": "https://api.github.com/repos/transloadit/uppy/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/transloadit/uppy/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/transloadit/uppy/tags",
                        "blobs_url": "https://api.github.com/repos/transloadit/uppy/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/transloadit/uppy/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/transloadit/uppy/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/transloadit/uppy/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/transloadit/uppy/languages",
                        "stargazers_url": "https://api.github.com/repos/transloadit/uppy/stargazers",
                        "contributors_url": "https://api.github.com/repos/transloadit/uppy/contributors",
                        "subscribers_url": "https://api.github.com/repos/transloadit/uppy/subscribers",
                        "subscription_url": "https://api.github.com/repos/transloadit/uppy/subscription",
                        "commits_url": "https://api.github.com/repos/transloadit/uppy/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/transloadit/uppy/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/transloadit/uppy/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/transloadit/uppy/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/transloadit/uppy/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/transloadit/uppy/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/transloadit/uppy/merges",
                        "archive_url": "https://api.github.com/repos/transloadit/uppy/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/transloadit/uppy/downloads",
                        "issues_url": "https://api.github.com/repos/transloadit/uppy/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/transloadit/uppy/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/transloadit/uppy/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/transloadit/uppy/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/transloadit/uppy/labels{/name}",
                        "releases_url": "https://api.github.com/repos/transloadit/uppy/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/transloadit/uppy/deployments",
                        "created_at": "2015-11-16T12:32:33Z",
                        "updated_at": "2023-10-26T07:17:22Z",
                        "pushed_at": "2023-10-25T15:17:29Z",
                        "git_url": "git://github.com/transloadit/uppy.git",
                        "ssh_url": "git@github.com:transloadit/uppy.git",
                        "clone_url": "https://github.com/transloadit/uppy.git",
                        "svn_url": "https://github.com/transloadit/uppy",
                        "homepage": "https://uppy.io",
                        "size": 389980,
                        "stargazers_count": 27486,
                        "watchers_count": 27486,
                        "language": "JavaScript",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": true,
                        "has_discussions": false,
                        "forks_count": 1934,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 168,
                        "license": {
                            "key": "mit",
                            "name": "MIT License",
                            "spdx_id": "MIT",
                            "url": "https://api.github.com/licenses/mit",
                            "node_id": "MDc6TGljZW5zZTEz"
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "dropbox",
                            "encoding",
                            "file-uploader",
                            "file-uploads",
                            "files",
                            "hacktoberfest",
                            "instagram",
                            "javascript",
                            "mit",
                            "modular",
                            "open-source",
                            "pick-files",
                            "resumable",
                            "transloadit",
                            "tus",
                            "uploader",
                            "uppy",
                            "webbrowser"
                        ],
                        "visibility": "public",
                        "forks": 1934,
                        "open_issues": 168,
                        "watchers": 27486,
                        "default_branch": "main"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4766"
                    },
                    "html": {
                        "href": "https://github.com/transloadit/uppy/pull/4766"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/transloadit/uppy/issues/4766"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/transloadit/uppy/issues/4766/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4766/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4766/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/transloadit/uppy/statuses/c5d0f6f813dccbcff9693d66b9f93564a62e0e9b"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T07:37:18Z",
        "org": {
            "id": 125754,
            "login": "transloadit",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/transloadit",
            "avatar_url": "https://avatars.githubusercontent.com/u/125754?"
        }
    },
    {
        "id": "32859275241",
        "type": "PullRequestReviewCommentEvent",
        "actor": {
            "id": 9060226,
            "login": "Murderlon",
            "display_login": "Murderlon",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Murderlon",
            "avatar_url": "https://avatars.githubusercontent.com/u/9060226?"
        },
        "repo": {
            "id": 46273445,
            "name": "transloadit/uppy",
            "url": "https://api.github.com/repos/transloadit/uppy"
        },
        "payload": {
            "action": "created",
            "comment": {
                "url": "https://api.github.com/repos/transloadit/uppy/pulls/comments/1372714679",
                "pull_request_review_id": 1698909500,
                "id": 1372714679,
                "node_id": "PRRC_kwDOAsITpc5R0fa3",
                "diff_hunk": "@@ -111,7 +111,7 @@ export default class Provider extends RequestClient {\n       const authWindow = window.open(link, '_blank')\n       const handleToken = (e) => {\n         if (e.source !== authWindow) {\n-          this.uppy.log.warn('ignoring event from unknown source', e)\n+          this.uppy.log(`ignoring event from unknown source ${JSON.stringify(e.data)}`, 'warning')",
                "path": "packages/@uppy/companion-client/src/Provider.js",
                "commit_id": "c5d0f6f813dccbcff9693d66b9f93564a62e0e9b",
                "original_commit_id": "c5d0f6f813dccbcff9693d66b9f93564a62e0e9b",
                "user": {
                    "login": "Murderlon",
                    "id": 9060226,
                    "node_id": "MDQ6VXNlcjkwNjAyMjY=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/9060226?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/Murderlon",
                    "html_url": "https://github.com/Murderlon",
                    "followers_url": "https://api.github.com/users/Murderlon/followers",
                    "following_url": "https://api.github.com/users/Murderlon/following{/other_user}",
                    "gists_url": "https://api.github.com/users/Murderlon/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/Murderlon/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/Murderlon/subscriptions",
                    "organizations_url": "https://api.github.com/users/Murderlon/orgs",
                    "repos_url": "https://api.github.com/users/Murderlon/repos",
                    "events_url": "https://api.github.com/users/Murderlon/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/Murderlon/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "That also but in this case I meant a type check if we are doubting the validity: `if (e.data)`.",
                "created_at": "2023-10-26T07:30:51Z",
                "updated_at": "2023-10-26T07:30:52Z",
                "html_url": "https://github.com/transloadit/uppy/pull/4766#discussion_r1372714679",
                "pull_request_url": "https://api.github.com/repos/transloadit/uppy/pulls/4766",
                "author_association": "MEMBER",
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/comments/1372714679"
                    },
                    "html": {
                        "href": "https://github.com/transloadit/uppy/pull/4766#discussion_r1372714679"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4766"
                    }
                },
                "reactions": {
                    "url": "https://api.github.com/repos/transloadit/uppy/pulls/comments/1372714679/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "start_line": null,
                "original_start_line": null,
                "start_side": null,
                "line": 114,
                "original_line": 114,
                "side": "RIGHT",
                "in_reply_to_id": 1371972362,
                "original_position": 5,
                "position": 5,
                "subject_type": "line"
            },
            "pull_request": {
                "url": "https://api.github.com/repos/transloadit/uppy/pulls/4766",
                "id": 1573159986,
                "node_id": "PR_kwDOAsITpc5dxIQy",
                "html_url": "https://github.com/transloadit/uppy/pull/4766",
                "diff_url": "https://github.com/transloadit/uppy/pull/4766.diff",
                "patch_url": "https://github.com/transloadit/uppy/pull/4766.patch",
                "issue_url": "https://api.github.com/repos/transloadit/uppy/issues/4766",
                "number": 4766,
                "state": "open",
                "locked": false,
                "title": "@uppy/companion-client: fix log type error",
                "user": {
                    "login": "mifi",
                    "id": 402547,
                    "node_id": "MDQ6VXNlcjQwMjU0Nw==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/402547?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/mifi",
                    "html_url": "https://github.com/mifi",
                    "followers_url": "https://api.github.com/users/mifi/followers",
                    "following_url": "https://api.github.com/users/mifi/following{/other_user}",
                    "gists_url": "https://api.github.com/users/mifi/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/mifi/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/mifi/subscriptions",
                    "organizations_url": "https://api.github.com/users/mifi/orgs",
                    "repos_url": "https://api.github.com/users/mifi/repos",
                    "events_url": "https://api.github.com/users/mifi/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/mifi/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "fixes `this.uppy.log.warn is not a function`",
                "created_at": "2023-10-25T15:10:50Z",
                "updated_at": "2023-10-26T07:30:52Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "6629f42a35b3ff9282bcdf9004fd13beb2dd7f96",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/transloadit/uppy/pulls/4766/commits",
                "review_comments_url": "https://api.github.com/repos/transloadit/uppy/pulls/4766/comments",
                "review_comment_url": "https://api.github.com/repos/transloadit/uppy/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/transloadit/uppy/issues/4766/comments",
                "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/c5d0f6f813dccbcff9693d66b9f93564a62e0e9b",
                "head": {
                    "label": "transloadit:fix-logging-bug",
                    "ref": "fix-logging-bug",
                    "sha": "c5d0f6f813dccbcff9693d66b9f93564a62e0e9b",
                    "user": {
                        "login": "transloadit",
                        "id": 125754,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/transloadit",
                        "html_url": "https://github.com/transloadit",
                        "followers_url": "https://api.github.com/users/transloadit/followers",
                        "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                        "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                        "organizations_url": "https://api.github.com/users/transloadit/orgs",
                        "repos_url": "https://api.github.com/users/transloadit/repos",
                        "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/transloadit/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 46273445,
                        "node_id": "MDEwOlJlcG9zaXRvcnk0NjI3MzQ0NQ==",
                        "name": "uppy",
                        "full_name": "transloadit/uppy",
                        "private": false,
                        "owner": {
                            "login": "transloadit",
                            "id": 125754,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/transloadit",
                            "html_url": "https://github.com/transloadit",
                            "followers_url": "https://api.github.com/users/transloadit/followers",
                            "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                            "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                            "organizations_url": "https://api.github.com/users/transloadit/orgs",
                            "repos_url": "https://api.github.com/users/transloadit/repos",
                            "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/transloadit/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/transloadit/uppy",
                        "description": "The next open source file uploader for web browsers :dog: ",
                        "fork": false,
                        "url": "https://api.github.com/repos/transloadit/uppy",
                        "forks_url": "https://api.github.com/repos/transloadit/uppy/forks",
                        "keys_url": "https://api.github.com/repos/transloadit/uppy/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/transloadit/uppy/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/transloadit/uppy/teams",
                        "hooks_url": "https://api.github.com/repos/transloadit/uppy/hooks",
                        "issue_events_url": "https://api.github.com/repos/transloadit/uppy/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/transloadit/uppy/events",
                        "assignees_url": "https://api.github.com/repos/transloadit/uppy/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/transloadit/uppy/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/transloadit/uppy/tags",
                        "blobs_url": "https://api.github.com/repos/transloadit/uppy/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/transloadit/uppy/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/transloadit/uppy/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/transloadit/uppy/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/transloadit/uppy/languages",
                        "stargazers_url": "https://api.github.com/repos/transloadit/uppy/stargazers",
                        "contributors_url": "https://api.github.com/repos/transloadit/uppy/contributors",
                        "subscribers_url": "https://api.github.com/repos/transloadit/uppy/subscribers",
                        "subscription_url": "https://api.github.com/repos/transloadit/uppy/subscription",
                        "commits_url": "https://api.github.com/repos/transloadit/uppy/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/transloadit/uppy/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/transloadit/uppy/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/transloadit/uppy/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/transloadit/uppy/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/transloadit/uppy/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/transloadit/uppy/merges",
                        "archive_url": "https://api.github.com/repos/transloadit/uppy/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/transloadit/uppy/downloads",
                        "issues_url": "https://api.github.com/repos/transloadit/uppy/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/transloadit/uppy/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/transloadit/uppy/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/transloadit/uppy/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/transloadit/uppy/labels{/name}",
                        "releases_url": "https://api.github.com/repos/transloadit/uppy/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/transloadit/uppy/deployments",
                        "created_at": "2015-11-16T12:32:33Z",
                        "updated_at": "2023-10-26T07:17:22Z",
                        "pushed_at": "2023-10-25T15:17:29Z",
                        "git_url": "git://github.com/transloadit/uppy.git",
                        "ssh_url": "git@github.com:transloadit/uppy.git",
                        "clone_url": "https://github.com/transloadit/uppy.git",
                        "svn_url": "https://github.com/transloadit/uppy",
                        "homepage": "https://uppy.io",
                        "size": 389980,
                        "stargazers_count": 27486,
                        "watchers_count": 27486,
                        "language": "JavaScript",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": true,
                        "has_discussions": false,
                        "forks_count": 1934,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 168,
                        "license": {
                            "key": "mit",
                            "name": "MIT License",
                            "spdx_id": "MIT",
                            "url": "https://api.github.com/licenses/mit",
                            "node_id": "MDc6TGljZW5zZTEz"
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "dropbox",
                            "encoding",
                            "file-uploader",
                            "file-uploads",
                            "files",
                            "hacktoberfest",
                            "instagram",
                            "javascript",
                            "mit",
                            "modular",
                            "open-source",
                            "pick-files",
                            "resumable",
                            "transloadit",
                            "tus",
                            "uploader",
                            "uppy",
                            "webbrowser"
                        ],
                        "visibility": "public",
                        "forks": 1934,
                        "open_issues": 168,
                        "watchers": 27486,
                        "default_branch": "main"
                    }
                },
                "base": {
                    "label": "transloadit:main",
                    "ref": "main",
                    "sha": "12e08ada02b9080bd5e1d19526bdf8a2010e62a1",
                    "user": {
                        "login": "transloadit",
                        "id": 125754,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/transloadit",
                        "html_url": "https://github.com/transloadit",
                        "followers_url": "https://api.github.com/users/transloadit/followers",
                        "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                        "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                        "organizations_url": "https://api.github.com/users/transloadit/orgs",
                        "repos_url": "https://api.github.com/users/transloadit/repos",
                        "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/transloadit/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 46273445,
                        "node_id": "MDEwOlJlcG9zaXRvcnk0NjI3MzQ0NQ==",
                        "name": "uppy",
                        "full_name": "transloadit/uppy",
                        "private": false,
                        "owner": {
                            "login": "transloadit",
                            "id": 125754,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjEyNTc1NA==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/125754?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/transloadit",
                            "html_url": "https://github.com/transloadit",
                            "followers_url": "https://api.github.com/users/transloadit/followers",
                            "following_url": "https://api.github.com/users/transloadit/following{/other_user}",
                            "gists_url": "https://api.github.com/users/transloadit/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/transloadit/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/transloadit/subscriptions",
                            "organizations_url": "https://api.github.com/users/transloadit/orgs",
                            "repos_url": "https://api.github.com/users/transloadit/repos",
                            "events_url": "https://api.github.com/users/transloadit/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/transloadit/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/transloadit/uppy",
                        "description": "The next open source file uploader for web browsers :dog: ",
                        "fork": false,
                        "url": "https://api.github.com/repos/transloadit/uppy",
                        "forks_url": "https://api.github.com/repos/transloadit/uppy/forks",
                        "keys_url": "https://api.github.com/repos/transloadit/uppy/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/transloadit/uppy/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/transloadit/uppy/teams",
                        "hooks_url": "https://api.github.com/repos/transloadit/uppy/hooks",
                        "issue_events_url": "https://api.github.com/repos/transloadit/uppy/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/transloadit/uppy/events",
                        "assignees_url": "https://api.github.com/repos/transloadit/uppy/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/transloadit/uppy/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/transloadit/uppy/tags",
                        "blobs_url": "https://api.github.com/repos/transloadit/uppy/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/transloadit/uppy/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/transloadit/uppy/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/transloadit/uppy/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/transloadit/uppy/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/transloadit/uppy/languages",
                        "stargazers_url": "https://api.github.com/repos/transloadit/uppy/stargazers",
                        "contributors_url": "https://api.github.com/repos/transloadit/uppy/contributors",
                        "subscribers_url": "https://api.github.com/repos/transloadit/uppy/subscribers",
                        "subscription_url": "https://api.github.com/repos/transloadit/uppy/subscription",
                        "commits_url": "https://api.github.com/repos/transloadit/uppy/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/transloadit/uppy/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/transloadit/uppy/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/transloadit/uppy/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/transloadit/uppy/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/transloadit/uppy/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/transloadit/uppy/merges",
                        "archive_url": "https://api.github.com/repos/transloadit/uppy/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/transloadit/uppy/downloads",
                        "issues_url": "https://api.github.com/repos/transloadit/uppy/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/transloadit/uppy/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/transloadit/uppy/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/transloadit/uppy/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/transloadit/uppy/labels{/name}",
                        "releases_url": "https://api.github.com/repos/transloadit/uppy/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/transloadit/uppy/deployments",
                        "created_at": "2015-11-16T12:32:33Z",
                        "updated_at": "2023-10-26T07:17:22Z",
                        "pushed_at": "2023-10-25T15:17:29Z",
                        "git_url": "git://github.com/transloadit/uppy.git",
                        "ssh_url": "git@github.com:transloadit/uppy.git",
                        "clone_url": "https://github.com/transloadit/uppy.git",
                        "svn_url": "https://github.com/transloadit/uppy",
                        "homepage": "https://uppy.io",
                        "size": 389980,
                        "stargazers_count": 27486,
                        "watchers_count": 27486,
                        "language": "JavaScript",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": true,
                        "has_discussions": false,
                        "forks_count": 1934,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 168,
                        "license": {
                            "key": "mit",
                            "name": "MIT License",
                            "spdx_id": "MIT",
                            "url": "https://api.github.com/licenses/mit",
                            "node_id": "MDc6TGljZW5zZTEz"
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "dropbox",
                            "encoding",
                            "file-uploader",
                            "file-uploads",
                            "files",
                            "hacktoberfest",
                            "instagram",
                            "javascript",
                            "mit",
                            "modular",
                            "open-source",
                            "pick-files",
                            "resumable",
                            "transloadit",
                            "tus",
                            "uploader",
                            "uppy",
                            "webbrowser"
                        ],
                        "visibility": "public",
                        "forks": 1934,
                        "open_issues": 168,
                        "watchers": 27486,
                        "default_branch": "main"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4766"
                    },
                    "html": {
                        "href": "https://github.com/transloadit/uppy/pull/4766"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/transloadit/uppy/issues/4766"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/transloadit/uppy/issues/4766/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4766/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/transloadit/uppy/pulls/4766/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/transloadit/uppy/statuses/c5d0f6f813dccbcff9693d66b9f93564a62e0e9b"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T07:30:51Z",
        "org": {
            "id": 125754,
            "login": "transloadit",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/transloadit",
            "avatar_url": "https://avatars.githubusercontent.com/u/125754?"
        }
    }
]