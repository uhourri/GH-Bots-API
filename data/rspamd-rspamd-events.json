[
    {
        "id": "32896346609",
        "type": "IssueCommentEvent",
        "actor": {
            "id": 9247853,
            "login": "swamp-fish",
            "display_login": "swamp-fish",
            "gravatar_id": "",
            "url": "https://api.github.com/users/swamp-fish",
            "avatar_url": "https://avatars.githubusercontent.com/u/9247853?"
        },
        "repo": {
            "id": 9549081,
            "name": "rspamd/rspamd",
            "url": "https://api.github.com/repos/rspamd/rspamd"
        },
        "payload": {
            "action": "created",
            "issue": {
                "url": "https://api.github.com/repos/rspamd/rspamd/issues/4665",
                "repository_url": "https://api.github.com/repos/rspamd/rspamd",
                "labels_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/labels{/name}",
                "comments_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/comments",
                "events_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/events",
                "html_url": "https://github.com/rspamd/rspamd/issues/4665",
                "id": 1964341363,
                "node_id": "I_kwDOAJG1Gc51FXhz",
                "number": 4665,
                "title": "[BUG] After upgrading to 3.7.2 doesn't see hsmp files",
                "user": {
                    "login": "swamp-fish",
                    "id": 9247853,
                    "node_id": "MDQ6VXNlcjkyNDc4NTM=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/9247853?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/swamp-fish",
                    "html_url": "https://github.com/swamp-fish",
                    "followers_url": "https://api.github.com/users/swamp-fish/followers",
                    "following_url": "https://api.github.com/users/swamp-fish/following{/other_user}",
                    "gists_url": "https://api.github.com/users/swamp-fish/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/swamp-fish/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/swamp-fish/subscriptions",
                    "organizations_url": "https://api.github.com/users/swamp-fish/orgs",
                    "repos_url": "https://api.github.com/users/swamp-fish/repos",
                    "events_url": "https://api.github.com/users/swamp-fish/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/swamp-fish/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "labels": [
                    {
                        "id": 36571652,
                        "node_id": "MDU6TGFiZWwzNjU3MTY1Mg==",
                        "url": "https://api.github.com/repos/rspamd/rspamd/labels/bug",
                        "name": "bug",
                        "color": "fc2929",
                        "default": true,
                        "description": null
                    }
                ],
                "state": "open",
                "locked": false,
                "assignee": null,
                "assignees": [],
                "milestone": null,
                "comments": 9,
                "created_at": "2023-10-26T20:43:22Z",
                "updated_at": "2023-10-27T10:56:46Z",
                "closed_at": null,
                "author_association": "NONE",
                "active_lock_reason": null,
                "body": "<!--\r\n\r\nDo you want to ask a question? Are you looking for support? Here are the places where you can get what you need: https://rspamd.com/support.html\r\n\r\n-->\r\n\r\n**Describe the bug**\r\nAfter upgrade to 3.7.2 i get false error messages about hsmp existence.\r\n\r\n### Steps to Reproduce\r\n\r\n1. Open Rspamd in the browser\r\n2. Go to History tab\r\n3. Observe many similar errors:\r\nWorker type\tPID\tModule\tInternal ID\tMessage\r\n\r\nmain\t675030\thypersca\thsxxxx\tinvalid path: \\\"/var/lib/rspamd//f2c5df70f8667d7f08a23bc82ec6b26f7c687a4823d8d52ba16859c28f0602d4.hsmp\\\", error message: Success\r\n\r\nrspamd_proxy\t675032\thypersca\thsxxxx\tinvalid path: \\\"/var/lib/rspamd//f2c5df70f8667d7f08a23bc82ec6b26f7c687a4823d8d52ba16859c28f0602d4.hsmp\\\", error message: Success\r\n\r\nFiles themselves exist\r\n-rw-r--r-- 1 _rspamd _rspamd 28K Oct 26 23:27 /var/lib/rspamd//f2c5df70f8667d7f08a23bc82ec6b26f7c687a4823d8d52ba16859c28f0602d4.hsmp\r\n\r\n**Expected behavior**\r\nI expect no such errors, in 3.7.1 thery didn't exist\r\n\r\n### Versions\r\n\r\nrspamd --version\r\nRspamd daemon version 3.7.2\r\n\r\nCPU architecture x86_64; features: avx2, avx, sse2, sse3, ssse3, sse4.1, sse4.2, rdrand\r\nHyperscan enabled: TRUE\r\nJemalloc enabled: TRUE\r\nLuaJIT enabled: TRUE (LuaJIT version: LuaJIT 2.1.1695653777)\r\nASAN enabled: FALSE\r\nBLAS enabled: FALSE\r\nFasttext enabled: FALSE\r\n\r\nUbuntu 22.04.3 LTS\r\n\r\nCPU: 8-core AMD Ryzen 7 5800X (-MT MCP-)\r\n",
                "reactions": {
                    "url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "timeline_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/timeline",
                "performed_via_github_app": null,
                "state_reason": null
            },
            "comment": {
                "url": "https://api.github.com/repos/rspamd/rspamd/issues/comments/1782712829",
                "html_url": "https://github.com/rspamd/rspamd/issues/4665#issuecomment-1782712829",
                "issue_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665",
                "id": 1782712829,
                "node_id": "IC_kwDOAJG1Gc5qQgn9",
                "user": {
                    "login": "swamp-fish",
                    "id": 9247853,
                    "node_id": "MDQ6VXNlcjkyNDc4NTM=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/9247853?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/swamp-fish",
                    "html_url": "https://github.com/swamp-fish",
                    "followers_url": "https://api.github.com/users/swamp-fish/followers",
                    "following_url": "https://api.github.com/users/swamp-fish/following{/other_user}",
                    "gists_url": "https://api.github.com/users/swamp-fish/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/swamp-fish/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/swamp-fish/subscriptions",
                    "organizations_url": "https://api.github.com/users/swamp-fish/orgs",
                    "repos_url": "https://api.github.com/users/swamp-fish/repos",
                    "events_url": "https://api.github.com/users/swamp-fish/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/swamp-fish/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "created_at": "2023-10-27T10:56:46Z",
                "updated_at": "2023-10-27T10:56:46Z",
                "author_association": "NONE",
                "body": "Same, solved for me as well, thank you!",
                "reactions": {
                    "url": "https://api.github.com/repos/rspamd/rspamd/issues/comments/1782712829/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "performed_via_github_app": null
            }
        },
        "public": true,
        "created_at": "2023-10-27T10:56:47Z",
        "org": {
            "id": 21975367,
            "login": "rspamd",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/rspamd",
            "avatar_url": "https://avatars.githubusercontent.com/u/21975367?"
        }
    },
    {
        "id": "32895390346",
        "type": "IssueCommentEvent",
        "actor": {
            "id": 65831984,
            "login": "DiveSurfer",
            "display_login": "DiveSurfer",
            "gravatar_id": "",
            "url": "https://api.github.com/users/DiveSurfer",
            "avatar_url": "https://avatars.githubusercontent.com/u/65831984?"
        },
        "repo": {
            "id": 9549081,
            "name": "rspamd/rspamd",
            "url": "https://api.github.com/repos/rspamd/rspamd"
        },
        "payload": {
            "action": "created",
            "issue": {
                "url": "https://api.github.com/repos/rspamd/rspamd/issues/4665",
                "repository_url": "https://api.github.com/repos/rspamd/rspamd",
                "labels_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/labels{/name}",
                "comments_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/comments",
                "events_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/events",
                "html_url": "https://github.com/rspamd/rspamd/issues/4665",
                "id": 1964341363,
                "node_id": "I_kwDOAJG1Gc51FXhz",
                "number": 4665,
                "title": "[BUG] After upgrading to 3.7.2 doesn't see hsmp files",
                "user": {
                    "login": "swamp-fish",
                    "id": 9247853,
                    "node_id": "MDQ6VXNlcjkyNDc4NTM=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/9247853?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/swamp-fish",
                    "html_url": "https://github.com/swamp-fish",
                    "followers_url": "https://api.github.com/users/swamp-fish/followers",
                    "following_url": "https://api.github.com/users/swamp-fish/following{/other_user}",
                    "gists_url": "https://api.github.com/users/swamp-fish/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/swamp-fish/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/swamp-fish/subscriptions",
                    "organizations_url": "https://api.github.com/users/swamp-fish/orgs",
                    "repos_url": "https://api.github.com/users/swamp-fish/repos",
                    "events_url": "https://api.github.com/users/swamp-fish/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/swamp-fish/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "labels": [
                    {
                        "id": 36571652,
                        "node_id": "MDU6TGFiZWwzNjU3MTY1Mg==",
                        "url": "https://api.github.com/repos/rspamd/rspamd/labels/bug",
                        "name": "bug",
                        "color": "fc2929",
                        "default": true,
                        "description": null
                    }
                ],
                "state": "open",
                "locked": false,
                "assignee": null,
                "assignees": [],
                "milestone": null,
                "comments": 8,
                "created_at": "2023-10-26T20:43:22Z",
                "updated_at": "2023-10-27T10:18:23Z",
                "closed_at": null,
                "author_association": "NONE",
                "active_lock_reason": null,
                "body": "<!--\r\n\r\nDo you want to ask a question? Are you looking for support? Here are the places where you can get what you need: https://rspamd.com/support.html\r\n\r\n-->\r\n\r\n**Describe the bug**\r\nAfter upgrade to 3.7.2 i get false error messages about hsmp existence.\r\n\r\n### Steps to Reproduce\r\n\r\n1. Open Rspamd in the browser\r\n2. Go to History tab\r\n3. Observe many similar errors:\r\nWorker type\tPID\tModule\tInternal ID\tMessage\r\n\r\nmain\t675030\thypersca\thsxxxx\tinvalid path: \\\"/var/lib/rspamd//f2c5df70f8667d7f08a23bc82ec6b26f7c687a4823d8d52ba16859c28f0602d4.hsmp\\\", error message: Success\r\n\r\nrspamd_proxy\t675032\thypersca\thsxxxx\tinvalid path: \\\"/var/lib/rspamd//f2c5df70f8667d7f08a23bc82ec6b26f7c687a4823d8d52ba16859c28f0602d4.hsmp\\\", error message: Success\r\n\r\nFiles themselves exist\r\n-rw-r--r-- 1 _rspamd _rspamd 28K Oct 26 23:27 /var/lib/rspamd//f2c5df70f8667d7f08a23bc82ec6b26f7c687a4823d8d52ba16859c28f0602d4.hsmp\r\n\r\n**Expected behavior**\r\nI expect no such errors, in 3.7.1 thery didn't exist\r\n\r\n### Versions\r\n\r\nrspamd --version\r\nRspamd daemon version 3.7.2\r\n\r\nCPU architecture x86_64; features: avx2, avx, sse2, sse3, ssse3, sse4.1, sse4.2, rdrand\r\nHyperscan enabled: TRUE\r\nJemalloc enabled: TRUE\r\nLuaJIT enabled: TRUE (LuaJIT version: LuaJIT 2.1.1695653777)\r\nASAN enabled: FALSE\r\nBLAS enabled: FALSE\r\nFasttext enabled: FALSE\r\n\r\nUbuntu 22.04.3 LTS\r\n\r\nCPU: 8-core AMD Ryzen 7 5800X (-MT MCP-)\r\n",
                "reactions": {
                    "url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "timeline_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/timeline",
                "performed_via_github_app": null,
                "state_reason": null
            },
            "comment": {
                "url": "https://api.github.com/repos/rspamd/rspamd/issues/comments/1782664663",
                "html_url": "https://github.com/rspamd/rspamd/issues/4665#issuecomment-1782664663",
                "issue_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665",
                "id": 1782664663,
                "node_id": "IC_kwDOAJG1Gc5qQU3X",
                "user": {
                    "login": "DiveSurfer",
                    "id": 65831984,
                    "node_id": "MDQ6VXNlcjY1ODMxOTg0",
                    "avatar_url": "https://avatars.githubusercontent.com/u/65831984?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/DiveSurfer",
                    "html_url": "https://github.com/DiveSurfer",
                    "followers_url": "https://api.github.com/users/DiveSurfer/followers",
                    "following_url": "https://api.github.com/users/DiveSurfer/following{/other_user}",
                    "gists_url": "https://api.github.com/users/DiveSurfer/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/DiveSurfer/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/DiveSurfer/subscriptions",
                    "organizations_url": "https://api.github.com/users/DiveSurfer/orgs",
                    "repos_url": "https://api.github.com/users/DiveSurfer/repos",
                    "events_url": "https://api.github.com/users/DiveSurfer/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/DiveSurfer/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "created_at": "2023-10-27T10:18:22Z",
                "updated_at": "2023-10-27T10:18:22Z",
                "author_association": "NONE",
                "body": "solved, thank you",
                "reactions": {
                    "url": "https://api.github.com/repos/rspamd/rspamd/issues/comments/1782664663/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "performed_via_github_app": null
            }
        },
        "public": true,
        "created_at": "2023-10-27T10:18:23Z",
        "org": {
            "id": 21975367,
            "login": "rspamd",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/rspamd",
            "avatar_url": "https://avatars.githubusercontent.com/u/21975367?"
        }
    },
    {
        "id": "32892586054",
        "type": "IssueCommentEvent",
        "actor": {
            "id": 9247853,
            "login": "swamp-fish",
            "display_login": "swamp-fish",
            "gravatar_id": "",
            "url": "https://api.github.com/users/swamp-fish",
            "avatar_url": "https://avatars.githubusercontent.com/u/9247853?"
        },
        "repo": {
            "id": 9549081,
            "name": "rspamd/rspamd",
            "url": "https://api.github.com/repos/rspamd/rspamd"
        },
        "payload": {
            "action": "created",
            "issue": {
                "url": "https://api.github.com/repos/rspamd/rspamd/issues/4665",
                "repository_url": "https://api.github.com/repos/rspamd/rspamd",
                "labels_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/labels{/name}",
                "comments_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/comments",
                "events_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/events",
                "html_url": "https://github.com/rspamd/rspamd/issues/4665",
                "id": 1964341363,
                "node_id": "I_kwDOAJG1Gc51FXhz",
                "number": 4665,
                "title": "[BUG] After upgrading to 3.7.2 doesn't see hsmp files",
                "user": {
                    "login": "swamp-fish",
                    "id": 9247853,
                    "node_id": "MDQ6VXNlcjkyNDc4NTM=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/9247853?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/swamp-fish",
                    "html_url": "https://github.com/swamp-fish",
                    "followers_url": "https://api.github.com/users/swamp-fish/followers",
                    "following_url": "https://api.github.com/users/swamp-fish/following{/other_user}",
                    "gists_url": "https://api.github.com/users/swamp-fish/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/swamp-fish/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/swamp-fish/subscriptions",
                    "organizations_url": "https://api.github.com/users/swamp-fish/orgs",
                    "repos_url": "https://api.github.com/users/swamp-fish/repos",
                    "events_url": "https://api.github.com/users/swamp-fish/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/swamp-fish/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "labels": [
                    {
                        "id": 36571652,
                        "node_id": "MDU6TGFiZWwzNjU3MTY1Mg==",
                        "url": "https://api.github.com/repos/rspamd/rspamd/labels/bug",
                        "name": "bug",
                        "color": "fc2929",
                        "default": true,
                        "description": null
                    }
                ],
                "state": "open",
                "locked": false,
                "assignee": null,
                "assignees": [],
                "milestone": null,
                "comments": 7,
                "created_at": "2023-10-26T20:43:22Z",
                "updated_at": "2023-10-27T08:31:57Z",
                "closed_at": null,
                "author_association": "NONE",
                "active_lock_reason": null,
                "body": "<!--\r\n\r\nDo you want to ask a question? Are you looking for support? Here are the places where you can get what you need: https://rspamd.com/support.html\r\n\r\n-->\r\n\r\n**Describe the bug**\r\nAfter upgrade to 3.7.2 i get false error messages about hsmp existence.\r\n\r\n### Steps to Reproduce\r\n\r\n1. Open Rspamd in the browser\r\n2. Go to History tab\r\n3. Observe many similar errors:\r\nWorker type\tPID\tModule\tInternal ID\tMessage\r\n\r\nmain\t675030\thypersca\thsxxxx\tinvalid path: \\\"/var/lib/rspamd//f2c5df70f8667d7f08a23bc82ec6b26f7c687a4823d8d52ba16859c28f0602d4.hsmp\\\", error message: Success\r\n\r\nrspamd_proxy\t675032\thypersca\thsxxxx\tinvalid path: \\\"/var/lib/rspamd//f2c5df70f8667d7f08a23bc82ec6b26f7c687a4823d8d52ba16859c28f0602d4.hsmp\\\", error message: Success\r\n\r\nFiles themselves exist\r\n-rw-r--r-- 1 _rspamd _rspamd 28K Oct 26 23:27 /var/lib/rspamd//f2c5df70f8667d7f08a23bc82ec6b26f7c687a4823d8d52ba16859c28f0602d4.hsmp\r\n\r\n**Expected behavior**\r\nI expect no such errors, in 3.7.1 thery didn't exist\r\n\r\n### Versions\r\n\r\nrspamd --version\r\nRspamd daemon version 3.7.2\r\n\r\nCPU architecture x86_64; features: avx2, avx, sse2, sse3, ssse3, sse4.1, sse4.2, rdrand\r\nHyperscan enabled: TRUE\r\nJemalloc enabled: TRUE\r\nLuaJIT enabled: TRUE (LuaJIT version: LuaJIT 2.1.1695653777)\r\nASAN enabled: FALSE\r\nBLAS enabled: FALSE\r\nFasttext enabled: FALSE\r\n\r\nUbuntu 22.04.3 LTS\r\n\r\nCPU: 8-core AMD Ryzen 7 5800X (-MT MCP-)\r\n",
                "reactions": {
                    "url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "timeline_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/timeline",
                "performed_via_github_app": null,
                "state_reason": null
            },
            "comment": {
                "url": "https://api.github.com/repos/rspamd/rspamd/issues/comments/1782516829",
                "html_url": "https://github.com/rspamd/rspamd/issues/4665#issuecomment-1782516829",
                "issue_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665",
                "id": 1782516829,
                "node_id": "IC_kwDOAJG1Gc5qPwxd",
                "user": {
                    "login": "swamp-fish",
                    "id": 9247853,
                    "node_id": "MDQ6VXNlcjkyNDc4NTM=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/9247853?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/swamp-fish",
                    "html_url": "https://github.com/swamp-fish",
                    "followers_url": "https://api.github.com/users/swamp-fish/followers",
                    "following_url": "https://api.github.com/users/swamp-fish/following{/other_user}",
                    "gists_url": "https://api.github.com/users/swamp-fish/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/swamp-fish/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/swamp-fish/subscriptions",
                    "organizations_url": "https://api.github.com/users/swamp-fish/orgs",
                    "repos_url": "https://api.github.com/users/swamp-fish/repos",
                    "events_url": "https://api.github.com/users/swamp-fish/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/swamp-fish/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "created_at": "2023-10-27T08:31:56Z",
                "updated_at": "2023-10-27T08:31:56Z",
                "author_association": "NONE",
                "body": "> Do you set any custom DBDIR?\r\n\r\nNo, only default one. But it seems you've already fixed it, thank you! I will wait for the new release.",
                "reactions": {
                    "url": "https://api.github.com/repos/rspamd/rspamd/issues/comments/1782516829/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "performed_via_github_app": null
            }
        },
        "public": true,
        "created_at": "2023-10-27T08:31:57Z",
        "org": {
            "id": 21975367,
            "login": "rspamd",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/rspamd",
            "avatar_url": "https://avatars.githubusercontent.com/u/21975367?"
        }
    },
    {
        "id": "32891345539",
        "type": "ReleaseEvent",
        "actor": {
            "id": 487344,
            "login": "vstakhov",
            "display_login": "vstakhov",
            "gravatar_id": "",
            "url": "https://api.github.com/users/vstakhov",
            "avatar_url": "https://avatars.githubusercontent.com/u/487344?"
        },
        "repo": {
            "id": 9549081,
            "name": "rspamd/rspamd",
            "url": "https://api.github.com/repos/rspamd/rspamd"
        },
        "payload": {
            "action": "published",
            "release": {
                "url": "https://api.github.com/repos/rspamd/rspamd/releases/126899549",
                "assets_url": "https://api.github.com/repos/rspamd/rspamd/releases/126899549/assets",
                "upload_url": "https://uploads.github.com/repos/rspamd/rspamd/releases/126899549/assets{?name,label}",
                "html_url": "https://github.com/rspamd/rspamd/releases/tag/3.7.3",
                "id": 126899549,
                "author": {
                    "login": "vstakhov",
                    "id": 487344,
                    "node_id": "MDQ6VXNlcjQ4NzM0NA==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/487344?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/vstakhov",
                    "html_url": "https://github.com/vstakhov",
                    "followers_url": "https://api.github.com/users/vstakhov/followers",
                    "following_url": "https://api.github.com/users/vstakhov/following{/other_user}",
                    "gists_url": "https://api.github.com/users/vstakhov/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/vstakhov/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/vstakhov/subscriptions",
                    "organizations_url": "https://api.github.com/users/vstakhov/orgs",
                    "repos_url": "https://api.github.com/users/vstakhov/repos",
                    "events_url": "https://api.github.com/users/vstakhov/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/vstakhov/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "node_id": "RE_kwDOAJG1Gc4HkFVd",
                "tag_name": "3.7.3",
                "target_commitish": "master",
                "name": "3.7.3",
                "draft": false,
                "prerelease": false,
                "created_at": "2023-10-27T07:39:01Z",
                "published_at": "2023-10-27T07:42:18Z",
                "assets": [],
                "tarball_url": "https://api.github.com/repos/rspamd/rspamd/tarball/3.7.3",
                "zipball_url": "https://api.github.com/repos/rspamd/rspamd/zipball/3.7.3",
                "body": "###  Release 3.7.3\r\n\r\n* [Fix] Emergency fix for the hyperscan path error",
                "short_description_html": "<h3>Release 3.7.3</h3>\n<ul>\n<li>[Fix] Emergency fix for the hyperscan path error</li>\n</ul>",
                "is_short_description_html_truncated": false
            }
        },
        "public": true,
        "created_at": "2023-10-27T07:42:19Z",
        "org": {
            "id": 21975367,
            "login": "rspamd",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/rspamd",
            "avatar_url": "https://avatars.githubusercontent.com/u/21975367?"
        }
    },
    {
        "id": "32891290549",
        "type": "PushEvent",
        "actor": {
            "id": 487344,
            "login": "vstakhov",
            "display_login": "vstakhov",
            "gravatar_id": "",
            "url": "https://api.github.com/users/vstakhov",
            "avatar_url": "https://avatars.githubusercontent.com/u/487344?"
        },
        "repo": {
            "id": 9549081,
            "name": "rspamd/rspamd",
            "url": "https://api.github.com/repos/rspamd/rspamd"
        },
        "payload": {
            "repository_id": 9549081,
            "push_id": 15588119518,
            "size": 1,
            "distinct_size": 1,
            "ref": "refs/heads/master",
            "head": "81412f8b22d364ae94820fb368f669dabf5d4b94",
            "before": "23ed02bcacbab3636e10019396c6f1b3ece49841",
            "commits": [
                {
                    "sha": "81412f8b22d364ae94820fb368f669dabf5d4b94",
                    "author": {
                        "email": "vsevolod@rspamd.com",
                        "name": "Vsevolod Stakhov"
                    },
                    "message": "[Minor] Update version",
                    "distinct": true,
                    "url": "https://api.github.com/repos/rspamd/rspamd/commits/81412f8b22d364ae94820fb368f669dabf5d4b94"
                }
            ]
        },
        "public": true,
        "created_at": "2023-10-27T07:39:59Z",
        "org": {
            "id": 21975367,
            "login": "rspamd",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/rspamd",
            "avatar_url": "https://avatars.githubusercontent.com/u/21975367?"
        }
    },
    {
        "id": "32891273072",
        "type": "CreateEvent",
        "actor": {
            "id": 487344,
            "login": "vstakhov",
            "display_login": "vstakhov",
            "gravatar_id": "",
            "url": "https://api.github.com/users/vstakhov",
            "avatar_url": "https://avatars.githubusercontent.com/u/487344?"
        },
        "repo": {
            "id": 9549081,
            "name": "rspamd/rspamd",
            "url": "https://api.github.com/repos/rspamd/rspamd"
        },
        "payload": {
            "ref": "3.7.3",
            "ref_type": "tag",
            "master_branch": "master",
            "description": "Rapid spam filtering system.",
            "pusher_type": "user"
        },
        "public": true,
        "created_at": "2023-10-27T07:39:16Z",
        "org": {
            "id": 21975367,
            "login": "rspamd",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/rspamd",
            "avatar_url": "https://avatars.githubusercontent.com/u/21975367?"
        }
    },
    {
        "id": "32891271062",
        "type": "PushEvent",
        "actor": {
            "id": 487344,
            "login": "vstakhov",
            "display_login": "vstakhov",
            "gravatar_id": "",
            "url": "https://api.github.com/users/vstakhov",
            "avatar_url": "https://avatars.githubusercontent.com/u/487344?"
        },
        "repo": {
            "id": 9549081,
            "name": "rspamd/rspamd",
            "url": "https://api.github.com/repos/rspamd/rspamd"
        },
        "payload": {
            "repository_id": 9549081,
            "push_id": 15588110640,
            "size": 1,
            "distinct_size": 1,
            "ref": "refs/heads/master",
            "head": "23ed02bcacbab3636e10019396c6f1b3ece49841",
            "before": "ae8621d2fbfe77e60320324fe35c9542ff31c459",
            "commits": [
                {
                    "sha": "23ed02bcacbab3636e10019396c6f1b3ece49841",
                    "author": {
                        "email": "vsevolod@rspamd.com",
                        "name": "Vsevolod Stakhov"
                    },
                    "message": "Release 3.7.3\n\n* [Fix] Emergency fix for the hyperscan path error",
                    "distinct": true,
                    "url": "https://api.github.com/repos/rspamd/rspamd/commits/23ed02bcacbab3636e10019396c6f1b3ece49841"
                }
            ]
        },
        "public": true,
        "created_at": "2023-10-27T07:39:11Z",
        "org": {
            "id": 21975367,
            "login": "rspamd",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/rspamd",
            "avatar_url": "https://avatars.githubusercontent.com/u/21975367?"
        }
    },
    {
        "id": "32890847349",
        "type": "PushEvent",
        "actor": {
            "id": 487344,
            "login": "vstakhov",
            "display_login": "vstakhov",
            "gravatar_id": "",
            "url": "https://api.github.com/users/vstakhov",
            "avatar_url": "https://avatars.githubusercontent.com/u/487344?"
        },
        "repo": {
            "id": 9549081,
            "name": "rspamd/rspamd",
            "url": "https://api.github.com/repos/rspamd/rspamd"
        },
        "payload": {
            "repository_id": 9549081,
            "push_id": 15587907602,
            "size": 1,
            "distinct_size": 1,
            "ref": "refs/heads/master",
            "head": "ae8621d2fbfe77e60320324fe35c9542ff31c459",
            "before": "8d70c4a50198b18f2e16ab9ff58ca43df0d4ebd8",
            "commits": [
                {
                    "sha": "ae8621d2fbfe77e60320324fe35c9542ff31c459",
                    "author": {
                        "email": "vsevolod@rspamd.com",
                        "name": "Vsevolod Stakhov"
                    },
                    "message": "[Minor] Really fix the issue",
                    "distinct": true,
                    "url": "https://api.github.com/repos/rspamd/rspamd/commits/ae8621d2fbfe77e60320324fe35c9542ff31c459"
                }
            ]
        },
        "public": true,
        "created_at": "2023-10-27T07:21:11Z",
        "org": {
            "id": 21975367,
            "login": "rspamd",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/rspamd",
            "avatar_url": "https://avatars.githubusercontent.com/u/21975367?"
        }
    },
    {
        "id": "32890809140",
        "type": "IssueCommentEvent",
        "actor": {
            "id": 65831984,
            "login": "DiveSurfer",
            "display_login": "DiveSurfer",
            "gravatar_id": "",
            "url": "https://api.github.com/users/DiveSurfer",
            "avatar_url": "https://avatars.githubusercontent.com/u/65831984?"
        },
        "repo": {
            "id": 9549081,
            "name": "rspamd/rspamd",
            "url": "https://api.github.com/repos/rspamd/rspamd"
        },
        "payload": {
            "action": "created",
            "issue": {
                "url": "https://api.github.com/repos/rspamd/rspamd/issues/4665",
                "repository_url": "https://api.github.com/repos/rspamd/rspamd",
                "labels_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/labels{/name}",
                "comments_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/comments",
                "events_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/events",
                "html_url": "https://github.com/rspamd/rspamd/issues/4665",
                "id": 1964341363,
                "node_id": "I_kwDOAJG1Gc51FXhz",
                "number": 4665,
                "title": "[BUG] After upgrading to 3.7.2 doesn't see hsmp files",
                "user": {
                    "login": "swamp-fish",
                    "id": 9247853,
                    "node_id": "MDQ6VXNlcjkyNDc4NTM=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/9247853?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/swamp-fish",
                    "html_url": "https://github.com/swamp-fish",
                    "followers_url": "https://api.github.com/users/swamp-fish/followers",
                    "following_url": "https://api.github.com/users/swamp-fish/following{/other_user}",
                    "gists_url": "https://api.github.com/users/swamp-fish/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/swamp-fish/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/swamp-fish/subscriptions",
                    "organizations_url": "https://api.github.com/users/swamp-fish/orgs",
                    "repos_url": "https://api.github.com/users/swamp-fish/repos",
                    "events_url": "https://api.github.com/users/swamp-fish/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/swamp-fish/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "labels": [
                    {
                        "id": 36571652,
                        "node_id": "MDU6TGFiZWwzNjU3MTY1Mg==",
                        "url": "https://api.github.com/repos/rspamd/rspamd/labels/bug",
                        "name": "bug",
                        "color": "fc2929",
                        "default": true,
                        "description": null
                    }
                ],
                "state": "open",
                "locked": false,
                "assignee": null,
                "assignees": [],
                "milestone": null,
                "comments": 6,
                "created_at": "2023-10-26T20:43:22Z",
                "updated_at": "2023-10-27T07:19:31Z",
                "closed_at": null,
                "author_association": "NONE",
                "active_lock_reason": null,
                "body": "<!--\r\n\r\nDo you want to ask a question? Are you looking for support? Here are the places where you can get what you need: https://rspamd.com/support.html\r\n\r\n-->\r\n\r\n**Describe the bug**\r\nAfter upgrade to 3.7.2 i get false error messages about hsmp existence.\r\n\r\n### Steps to Reproduce\r\n\r\n1. Open Rspamd in the browser\r\n2. Go to History tab\r\n3. Observe many similar errors:\r\nWorker type\tPID\tModule\tInternal ID\tMessage\r\n\r\nmain\t675030\thypersca\thsxxxx\tinvalid path: \\\"/var/lib/rspamd//f2c5df70f8667d7f08a23bc82ec6b26f7c687a4823d8d52ba16859c28f0602d4.hsmp\\\", error message: Success\r\n\r\nrspamd_proxy\t675032\thypersca\thsxxxx\tinvalid path: \\\"/var/lib/rspamd//f2c5df70f8667d7f08a23bc82ec6b26f7c687a4823d8d52ba16859c28f0602d4.hsmp\\\", error message: Success\r\n\r\nFiles themselves exist\r\n-rw-r--r-- 1 _rspamd _rspamd 28K Oct 26 23:27 /var/lib/rspamd//f2c5df70f8667d7f08a23bc82ec6b26f7c687a4823d8d52ba16859c28f0602d4.hsmp\r\n\r\n**Expected behavior**\r\nI expect no such errors, in 3.7.1 thery didn't exist\r\n\r\n### Versions\r\n\r\nrspamd --version\r\nRspamd daemon version 3.7.2\r\n\r\nCPU architecture x86_64; features: avx2, avx, sse2, sse3, ssse3, sse4.1, sse4.2, rdrand\r\nHyperscan enabled: TRUE\r\nJemalloc enabled: TRUE\r\nLuaJIT enabled: TRUE (LuaJIT version: LuaJIT 2.1.1695653777)\r\nASAN enabled: FALSE\r\nBLAS enabled: FALSE\r\nFasttext enabled: FALSE\r\n\r\nUbuntu 22.04.3 LTS\r\n\r\nCPU: 8-core AMD Ryzen 7 5800X (-MT MCP-)\r\n",
                "reactions": {
                    "url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "timeline_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/timeline",
                "performed_via_github_app": null,
                "state_reason": null
            },
            "comment": {
                "url": "https://api.github.com/repos/rspamd/rspamd/issues/comments/1782422172",
                "html_url": "https://github.com/rspamd/rspamd/issues/4665#issuecomment-1782422172",
                "issue_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665",
                "id": 1782422172,
                "node_id": "IC_kwDOAJG1Gc5qPZqc",
                "user": {
                    "login": "DiveSurfer",
                    "id": 65831984,
                    "node_id": "MDQ6VXNlcjY1ODMxOTg0",
                    "avatar_url": "https://avatars.githubusercontent.com/u/65831984?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/DiveSurfer",
                    "html_url": "https://github.com/DiveSurfer",
                    "followers_url": "https://api.github.com/users/DiveSurfer/followers",
                    "following_url": "https://api.github.com/users/DiveSurfer/following{/other_user}",
                    "gists_url": "https://api.github.com/users/DiveSurfer/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/DiveSurfer/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/DiveSurfer/subscriptions",
                    "organizations_url": "https://api.github.com/users/DiveSurfer/orgs",
                    "repos_url": "https://api.github.com/users/DiveSurfer/repos",
                    "events_url": "https://api.github.com/users/DiveSurfer/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/DiveSurfer/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "created_at": "2023-10-27T07:19:30Z",
                "updated_at": "2023-10-27T07:19:30Z",
                "author_association": "NONE",
                "body": "Great, thanks a lot, also for the quick fix",
                "reactions": {
                    "url": "https://api.github.com/repos/rspamd/rspamd/issues/comments/1782422172/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "performed_via_github_app": null
            }
        },
        "public": true,
        "created_at": "2023-10-27T07:19:31Z",
        "org": {
            "id": 21975367,
            "login": "rspamd",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/rspamd",
            "avatar_url": "https://avatars.githubusercontent.com/u/21975367?"
        }
    },
    {
        "id": "32890783543",
        "type": "IssueCommentEvent",
        "actor": {
            "id": 487344,
            "login": "vstakhov",
            "display_login": "vstakhov",
            "gravatar_id": "",
            "url": "https://api.github.com/users/vstakhov",
            "avatar_url": "https://avatars.githubusercontent.com/u/487344?"
        },
        "repo": {
            "id": 9549081,
            "name": "rspamd/rspamd",
            "url": "https://api.github.com/repos/rspamd/rspamd"
        },
        "payload": {
            "action": "created",
            "issue": {
                "url": "https://api.github.com/repos/rspamd/rspamd/issues/4665",
                "repository_url": "https://api.github.com/repos/rspamd/rspamd",
                "labels_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/labels{/name}",
                "comments_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/comments",
                "events_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/events",
                "html_url": "https://github.com/rspamd/rspamd/issues/4665",
                "id": 1964341363,
                "node_id": "I_kwDOAJG1Gc51FXhz",
                "number": 4665,
                "title": "[BUG] After upgrading to 3.7.2 doesn't see hsmp files",
                "user": {
                    "login": "swamp-fish",
                    "id": 9247853,
                    "node_id": "MDQ6VXNlcjkyNDc4NTM=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/9247853?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/swamp-fish",
                    "html_url": "https://github.com/swamp-fish",
                    "followers_url": "https://api.github.com/users/swamp-fish/followers",
                    "following_url": "https://api.github.com/users/swamp-fish/following{/other_user}",
                    "gists_url": "https://api.github.com/users/swamp-fish/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/swamp-fish/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/swamp-fish/subscriptions",
                    "organizations_url": "https://api.github.com/users/swamp-fish/orgs",
                    "repos_url": "https://api.github.com/users/swamp-fish/repos",
                    "events_url": "https://api.github.com/users/swamp-fish/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/swamp-fish/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "labels": [
                    {
                        "id": 36571652,
                        "node_id": "MDU6TGFiZWwzNjU3MTY1Mg==",
                        "url": "https://api.github.com/repos/rspamd/rspamd/labels/bug",
                        "name": "bug",
                        "color": "fc2929",
                        "default": true,
                        "description": null
                    }
                ],
                "state": "open",
                "locked": false,
                "assignee": null,
                "assignees": [],
                "milestone": null,
                "comments": 5,
                "created_at": "2023-10-26T20:43:22Z",
                "updated_at": "2023-10-27T07:18:22Z",
                "closed_at": null,
                "author_association": "NONE",
                "active_lock_reason": null,
                "body": "<!--\r\n\r\nDo you want to ask a question? Are you looking for support? Here are the places where you can get what you need: https://rspamd.com/support.html\r\n\r\n-->\r\n\r\n**Describe the bug**\r\nAfter upgrade to 3.7.2 i get false error messages about hsmp existence.\r\n\r\n### Steps to Reproduce\r\n\r\n1. Open Rspamd in the browser\r\n2. Go to History tab\r\n3. Observe many similar errors:\r\nWorker type\tPID\tModule\tInternal ID\tMessage\r\n\r\nmain\t675030\thypersca\thsxxxx\tinvalid path: \\\"/var/lib/rspamd//f2c5df70f8667d7f08a23bc82ec6b26f7c687a4823d8d52ba16859c28f0602d4.hsmp\\\", error message: Success\r\n\r\nrspamd_proxy\t675032\thypersca\thsxxxx\tinvalid path: \\\"/var/lib/rspamd//f2c5df70f8667d7f08a23bc82ec6b26f7c687a4823d8d52ba16859c28f0602d4.hsmp\\\", error message: Success\r\n\r\nFiles themselves exist\r\n-rw-r--r-- 1 _rspamd _rspamd 28K Oct 26 23:27 /var/lib/rspamd//f2c5df70f8667d7f08a23bc82ec6b26f7c687a4823d8d52ba16859c28f0602d4.hsmp\r\n\r\n**Expected behavior**\r\nI expect no such errors, in 3.7.1 thery didn't exist\r\n\r\n### Versions\r\n\r\nrspamd --version\r\nRspamd daemon version 3.7.2\r\n\r\nCPU architecture x86_64; features: avx2, avx, sse2, sse3, ssse3, sse4.1, sse4.2, rdrand\r\nHyperscan enabled: TRUE\r\nJemalloc enabled: TRUE\r\nLuaJIT enabled: TRUE (LuaJIT version: LuaJIT 2.1.1695653777)\r\nASAN enabled: FALSE\r\nBLAS enabled: FALSE\r\nFasttext enabled: FALSE\r\n\r\nUbuntu 22.04.3 LTS\r\n\r\nCPU: 8-core AMD Ryzen 7 5800X (-MT MCP-)\r\n",
                "reactions": {
                    "url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "timeline_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/timeline",
                "performed_via_github_app": null,
                "state_reason": null
            },
            "comment": {
                "url": "https://api.github.com/repos/rspamd/rspamd/issues/comments/1782420841",
                "html_url": "https://github.com/rspamd/rspamd/issues/4665#issuecomment-1782420841",
                "issue_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665",
                "id": 1782420841,
                "node_id": "IC_kwDOAJG1Gc5qPZVp",
                "user": {
                    "login": "vstakhov",
                    "id": 487344,
                    "node_id": "MDQ6VXNlcjQ4NzM0NA==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/487344?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/vstakhov",
                    "html_url": "https://github.com/vstakhov",
                    "followers_url": "https://api.github.com/users/vstakhov/followers",
                    "following_url": "https://api.github.com/users/vstakhov/following{/other_user}",
                    "gists_url": "https://api.github.com/users/vstakhov/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/vstakhov/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/vstakhov/subscriptions",
                    "organizations_url": "https://api.github.com/users/vstakhov/orgs",
                    "repos_url": "https://api.github.com/users/vstakhov/repos",
                    "events_url": "https://api.github.com/users/vstakhov/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/vstakhov/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "created_at": "2023-10-27T07:18:21Z",
                "updated_at": "2023-10-27T07:18:21Z",
                "author_association": "MEMBER",
                "body": "We'll check if that's a fix and I will make a new release.",
                "reactions": {
                    "url": "https://api.github.com/repos/rspamd/rspamd/issues/comments/1782420841/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "performed_via_github_app": null
            }
        },
        "public": true,
        "created_at": "2023-10-27T07:18:22Z",
        "org": {
            "id": 21975367,
            "login": "rspamd",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/rspamd",
            "avatar_url": "https://avatars.githubusercontent.com/u/21975367?"
        }
    },
    {
        "id": "32890733788",
        "type": "IssueCommentEvent",
        "actor": {
            "id": 65831984,
            "login": "DiveSurfer",
            "display_login": "DiveSurfer",
            "gravatar_id": "",
            "url": "https://api.github.com/users/DiveSurfer",
            "avatar_url": "https://avatars.githubusercontent.com/u/65831984?"
        },
        "repo": {
            "id": 9549081,
            "name": "rspamd/rspamd",
            "url": "https://api.github.com/repos/rspamd/rspamd"
        },
        "payload": {
            "action": "created",
            "issue": {
                "url": "https://api.github.com/repos/rspamd/rspamd/issues/4665",
                "repository_url": "https://api.github.com/repos/rspamd/rspamd",
                "labels_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/labels{/name}",
                "comments_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/comments",
                "events_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/events",
                "html_url": "https://github.com/rspamd/rspamd/issues/4665",
                "id": 1964341363,
                "node_id": "I_kwDOAJG1Gc51FXhz",
                "number": 4665,
                "title": "[BUG] After upgrading to 3.7.2 doesn't see hsmp files",
                "user": {
                    "login": "swamp-fish",
                    "id": 9247853,
                    "node_id": "MDQ6VXNlcjkyNDc4NTM=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/9247853?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/swamp-fish",
                    "html_url": "https://github.com/swamp-fish",
                    "followers_url": "https://api.github.com/users/swamp-fish/followers",
                    "following_url": "https://api.github.com/users/swamp-fish/following{/other_user}",
                    "gists_url": "https://api.github.com/users/swamp-fish/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/swamp-fish/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/swamp-fish/subscriptions",
                    "organizations_url": "https://api.github.com/users/swamp-fish/orgs",
                    "repos_url": "https://api.github.com/users/swamp-fish/repos",
                    "events_url": "https://api.github.com/users/swamp-fish/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/swamp-fish/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "labels": [
                    {
                        "id": 36571652,
                        "node_id": "MDU6TGFiZWwzNjU3MTY1Mg==",
                        "url": "https://api.github.com/repos/rspamd/rspamd/labels/bug",
                        "name": "bug",
                        "color": "fc2929",
                        "default": true,
                        "description": null
                    }
                ],
                "state": "open",
                "locked": false,
                "assignee": null,
                "assignees": [],
                "milestone": null,
                "comments": 4,
                "created_at": "2023-10-26T20:43:22Z",
                "updated_at": "2023-10-27T07:16:11Z",
                "closed_at": null,
                "author_association": "NONE",
                "active_lock_reason": null,
                "body": "<!--\r\n\r\nDo you want to ask a question? Are you looking for support? Here are the places where you can get what you need: https://rspamd.com/support.html\r\n\r\n-->\r\n\r\n**Describe the bug**\r\nAfter upgrade to 3.7.2 i get false error messages about hsmp existence.\r\n\r\n### Steps to Reproduce\r\n\r\n1. Open Rspamd in the browser\r\n2. Go to History tab\r\n3. Observe many similar errors:\r\nWorker type\tPID\tModule\tInternal ID\tMessage\r\n\r\nmain\t675030\thypersca\thsxxxx\tinvalid path: \\\"/var/lib/rspamd//f2c5df70f8667d7f08a23bc82ec6b26f7c687a4823d8d52ba16859c28f0602d4.hsmp\\\", error message: Success\r\n\r\nrspamd_proxy\t675032\thypersca\thsxxxx\tinvalid path: \\\"/var/lib/rspamd//f2c5df70f8667d7f08a23bc82ec6b26f7c687a4823d8d52ba16859c28f0602d4.hsmp\\\", error message: Success\r\n\r\nFiles themselves exist\r\n-rw-r--r-- 1 _rspamd _rspamd 28K Oct 26 23:27 /var/lib/rspamd//f2c5df70f8667d7f08a23bc82ec6b26f7c687a4823d8d52ba16859c28f0602d4.hsmp\r\n\r\n**Expected behavior**\r\nI expect no such errors, in 3.7.1 thery didn't exist\r\n\r\n### Versions\r\n\r\nrspamd --version\r\nRspamd daemon version 3.7.2\r\n\r\nCPU architecture x86_64; features: avx2, avx, sse2, sse3, ssse3, sse4.1, sse4.2, rdrand\r\nHyperscan enabled: TRUE\r\nJemalloc enabled: TRUE\r\nLuaJIT enabled: TRUE (LuaJIT version: LuaJIT 2.1.1695653777)\r\nASAN enabled: FALSE\r\nBLAS enabled: FALSE\r\nFasttext enabled: FALSE\r\n\r\nUbuntu 22.04.3 LTS\r\n\r\nCPU: 8-core AMD Ryzen 7 5800X (-MT MCP-)\r\n",
                "reactions": {
                    "url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "timeline_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/timeline",
                "performed_via_github_app": null,
                "state_reason": null
            },
            "comment": {
                "url": "https://api.github.com/repos/rspamd/rspamd/issues/comments/1782418356",
                "html_url": "https://github.com/rspamd/rspamd/issues/4665#issuecomment-1782418356",
                "issue_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665",
                "id": 1782418356,
                "node_id": "IC_kwDOAJG1Gc5qPYu0",
                "user": {
                    "login": "DiveSurfer",
                    "id": 65831984,
                    "node_id": "MDQ6VXNlcjY1ODMxOTg0",
                    "avatar_url": "https://avatars.githubusercontent.com/u/65831984?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/DiveSurfer",
                    "html_url": "https://github.com/DiveSurfer",
                    "followers_url": "https://api.github.com/users/DiveSurfer/followers",
                    "following_url": "https://api.github.com/users/DiveSurfer/following{/other_user}",
                    "gists_url": "https://api.github.com/users/DiveSurfer/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/DiveSurfer/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/DiveSurfer/subscriptions",
                    "organizations_url": "https://api.github.com/users/DiveSurfer/orgs",
                    "repos_url": "https://api.github.com/users/DiveSurfer/repos",
                    "events_url": "https://api.github.com/users/DiveSurfer/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/DiveSurfer/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "created_at": "2023-10-27T07:16:10Z",
                "updated_at": "2023-10-27T07:16:10Z",
                "author_association": "NONE",
                "body": "Thanks for the fix, sorry for the possibly stupid question, but will there be a new package for Ubuntu, or how can I apply the fix?",
                "reactions": {
                    "url": "https://api.github.com/repos/rspamd/rspamd/issues/comments/1782418356/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "performed_via_github_app": null
            }
        },
        "public": true,
        "created_at": "2023-10-27T07:16:11Z",
        "org": {
            "id": 21975367,
            "login": "rspamd",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/rspamd",
            "avatar_url": "https://avatars.githubusercontent.com/u/21975367?"
        }
    },
    {
        "id": "32890662328",
        "type": "PushEvent",
        "actor": {
            "id": 487344,
            "login": "vstakhov",
            "display_login": "vstakhov",
            "gravatar_id": "",
            "url": "https://api.github.com/users/vstakhov",
            "avatar_url": "https://avatars.githubusercontent.com/u/487344?"
        },
        "repo": {
            "id": 9549081,
            "name": "rspamd/rspamd",
            "url": "https://api.github.com/repos/rspamd/rspamd"
        },
        "payload": {
            "repository_id": 9549081,
            "push_id": 15587816638,
            "size": 1,
            "distinct_size": 1,
            "ref": "refs/heads/master",
            "head": "8d70c4a50198b18f2e16ab9ff58ca43df0d4ebd8",
            "before": "1112ad8b30b0f5951d9fa553bea6072105284011",
            "commits": [
                {
                    "sha": "8d70c4a50198b18f2e16ab9ff58ca43df0d4ebd8",
                    "author": {
                        "email": "vsevolod@rspamd.com",
                        "name": "Vsevolod Stakhov"
                    },
                    "message": "[Fix] A workaround for brain-damaged std::filesystem behaviour\n\nIssue: #4665",
                    "distinct": true,
                    "url": "https://api.github.com/repos/rspamd/rspamd/commits/8d70c4a50198b18f2e16ab9ff58ca43df0d4ebd8"
                }
            ]
        },
        "public": true,
        "created_at": "2023-10-27T07:12:59Z",
        "org": {
            "id": 21975367,
            "login": "rspamd",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/rspamd",
            "avatar_url": "https://avatars.githubusercontent.com/u/21975367?"
        }
    },
    {
        "id": "32890584449",
        "type": "IssueCommentEvent",
        "actor": {
            "id": 65831984,
            "login": "DiveSurfer",
            "display_login": "DiveSurfer",
            "gravatar_id": "",
            "url": "https://api.github.com/users/DiveSurfer",
            "avatar_url": "https://avatars.githubusercontent.com/u/65831984?"
        },
        "repo": {
            "id": 9549081,
            "name": "rspamd/rspamd",
            "url": "https://api.github.com/repos/rspamd/rspamd"
        },
        "payload": {
            "action": "created",
            "issue": {
                "url": "https://api.github.com/repos/rspamd/rspamd/issues/4665",
                "repository_url": "https://api.github.com/repos/rspamd/rspamd",
                "labels_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/labels{/name}",
                "comments_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/comments",
                "events_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/events",
                "html_url": "https://github.com/rspamd/rspamd/issues/4665",
                "id": 1964341363,
                "node_id": "I_kwDOAJG1Gc51FXhz",
                "number": 4665,
                "title": "[BUG] After upgrading to 3.7.2 doesn't see hsmp files",
                "user": {
                    "login": "swamp-fish",
                    "id": 9247853,
                    "node_id": "MDQ6VXNlcjkyNDc4NTM=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/9247853?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/swamp-fish",
                    "html_url": "https://github.com/swamp-fish",
                    "followers_url": "https://api.github.com/users/swamp-fish/followers",
                    "following_url": "https://api.github.com/users/swamp-fish/following{/other_user}",
                    "gists_url": "https://api.github.com/users/swamp-fish/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/swamp-fish/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/swamp-fish/subscriptions",
                    "organizations_url": "https://api.github.com/users/swamp-fish/orgs",
                    "repos_url": "https://api.github.com/users/swamp-fish/repos",
                    "events_url": "https://api.github.com/users/swamp-fish/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/swamp-fish/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "labels": [
                    {
                        "id": 36571652,
                        "node_id": "MDU6TGFiZWwzNjU3MTY1Mg==",
                        "url": "https://api.github.com/repos/rspamd/rspamd/labels/bug",
                        "name": "bug",
                        "color": "fc2929",
                        "default": true,
                        "description": null
                    }
                ],
                "state": "open",
                "locked": false,
                "assignee": null,
                "assignees": [],
                "milestone": null,
                "comments": 3,
                "created_at": "2023-10-26T20:43:22Z",
                "updated_at": "2023-10-27T07:09:26Z",
                "closed_at": null,
                "author_association": "NONE",
                "active_lock_reason": null,
                "body": "<!--\r\n\r\nDo you want to ask a question? Are you looking for support? Here are the places where you can get what you need: https://rspamd.com/support.html\r\n\r\n-->\r\n\r\n**Describe the bug**\r\nAfter upgrade to 3.7.2 i get false error messages about hsmp existence.\r\n\r\n### Steps to Reproduce\r\n\r\n1. Open Rspamd in the browser\r\n2. Go to History tab\r\n3. Observe many similar errors:\r\nWorker type\tPID\tModule\tInternal ID\tMessage\r\n\r\nmain\t675030\thypersca\thsxxxx\tinvalid path: \\\"/var/lib/rspamd//f2c5df70f8667d7f08a23bc82ec6b26f7c687a4823d8d52ba16859c28f0602d4.hsmp\\\", error message: Success\r\n\r\nrspamd_proxy\t675032\thypersca\thsxxxx\tinvalid path: \\\"/var/lib/rspamd//f2c5df70f8667d7f08a23bc82ec6b26f7c687a4823d8d52ba16859c28f0602d4.hsmp\\\", error message: Success\r\n\r\nFiles themselves exist\r\n-rw-r--r-- 1 _rspamd _rspamd 28K Oct 26 23:27 /var/lib/rspamd//f2c5df70f8667d7f08a23bc82ec6b26f7c687a4823d8d52ba16859c28f0602d4.hsmp\r\n\r\n**Expected behavior**\r\nI expect no such errors, in 3.7.1 thery didn't exist\r\n\r\n### Versions\r\n\r\nrspamd --version\r\nRspamd daemon version 3.7.2\r\n\r\nCPU architecture x86_64; features: avx2, avx, sse2, sse3, ssse3, sse4.1, sse4.2, rdrand\r\nHyperscan enabled: TRUE\r\nJemalloc enabled: TRUE\r\nLuaJIT enabled: TRUE (LuaJIT version: LuaJIT 2.1.1695653777)\r\nASAN enabled: FALSE\r\nBLAS enabled: FALSE\r\nFasttext enabled: FALSE\r\n\r\nUbuntu 22.04.3 LTS\r\n\r\nCPU: 8-core AMD Ryzen 7 5800X (-MT MCP-)\r\n",
                "reactions": {
                    "url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "timeline_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/timeline",
                "performed_via_github_app": null,
                "state_reason": null
            },
            "comment": {
                "url": "https://api.github.com/repos/rspamd/rspamd/issues/comments/1782410715",
                "html_url": "https://github.com/rspamd/rspamd/issues/4665#issuecomment-1782410715",
                "issue_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665",
                "id": 1782410715,
                "node_id": "IC_kwDOAJG1Gc5qPW3b",
                "user": {
                    "login": "DiveSurfer",
                    "id": 65831984,
                    "node_id": "MDQ6VXNlcjY1ODMxOTg0",
                    "avatar_url": "https://avatars.githubusercontent.com/u/65831984?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/DiveSurfer",
                    "html_url": "https://github.com/DiveSurfer",
                    "followers_url": "https://api.github.com/users/DiveSurfer/followers",
                    "following_url": "https://api.github.com/users/DiveSurfer/following{/other_user}",
                    "gists_url": "https://api.github.com/users/DiveSurfer/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/DiveSurfer/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/DiveSurfer/subscriptions",
                    "organizations_url": "https://api.github.com/users/DiveSurfer/orgs",
                    "repos_url": "https://api.github.com/users/DiveSurfer/repos",
                    "events_url": "https://api.github.com/users/DiveSurfer/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/DiveSurfer/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "created_at": "2023-10-27T07:09:26Z",
                "updated_at": "2023-10-27T07:09:26Z",
                "author_association": "NONE",
                "body": "Hello,\r\nI have the same behavior, I do not have a custom DBDIR, only the default ones from the system.\r\n\r\n`etc/rspamd# grep -r DBDIR *\r\nmodules.d/forged_recipients.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/forged_recipients.conf\"\r\nmodules.d/history_redis.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/history_redis.conf\"\r\nmodules.d/regexp.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/regexp.conf\"\r\nmodules.d/replies.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/replies.conf\"\r\nmodules.d/maillist.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/maillist.conf\"\r\nmodules.d/arc.conf:# path = \"${DBDIR}/arc/$domain.$selector.key\";\r\nmodules.d/arc.conf:  #path = \"${DBDIR}/arc/$domain.$selector.key\";\r\nmodules.d/arc.conf:  #    path = \"${DBDIR}/arc/example.key\";\r\nmodules.d/arc.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/arc.conf\"\r\nmodules.d/mx_check.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/mx_check.conf\"\r\nmodules.d/reputation.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/reputation.conf\"\r\nmodules.d/spamassassin.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/spamassassin.conf\"\r\nmodules.d/greylist.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/greylist.conf\"\r\nmodules.d/neural.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/fann_redis.conf\"\r\nmodules.d/neural.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/neural.conf\"\r\nmodules.d/once_received.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/once_received.conf\"\r\nmodules.d/hfilter.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/hfilter.conf\"\r\nmodules.d/metadata_exporter.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/metadata_exporter.conf\"\r\nmodules.d/spamtrap.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/spamtrap.conf\"\r\nmodules.d/ratelimit.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/ratelimit.conf\"\r\nmodules.d/trie.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/trie.conf\"\r\nmodules.d/force_actions.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/force_actions.conf\"\r\nmodules.d/antivirus.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/antivirus.conf\"\r\nmodules.d/bimi.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/bimi.conf\"\r\nmodules.d/mime_types.conf:    \"${DBDIR}/mime_types.inc.local\",\r\nmodules.d/mime_types.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/mime_types.conf\"\r\nmodules.d/elastic.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/elastic.conf\"\r\nmodules.d/milter_headers.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/rmilter_headers.conf\"\r\nmodules.d/milter_headers.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/milter_headers.conf\"\r\nmodules.d/multimap.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/multimap.conf\"\r\nmodules.d/external_services.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/external_services.conf\"\r\nmodules.d/fuzzy_check.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/fuzzy_check.conf\"\r\nmodules.d/spf.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/spf.conf\"\r\nmodules.d/mid.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/mid.conf\"\r\nmodules.d/phishing.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/phishing.conf\"\r\nmodules.d/known_senders.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/known_senders.conf\"\r\nmodules.d/redis.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/redis.conf\"\r\nmodules.d/chartable.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/chartable.conf\"\r\nmodules.d/dkim_signing.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/dkim_signing.conf\"\r\nmodules.d/clickhouse.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/clickhouse.conf\"\r\nmodules.d/aws_s3.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/aws_s3.conf\"\r\nmodules.d/external_relay.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/external_relay.conf\"\r\nmodules.d/p0f.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/p0f.conf\"\r\nmodules.d/emails.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/emails.conf\"\r\nmodules.d/surbl.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/surbl.conf\"\r\nmodules.d/rbl.conf:    \"${DBDIR}/surbl-whitelist.inc.local\",\r\nmodules.d/rbl.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/rbl.conf\"\r\nmodules.d/dkim.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/dkim.conf\"\r\nmodules.d/metric_exporter.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/metric_exporter.conf\"\r\nmodules.d/dmarc.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/dmarc.conf\"\r\nmodules.d/rspamd_update.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/rspamd_update.conf\"\r\nmodules.d/asn.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/asn.conf\"\r\nmodules.d/whitelist.conf:        \"${DBDIR}/spf_whitelist.inc.local\",\r\nmodules.d/whitelist.conf:        \"${DBDIR}/dkim_whitelist.inc.local\",\r\nmodules.d/whitelist.conf:        \"${DBDIR}/spf_dkim_whitelist.inc.local\",\r\nmodules.d/whitelist.conf:        \"${DBDIR}/dmarc_whitelist.inc.local\",\r\nmodules.d/whitelist.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/whitelist.conf\"\r\nmodules.d/dcc.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/dcc.conf\"\r\nmodules.d/http_headers.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/http_headers.conf\"\r\nmodules.d/url_redirector.conf:  .include(try=true,priority=5) \"${DBDIR}/dynamic/url_redirector.conf\"\r\noptions.inc:cache_file = \"$DBDIR/symbols.cache\";\r\noptions.inc:dynamic_conf = \"$DBDIR/rspamd_dynamic\";\r\noptions.inc:history_file = \"$DBDIR/rspamd.history\";\r\noptions.inc:control_socket = \"$DBDIR/rspamd.sock mode=0600\";\r\noptions.inc:rrd = \"${DBDIR}/rspamd.rrd\";\r\noptions.inc:stats_file = \"${DBDIR}/stats.ucl\";\r\noptions.inc:hs_cache_dir = \"${DBDIR}/\";\r\nworker-fuzzy.inc:#hash_file = \"${DBDIR}/fuzzy.db\";`",
                "reactions": {
                    "url": "https://api.github.com/repos/rspamd/rspamd/issues/comments/1782410715/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "performed_via_github_app": null
            }
        },
        "public": true,
        "created_at": "2023-10-27T07:09:27Z",
        "org": {
            "id": 21975367,
            "login": "rspamd",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/rspamd",
            "avatar_url": "https://avatars.githubusercontent.com/u/21975367?"
        }
    },
    {
        "id": "32890198404",
        "type": "IssueCommentEvent",
        "actor": {
            "id": 487344,
            "login": "vstakhov",
            "display_login": "vstakhov",
            "gravatar_id": "",
            "url": "https://api.github.com/users/vstakhov",
            "avatar_url": "https://avatars.githubusercontent.com/u/487344?"
        },
        "repo": {
            "id": 9549081,
            "name": "rspamd/rspamd",
            "url": "https://api.github.com/repos/rspamd/rspamd"
        },
        "payload": {
            "action": "created",
            "issue": {
                "url": "https://api.github.com/repos/rspamd/rspamd/issues/4665",
                "repository_url": "https://api.github.com/repos/rspamd/rspamd",
                "labels_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/labels{/name}",
                "comments_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/comments",
                "events_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/events",
                "html_url": "https://github.com/rspamd/rspamd/issues/4665",
                "id": 1964341363,
                "node_id": "I_kwDOAJG1Gc51FXhz",
                "number": 4665,
                "title": "[BUG] After upgrading to 3.7.2 doesn't see hsmp files",
                "user": {
                    "login": "swamp-fish",
                    "id": 9247853,
                    "node_id": "MDQ6VXNlcjkyNDc4NTM=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/9247853?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/swamp-fish",
                    "html_url": "https://github.com/swamp-fish",
                    "followers_url": "https://api.github.com/users/swamp-fish/followers",
                    "following_url": "https://api.github.com/users/swamp-fish/following{/other_user}",
                    "gists_url": "https://api.github.com/users/swamp-fish/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/swamp-fish/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/swamp-fish/subscriptions",
                    "organizations_url": "https://api.github.com/users/swamp-fish/orgs",
                    "repos_url": "https://api.github.com/users/swamp-fish/repos",
                    "events_url": "https://api.github.com/users/swamp-fish/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/swamp-fish/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "labels": [
                    {
                        "id": 36571652,
                        "node_id": "MDU6TGFiZWwzNjU3MTY1Mg==",
                        "url": "https://api.github.com/repos/rspamd/rspamd/labels/bug",
                        "name": "bug",
                        "color": "fc2929",
                        "default": true,
                        "description": null
                    }
                ],
                "state": "open",
                "locked": false,
                "assignee": null,
                "assignees": [],
                "milestone": null,
                "comments": 2,
                "created_at": "2023-10-26T20:43:22Z",
                "updated_at": "2023-10-27T06:51:12Z",
                "closed_at": null,
                "author_association": "NONE",
                "active_lock_reason": null,
                "body": "<!--\r\n\r\nDo you want to ask a question? Are you looking for support? Here are the places where you can get what you need: https://rspamd.com/support.html\r\n\r\n-->\r\n\r\n**Describe the bug**\r\nAfter upgrade to 3.7.2 i get false error messages about hsmp existence.\r\n\r\n### Steps to Reproduce\r\n\r\n1. Open Rspamd in the browser\r\n2. Go to History tab\r\n3. Observe many similar errors:\r\nWorker type\tPID\tModule\tInternal ID\tMessage\r\n\r\nmain\t675030\thypersca\thsxxxx\tinvalid path: \\\"/var/lib/rspamd//f2c5df70f8667d7f08a23bc82ec6b26f7c687a4823d8d52ba16859c28f0602d4.hsmp\\\", error message: Success\r\n\r\nrspamd_proxy\t675032\thypersca\thsxxxx\tinvalid path: \\\"/var/lib/rspamd//f2c5df70f8667d7f08a23bc82ec6b26f7c687a4823d8d52ba16859c28f0602d4.hsmp\\\", error message: Success\r\n\r\nFiles themselves exist\r\n-rw-r--r-- 1 _rspamd _rspamd 28K Oct 26 23:27 /var/lib/rspamd//f2c5df70f8667d7f08a23bc82ec6b26f7c687a4823d8d52ba16859c28f0602d4.hsmp\r\n\r\n**Expected behavior**\r\nI expect no such errors, in 3.7.1 thery didn't exist\r\n\r\n### Versions\r\n\r\nrspamd --version\r\nRspamd daemon version 3.7.2\r\n\r\nCPU architecture x86_64; features: avx2, avx, sse2, sse3, ssse3, sse4.1, sse4.2, rdrand\r\nHyperscan enabled: TRUE\r\nJemalloc enabled: TRUE\r\nLuaJIT enabled: TRUE (LuaJIT version: LuaJIT 2.1.1695653777)\r\nASAN enabled: FALSE\r\nBLAS enabled: FALSE\r\nFasttext enabled: FALSE\r\n\r\nUbuntu 22.04.3 LTS\r\n\r\nCPU: 8-core AMD Ryzen 7 5800X (-MT MCP-)\r\n",
                "reactions": {
                    "url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "timeline_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/timeline",
                "performed_via_github_app": null,
                "state_reason": null
            },
            "comment": {
                "url": "https://api.github.com/repos/rspamd/rspamd/issues/comments/1782391499",
                "html_url": "https://github.com/rspamd/rspamd/issues/4665#issuecomment-1782391499",
                "issue_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665",
                "id": 1782391499,
                "node_id": "IC_kwDOAJG1Gc5qPSLL",
                "user": {
                    "login": "vstakhov",
                    "id": 487344,
                    "node_id": "MDQ6VXNlcjQ4NzM0NA==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/487344?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/vstakhov",
                    "html_url": "https://github.com/vstakhov",
                    "followers_url": "https://api.github.com/users/vstakhov/followers",
                    "following_url": "https://api.github.com/users/vstakhov/following{/other_user}",
                    "gists_url": "https://api.github.com/users/vstakhov/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/vstakhov/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/vstakhov/subscriptions",
                    "organizations_url": "https://api.github.com/users/vstakhov/orgs",
                    "repos_url": "https://api.github.com/users/vstakhov/repos",
                    "events_url": "https://api.github.com/users/vstakhov/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/vstakhov/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "created_at": "2023-10-27T06:51:11Z",
                "updated_at": "2023-10-27T06:51:11Z",
                "author_association": "MEMBER",
                "body": "Do you set any custom DBDIR?",
                "reactions": {
                    "url": "https://api.github.com/repos/rspamd/rspamd/issues/comments/1782391499/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "performed_via_github_app": null
            }
        },
        "public": true,
        "created_at": "2023-10-27T06:51:12Z",
        "org": {
            "id": 21975367,
            "login": "rspamd",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/rspamd",
            "avatar_url": "https://avatars.githubusercontent.com/u/21975367?"
        }
    },
    {
        "id": "32881749504",
        "type": "IssueCommentEvent",
        "actor": {
            "id": 487344,
            "login": "vstakhov",
            "display_login": "vstakhov",
            "gravatar_id": "",
            "url": "https://api.github.com/users/vstakhov",
            "avatar_url": "https://avatars.githubusercontent.com/u/487344?"
        },
        "repo": {
            "id": 9549081,
            "name": "rspamd/rspamd",
            "url": "https://api.github.com/repos/rspamd/rspamd"
        },
        "payload": {
            "action": "created",
            "issue": {
                "url": "https://api.github.com/repos/rspamd/rspamd/issues/4665",
                "repository_url": "https://api.github.com/repos/rspamd/rspamd",
                "labels_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/labels{/name}",
                "comments_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/comments",
                "events_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/events",
                "html_url": "https://github.com/rspamd/rspamd/issues/4665",
                "id": 1964341363,
                "node_id": "I_kwDOAJG1Gc51FXhz",
                "number": 4665,
                "title": "[BUG] After upgrading to 3.7.2 doesn't see hsmp files",
                "user": {
                    "login": "swamp-fish",
                    "id": 9247853,
                    "node_id": "MDQ6VXNlcjkyNDc4NTM=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/9247853?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/swamp-fish",
                    "html_url": "https://github.com/swamp-fish",
                    "followers_url": "https://api.github.com/users/swamp-fish/followers",
                    "following_url": "https://api.github.com/users/swamp-fish/following{/other_user}",
                    "gists_url": "https://api.github.com/users/swamp-fish/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/swamp-fish/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/swamp-fish/subscriptions",
                    "organizations_url": "https://api.github.com/users/swamp-fish/orgs",
                    "repos_url": "https://api.github.com/users/swamp-fish/repos",
                    "events_url": "https://api.github.com/users/swamp-fish/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/swamp-fish/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "labels": [
                    {
                        "id": 36571652,
                        "node_id": "MDU6TGFiZWwzNjU3MTY1Mg==",
                        "url": "https://api.github.com/repos/rspamd/rspamd/labels/bug",
                        "name": "bug",
                        "color": "fc2929",
                        "default": true,
                        "description": null
                    }
                ],
                "state": "open",
                "locked": false,
                "assignee": null,
                "assignees": [],
                "milestone": null,
                "comments": 1,
                "created_at": "2023-10-26T20:43:22Z",
                "updated_at": "2023-10-26T20:59:14Z",
                "closed_at": null,
                "author_association": "NONE",
                "active_lock_reason": null,
                "body": "<!--\r\n\r\nDo you want to ask a question? Are you looking for support? Here are the places where you can get what you need: https://rspamd.com/support.html\r\n\r\n-->\r\n\r\n**Describe the bug**\r\nAfter upgrade to 3.7.2 i get false error messages about hsmp existence.\r\n\r\n### Steps to Reproduce\r\n\r\n1. Open Rspamd in the browser\r\n2. Go to History tab\r\n3. Observe many similar errors:\r\nWorker type\tPID\tModule\tInternal ID\tMessage\r\n\r\nmain\t675030\thypersca\thsxxxx\tinvalid path: \\\"/var/lib/rspamd//f2c5df70f8667d7f08a23bc82ec6b26f7c687a4823d8d52ba16859c28f0602d4.hsmp\\\", error message: Success\r\n\r\nrspamd_proxy\t675032\thypersca\thsxxxx\tinvalid path: \\\"/var/lib/rspamd//f2c5df70f8667d7f08a23bc82ec6b26f7c687a4823d8d52ba16859c28f0602d4.hsmp\\\", error message: Success\r\n\r\nFiles themselves exist\r\n-rw-r--r-- 1 _rspamd _rspamd 28K Oct 26 23:27 /var/lib/rspamd//f2c5df70f8667d7f08a23bc82ec6b26f7c687a4823d8d52ba16859c28f0602d4.hsmp\r\n\r\n**Expected behavior**\r\nI expect no such errors, in 3.7.1 thery didn't exist\r\n\r\n### Versions\r\n\r\nrspamd --version\r\nRspamd daemon version 3.7.2\r\n\r\nCPU architecture x86_64; features: avx2, avx, sse2, sse3, ssse3, sse4.1, sse4.2, rdrand\r\nHyperscan enabled: TRUE\r\nJemalloc enabled: TRUE\r\nLuaJIT enabled: TRUE (LuaJIT version: LuaJIT 2.1.1695653777)\r\nASAN enabled: FALSE\r\nBLAS enabled: FALSE\r\nFasttext enabled: FALSE\r\n\r\nUbuntu 22.04.3 LTS\r\n\r\nCPU: 8-core AMD Ryzen 7 5800X (-MT MCP-)\r\n",
                "reactions": {
                    "url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "timeline_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/timeline",
                "performed_via_github_app": null,
                "state_reason": null
            },
            "comment": {
                "url": "https://api.github.com/repos/rspamd/rspamd/issues/comments/1781886425",
                "html_url": "https://github.com/rspamd/rspamd/issues/4665#issuecomment-1781886425",
                "issue_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665",
                "id": 1781886425,
                "node_id": "IC_kwDOAJG1Gc5qNW3Z",
                "user": {
                    "login": "vstakhov",
                    "id": 487344,
                    "node_id": "MDQ6VXNlcjQ4NzM0NA==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/487344?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/vstakhov",
                    "html_url": "https://github.com/vstakhov",
                    "followers_url": "https://api.github.com/users/vstakhov/followers",
                    "following_url": "https://api.github.com/users/vstakhov/following{/other_user}",
                    "gists_url": "https://api.github.com/users/vstakhov/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/vstakhov/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/vstakhov/subscriptions",
                    "organizations_url": "https://api.github.com/users/vstakhov/orgs",
                    "repos_url": "https://api.github.com/users/vstakhov/repos",
                    "events_url": "https://api.github.com/users/vstakhov/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/vstakhov/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "created_at": "2023-10-26T20:59:14Z",
                "updated_at": "2023-10-26T20:59:14Z",
                "author_association": "MEMBER",
                "body": "I think it's caused by https://github.com/rspamd/rspamd/commit/48fffd3548320827d8d65dcc258afd24ddc5aefe but I don't know yet why.",
                "reactions": {
                    "url": "https://api.github.com/repos/rspamd/rspamd/issues/comments/1781886425/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "performed_via_github_app": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T20:59:15Z",
        "org": {
            "id": 21975367,
            "login": "rspamd",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/rspamd",
            "avatar_url": "https://avatars.githubusercontent.com/u/21975367?"
        }
    },
    {
        "id": "32881419853",
        "type": "IssuesEvent",
        "actor": {
            "id": 9247853,
            "login": "swamp-fish",
            "display_login": "swamp-fish",
            "gravatar_id": "",
            "url": "https://api.github.com/users/swamp-fish",
            "avatar_url": "https://avatars.githubusercontent.com/u/9247853?"
        },
        "repo": {
            "id": 9549081,
            "name": "rspamd/rspamd",
            "url": "https://api.github.com/repos/rspamd/rspamd"
        },
        "payload": {
            "action": "opened",
            "issue": {
                "url": "https://api.github.com/repos/rspamd/rspamd/issues/4665",
                "repository_url": "https://api.github.com/repos/rspamd/rspamd",
                "labels_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/labels{/name}",
                "comments_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/comments",
                "events_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/events",
                "html_url": "https://github.com/rspamd/rspamd/issues/4665",
                "id": 1964341363,
                "node_id": "I_kwDOAJG1Gc51FXhz",
                "number": 4665,
                "title": "[BUG] After upgrading to 3.7.2 doesn't see hsmp files",
                "user": {
                    "login": "swamp-fish",
                    "id": 9247853,
                    "node_id": "MDQ6VXNlcjkyNDc4NTM=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/9247853?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/swamp-fish",
                    "html_url": "https://github.com/swamp-fish",
                    "followers_url": "https://api.github.com/users/swamp-fish/followers",
                    "following_url": "https://api.github.com/users/swamp-fish/following{/other_user}",
                    "gists_url": "https://api.github.com/users/swamp-fish/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/swamp-fish/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/swamp-fish/subscriptions",
                    "organizations_url": "https://api.github.com/users/swamp-fish/orgs",
                    "repos_url": "https://api.github.com/users/swamp-fish/repos",
                    "events_url": "https://api.github.com/users/swamp-fish/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/swamp-fish/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "labels": [
                    {
                        "id": 36571652,
                        "node_id": "MDU6TGFiZWwzNjU3MTY1Mg==",
                        "url": "https://api.github.com/repos/rspamd/rspamd/labels/bug",
                        "name": "bug",
                        "color": "fc2929",
                        "default": true,
                        "description": null
                    }
                ],
                "state": "open",
                "locked": false,
                "assignee": null,
                "assignees": [],
                "milestone": null,
                "comments": 0,
                "created_at": "2023-10-26T20:43:22Z",
                "updated_at": "2023-10-26T20:43:22Z",
                "closed_at": null,
                "author_association": "NONE",
                "active_lock_reason": null,
                "body": "<!--\r\n\r\nDo you want to ask a question? Are you looking for support? Here are the places where you can get what you need: https://rspamd.com/support.html\r\n\r\n-->\r\n\r\n**Describe the bug**\r\nAfter upgrade to 3.7.2 i get false error messages about hsmp existence.\r\n\r\n### Steps to Reproduce\r\n\r\n1. Open Rspamd in the browser\r\n2. Go to History tab\r\n3. Observe many similar errors:\r\nWorker type\tPID\tModule\tInternal ID\tMessage\r\n\r\nmain\t675030\thypersca\thsxxxx\tinvalid path: \\\"/var/lib/rspamd//f2c5df70f8667d7f08a23bc82ec6b26f7c687a4823d8d52ba16859c28f0602d4.hsmp\\\", error message: Success\r\n\r\nrspamd_proxy\t675032\thypersca\thsxxxx\tinvalid path: \\\"/var/lib/rspamd//f2c5df70f8667d7f08a23bc82ec6b26f7c687a4823d8d52ba16859c28f0602d4.hsmp\\\", error message: Success\r\n\r\nFiles themselves exist\r\n-rw-r--r-- 1 _rspamd _rspamd 28K Oct 26 23:27 /var/lib/rspamd//f2c5df70f8667d7f08a23bc82ec6b26f7c687a4823d8d52ba16859c28f0602d4.hsmp\r\n\r\n**Expected behavior**\r\nI expect no such errors, in 3.7.1 thery didn't exist\r\n\r\n### Versions\r\n\r\nrspamd --version\r\nRspamd daemon version 3.7.2\r\n\r\nCPU architecture x86_64; features: avx2, avx, sse2, sse3, ssse3, sse4.1, sse4.2, rdrand\r\nHyperscan enabled: TRUE\r\nJemalloc enabled: TRUE\r\nLuaJIT enabled: TRUE (LuaJIT version: LuaJIT 2.1.1695653777)\r\nASAN enabled: FALSE\r\nBLAS enabled: FALSE\r\nFasttext enabled: FALSE\r\n\r\nUbuntu 22.04.3 LTS\r\n\r\nCPU: 8-core AMD Ryzen 7 5800X (-MT MCP-)\r\n",
                "reactions": {
                    "url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "timeline_url": "https://api.github.com/repos/rspamd/rspamd/issues/4665/timeline",
                "performed_via_github_app": null,
                "state_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T20:43:24Z",
        "org": {
            "id": 21975367,
            "login": "rspamd",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/rspamd",
            "avatar_url": "https://avatars.githubusercontent.com/u/21975367?"
        }
    },
    {
        "id": "32879150105",
        "type": "IssuesEvent",
        "actor": {
            "id": 5272113,
            "login": "Kuzuto",
            "display_login": "Kuzuto",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Kuzuto",
            "avatar_url": "https://avatars.githubusercontent.com/u/5272113?"
        },
        "repo": {
            "id": 9549081,
            "name": "rspamd/rspamd",
            "url": "https://api.github.com/repos/rspamd/rspamd"
        },
        "payload": {
            "action": "closed",
            "issue": {
                "url": "https://api.github.com/repos/rspamd/rspamd/issues/4568",
                "repository_url": "https://api.github.com/repos/rspamd/rspamd",
                "labels_url": "https://api.github.com/repos/rspamd/rspamd/issues/4568/labels{/name}",
                "comments_url": "https://api.github.com/repos/rspamd/rspamd/issues/4568/comments",
                "events_url": "https://api.github.com/repos/rspamd/rspamd/issues/4568/events",
                "html_url": "https://github.com/rspamd/rspamd/issues/4568",
                "id": 1841475850,
                "node_id": "I_kwDOAJG1Gc5twrEK",
                "number": 4568,
                "title": "[BUG] Crash on specific messages after upgrade to 3.6",
                "user": {
                    "login": "Kuzuto",
                    "id": 5272113,
                    "node_id": "MDQ6VXNlcjUyNzIxMTM=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/5272113?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/Kuzuto",
                    "html_url": "https://github.com/Kuzuto",
                    "followers_url": "https://api.github.com/users/Kuzuto/followers",
                    "following_url": "https://api.github.com/users/Kuzuto/following{/other_user}",
                    "gists_url": "https://api.github.com/users/Kuzuto/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/Kuzuto/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/Kuzuto/subscriptions",
                    "organizations_url": "https://api.github.com/users/Kuzuto/orgs",
                    "repos_url": "https://api.github.com/users/Kuzuto/repos",
                    "events_url": "https://api.github.com/users/Kuzuto/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/Kuzuto/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "labels": [
                    {
                        "id": 36571652,
                        "node_id": "MDU6TGFiZWwzNjU3MTY1Mg==",
                        "url": "https://api.github.com/repos/rspamd/rspamd/labels/bug",
                        "name": "bug",
                        "color": "fc2929",
                        "default": true,
                        "description": null
                    }
                ],
                "state": "closed",
                "locked": false,
                "assignee": null,
                "assignees": [],
                "milestone": null,
                "comments": 8,
                "created_at": "2023-08-08T14:52:08Z",
                "updated_at": "2023-10-26T19:01:46Z",
                "closed_at": "2023-10-26T19:01:45Z",
                "author_association": "NONE",
                "active_lock_reason": null,
                "body": "### Prerequisites\r\n\r\n* [X] Put an X between the brackets on this line if you have done all of the following:\r\n    * Read about bug reporting in general: https://rspamd.com/doc/faq.html#how-to-report-bugs-found-in-rspamd\r\n    * Enabled relevant debugging logs: https://rspamd.com/doc/faq.html#how-to-debug-some-module-in-rspamd \r\n    * Checked the FAQs about Core files in case of fatal crash: https://rspamd.com/doc/faq.html#how-to-figure-out-why-rspamd-process-crashed\r\n    * Tried ASAN package and obtained the ASAN report (if possible): https://rspamd.com/doc/faq.html#asan-builds \r\n    * Checked that your issue isn't already filed: https://github.com/issues?utf8=%E2%9C%93&q=is%3Aissue+user%3Arspamd\r\n    * Checked that there is not already an experimental package or master branch\r\n\r\n**Describe the bug**\r\nAfter upgrade to 3.6 (and now 3.6.2) I'm getting crash on some messages.\r\nTesting same .eml file works fine on version 3.5.\r\nTried to do a Core-Dump, but without success. So need help with that, but can provide .eml file.\r\nIn the Rspamd.log I see this:\r\n\r\n2023-08-08 15:48:51 #82298(controller) <cd5d48>; csession; rspamd_message_parse: loaded message; id: <AM9PR01MB7299DACA02EF5099CE328F6AC50DA@AM9PR01MB7299.eurprd01.prod.exchangelabs.com>; queue-id: <undef>; size: 12174; checksum: <623f81ca3f1a26508f5cb2c252fe7268>\r\n2023-08-08 15:48:51 #82298(controller) <cd5d48>; csession; rspamd_mime_part_detect_language: detected part language: da\r\n2023-08-08 15:48:51 #82298(controller) rspamd_crash_sig_handler: caught fatal signal 6(Aborted), pid: 82298, trace: \r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 0: 00007FA32AC3BCE1: gsignal()+0x141\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 1: 00007FA32AC25537: abort()+0x123\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 2: 00007FA32B2DD768: <unknown>\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 3: 00007FA32B30281A: rspamd_mempool_alloc0_()+0xa\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 4: 00007FA32B45CD38: rspamd_lua_ip_push_fromstring()+0x29b8\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 5: 00007FA32B5B22E6: luaL_openlibs()+0x1d66\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 6: 00007FA32B59E8AF: lua_pcall()+0xbf\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 7: 00007FA32B44ED17: luaopen_regexp()+0x20c7\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 8: 00007FA32B3AB9AC: rspamd_http_context_push_keepalive()+0x32c\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 9: 00007FA32B49247A: http_parser_execute()+0xa3a\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 10: 00007FA32B3A76C4: rspamd_http_connection_read_message_shared()+0x514\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 11: 00007FA32B37F515: rspamd_ssl_writev()+0x4c5\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 12: 00007FA32B2184E6: ev_invoke_pending()+0x56\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 13: 00007FA32B21BCA7: ev_run()+0x6b7\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 14: 00005573C028D0D0: <unknown>\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 15: 00007FA32B3A068E: rspamd_fork_worker()+0x7ae\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 16: 00005573C0293340: <unknown>\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 17: 00007FA32B2184E6: ev_invoke_pending()+0x56\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 18: 00007FA32B21BCA7: ev_run()+0x6b7\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 19: 00005573C028550D: <unknown>\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 20: 00007FA32AC26D0A: __libc_start_main()+0xea\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 21: 00005573C0285A3A: <unknown>\r\n2023-08-08 15:48:51 #82298(controller) rspamd_crash_sig_handler: please see Rspamd FAQ to learn how to dump core files and how to fill a bug report\r\n2023-08-08 15:48:51 #81712(main) rspamd_srv_handler: cannot read from worker's srv pipe connection closed; command = heartbeat\r\n2023-08-08 15:48:51 #81712(main) <bff642>; main; rspamd_check_termination_clause: controller process 82298 terminated abnormally with exit code 0 by signal: Aborted but NOT created core file (throttled=no); core file limits: -1 current, -1 max\r\n\r\n### Steps to Reproduce\r\n\r\nUploading the .eml text in Scan/Learn WebGUI, and getting Red bar and log.\r\n\r\n### Versions\r\n- Upgraded Rspamd with apt upgrade to 3.6.2 (Unpacking rspamd (3.6-2~bbb8660e5~bullseye) over (3.6-1~bbb8660e5~bullseye) ...\r\n- \r\nDebian 11.7\r\nRspamd daemon version 3.6\r\nCPU architecture x86_64; features: avx2, avx, sse2, sse3, ssse3, sse4.1, sse4.2, rdrand\r\nHyperscan enabled: TRUE\r\nJemalloc enabled: TRUE\r\nLuaJIT enabled: TRUE (LuaJIT version: LuaJIT 2.1.0-beta3)\r\nASAN enabled: FALSE\r\nBLAS enabled: FALSE\r\nFasttext enabled: FALSE\r\n",
                "reactions": {
                    "url": "https://api.github.com/repos/rspamd/rspamd/issues/4568/reactions",
                    "total_count": 1,
                    "+1": 1,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "timeline_url": "https://api.github.com/repos/rspamd/rspamd/issues/4568/timeline",
                "performed_via_github_app": null,
                "state_reason": "completed"
            }
        },
        "public": true,
        "created_at": "2023-10-26T19:01:46Z",
        "org": {
            "id": 21975367,
            "login": "rspamd",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/rspamd",
            "avatar_url": "https://avatars.githubusercontent.com/u/21975367?"
        }
    },
    {
        "id": "32879149957",
        "type": "IssueCommentEvent",
        "actor": {
            "id": 5272113,
            "login": "Kuzuto",
            "display_login": "Kuzuto",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Kuzuto",
            "avatar_url": "https://avatars.githubusercontent.com/u/5272113?"
        },
        "repo": {
            "id": 9549081,
            "name": "rspamd/rspamd",
            "url": "https://api.github.com/repos/rspamd/rspamd"
        },
        "payload": {
            "action": "created",
            "issue": {
                "url": "https://api.github.com/repos/rspamd/rspamd/issues/4568",
                "repository_url": "https://api.github.com/repos/rspamd/rspamd",
                "labels_url": "https://api.github.com/repos/rspamd/rspamd/issues/4568/labels{/name}",
                "comments_url": "https://api.github.com/repos/rspamd/rspamd/issues/4568/comments",
                "events_url": "https://api.github.com/repos/rspamd/rspamd/issues/4568/events",
                "html_url": "https://github.com/rspamd/rspamd/issues/4568",
                "id": 1841475850,
                "node_id": "I_kwDOAJG1Gc5twrEK",
                "number": 4568,
                "title": "[BUG] Crash on specific messages after upgrade to 3.6",
                "user": {
                    "login": "Kuzuto",
                    "id": 5272113,
                    "node_id": "MDQ6VXNlcjUyNzIxMTM=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/5272113?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/Kuzuto",
                    "html_url": "https://github.com/Kuzuto",
                    "followers_url": "https://api.github.com/users/Kuzuto/followers",
                    "following_url": "https://api.github.com/users/Kuzuto/following{/other_user}",
                    "gists_url": "https://api.github.com/users/Kuzuto/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/Kuzuto/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/Kuzuto/subscriptions",
                    "organizations_url": "https://api.github.com/users/Kuzuto/orgs",
                    "repos_url": "https://api.github.com/users/Kuzuto/repos",
                    "events_url": "https://api.github.com/users/Kuzuto/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/Kuzuto/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "labels": [
                    {
                        "id": 36571652,
                        "node_id": "MDU6TGFiZWwzNjU3MTY1Mg==",
                        "url": "https://api.github.com/repos/rspamd/rspamd/labels/bug",
                        "name": "bug",
                        "color": "fc2929",
                        "default": true,
                        "description": null
                    }
                ],
                "state": "closed",
                "locked": false,
                "assignee": null,
                "assignees": [],
                "milestone": null,
                "comments": 8,
                "created_at": "2023-08-08T14:52:08Z",
                "updated_at": "2023-10-26T19:01:46Z",
                "closed_at": "2023-10-26T19:01:45Z",
                "author_association": "NONE",
                "active_lock_reason": null,
                "body": "### Prerequisites\r\n\r\n* [X] Put an X between the brackets on this line if you have done all of the following:\r\n    * Read about bug reporting in general: https://rspamd.com/doc/faq.html#how-to-report-bugs-found-in-rspamd\r\n    * Enabled relevant debugging logs: https://rspamd.com/doc/faq.html#how-to-debug-some-module-in-rspamd \r\n    * Checked the FAQs about Core files in case of fatal crash: https://rspamd.com/doc/faq.html#how-to-figure-out-why-rspamd-process-crashed\r\n    * Tried ASAN package and obtained the ASAN report (if possible): https://rspamd.com/doc/faq.html#asan-builds \r\n    * Checked that your issue isn't already filed: https://github.com/issues?utf8=%E2%9C%93&q=is%3Aissue+user%3Arspamd\r\n    * Checked that there is not already an experimental package or master branch\r\n\r\n**Describe the bug**\r\nAfter upgrade to 3.6 (and now 3.6.2) I'm getting crash on some messages.\r\nTesting same .eml file works fine on version 3.5.\r\nTried to do a Core-Dump, but without success. So need help with that, but can provide .eml file.\r\nIn the Rspamd.log I see this:\r\n\r\n2023-08-08 15:48:51 #82298(controller) <cd5d48>; csession; rspamd_message_parse: loaded message; id: <AM9PR01MB7299DACA02EF5099CE328F6AC50DA@AM9PR01MB7299.eurprd01.prod.exchangelabs.com>; queue-id: <undef>; size: 12174; checksum: <623f81ca3f1a26508f5cb2c252fe7268>\r\n2023-08-08 15:48:51 #82298(controller) <cd5d48>; csession; rspamd_mime_part_detect_language: detected part language: da\r\n2023-08-08 15:48:51 #82298(controller) rspamd_crash_sig_handler: caught fatal signal 6(Aborted), pid: 82298, trace: \r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 0: 00007FA32AC3BCE1: gsignal()+0x141\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 1: 00007FA32AC25537: abort()+0x123\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 2: 00007FA32B2DD768: <unknown>\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 3: 00007FA32B30281A: rspamd_mempool_alloc0_()+0xa\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 4: 00007FA32B45CD38: rspamd_lua_ip_push_fromstring()+0x29b8\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 5: 00007FA32B5B22E6: luaL_openlibs()+0x1d66\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 6: 00007FA32B59E8AF: lua_pcall()+0xbf\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 7: 00007FA32B44ED17: luaopen_regexp()+0x20c7\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 8: 00007FA32B3AB9AC: rspamd_http_context_push_keepalive()+0x32c\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 9: 00007FA32B49247A: http_parser_execute()+0xa3a\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 10: 00007FA32B3A76C4: rspamd_http_connection_read_message_shared()+0x514\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 11: 00007FA32B37F515: rspamd_ssl_writev()+0x4c5\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 12: 00007FA32B2184E6: ev_invoke_pending()+0x56\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 13: 00007FA32B21BCA7: ev_run()+0x6b7\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 14: 00005573C028D0D0: <unknown>\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 15: 00007FA32B3A068E: rspamd_fork_worker()+0x7ae\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 16: 00005573C0293340: <unknown>\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 17: 00007FA32B2184E6: ev_invoke_pending()+0x56\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 18: 00007FA32B21BCA7: ev_run()+0x6b7\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 19: 00005573C028550D: <unknown>\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 20: 00007FA32AC26D0A: __libc_start_main()+0xea\r\n2023-08-08 15:48:51 #82298(controller) rspamd_print_crash: 21: 00005573C0285A3A: <unknown>\r\n2023-08-08 15:48:51 #82298(controller) rspamd_crash_sig_handler: please see Rspamd FAQ to learn how to dump core files and how to fill a bug report\r\n2023-08-08 15:48:51 #81712(main) rspamd_srv_handler: cannot read from worker's srv pipe connection closed; command = heartbeat\r\n2023-08-08 15:48:51 #81712(main) <bff642>; main; rspamd_check_termination_clause: controller process 82298 terminated abnormally with exit code 0 by signal: Aborted but NOT created core file (throttled=no); core file limits: -1 current, -1 max\r\n\r\n### Steps to Reproduce\r\n\r\nUploading the .eml text in Scan/Learn WebGUI, and getting Red bar and log.\r\n\r\n### Versions\r\n- Upgraded Rspamd with apt upgrade to 3.6.2 (Unpacking rspamd (3.6-2~bbb8660e5~bullseye) over (3.6-1~bbb8660e5~bullseye) ...\r\n- \r\nDebian 11.7\r\nRspamd daemon version 3.6\r\nCPU architecture x86_64; features: avx2, avx, sse2, sse3, ssse3, sse4.1, sse4.2, rdrand\r\nHyperscan enabled: TRUE\r\nJemalloc enabled: TRUE\r\nLuaJIT enabled: TRUE (LuaJIT version: LuaJIT 2.1.0-beta3)\r\nASAN enabled: FALSE\r\nBLAS enabled: FALSE\r\nFasttext enabled: FALSE\r\n",
                "reactions": {
                    "url": "https://api.github.com/repos/rspamd/rspamd/issues/4568/reactions",
                    "total_count": 1,
                    "+1": 1,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "timeline_url": "https://api.github.com/repos/rspamd/rspamd/issues/4568/timeline",
                "performed_via_github_app": null,
                "state_reason": "completed"
            },
            "comment": {
                "url": "https://api.github.com/repos/rspamd/rspamd/issues/comments/1781733390",
                "html_url": "https://github.com/rspamd/rspamd/issues/4568#issuecomment-1781733390",
                "issue_url": "https://api.github.com/repos/rspamd/rspamd/issues/4568",
                "id": 1781733390,
                "node_id": "IC_kwDOAJG1Gc5qMxgO",
                "user": {
                    "login": "Kuzuto",
                    "id": 5272113,
                    "node_id": "MDQ6VXNlcjUyNzIxMTM=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/5272113?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/Kuzuto",
                    "html_url": "https://github.com/Kuzuto",
                    "followers_url": "https://api.github.com/users/Kuzuto/followers",
                    "following_url": "https://api.github.com/users/Kuzuto/following{/other_user}",
                    "gists_url": "https://api.github.com/users/Kuzuto/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/Kuzuto/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/Kuzuto/subscriptions",
                    "organizations_url": "https://api.github.com/users/Kuzuto/orgs",
                    "repos_url": "https://api.github.com/users/Kuzuto/repos",
                    "events_url": "https://api.github.com/users/Kuzuto/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/Kuzuto/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "created_at": "2023-10-26T19:01:45Z",
                "updated_at": "2023-10-26T19:01:45Z",
                "author_association": "NONE",
                "body": "Issue is not present in current version 3.7.2",
                "reactions": {
                    "url": "https://api.github.com/repos/rspamd/rspamd/issues/comments/1781733390/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "performed_via_github_app": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T19:01:46Z",
        "org": {
            "id": 21975367,
            "login": "rspamd",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/rspamd",
            "avatar_url": "https://avatars.githubusercontent.com/u/21975367?"
        }
    },
    {
        "id": "32875093571",
        "type": "IssueCommentEvent",
        "actor": {
            "id": 24227479,
            "login": "grufocom",
            "display_login": "grufocom",
            "gravatar_id": "",
            "url": "https://api.github.com/users/grufocom",
            "avatar_url": "https://avatars.githubusercontent.com/u/24227479?"
        },
        "repo": {
            "id": 9549081,
            "name": "rspamd/rspamd",
            "url": "https://api.github.com/repos/rspamd/rspamd"
        },
        "payload": {
            "action": "created",
            "issue": {
                "url": "https://api.github.com/repos/rspamd/rspamd/issues/4643",
                "repository_url": "https://api.github.com/repos/rspamd/rspamd",
                "labels_url": "https://api.github.com/repos/rspamd/rspamd/issues/4643/labels{/name}",
                "comments_url": "https://api.github.com/repos/rspamd/rspamd/issues/4643/comments",
                "events_url": "https://api.github.com/repos/rspamd/rspamd/issues/4643/events",
                "html_url": "https://github.com/rspamd/rspamd/issues/4643",
                "id": 1942091606,
                "node_id": "I_kwDOAJG1Gc5zwfdW",
                "number": 4643,
                "title": "ICAP Issues after 3.7.1 upgrade - ESET[BUG]",
                "user": {
                    "login": "padrogass",
                    "id": 12258169,
                    "node_id": "MDQ6VXNlcjEyMjU4MTY5",
                    "avatar_url": "https://avatars.githubusercontent.com/u/12258169?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/padrogass",
                    "html_url": "https://github.com/padrogass",
                    "followers_url": "https://api.github.com/users/padrogass/followers",
                    "following_url": "https://api.github.com/users/padrogass/following{/other_user}",
                    "gists_url": "https://api.github.com/users/padrogass/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/padrogass/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/padrogass/subscriptions",
                    "organizations_url": "https://api.github.com/users/padrogass/orgs",
                    "repos_url": "https://api.github.com/users/padrogass/repos",
                    "events_url": "https://api.github.com/users/padrogass/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/padrogass/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "labels": [
                    {
                        "id": 36571652,
                        "node_id": "MDU6TGFiZWwzNjU3MTY1Mg==",
                        "url": "https://api.github.com/repos/rspamd/rspamd/labels/bug",
                        "name": "bug",
                        "color": "fc2929",
                        "default": true,
                        "description": null
                    }
                ],
                "state": "open",
                "locked": false,
                "assignee": null,
                "assignees": [],
                "milestone": null,
                "comments": 14,
                "created_at": "2023-10-13T14:40:45Z",
                "updated_at": "2023-10-26T16:18:54Z",
                "closed_at": null,
                "author_association": "NONE",
                "active_lock_reason": null,
                "body": "Hi!\r\n\r\nICAP sanning (ESET Server Security for Linux (version: 10.0.328.0)) is not working after RSPAMD 3.7.1 upgrade. \r\n\r\nMy external_services.conf file is the same as it was working on previous versions or rspamd:\r\n\r\neset {\r\n  servers = \"127.0.0.1:1344\";\r\n  user_agent = \"RSPM_Agent\";\r\n  # symbol to add (add it to metric if you want non-zero weight)\r\n  symbol = \"ESET_VIRUS\";\r\n\r\n  # type of scanner: \"icap\", \"oletools\", \"dcc\" or \"vadesecure\"\r\n  type = \"icap\";\r\n  scheme = \"scan\";\r\n  # Scan mime_parts seperately - otherwise the complete mail will be transfered\r\n  scan_mime_parts = true;\r\n  scan_text_mime = true;\r\n  scan_image_mime = true;\r\n\r\n  # filter attachments by content-type, filename or filename extension\r\n  # setting a filter will also enable scan_mime_parts = true;\r\n  mime_parts_filter_regex {\r\n    #FILE1 = \"^invoice\\.xls$\"\r\n    #DOC1 = \"application\\/msword\";\r\n  }\r\n  mime_parts_filter_ext {\r\n    #doc = \"doc\";\r\n    #docx = \"docx\";\r\n  }\r\n\r\n  # If set force this action if any threat is found (default unset: no action is forced)\r\n  #action = \"reject\";\r\n\r\n  # If `max_size` is set, messages > n bytes in size are not scanned\r\n  #max_size = 20000000;\r\n\r\n  # If set true, log message is emitted for clean messages\r\n  log_clean = true;\r\n\r\n  # if `patterns` is specified threat name will be matched against provided regexes and the related\r\n  # symbol will be yielded if a match is found. If no match is found, default symbol is yielded.\r\n  patterns {\r\n    # symbol_name = \"pattern\";\r\n    JUST_EICAR = '^Eicar-Test-Signature$';\r\n  }\r\n  # same as above, but matching on the _FAIL symbol\r\n  patterns_fail {\r\n    # symbol_name = \"pattern\";\r\n  }\r\n  # In version 1.7.0+ patterns could be extended\r\n  #patterns = {SANE_MAL = 'Sanesecurity\\.Malware\\.*', CLAM_UNOFFICIAL = 'UNOFFICIAL$'};\r\n\r\n  # `whitelist` points to a map of IP addresses. Mail from these addresses is not scanned.\r\n  whitelist = \"/etc/rspamd/antivirus.wl\";\r\n}\r\n\r\nRSPAMD shows this messages:\r\n\r\n_2023-10-13 16:20:49 #79158(main) <b7x9e6>; lua; external_services.lua:193: registered external services rule: symbol ESET_VIRUS; type icap\r\n2023-10-13 16:22:54 #79159(rspamd_proxy) <7ff231>; lua; icap.lua:574: eset (icap): ICAP ERROR: ICAP/1.0 400 Bad request\r\n2023-10-13 16:22:54 #79159(rspamd_proxy) <7ff231>; lua; common.lua:113: eset (icap): result - FAILED with error: \"ICAP/1.0 400 Bad request - score: 0\"_\r\n\r\nESET shows this messages on log:\r\n\r\n_13/10/2023, 16:22 ICAP Server Invalid request: Bad message eset-efs-icapd_\r\n",
                "reactions": {
                    "url": "https://api.github.com/repos/rspamd/rspamd/issues/4643/reactions",
                    "total_count": 2,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 2,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "timeline_url": "https://api.github.com/repos/rspamd/rspamd/issues/4643/timeline",
                "performed_via_github_app": null,
                "state_reason": null
            },
            "comment": {
                "url": "https://api.github.com/repos/rspamd/rspamd/issues/comments/1781440280",
                "html_url": "https://github.com/rspamd/rspamd/issues/4643#issuecomment-1781440280",
                "issue_url": "https://api.github.com/repos/rspamd/rspamd/issues/4643",
                "id": 1781440280,
                "node_id": "IC_kwDOAJG1Gc5qLp8Y",
                "user": {
                    "login": "grufocom",
                    "id": 24227479,
                    "node_id": "MDQ6VXNlcjI0MjI3NDc5",
                    "avatar_url": "https://avatars.githubusercontent.com/u/24227479?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/grufocom",
                    "html_url": "https://github.com/grufocom",
                    "followers_url": "https://api.github.com/users/grufocom/followers",
                    "following_url": "https://api.github.com/users/grufocom/following{/other_user}",
                    "gists_url": "https://api.github.com/users/grufocom/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/grufocom/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/grufocom/subscriptions",
                    "organizations_url": "https://api.github.com/users/grufocom/orgs",
                    "repos_url": "https://api.github.com/users/grufocom/repos",
                    "events_url": "https://api.github.com/users/grufocom/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/grufocom/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "created_at": "2023-10-26T16:18:54Z",
                "updated_at": "2023-10-26T16:18:54Z",
                "author_association": "NONE",
                "body": "Sure - here is my /etc/rspamd/local.d/external_service.conf:\r\n\r\nicap {\r\n\tservers = \"127.0.0.1:1344\",\r\n\ttype = \"icap\",\r\n\tsymbol = \"ICAP_VIRUS\",\r\n\tscan_mime_parts = true,\r\n\tscan_all_mime_parts = true,\r\n\tscan_text_mime = false,\r\n\tscan_image_mime = false,\r\n\tscheme = \"scan\",\r\n\tdefault_port = 1344,\r\n\ttimeout = 10.0,\r\n\tlog_clean = false,\r\n\tretransmits = 2,\r\n\tcache_expire = 7200,\r\n\tmessage = '${SCANNER}: threat found with icap scanner: \"${VIRUS}\"',\r\n\tdetection_category = \"virus\",\r\n\tdefault_score = 1,\r\n\taction = reject,\r\n\tdynamic_scan = true,\r\n\tuser_agent = \"none\",\r\n}\r\n",
                "reactions": {
                    "url": "https://api.github.com/repos/rspamd/rspamd/issues/comments/1781440280/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "performed_via_github_app": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T16:18:55Z",
        "org": {
            "id": 21975367,
            "login": "rspamd",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/rspamd",
            "avatar_url": "https://avatars.githubusercontent.com/u/21975367?"
        }
    },
    {
        "id": "32869778109",
        "type": "ReleaseEvent",
        "actor": {
            "id": 487344,
            "login": "vstakhov",
            "display_login": "vstakhov",
            "gravatar_id": "",
            "url": "https://api.github.com/users/vstakhov",
            "avatar_url": "https://avatars.githubusercontent.com/u/487344?"
        },
        "repo": {
            "id": 9549081,
            "name": "rspamd/rspamd",
            "url": "https://api.github.com/repos/rspamd/rspamd"
        },
        "payload": {
            "action": "published",
            "release": {
                "url": "https://api.github.com/repos/rspamd/rspamd/releases/126777175",
                "assets_url": "https://api.github.com/repos/rspamd/rspamd/releases/126777175/assets",
                "upload_url": "https://uploads.github.com/repos/rspamd/rspamd/releases/126777175/assets{?name,label}",
                "html_url": "https://github.com/rspamd/rspamd/releases/tag/3.7.2",
                "id": 126777175,
                "author": {
                    "login": "vstakhov",
                    "id": 487344,
                    "node_id": "MDQ6VXNlcjQ4NzM0NA==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/487344?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/vstakhov",
                    "html_url": "https://github.com/vstakhov",
                    "followers_url": "https://api.github.com/users/vstakhov/followers",
                    "following_url": "https://api.github.com/users/vstakhov/following{/other_user}",
                    "gists_url": "https://api.github.com/users/vstakhov/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/vstakhov/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/vstakhov/subscriptions",
                    "organizations_url": "https://api.github.com/users/vstakhov/orgs",
                    "repos_url": "https://api.github.com/users/vstakhov/repos",
                    "events_url": "https://api.github.com/users/vstakhov/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/vstakhov/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "node_id": "RE_kwDOAJG1Gc4HjndX",
                "tag_name": "3.7.2",
                "target_commitish": "master",
                "name": "3.7.2",
                "draft": false,
                "prerelease": false,
                "created_at": "2023-10-26T13:30:35Z",
                "published_at": "2023-10-26T13:33:55Z",
                "assets": [],
                "tarball_url": "https://api.github.com/repos/rspamd/rspamd/tarball/3.7.2",
                "zipball_url": "https://api.github.com/repos/rspamd/rspamd/zipball/3.7.2",
                "body": "## What's Changed\r\n* [Minor] Make compiling with backward-cpp optional by @a16bitsysop in https://github.com/rspamd/rspamd/pull/4639\r\n* [Rules] Blank spam detection by @fatalbanana in https://github.com/rspamd/rspamd/pull/4644\r\n* [Minor] Treat *.cue attachments as harmful by @twesterhever in https://github.com/rspamd/rspamd/pull/4642\r\n* Dzjaivnt patch 1 by @dzjaivnt in https://github.com/rspamd/rspamd/pull/4640\r\n* [WebUI] Add control to invert action filter by @moisseev in https://github.com/rspamd/rspamd/pull/4645\r\n* [Fix] DMARC reporting: fix reporting for subdomains by @fatalbanana in https://github.com/rspamd/rspamd/pull/4587\r\n* [Test] Banish luacheck from functional tests by @fatalbanana in https://github.com/rspamd/rspamd/pull/4648\r\n* [Minor] RSPAMD_SHAREDIR is called SHAREDIR in configuration by @fatalbanana in https://github.com/rspamd/rspamd/pull/4649\r\n* [WebUI] Fix history table vanishing by @moisseev in https://github.com/rspamd/rspamd/pull/4661\r\n* Tighten rspamd's attachment policy by @twesterhever in https://github.com/rspamd/rspamd/pull/4656\r\n* [Minor] rbl: support use of different matchers for return codes by @fatalbanana in https://github.com/rspamd/rspamd/pull/4657\r\n\r\n## New Contributors\r\n* @dzjaivnt made their first contribution in https://github.com/rspamd/rspamd/pull/4640\r\n\r\n**Full Changelog**: https://github.com/rspamd/rspamd/compare/3.7.1...3.7.2",
                "mentions_count": 5,
                "mentions": [
                    {
                        "avatar_url": "https://avatars.githubusercontent.com/u/2176651?v=4",
                        "login": "fatalbanana",
                        "profile_name": "Andrew Lewis",
                        "profile_url": "https://github.com/fatalbanana",
                        "avatar_user_actor": true
                    },
                    {
                        "avatar_url": "https://avatars.githubusercontent.com/u/2275981?v=4",
                        "login": "moisseev",
                        "profile_name": "Alexander Moisseev",
                        "profile_url": "https://github.com/moisseev",
                        "avatar_user_actor": true
                    },
                    {
                        "avatar_url": "https://avatars.githubusercontent.com/u/32509178?v=4",
                        "login": "a16bitsysop",
                        "profile_name": "Duncan Bellamy",
                        "profile_url": "https://github.com/a16bitsysop",
                        "avatar_user_actor": true
                    },
                    {
                        "avatar_url": "https://avatars.githubusercontent.com/u/40121680?v=4",
                        "login": "twesterhever",
                        "profile_name": null,
                        "profile_url": "https://github.com/twesterhever",
                        "avatar_user_actor": true
                    },
                    {
                        "avatar_url": "https://avatars.githubusercontent.com/u/91220882?v=4",
                        "login": "dzjaivnt",
                        "profile_name": null,
                        "profile_url": "https://github.com/dzjaivnt",
                        "avatar_user_actor": true
                    }
                ],
                "short_description_html": "<h2>What's Changed</h2>\n<ul>\n<li>[Minor] Make compiling with backward-cpp optional by <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/a16bitsysop/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/a16bitsysop\">@a16bitsysop</a> in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1939698605\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rspamd/rspamd/issues/4639\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rspamd/rspamd/pull/4639/hovercard\" href=\"https://github.com/rspamd/rspamd/pull/4639\">#4639</a>\n</li>\n<li>[Rules] Blank spam detection by <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/fatalbanana/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/fatalbanana\">@fatalbanana</a> in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1942133772\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rspamd/rspamd/issues/4644\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rspamd/rspamd/pull/4644/hovercard\" href=\"https://github.com/rspamd/rspamd/pull/4644\">#4644</a>\n</li>\n<li>[Minor] Treat *.cue attachments as harmful by <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/twesterhever/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/twesterhever\">@twest\u2026</a>\n</li>\n</ul>",
                "is_short_description_html_truncated": true
            }
        },
        "public": true,
        "created_at": "2023-10-26T13:33:56Z",
        "org": {
            "id": 21975367,
            "login": "rspamd",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/rspamd",
            "avatar_url": "https://avatars.githubusercontent.com/u/21975367?"
        }
    },
    {
        "id": "32869695343",
        "type": "PushEvent",
        "actor": {
            "id": 487344,
            "login": "vstakhov",
            "display_login": "vstakhov",
            "gravatar_id": "",
            "url": "https://api.github.com/users/vstakhov",
            "avatar_url": "https://avatars.githubusercontent.com/u/487344?"
        },
        "repo": {
            "id": 9549081,
            "name": "rspamd/rspamd",
            "url": "https://api.github.com/repos/rspamd/rspamd"
        },
        "payload": {
            "repository_id": 9549081,
            "push_id": 15577243763,
            "size": 1,
            "distinct_size": 1,
            "ref": "refs/heads/master",
            "head": "1112ad8b30b0f5951d9fa553bea6072105284011",
            "before": "b5bbeaa5d9d1003acf126da5a4edfc1d1fbcb1f4",
            "commits": [
                {
                    "sha": "1112ad8b30b0f5951d9fa553bea6072105284011",
                    "author": {
                        "email": "vsevolod@rspamd.com",
                        "name": "Vsevolod Stakhov"
                    },
                    "message": "[Minor] Update version",
                    "distinct": true,
                    "url": "https://api.github.com/repos/rspamd/rspamd/commits/1112ad8b30b0f5951d9fa553bea6072105284011"
                }
            ]
        },
        "public": true,
        "created_at": "2023-10-26T13:31:33Z",
        "org": {
            "id": 21975367,
            "login": "rspamd",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/rspamd",
            "avatar_url": "https://avatars.githubusercontent.com/u/21975367?"
        }
    },
    {
        "id": "32869670654",
        "type": "CreateEvent",
        "actor": {
            "id": 487344,
            "login": "vstakhov",
            "display_login": "vstakhov",
            "gravatar_id": "",
            "url": "https://api.github.com/users/vstakhov",
            "avatar_url": "https://avatars.githubusercontent.com/u/487344?"
        },
        "repo": {
            "id": 9549081,
            "name": "rspamd/rspamd",
            "url": "https://api.github.com/repos/rspamd/rspamd"
        },
        "payload": {
            "ref": "3.7.2",
            "ref_type": "tag",
            "master_branch": "master",
            "description": "Rapid spam filtering system.",
            "pusher_type": "user"
        },
        "public": true,
        "created_at": "2023-10-26T13:30:50Z",
        "org": {
            "id": 21975367,
            "login": "rspamd",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/rspamd",
            "avatar_url": "https://avatars.githubusercontent.com/u/21975367?"
        }
    },
    {
        "id": "32869667055",
        "type": "PushEvent",
        "actor": {
            "id": 487344,
            "login": "vstakhov",
            "display_login": "vstakhov",
            "gravatar_id": "",
            "url": "https://api.github.com/users/vstakhov",
            "avatar_url": "https://avatars.githubusercontent.com/u/487344?"
        },
        "repo": {
            "id": 9549081,
            "name": "rspamd/rspamd",
            "url": "https://api.github.com/repos/rspamd/rspamd"
        },
        "payload": {
            "repository_id": 9549081,
            "push_id": 15577231048,
            "size": 1,
            "distinct_size": 1,
            "ref": "refs/heads/master",
            "head": "b5bbeaa5d9d1003acf126da5a4edfc1d1fbcb1f4",
            "before": "d2f250ae1ea421d423b1e07bbafcf7ef3560a191",
            "commits": [
                {
                    "sha": "b5bbeaa5d9d1003acf126da5a4edfc1d1fbcb1f4",
                    "author": {
                        "email": "vsevolod@rspamd.com",
                        "name": "Vsevolod Stakhov"
                    },
                    "message": "Release 3.7.2\n\n* [Feature] rbl: support checking returncodes by CIDR\n* [Feature] rbl: support checking returncodes by regex\n* [Feature] rbl: support globbed return codes\n* [Fix] DMARC reporting: fix reporting for subdomains\n* [Fix] Deal with fmtlib exceptions properly\n* [Fix] backport fix for dlfcn.h from backward-cpp\n* [Rules] Blank spam detection",
                    "distinct": true,
                    "url": "https://api.github.com/repos/rspamd/rspamd/commits/b5bbeaa5d9d1003acf126da5a4edfc1d1fbcb1f4"
                }
            ]
        },
        "public": true,
        "created_at": "2023-10-26T13:30:44Z",
        "org": {
            "id": 21975367,
            "login": "rspamd",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/rspamd",
            "avatar_url": "https://avatars.githubusercontent.com/u/21975367?"
        }
    },
    {
        "id": "32863748208",
        "type": "PushEvent",
        "actor": {
            "id": 487344,
            "login": "vstakhov",
            "display_login": "vstakhov",
            "gravatar_id": "",
            "url": "https://api.github.com/users/vstakhov",
            "avatar_url": "https://avatars.githubusercontent.com/u/487344?"
        },
        "repo": {
            "id": 9549081,
            "name": "rspamd/rspamd",
            "url": "https://api.github.com/repos/rspamd/rspamd"
        },
        "payload": {
            "repository_id": 9549081,
            "push_id": 15574283706,
            "size": 6,
            "distinct_size": 6,
            "ref": "refs/heads/master",
            "head": "d2f250ae1ea421d423b1e07bbafcf7ef3560a191",
            "before": "6491804e19f1771bb1b4146420a2a3b98939d516",
            "commits": [
                {
                    "sha": "fea6bf4c35ae7fd40c9d61edc2283d335347d998",
                    "author": {
                        "email": "nerf@judo.za.org",
                        "name": "Andrew Lewis"
                    },
                    "message": "[Minor] rbl: support use of different matchers for return codes",
                    "distinct": true,
                    "url": "https://api.github.com/repos/rspamd/rspamd/commits/fea6bf4c35ae7fd40c9d61edc2283d335347d998"
                },
                {
                    "sha": "06618f8a52242c8678eed659b56cebb23a34ed38",
                    "author": {
                        "email": "nerf@judo.za.org",
                        "name": "Andrew Lewis"
                    },
                    "message": "[Feature] rbl: support checking returncodes by regex",
                    "distinct": true,
                    "url": "https://api.github.com/repos/rspamd/rspamd/commits/06618f8a52242c8678eed659b56cebb23a34ed38"
                },
                {
                    "sha": "3d17d2d857bb2d719b6e32e1b85e81dd1431d5bd",
                    "author": {
                        "email": "nerf@judo.za.org",
                        "name": "Andrew Lewis"
                    },
                    "message": "[Feature] rbl: support checking returncodes by CIDR",
                    "distinct": true,
                    "url": "https://api.github.com/repos/rspamd/rspamd/commits/3d17d2d857bb2d719b6e32e1b85e81dd1431d5bd"
                },
                {
                    "sha": "5ef8dfff5dcff5e8922e5a2c8e41d7e381dbcd37",
                    "author": {
                        "email": "nerf@judo.za.org",
                        "name": "Andrew Lewis"
                    },
                    "message": "[Feature] rbl: support globbed return codes",
                    "distinct": true,
                    "url": "https://api.github.com/repos/rspamd/rspamd/commits/5ef8dfff5dcff5e8922e5a2c8e41d7e381dbcd37"
                },
                {
                    "sha": "15e3f277fad7c692b641423b38d6b508b764a3f8",
                    "author": {
                        "email": "nerf@judo.za.org",
                        "name": "Andrew Lewis"
                    },
                    "message": "[Minor] Reiterate on the previous changes\n\n - Demote message to info level\n - Name it returncodes_matcher for better specificity",
                    "distinct": true,
                    "url": "https://api.github.com/repos/rspamd/rspamd/commits/15e3f277fad7c692b641423b38d6b508b764a3f8"
                },
                {
                    "sha": "d2f250ae1ea421d423b1e07bbafcf7ef3560a191",
                    "author": {
                        "email": "vsevolod@rspamd.com",
                        "name": "Vsevolod Stakhov"
                    },
                    "message": "Merge pull request #4657 from fatalbanana/rbl_matchers\n\n[Feature] rbl: support use of different matchers for return codes",
                    "distinct": true,
                    "url": "https://api.github.com/repos/rspamd/rspamd/commits/d2f250ae1ea421d423b1e07bbafcf7ef3560a191"
                }
            ]
        },
        "public": true,
        "created_at": "2023-10-26T10:06:27Z",
        "org": {
            "id": 21975367,
            "login": "rspamd",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/rspamd",
            "avatar_url": "https://avatars.githubusercontent.com/u/21975367?"
        }
    },
    {
        "id": "32863747933",
        "type": "PullRequestEvent",
        "actor": {
            "id": 487344,
            "login": "vstakhov",
            "display_login": "vstakhov",
            "gravatar_id": "",
            "url": "https://api.github.com/users/vstakhov",
            "avatar_url": "https://avatars.githubusercontent.com/u/487344?"
        },
        "repo": {
            "id": 9549081,
            "name": "rspamd/rspamd",
            "url": "https://api.github.com/repos/rspamd/rspamd"
        },
        "payload": {
            "action": "closed",
            "number": 4657,
            "pull_request": {
                "url": "https://api.github.com/repos/rspamd/rspamd/pulls/4657",
                "id": 1570793693,
                "node_id": "PR_kwDOAJG1Gc5doGjd",
                "html_url": "https://github.com/rspamd/rspamd/pull/4657",
                "diff_url": "https://github.com/rspamd/rspamd/pull/4657.diff",
                "patch_url": "https://github.com/rspamd/rspamd/pull/4657.patch",
                "issue_url": "https://api.github.com/repos/rspamd/rspamd/issues/4657",
                "number": 4657,
                "state": "closed",
                "locked": false,
                "title": "[Minor] rbl: support use of different matchers for return codes",
                "user": {
                    "login": "fatalbanana",
                    "id": 2176651,
                    "node_id": "MDQ6VXNlcjIxNzY2NTE=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/2176651?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/fatalbanana",
                    "html_url": "https://github.com/fatalbanana",
                    "followers_url": "https://api.github.com/users/fatalbanana/followers",
                    "following_url": "https://api.github.com/users/fatalbanana/following{/other_user}",
                    "gists_url": "https://api.github.com/users/fatalbanana/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/fatalbanana/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/fatalbanana/subscriptions",
                    "organizations_url": "https://api.github.com/users/fatalbanana/orgs",
                    "repos_url": "https://api.github.com/users/fatalbanana/repos",
                    "events_url": "https://api.github.com/users/fatalbanana/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/fatalbanana/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "The idea is to:\r\n\r\n- [X] get rid of un-needed usage of Lua patterns\r\n- [X] deprecate unqualified use of Lua patterns (prompt users to set `matcher = \"luapattern\"`)\r\n- [X] add different options for matching, like regexp\r\n- [x] and radix...\r\n- [x] and glob...",
                "created_at": "2023-10-24T10:48:22Z",
                "updated_at": "2023-10-26T10:06:26Z",
                "closed_at": "2023-10-26T10:06:26Z",
                "merged_at": "2023-10-26T10:06:26Z",
                "merge_commit_sha": "d2f250ae1ea421d423b1e07bbafcf7ef3560a191",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/rspamd/rspamd/pulls/4657/commits",
                "review_comments_url": "https://api.github.com/repos/rspamd/rspamd/pulls/4657/comments",
                "review_comment_url": "https://api.github.com/repos/rspamd/rspamd/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/rspamd/rspamd/issues/4657/comments",
                "statuses_url": "https://api.github.com/repos/rspamd/rspamd/statuses/15e3f277fad7c692b641423b38d6b508b764a3f8",
                "head": {
                    "label": "fatalbanana:rbl_matchers",
                    "ref": "rbl_matchers",
                    "sha": "15e3f277fad7c692b641423b38d6b508b764a3f8",
                    "user": {
                        "login": "fatalbanana",
                        "id": 2176651,
                        "node_id": "MDQ6VXNlcjIxNzY2NTE=",
                        "avatar_url": "https://avatars.githubusercontent.com/u/2176651?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/fatalbanana",
                        "html_url": "https://github.com/fatalbanana",
                        "followers_url": "https://api.github.com/users/fatalbanana/followers",
                        "following_url": "https://api.github.com/users/fatalbanana/following{/other_user}",
                        "gists_url": "https://api.github.com/users/fatalbanana/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/fatalbanana/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/fatalbanana/subscriptions",
                        "organizations_url": "https://api.github.com/users/fatalbanana/orgs",
                        "repos_url": "https://api.github.com/users/fatalbanana/repos",
                        "events_url": "https://api.github.com/users/fatalbanana/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/fatalbanana/received_events",
                        "type": "User",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 235838452,
                        "node_id": "MDEwOlJlcG9zaXRvcnkyMzU4Mzg0NTI=",
                        "name": "rspamd",
                        "full_name": "fatalbanana/rspamd",
                        "private": false,
                        "owner": {
                            "login": "fatalbanana",
                            "id": 2176651,
                            "node_id": "MDQ6VXNlcjIxNzY2NTE=",
                            "avatar_url": "https://avatars.githubusercontent.com/u/2176651?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/fatalbanana",
                            "html_url": "https://github.com/fatalbanana",
                            "followers_url": "https://api.github.com/users/fatalbanana/followers",
                            "following_url": "https://api.github.com/users/fatalbanana/following{/other_user}",
                            "gists_url": "https://api.github.com/users/fatalbanana/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/fatalbanana/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/fatalbanana/subscriptions",
                            "organizations_url": "https://api.github.com/users/fatalbanana/orgs",
                            "repos_url": "https://api.github.com/users/fatalbanana/repos",
                            "events_url": "https://api.github.com/users/fatalbanana/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/fatalbanana/received_events",
                            "type": "User",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/fatalbanana/rspamd",
                        "description": "Rapid spam filtering system.",
                        "fork": true,
                        "url": "https://api.github.com/repos/fatalbanana/rspamd",
                        "forks_url": "https://api.github.com/repos/fatalbanana/rspamd/forks",
                        "keys_url": "https://api.github.com/repos/fatalbanana/rspamd/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/fatalbanana/rspamd/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/fatalbanana/rspamd/teams",
                        "hooks_url": "https://api.github.com/repos/fatalbanana/rspamd/hooks",
                        "issue_events_url": "https://api.github.com/repos/fatalbanana/rspamd/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/fatalbanana/rspamd/events",
                        "assignees_url": "https://api.github.com/repos/fatalbanana/rspamd/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/fatalbanana/rspamd/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/fatalbanana/rspamd/tags",
                        "blobs_url": "https://api.github.com/repos/fatalbanana/rspamd/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/fatalbanana/rspamd/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/fatalbanana/rspamd/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/fatalbanana/rspamd/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/fatalbanana/rspamd/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/fatalbanana/rspamd/languages",
                        "stargazers_url": "https://api.github.com/repos/fatalbanana/rspamd/stargazers",
                        "contributors_url": "https://api.github.com/repos/fatalbanana/rspamd/contributors",
                        "subscribers_url": "https://api.github.com/repos/fatalbanana/rspamd/subscribers",
                        "subscription_url": "https://api.github.com/repos/fatalbanana/rspamd/subscription",
                        "commits_url": "https://api.github.com/repos/fatalbanana/rspamd/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/fatalbanana/rspamd/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/fatalbanana/rspamd/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/fatalbanana/rspamd/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/fatalbanana/rspamd/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/fatalbanana/rspamd/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/fatalbanana/rspamd/merges",
                        "archive_url": "https://api.github.com/repos/fatalbanana/rspamd/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/fatalbanana/rspamd/downloads",
                        "issues_url": "https://api.github.com/repos/fatalbanana/rspamd/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/fatalbanana/rspamd/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/fatalbanana/rspamd/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/fatalbanana/rspamd/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/fatalbanana/rspamd/labels{/name}",
                        "releases_url": "https://api.github.com/repos/fatalbanana/rspamd/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/fatalbanana/rspamd/deployments",
                        "created_at": "2020-01-23T16:38:58Z",
                        "updated_at": "2023-05-26T13:08:56Z",
                        "pushed_at": "2023-10-26T06:41:27Z",
                        "git_url": "git://github.com/fatalbanana/rspamd.git",
                        "ssh_url": "git@github.com:fatalbanana/rspamd.git",
                        "clone_url": "https://github.com/fatalbanana/rspamd.git",
                        "svn_url": "https://github.com/fatalbanana/rspamd",
                        "homepage": null,
                        "size": 67617,
                        "stargazers_count": 0,
                        "watchers_count": 0,
                        "language": "C",
                        "has_issues": false,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": true,
                        "has_pages": false,
                        "has_discussions": false,
                        "forks_count": 0,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 0,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [],
                        "visibility": "public",
                        "forks": 0,
                        "open_issues": 0,
                        "watchers": 0,
                        "default_branch": "master"
                    }
                },
                "base": {
                    "label": "rspamd:master",
                    "ref": "master",
                    "sha": "6b81b812a7a34ad7201b7df214bb543d089d7919",
                    "user": {
                        "login": "rspamd",
                        "id": 21975367,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjIxOTc1MzY3",
                        "avatar_url": "https://avatars.githubusercontent.com/u/21975367?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/rspamd",
                        "html_url": "https://github.com/rspamd",
                        "followers_url": "https://api.github.com/users/rspamd/followers",
                        "following_url": "https://api.github.com/users/rspamd/following{/other_user}",
                        "gists_url": "https://api.github.com/users/rspamd/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/rspamd/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/rspamd/subscriptions",
                        "organizations_url": "https://api.github.com/users/rspamd/orgs",
                        "repos_url": "https://api.github.com/users/rspamd/repos",
                        "events_url": "https://api.github.com/users/rspamd/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/rspamd/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 9549081,
                        "node_id": "MDEwOlJlcG9zaXRvcnk5NTQ5MDgx",
                        "name": "rspamd",
                        "full_name": "rspamd/rspamd",
                        "private": false,
                        "owner": {
                            "login": "rspamd",
                            "id": 21975367,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjIxOTc1MzY3",
                            "avatar_url": "https://avatars.githubusercontent.com/u/21975367?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/rspamd",
                            "html_url": "https://github.com/rspamd",
                            "followers_url": "https://api.github.com/users/rspamd/followers",
                            "following_url": "https://api.github.com/users/rspamd/following{/other_user}",
                            "gists_url": "https://api.github.com/users/rspamd/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/rspamd/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/rspamd/subscriptions",
                            "organizations_url": "https://api.github.com/users/rspamd/orgs",
                            "repos_url": "https://api.github.com/users/rspamd/repos",
                            "events_url": "https://api.github.com/users/rspamd/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/rspamd/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/rspamd/rspamd",
                        "description": "Rapid spam filtering system.",
                        "fork": false,
                        "url": "https://api.github.com/repos/rspamd/rspamd",
                        "forks_url": "https://api.github.com/repos/rspamd/rspamd/forks",
                        "keys_url": "https://api.github.com/repos/rspamd/rspamd/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/rspamd/rspamd/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/rspamd/rspamd/teams",
                        "hooks_url": "https://api.github.com/repos/rspamd/rspamd/hooks",
                        "issue_events_url": "https://api.github.com/repos/rspamd/rspamd/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/rspamd/rspamd/events",
                        "assignees_url": "https://api.github.com/repos/rspamd/rspamd/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/rspamd/rspamd/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/rspamd/rspamd/tags",
                        "blobs_url": "https://api.github.com/repos/rspamd/rspamd/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/rspamd/rspamd/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/rspamd/rspamd/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/rspamd/rspamd/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/rspamd/rspamd/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/rspamd/rspamd/languages",
                        "stargazers_url": "https://api.github.com/repos/rspamd/rspamd/stargazers",
                        "contributors_url": "https://api.github.com/repos/rspamd/rspamd/contributors",
                        "subscribers_url": "https://api.github.com/repos/rspamd/rspamd/subscribers",
                        "subscription_url": "https://api.github.com/repos/rspamd/rspamd/subscription",
                        "commits_url": "https://api.github.com/repos/rspamd/rspamd/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/rspamd/rspamd/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/rspamd/rspamd/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/rspamd/rspamd/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/rspamd/rspamd/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/rspamd/rspamd/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/rspamd/rspamd/merges",
                        "archive_url": "https://api.github.com/repos/rspamd/rspamd/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/rspamd/rspamd/downloads",
                        "issues_url": "https://api.github.com/repos/rspamd/rspamd/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/rspamd/rspamd/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/rspamd/rspamd/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/rspamd/rspamd/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/rspamd/rspamd/labels{/name}",
                        "releases_url": "https://api.github.com/repos/rspamd/rspamd/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/rspamd/rspamd/deployments",
                        "created_at": "2013-04-19T16:00:18Z",
                        "updated_at": "2023-10-25T08:03:34Z",
                        "pushed_at": "2023-10-26T10:06:25Z",
                        "git_url": "git://github.com/rspamd/rspamd.git",
                        "ssh_url": "git@github.com:rspamd/rspamd.git",
                        "clone_url": "https://github.com/rspamd/rspamd.git",
                        "svn_url": "https://github.com/rspamd/rspamd",
                        "homepage": null,
                        "size": 67629,
                        "stargazers_count": 1833,
                        "watchers_count": 1833,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": true,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 369,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 143,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "c",
                            "email",
                            "lua",
                            "rspamd",
                            "spam-filter"
                        ],
                        "visibility": "public",
                        "forks": 369,
                        "open_issues": 143,
                        "watchers": 1833,
                        "default_branch": "master"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/rspamd/rspamd/pulls/4657"
                    },
                    "html": {
                        "href": "https://github.com/rspamd/rspamd/pull/4657"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/rspamd/rspamd/issues/4657"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/rspamd/rspamd/issues/4657/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/rspamd/rspamd/pulls/4657/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/rspamd/rspamd/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/rspamd/rspamd/pulls/4657/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/rspamd/rspamd/statuses/15e3f277fad7c692b641423b38d6b508b764a3f8"
                    }
                },
                "author_association": "MEMBER",
                "auto_merge": null,
                "active_lock_reason": null,
                "merged": true,
                "mergeable": null,
                "rebaseable": null,
                "mergeable_state": "unknown",
                "merged_by": {
                    "login": "vstakhov",
                    "id": 487344,
                    "node_id": "MDQ6VXNlcjQ4NzM0NA==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/487344?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/vstakhov",
                    "html_url": "https://github.com/vstakhov",
                    "followers_url": "https://api.github.com/users/vstakhov/followers",
                    "following_url": "https://api.github.com/users/vstakhov/following{/other_user}",
                    "gists_url": "https://api.github.com/users/vstakhov/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/vstakhov/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/vstakhov/subscriptions",
                    "organizations_url": "https://api.github.com/users/vstakhov/orgs",
                    "repos_url": "https://api.github.com/users/vstakhov/repos",
                    "events_url": "https://api.github.com/users/vstakhov/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/vstakhov/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "comments": 0,
                "review_comments": 1,
                "maintainer_can_modify": false,
                "commits": 5,
                "additions": 100,
                "deletions": 14,
                "changed_files": 4
            }
        },
        "public": true,
        "created_at": "2023-10-26T10:06:27Z",
        "org": {
            "id": 21975367,
            "login": "rspamd",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/rspamd",
            "avatar_url": "https://avatars.githubusercontent.com/u/21975367?"
        }
    },
    {
        "id": "32863313766",
        "type": "IssueCommentEvent",
        "actor": {
            "id": 57094497,
            "login": "droszler",
            "display_login": "droszler",
            "gravatar_id": "",
            "url": "https://api.github.com/users/droszler",
            "avatar_url": "https://avatars.githubusercontent.com/u/57094497?"
        },
        "repo": {
            "id": 9549081,
            "name": "rspamd/rspamd",
            "url": "https://api.github.com/repos/rspamd/rspamd"
        },
        "payload": {
            "action": "created",
            "issue": {
                "url": "https://api.github.com/repos/rspamd/rspamd/issues/4643",
                "repository_url": "https://api.github.com/repos/rspamd/rspamd",
                "labels_url": "https://api.github.com/repos/rspamd/rspamd/issues/4643/labels{/name}",
                "comments_url": "https://api.github.com/repos/rspamd/rspamd/issues/4643/comments",
                "events_url": "https://api.github.com/repos/rspamd/rspamd/issues/4643/events",
                "html_url": "https://github.com/rspamd/rspamd/issues/4643",
                "id": 1942091606,
                "node_id": "I_kwDOAJG1Gc5zwfdW",
                "number": 4643,
                "title": "ICAP Issues after 3.7.1 upgrade - ESET[BUG]",
                "user": {
                    "login": "padrogass",
                    "id": 12258169,
                    "node_id": "MDQ6VXNlcjEyMjU4MTY5",
                    "avatar_url": "https://avatars.githubusercontent.com/u/12258169?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/padrogass",
                    "html_url": "https://github.com/padrogass",
                    "followers_url": "https://api.github.com/users/padrogass/followers",
                    "following_url": "https://api.github.com/users/padrogass/following{/other_user}",
                    "gists_url": "https://api.github.com/users/padrogass/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/padrogass/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/padrogass/subscriptions",
                    "organizations_url": "https://api.github.com/users/padrogass/orgs",
                    "repos_url": "https://api.github.com/users/padrogass/repos",
                    "events_url": "https://api.github.com/users/padrogass/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/padrogass/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "labels": [
                    {
                        "id": 36571652,
                        "node_id": "MDU6TGFiZWwzNjU3MTY1Mg==",
                        "url": "https://api.github.com/repos/rspamd/rspamd/labels/bug",
                        "name": "bug",
                        "color": "fc2929",
                        "default": true,
                        "description": null
                    }
                ],
                "state": "open",
                "locked": false,
                "assignee": null,
                "assignees": [],
                "milestone": null,
                "comments": 13,
                "created_at": "2023-10-13T14:40:45Z",
                "updated_at": "2023-10-26T09:51:51Z",
                "closed_at": null,
                "author_association": "NONE",
                "active_lock_reason": null,
                "body": "Hi!\r\n\r\nICAP sanning (ESET Server Security for Linux (version: 10.0.328.0)) is not working after RSPAMD 3.7.1 upgrade. \r\n\r\nMy external_services.conf file is the same as it was working on previous versions or rspamd:\r\n\r\neset {\r\n  servers = \"127.0.0.1:1344\";\r\n  user_agent = \"RSPM_Agent\";\r\n  # symbol to add (add it to metric if you want non-zero weight)\r\n  symbol = \"ESET_VIRUS\";\r\n\r\n  # type of scanner: \"icap\", \"oletools\", \"dcc\" or \"vadesecure\"\r\n  type = \"icap\";\r\n  scheme = \"scan\";\r\n  # Scan mime_parts seperately - otherwise the complete mail will be transfered\r\n  scan_mime_parts = true;\r\n  scan_text_mime = true;\r\n  scan_image_mime = true;\r\n\r\n  # filter attachments by content-type, filename or filename extension\r\n  # setting a filter will also enable scan_mime_parts = true;\r\n  mime_parts_filter_regex {\r\n    #FILE1 = \"^invoice\\.xls$\"\r\n    #DOC1 = \"application\\/msword\";\r\n  }\r\n  mime_parts_filter_ext {\r\n    #doc = \"doc\";\r\n    #docx = \"docx\";\r\n  }\r\n\r\n  # If set force this action if any threat is found (default unset: no action is forced)\r\n  #action = \"reject\";\r\n\r\n  # If `max_size` is set, messages > n bytes in size are not scanned\r\n  #max_size = 20000000;\r\n\r\n  # If set true, log message is emitted for clean messages\r\n  log_clean = true;\r\n\r\n  # if `patterns` is specified threat name will be matched against provided regexes and the related\r\n  # symbol will be yielded if a match is found. If no match is found, default symbol is yielded.\r\n  patterns {\r\n    # symbol_name = \"pattern\";\r\n    JUST_EICAR = '^Eicar-Test-Signature$';\r\n  }\r\n  # same as above, but matching on the _FAIL symbol\r\n  patterns_fail {\r\n    # symbol_name = \"pattern\";\r\n  }\r\n  # In version 1.7.0+ patterns could be extended\r\n  #patterns = {SANE_MAL = 'Sanesecurity\\.Malware\\.*', CLAM_UNOFFICIAL = 'UNOFFICIAL$'};\r\n\r\n  # `whitelist` points to a map of IP addresses. Mail from these addresses is not scanned.\r\n  whitelist = \"/etc/rspamd/antivirus.wl\";\r\n}\r\n\r\nRSPAMD shows this messages:\r\n\r\n_2023-10-13 16:20:49 #79158(main) <b7x9e6>; lua; external_services.lua:193: registered external services rule: symbol ESET_VIRUS; type icap\r\n2023-10-13 16:22:54 #79159(rspamd_proxy) <7ff231>; lua; icap.lua:574: eset (icap): ICAP ERROR: ICAP/1.0 400 Bad request\r\n2023-10-13 16:22:54 #79159(rspamd_proxy) <7ff231>; lua; common.lua:113: eset (icap): result - FAILED with error: \"ICAP/1.0 400 Bad request - score: 0\"_\r\n\r\nESET shows this messages on log:\r\n\r\n_13/10/2023, 16:22 ICAP Server Invalid request: Bad message eset-efs-icapd_\r\n",
                "reactions": {
                    "url": "https://api.github.com/repos/rspamd/rspamd/issues/4643/reactions",
                    "total_count": 2,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 2,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "timeline_url": "https://api.github.com/repos/rspamd/rspamd/issues/4643/timeline",
                "performed_via_github_app": null,
                "state_reason": null
            },
            "comment": {
                "url": "https://api.github.com/repos/rspamd/rspamd/issues/comments/1780786196",
                "html_url": "https://github.com/rspamd/rspamd/issues/4643#issuecomment-1780786196",
                "issue_url": "https://api.github.com/repos/rspamd/rspamd/issues/4643",
                "id": 1780786196,
                "node_id": "IC_kwDOAJG1Gc5qJKQU",
                "user": {
                    "login": "droszler",
                    "id": 57094497,
                    "node_id": "MDQ6VXNlcjU3MDk0NDk3",
                    "avatar_url": "https://avatars.githubusercontent.com/u/57094497?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/droszler",
                    "html_url": "https://github.com/droszler",
                    "followers_url": "https://api.github.com/users/droszler/followers",
                    "following_url": "https://api.github.com/users/droszler/following{/other_user}",
                    "gists_url": "https://api.github.com/users/droszler/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/droszler/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/droszler/subscriptions",
                    "organizations_url": "https://api.github.com/users/droszler/orgs",
                    "repos_url": "https://api.github.com/users/droszler/repos",
                    "events_url": "https://api.github.com/users/droszler/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/droszler/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "created_at": "2023-10-26T09:51:51Z",
                "updated_at": "2023-10-26T09:51:51Z",
                "author_association": "NONE",
                "body": "Hi Grufocom,\r\n\r\ncan you show us your configuration (external_services.conf)?\r\ni'm getting icap errors:\r\n\r\nOct 26 11:47:49 mail rspamd[621792]: <a64a2b>; lua; icap.lua:583: icap (icap): ICAP ERROR: ICAP/1.0 400 Bad request\r\nOct 26 11:47:49 mail rspamd[621792]: <a64a2b>; lua; common.lua:113: icap (icap): result - FAILED with error: \"ICAP/1.0 400 Bad request - score: 0\"\r\n\r\nand\r\n\r\nOct 26 11:47:57 mail rspamd[621792]: <189d45>; icap; icap.lua:215: icap (icap): icap_w_respond_cb Request Error: IO write error while trying to write 0 bytes: A kapcsolatot bontotta a t\u00e1voli f\u00e9l - retries left: 0\r\n\r\nMy config:\r\nicap {\r\n  scheme = \"scan\";\r\n  servers = \"81.93.xxx.yyy:1344\";\r\n  user_agent = \"extended\";\r\n}\r\n",
                "reactions": {
                    "url": "https://api.github.com/repos/rspamd/rspamd/issues/comments/1780786196/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "performed_via_github_app": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T09:51:52Z",
        "org": {
            "id": 21975367,
            "login": "rspamd",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/rspamd",
            "avatar_url": "https://avatars.githubusercontent.com/u/21975367?"
        }
    },
    {
        "id": "32849292570",
        "type": "IssuesEvent",
        "actor": {
            "id": 1865999,
            "login": "dragoangel",
            "display_login": "dragoangel",
            "gravatar_id": "",
            "url": "https://api.github.com/users/dragoangel",
            "avatar_url": "https://avatars.githubusercontent.com/u/1865999?"
        },
        "repo": {
            "id": 9549081,
            "name": "rspamd/rspamd",
            "url": "https://api.github.com/repos/rspamd/rspamd"
        },
        "payload": {
            "action": "opened",
            "issue": {
                "url": "https://api.github.com/repos/rspamd/rspamd/issues/4663",
                "repository_url": "https://api.github.com/repos/rspamd/rspamd",
                "labels_url": "https://api.github.com/repos/rspamd/rspamd/issues/4663/labels{/name}",
                "comments_url": "https://api.github.com/repos/rspamd/rspamd/issues/4663/comments",
                "events_url": "https://api.github.com/repos/rspamd/rspamd/issues/4663/events",
                "html_url": "https://github.com/rspamd/rspamd/issues/4663",
                "id": 1962220962,
                "node_id": "I_kwDOAJG1Gc509R2i",
                "number": 4663,
                "title": "[Feature] Support Redis sharding (hash slots) exclusively for per_user bayes",
                "user": {
                    "login": "dragoangel",
                    "id": 1865999,
                    "node_id": "MDQ6VXNlcjE4NjU5OTk=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/1865999?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/dragoangel",
                    "html_url": "https://github.com/dragoangel",
                    "followers_url": "https://api.github.com/users/dragoangel/followers",
                    "following_url": "https://api.github.com/users/dragoangel/following{/other_user}",
                    "gists_url": "https://api.github.com/users/dragoangel/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/dragoangel/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/dragoangel/subscriptions",
                    "organizations_url": "https://api.github.com/users/dragoangel/orgs",
                    "repos_url": "https://api.github.com/users/dragoangel/repos",
                    "events_url": "https://api.github.com/users/dragoangel/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/dragoangel/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "labels": [
                    {
                        "id": 36571654,
                        "node_id": "MDU6TGFiZWwzNjU3MTY1NA==",
                        "url": "https://api.github.com/repos/rspamd/rspamd/labels/enhancement",
                        "name": "enhancement",
                        "color": "84b6eb",
                        "default": true,
                        "description": null
                    }
                ],
                "state": "open",
                "locked": false,
                "assignee": null,
                "assignees": [],
                "milestone": null,
                "comments": 0,
                "created_at": "2023-10-25T21:01:09Z",
                "updated_at": "2023-10-25T21:01:09Z",
                "closed_at": null,
                "author_association": "CONTRIBUTOR",
                "active_lock_reason": null,
                "body": "<!--\r\n\r\nDo you want to ask a question? Are you looking for support? Here are the places where you can get what you need: https://rspamd.com/support.html\r\n\r\nFeature requests are welcomed. Before opening a feature request, please take a moment to find out whether your idea fits with the scope and goals of the project. It\u2019s up to you to make a strong case to convince the project maintainers the merits of the feature. Please provide as much detail and context as possible.\r\n\r\n-->\r\n\r\n## Summary\r\n\r\nSupport Redis sharding (hash slots) exclusively for per_user bayes (statistics)\r\n\r\n## Motivation\r\n\r\nGet better level of statistics quality per_user by having option to store it in shared Redis setups.\r\n\r\n## Describe alternatives you've considered\r\n\r\nWhile statistics `per_user = false;` is okay with a couple of GBs in Redis same data splitted per_user requires much more data to be stored, because of 2 factors: key name size includes full email address which can be quite big and general nature of statistics per user. From a logical perspective sharding in Redis for per_user bayes storage should fit flawlessly if all keys for one user will use the same hash tag and will be placed in the same Redis shard.\r\n\r\n## Additional context\r\n\r\nI'm aware of https://github.com/rspamd/rspamd/issues/1883 but my request a bit more exact, it asks only sharding for place where it can fit without issues, at least from my view",
                "reactions": {
                    "url": "https://api.github.com/repos/rspamd/rspamd/issues/4663/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "timeline_url": "https://api.github.com/repos/rspamd/rspamd/issues/4663/timeline",
                "performed_via_github_app": null,
                "state_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-25T21:01:10Z",
        "org": {
            "id": 21975367,
            "login": "rspamd",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/rspamd",
            "avatar_url": "https://avatars.githubusercontent.com/u/21975367?"
        }
    },
    {
        "id": "32844884666",
        "type": "PushEvent",
        "actor": {
            "id": 487344,
            "login": "vstakhov",
            "display_login": "vstakhov",
            "gravatar_id": "",
            "url": "https://api.github.com/users/vstakhov",
            "avatar_url": "https://avatars.githubusercontent.com/u/487344?"
        },
        "repo": {
            "id": 9549081,
            "name": "rspamd/rspamd",
            "url": "https://api.github.com/repos/rspamd/rspamd"
        },
        "payload": {
            "repository_id": 9549081,
            "push_id": 15564782260,
            "size": 7,
            "distinct_size": 7,
            "ref": "refs/heads/master",
            "head": "6491804e19f1771bb1b4146420a2a3b98939d516",
            "before": "b48547358dfc8aed59c7c69b1718595c41f65c43",
            "commits": [
                {
                    "sha": "7379c8b28375f8c8944165b8dea75d462eb47139",
                    "author": {
                        "email": "40121680+twesterhever@users.noreply.github.com",
                        "name": "twesterhever"
                    },
                    "message": "[Minor] Refer to third parties for attachment handling whenever possible\n\nThis avoids confusion and enqueries to the rspamd project, if it is made\nclear that the decision to score certain attachments high has been\nincorporated from a well-known third party, such as Google's or\nMicrosoft's attachment handling policy.",
                    "distinct": true,
                    "url": "https://api.github.com/repos/rspamd/rspamd/commits/7379c8b28375f8c8944165b8dea75d462eb47139"
                },
                {
                    "sha": "e484b311bb57ab9843684db33738c9829bdbba6e",
                    "author": {
                        "email": "40121680+twesterhever@users.noreply.github.com",
                        "name": "twesterhever"
                    },
                    "message": "[Minor] Incorporate additional bad attachments from Microsoft\n\nThese are as follows:\n- htc: HTML Component File\n- pyc: Compiled Python Script\n- pyo: Optimized Compiled Python Module\n- pyw: Python Script To Be Executed With Suppressed Terminal Window\n- pyz: Python Zip Application\n- pyzw: Python Zip Application\n- vhd: Virtual Hard Disk\n- vhdx: Virtual Hard Disk Extended\n- wsf: Windows Script File\n\nNote that the Python file types remain unscored in archives, so\ndistribution of these in source tarballs and the like is not affected by\nthis commit.\n\nSource: https://support.microsoft.com/en-us/office/blocked-attachments-in-outlook-434752e1-02d3-4e90-9124-8b81e49a8519?ui=en-us&rs=en-us&ad=us",
                    "distinct": true,
                    "url": "https://api.github.com/repos/rspamd/rspamd/commits/e484b311bb57ab9843684db33738c9829bdbba6e"
                },
                {
                    "sha": "8171424d846a3e33b5d0f9f7f4ee09ec8d553a03",
                    "author": {
                        "email": "40121680+twesterhever@users.noreply.github.com",
                        "name": "twesterhever"
                    },
                    "message": "[Minor] Increase scoring of *.exe attachments\n\nThese are already banned in most environments, including GMail and\nOutlook. We may as well bump this score up to 4 eventually.",
                    "distinct": true,
                    "url": "https://api.github.com/repos/rspamd/rspamd/commits/8171424d846a3e33b5d0f9f7f4ee09ec8d553a03"
                },
                {
                    "sha": "fab67cebb9c1f29966477ba2eabf167435a9c337",
                    "author": {
                        "email": "40121680+twesterhever@users.noreply.github.com",
                        "name": "twesterhever"
                    },
                    "message": "[Minor] Add additional bad attachment types\n\n- app: Executable Application, blocked in Outlook by default\n- aspx: Active Server Page Extended, blocked in Outlook by default\n- dll: Dynamic-link Library\n- dqy: Microsoft Query File, blocking recommended in MS365\n- iqy: ditto\n- mht: MHTML File, often abused for phishing and exploit attempts\n- mhtml: ditto\n- oqy: Microsoft Query File, blocking recommended in MS365\n- rqy: ditto\n- slk: Microsoft Symbolic Link\n- wim: Windows Imaging Format",
                    "distinct": true,
                    "url": "https://api.github.com/repos/rspamd/rspamd/commits/fab67cebb9c1f29966477ba2eabf167435a9c337"
                },
                {
                    "sha": "15548d3dece592403973e9bb09c0665df84a2398",
                    "author": {
                        "email": "40121680+twesterhever@users.noreply.github.com",
                        "name": "twesterhever"
                    },
                    "message": "Revert \"[Minor] Increase scoring of *.exe attachments\"\n\nReverted based on feedback by @moisseev.\n\nThis reverts commit 8171424d846a3e33b5d0f9f7f4ee09ec8d553a03.",
                    "distinct": true,
                    "url": "https://api.github.com/repos/rspamd/rspamd/commits/15548d3dece592403973e9bb09c0665df84a2398"
                },
                {
                    "sha": "b135022759cc30b4ee71f6aab833461cb604f6e4",
                    "author": {
                        "email": "40121680+twesterhever@users.noreply.github.com",
                        "name": "twesterhever"
                    },
                    "message": "[Minor] Remove duplicate *.app attachment type\n\nReported by @fatalbanana.",
                    "distinct": true,
                    "url": "https://api.github.com/repos/rspamd/rspamd/commits/b135022759cc30b4ee71f6aab833461cb604f6e4"
                },
                {
                    "sha": "6491804e19f1771bb1b4146420a2a3b98939d516",
                    "author": {
                        "email": "vsevolod@rspamd.com",
                        "name": "Vsevolod Stakhov"
                    },
                    "message": "Merge pull request #4656 from twesterhever/temp-tighten-attachment-policy\n\nTighten rspamd's attachment policy",
                    "distinct": true,
                    "url": "https://api.github.com/repos/rspamd/rspamd/commits/6491804e19f1771bb1b4146420a2a3b98939d516"
                }
            ]
        },
        "public": true,
        "created_at": "2023-10-25T17:55:45Z",
        "org": {
            "id": 21975367,
            "login": "rspamd",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/rspamd",
            "avatar_url": "https://avatars.githubusercontent.com/u/21975367?"
        }
    },
    {
        "id": "32844884380",
        "type": "PullRequestEvent",
        "actor": {
            "id": 487344,
            "login": "vstakhov",
            "display_login": "vstakhov",
            "gravatar_id": "",
            "url": "https://api.github.com/users/vstakhov",
            "avatar_url": "https://avatars.githubusercontent.com/u/487344?"
        },
        "repo": {
            "id": 9549081,
            "name": "rspamd/rspamd",
            "url": "https://api.github.com/repos/rspamd/rspamd"
        },
        "payload": {
            "action": "closed",
            "number": 4656,
            "pull_request": {
                "url": "https://api.github.com/repos/rspamd/rspamd/pulls/4656",
                "id": 1568191954,
                "node_id": "PR_kwDOAJG1Gc5deLXS",
                "html_url": "https://github.com/rspamd/rspamd/pull/4656",
                "diff_url": "https://github.com/rspamd/rspamd/pull/4656.diff",
                "patch_url": "https://github.com/rspamd/rspamd/pull/4656.patch",
                "issue_url": "https://api.github.com/repos/rspamd/rspamd/issues/4656",
                "number": 4656,
                "state": "closed",
                "locked": false,
                "title": "Tighten rspamd's attachment policy",
                "user": {
                    "login": "twesterhever",
                    "id": 40121680,
                    "node_id": "MDQ6VXNlcjQwMTIxNjgw",
                    "avatar_url": "https://avatars.githubusercontent.com/u/40121680?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/twesterhever",
                    "html_url": "https://github.com/twesterhever",
                    "followers_url": "https://api.github.com/users/twesterhever/followers",
                    "following_url": "https://api.github.com/users/twesterhever/following{/other_user}",
                    "gists_url": "https://api.github.com/users/twesterhever/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/twesterhever/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/twesterhever/subscriptions",
                    "organizations_url": "https://api.github.com/users/twesterhever/orgs",
                    "repos_url": "https://api.github.com/users/twesterhever/repos",
                    "events_url": "https://api.github.com/users/twesterhever/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/twesterhever/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "This merge request seeks to clean up the current list of bad attachments in order to make it clear that these decision have been incorporated from third parties whenever possible, adds a couple of additional bad attachment types from [Microsoft's Outlook attachment handling policy](https://support.microsoft.com/en-us/office/blocked-attachments-in-outlook-434752e1-02d3-4e90-9124-8b81e49a8519?ui=en-us&rs=en-us&ad=us), as well as a couple of attachment types never observed in legitimate e-mails.\r\n\r\nThe latter was triggered by a recent onslaught in phishing e-mails leveraging MHTML.",
                "created_at": "2023-10-22T20:33:36Z",
                "updated_at": "2023-10-25T17:55:44Z",
                "closed_at": "2023-10-25T17:55:43Z",
                "merged_at": "2023-10-25T17:55:43Z",
                "merge_commit_sha": "6491804e19f1771bb1b4146420a2a3b98939d516",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/rspamd/rspamd/pulls/4656/commits",
                "review_comments_url": "https://api.github.com/repos/rspamd/rspamd/pulls/4656/comments",
                "review_comment_url": "https://api.github.com/repos/rspamd/rspamd/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/rspamd/rspamd/issues/4656/comments",
                "statuses_url": "https://api.github.com/repos/rspamd/rspamd/statuses/b135022759cc30b4ee71f6aab833461cb604f6e4",
                "head": {
                    "label": "twesterhever:temp-tighten-attachment-policy",
                    "ref": "temp-tighten-attachment-policy",
                    "sha": "b135022759cc30b4ee71f6aab833461cb604f6e4",
                    "user": {
                        "login": "twesterhever",
                        "id": 40121680,
                        "node_id": "MDQ6VXNlcjQwMTIxNjgw",
                        "avatar_url": "https://avatars.githubusercontent.com/u/40121680?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/twesterhever",
                        "html_url": "https://github.com/twesterhever",
                        "followers_url": "https://api.github.com/users/twesterhever/followers",
                        "following_url": "https://api.github.com/users/twesterhever/following{/other_user}",
                        "gists_url": "https://api.github.com/users/twesterhever/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/twesterhever/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/twesterhever/subscriptions",
                        "organizations_url": "https://api.github.com/users/twesterhever/orgs",
                        "repos_url": "https://api.github.com/users/twesterhever/repos",
                        "events_url": "https://api.github.com/users/twesterhever/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/twesterhever/received_events",
                        "type": "User",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 479751851,
                        "node_id": "R_kgDOHJhuqw",
                        "name": "rspamd",
                        "full_name": "twesterhever/rspamd",
                        "private": false,
                        "owner": {
                            "login": "twesterhever",
                            "id": 40121680,
                            "node_id": "MDQ6VXNlcjQwMTIxNjgw",
                            "avatar_url": "https://avatars.githubusercontent.com/u/40121680?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/twesterhever",
                            "html_url": "https://github.com/twesterhever",
                            "followers_url": "https://api.github.com/users/twesterhever/followers",
                            "following_url": "https://api.github.com/users/twesterhever/following{/other_user}",
                            "gists_url": "https://api.github.com/users/twesterhever/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/twesterhever/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/twesterhever/subscriptions",
                            "organizations_url": "https://api.github.com/users/twesterhever/orgs",
                            "repos_url": "https://api.github.com/users/twesterhever/repos",
                            "events_url": "https://api.github.com/users/twesterhever/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/twesterhever/received_events",
                            "type": "User",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/twesterhever/rspamd",
                        "description": "Rapid spam filtering system.",
                        "fork": true,
                        "url": "https://api.github.com/repos/twesterhever/rspamd",
                        "forks_url": "https://api.github.com/repos/twesterhever/rspamd/forks",
                        "keys_url": "https://api.github.com/repos/twesterhever/rspamd/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/twesterhever/rspamd/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/twesterhever/rspamd/teams",
                        "hooks_url": "https://api.github.com/repos/twesterhever/rspamd/hooks",
                        "issue_events_url": "https://api.github.com/repos/twesterhever/rspamd/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/twesterhever/rspamd/events",
                        "assignees_url": "https://api.github.com/repos/twesterhever/rspamd/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/twesterhever/rspamd/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/twesterhever/rspamd/tags",
                        "blobs_url": "https://api.github.com/repos/twesterhever/rspamd/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/twesterhever/rspamd/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/twesterhever/rspamd/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/twesterhever/rspamd/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/twesterhever/rspamd/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/twesterhever/rspamd/languages",
                        "stargazers_url": "https://api.github.com/repos/twesterhever/rspamd/stargazers",
                        "contributors_url": "https://api.github.com/repos/twesterhever/rspamd/contributors",
                        "subscribers_url": "https://api.github.com/repos/twesterhever/rspamd/subscribers",
                        "subscription_url": "https://api.github.com/repos/twesterhever/rspamd/subscription",
                        "commits_url": "https://api.github.com/repos/twesterhever/rspamd/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/twesterhever/rspamd/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/twesterhever/rspamd/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/twesterhever/rspamd/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/twesterhever/rspamd/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/twesterhever/rspamd/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/twesterhever/rspamd/merges",
                        "archive_url": "https://api.github.com/repos/twesterhever/rspamd/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/twesterhever/rspamd/downloads",
                        "issues_url": "https://api.github.com/repos/twesterhever/rspamd/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/twesterhever/rspamd/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/twesterhever/rspamd/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/twesterhever/rspamd/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/twesterhever/rspamd/labels{/name}",
                        "releases_url": "https://api.github.com/repos/twesterhever/rspamd/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/twesterhever/rspamd/deployments",
                        "created_at": "2022-04-09T14:33:24Z",
                        "updated_at": "2022-04-18T20:02:31Z",
                        "pushed_at": "2023-10-25T12:45:53Z",
                        "git_url": "git://github.com/twesterhever/rspamd.git",
                        "ssh_url": "git@github.com:twesterhever/rspamd.git",
                        "clone_url": "https://github.com/twesterhever/rspamd.git",
                        "svn_url": "https://github.com/twesterhever/rspamd",
                        "homepage": null,
                        "size": 67586,
                        "stargazers_count": 0,
                        "watchers_count": 0,
                        "language": "C",
                        "has_issues": false,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": true,
                        "has_pages": false,
                        "has_discussions": false,
                        "forks_count": 0,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 0,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [],
                        "visibility": "public",
                        "forks": 0,
                        "open_issues": 0,
                        "watchers": 0,
                        "default_branch": "master"
                    }
                },
                "base": {
                    "label": "rspamd:master",
                    "ref": "master",
                    "sha": "5c918670919580b1b514ddc21f58ec3ac32ab8eb",
                    "user": {
                        "login": "rspamd",
                        "id": 21975367,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjIxOTc1MzY3",
                        "avatar_url": "https://avatars.githubusercontent.com/u/21975367?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/rspamd",
                        "html_url": "https://github.com/rspamd",
                        "followers_url": "https://api.github.com/users/rspamd/followers",
                        "following_url": "https://api.github.com/users/rspamd/following{/other_user}",
                        "gists_url": "https://api.github.com/users/rspamd/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/rspamd/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/rspamd/subscriptions",
                        "organizations_url": "https://api.github.com/users/rspamd/orgs",
                        "repos_url": "https://api.github.com/users/rspamd/repos",
                        "events_url": "https://api.github.com/users/rspamd/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/rspamd/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 9549081,
                        "node_id": "MDEwOlJlcG9zaXRvcnk5NTQ5MDgx",
                        "name": "rspamd",
                        "full_name": "rspamd/rspamd",
                        "private": false,
                        "owner": {
                            "login": "rspamd",
                            "id": 21975367,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjIxOTc1MzY3",
                            "avatar_url": "https://avatars.githubusercontent.com/u/21975367?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/rspamd",
                            "html_url": "https://github.com/rspamd",
                            "followers_url": "https://api.github.com/users/rspamd/followers",
                            "following_url": "https://api.github.com/users/rspamd/following{/other_user}",
                            "gists_url": "https://api.github.com/users/rspamd/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/rspamd/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/rspamd/subscriptions",
                            "organizations_url": "https://api.github.com/users/rspamd/orgs",
                            "repos_url": "https://api.github.com/users/rspamd/repos",
                            "events_url": "https://api.github.com/users/rspamd/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/rspamd/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/rspamd/rspamd",
                        "description": "Rapid spam filtering system.",
                        "fork": false,
                        "url": "https://api.github.com/repos/rspamd/rspamd",
                        "forks_url": "https://api.github.com/repos/rspamd/rspamd/forks",
                        "keys_url": "https://api.github.com/repos/rspamd/rspamd/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/rspamd/rspamd/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/rspamd/rspamd/teams",
                        "hooks_url": "https://api.github.com/repos/rspamd/rspamd/hooks",
                        "issue_events_url": "https://api.github.com/repos/rspamd/rspamd/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/rspamd/rspamd/events",
                        "assignees_url": "https://api.github.com/repos/rspamd/rspamd/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/rspamd/rspamd/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/rspamd/rspamd/tags",
                        "blobs_url": "https://api.github.com/repos/rspamd/rspamd/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/rspamd/rspamd/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/rspamd/rspamd/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/rspamd/rspamd/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/rspamd/rspamd/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/rspamd/rspamd/languages",
                        "stargazers_url": "https://api.github.com/repos/rspamd/rspamd/stargazers",
                        "contributors_url": "https://api.github.com/repos/rspamd/rspamd/contributors",
                        "subscribers_url": "https://api.github.com/repos/rspamd/rspamd/subscribers",
                        "subscription_url": "https://api.github.com/repos/rspamd/rspamd/subscription",
                        "commits_url": "https://api.github.com/repos/rspamd/rspamd/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/rspamd/rspamd/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/rspamd/rspamd/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/rspamd/rspamd/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/rspamd/rspamd/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/rspamd/rspamd/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/rspamd/rspamd/merges",
                        "archive_url": "https://api.github.com/repos/rspamd/rspamd/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/rspamd/rspamd/downloads",
                        "issues_url": "https://api.github.com/repos/rspamd/rspamd/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/rspamd/rspamd/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/rspamd/rspamd/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/rspamd/rspamd/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/rspamd/rspamd/labels{/name}",
                        "releases_url": "https://api.github.com/repos/rspamd/rspamd/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/rspamd/rspamd/deployments",
                        "created_at": "2013-04-19T16:00:18Z",
                        "updated_at": "2023-10-25T08:03:34Z",
                        "pushed_at": "2023-10-25T17:55:43Z",
                        "git_url": "git://github.com/rspamd/rspamd.git",
                        "ssh_url": "git@github.com:rspamd/rspamd.git",
                        "clone_url": "https://github.com/rspamd/rspamd.git",
                        "svn_url": "https://github.com/rspamd/rspamd",
                        "homepage": null,
                        "size": 67610,
                        "stargazers_count": 1833,
                        "watchers_count": 1833,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": true,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 369,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 143,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "c",
                            "email",
                            "lua",
                            "rspamd",
                            "spam-filter"
                        ],
                        "visibility": "public",
                        "forks": 369,
                        "open_issues": 143,
                        "watchers": 1833,
                        "default_branch": "master"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/rspamd/rspamd/pulls/4656"
                    },
                    "html": {
                        "href": "https://github.com/rspamd/rspamd/pull/4656"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/rspamd/rspamd/issues/4656"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/rspamd/rspamd/issues/4656/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/rspamd/rspamd/pulls/4656/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/rspamd/rspamd/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/rspamd/rspamd/pulls/4656/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/rspamd/rspamd/statuses/b135022759cc30b4ee71f6aab833461cb604f6e4"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null,
                "merged": true,
                "mergeable": null,
                "rebaseable": null,
                "mergeable_state": "unknown",
                "merged_by": {
                    "login": "vstakhov",
                    "id": 487344,
                    "node_id": "MDQ6VXNlcjQ4NzM0NA==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/487344?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/vstakhov",
                    "html_url": "https://github.com/vstakhov",
                    "followers_url": "https://api.github.com/users/vstakhov/followers",
                    "following_url": "https://api.github.com/users/vstakhov/following{/other_user}",
                    "gists_url": "https://api.github.com/users/vstakhov/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/vstakhov/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/vstakhov/subscriptions",
                    "organizations_url": "https://api.github.com/users/vstakhov/orgs",
                    "repos_url": "https://api.github.com/users/vstakhov/repos",
                    "events_url": "https://api.github.com/users/vstakhov/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/vstakhov/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "comments": 0,
                "review_comments": 4,
                "maintainer_can_modify": false,
                "commits": 6,
                "additions": 25,
                "deletions": 6,
                "changed_files": 1
            }
        },
        "public": true,
        "created_at": "2023-10-25T17:55:45Z",
        "org": {
            "id": 21975367,
            "login": "rspamd",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/rspamd",
            "avatar_url": "https://avatars.githubusercontent.com/u/21975367?"
        }
    },
    {
        "id": "32844871047",
        "type": "PullRequestReviewEvent",
        "actor": {
            "id": 487344,
            "login": "vstakhov",
            "display_login": "vstakhov",
            "gravatar_id": "",
            "url": "https://api.github.com/users/vstakhov",
            "avatar_url": "https://avatars.githubusercontent.com/u/487344?"
        },
        "repo": {
            "id": 9549081,
            "name": "rspamd/rspamd",
            "url": "https://api.github.com/repos/rspamd/rspamd"
        },
        "payload": {
            "action": "created",
            "review": {
                "id": 1697938458,
                "node_id": "PRR_kwDOAJG1Gc5lNHwa",
                "user": {
                    "login": "vstakhov",
                    "id": 487344,
                    "node_id": "MDQ6VXNlcjQ4NzM0NA==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/487344?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/vstakhov",
                    "html_url": "https://github.com/vstakhov",
                    "followers_url": "https://api.github.com/users/vstakhov/followers",
                    "following_url": "https://api.github.com/users/vstakhov/following{/other_user}",
                    "gists_url": "https://api.github.com/users/vstakhov/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/vstakhov/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/vstakhov/subscriptions",
                    "organizations_url": "https://api.github.com/users/vstakhov/orgs",
                    "repos_url": "https://api.github.com/users/vstakhov/repos",
                    "events_url": "https://api.github.com/users/vstakhov/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/vstakhov/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "Looks very good, thank you! Please update docs if possible to match these new options.",
                "commit_id": "5ef8dfff5dcff5e8922e5a2c8e41d7e381dbcd37",
                "submitted_at": "2023-10-25T17:55:11Z",
                "state": "approved",
                "html_url": "https://github.com/rspamd/rspamd/pull/4657#pullrequestreview-1697938458",
                "pull_request_url": "https://api.github.com/repos/rspamd/rspamd/pulls/4657",
                "author_association": "MEMBER",
                "_links": {
                    "html": {
                        "href": "https://github.com/rspamd/rspamd/pull/4657#pullrequestreview-1697938458"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/rspamd/rspamd/pulls/4657"
                    }
                }
            },
            "pull_request": {
                "url": "https://api.github.com/repos/rspamd/rspamd/pulls/4657",
                "id": 1570793693,
                "node_id": "PR_kwDOAJG1Gc5doGjd",
                "html_url": "https://github.com/rspamd/rspamd/pull/4657",
                "diff_url": "https://github.com/rspamd/rspamd/pull/4657.diff",
                "patch_url": "https://github.com/rspamd/rspamd/pull/4657.patch",
                "issue_url": "https://api.github.com/repos/rspamd/rspamd/issues/4657",
                "number": 4657,
                "state": "open",
                "locked": false,
                "title": "[Minor] rbl: support use of different matchers for return codes",
                "user": {
                    "login": "fatalbanana",
                    "id": 2176651,
                    "node_id": "MDQ6VXNlcjIxNzY2NTE=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/2176651?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/fatalbanana",
                    "html_url": "https://github.com/fatalbanana",
                    "followers_url": "https://api.github.com/users/fatalbanana/followers",
                    "following_url": "https://api.github.com/users/fatalbanana/following{/other_user}",
                    "gists_url": "https://api.github.com/users/fatalbanana/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/fatalbanana/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/fatalbanana/subscriptions",
                    "organizations_url": "https://api.github.com/users/fatalbanana/orgs",
                    "repos_url": "https://api.github.com/users/fatalbanana/repos",
                    "events_url": "https://api.github.com/users/fatalbanana/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/fatalbanana/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "The idea is to:\r\n\r\n- [X] get rid of un-needed usage of Lua patterns\r\n- [X] deprecate unqualified use of Lua patterns (prompt users to set `matcher = \"luapattern\"`)\r\n- [X] add different options for matching, like regexp\r\n- [x] and radix...\r\n- [x] and glob...",
                "created_at": "2023-10-24T10:48:22Z",
                "updated_at": "2023-10-25T17:55:11Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "6c29609ab81c97a60aabded3e438a443a05f15c8",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/rspamd/rspamd/pulls/4657/commits",
                "review_comments_url": "https://api.github.com/repos/rspamd/rspamd/pulls/4657/comments",
                "review_comment_url": "https://api.github.com/repos/rspamd/rspamd/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/rspamd/rspamd/issues/4657/comments",
                "statuses_url": "https://api.github.com/repos/rspamd/rspamd/statuses/5ef8dfff5dcff5e8922e5a2c8e41d7e381dbcd37",
                "head": {
                    "label": "fatalbanana:rbl_matchers",
                    "ref": "rbl_matchers",
                    "sha": "5ef8dfff5dcff5e8922e5a2c8e41d7e381dbcd37",
                    "user": {
                        "login": "fatalbanana",
                        "id": 2176651,
                        "node_id": "MDQ6VXNlcjIxNzY2NTE=",
                        "avatar_url": "https://avatars.githubusercontent.com/u/2176651?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/fatalbanana",
                        "html_url": "https://github.com/fatalbanana",
                        "followers_url": "https://api.github.com/users/fatalbanana/followers",
                        "following_url": "https://api.github.com/users/fatalbanana/following{/other_user}",
                        "gists_url": "https://api.github.com/users/fatalbanana/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/fatalbanana/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/fatalbanana/subscriptions",
                        "organizations_url": "https://api.github.com/users/fatalbanana/orgs",
                        "repos_url": "https://api.github.com/users/fatalbanana/repos",
                        "events_url": "https://api.github.com/users/fatalbanana/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/fatalbanana/received_events",
                        "type": "User",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 235838452,
                        "node_id": "MDEwOlJlcG9zaXRvcnkyMzU4Mzg0NTI=",
                        "name": "rspamd",
                        "full_name": "fatalbanana/rspamd",
                        "private": false,
                        "owner": {
                            "login": "fatalbanana",
                            "id": 2176651,
                            "node_id": "MDQ6VXNlcjIxNzY2NTE=",
                            "avatar_url": "https://avatars.githubusercontent.com/u/2176651?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/fatalbanana",
                            "html_url": "https://github.com/fatalbanana",
                            "followers_url": "https://api.github.com/users/fatalbanana/followers",
                            "following_url": "https://api.github.com/users/fatalbanana/following{/other_user}",
                            "gists_url": "https://api.github.com/users/fatalbanana/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/fatalbanana/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/fatalbanana/subscriptions",
                            "organizations_url": "https://api.github.com/users/fatalbanana/orgs",
                            "repos_url": "https://api.github.com/users/fatalbanana/repos",
                            "events_url": "https://api.github.com/users/fatalbanana/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/fatalbanana/received_events",
                            "type": "User",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/fatalbanana/rspamd",
                        "description": "Rapid spam filtering system.",
                        "fork": true,
                        "url": "https://api.github.com/repos/fatalbanana/rspamd",
                        "forks_url": "https://api.github.com/repos/fatalbanana/rspamd/forks",
                        "keys_url": "https://api.github.com/repos/fatalbanana/rspamd/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/fatalbanana/rspamd/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/fatalbanana/rspamd/teams",
                        "hooks_url": "https://api.github.com/repos/fatalbanana/rspamd/hooks",
                        "issue_events_url": "https://api.github.com/repos/fatalbanana/rspamd/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/fatalbanana/rspamd/events",
                        "assignees_url": "https://api.github.com/repos/fatalbanana/rspamd/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/fatalbanana/rspamd/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/fatalbanana/rspamd/tags",
                        "blobs_url": "https://api.github.com/repos/fatalbanana/rspamd/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/fatalbanana/rspamd/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/fatalbanana/rspamd/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/fatalbanana/rspamd/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/fatalbanana/rspamd/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/fatalbanana/rspamd/languages",
                        "stargazers_url": "https://api.github.com/repos/fatalbanana/rspamd/stargazers",
                        "contributors_url": "https://api.github.com/repos/fatalbanana/rspamd/contributors",
                        "subscribers_url": "https://api.github.com/repos/fatalbanana/rspamd/subscribers",
                        "subscription_url": "https://api.github.com/repos/fatalbanana/rspamd/subscription",
                        "commits_url": "https://api.github.com/repos/fatalbanana/rspamd/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/fatalbanana/rspamd/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/fatalbanana/rspamd/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/fatalbanana/rspamd/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/fatalbanana/rspamd/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/fatalbanana/rspamd/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/fatalbanana/rspamd/merges",
                        "archive_url": "https://api.github.com/repos/fatalbanana/rspamd/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/fatalbanana/rspamd/downloads",
                        "issues_url": "https://api.github.com/repos/fatalbanana/rspamd/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/fatalbanana/rspamd/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/fatalbanana/rspamd/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/fatalbanana/rspamd/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/fatalbanana/rspamd/labels{/name}",
                        "releases_url": "https://api.github.com/repos/fatalbanana/rspamd/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/fatalbanana/rspamd/deployments",
                        "created_at": "2020-01-23T16:38:58Z",
                        "updated_at": "2023-05-26T13:08:56Z",
                        "pushed_at": "2023-10-25T13:01:11Z",
                        "git_url": "git://github.com/fatalbanana/rspamd.git",
                        "ssh_url": "git@github.com:fatalbanana/rspamd.git",
                        "clone_url": "https://github.com/fatalbanana/rspamd.git",
                        "svn_url": "https://github.com/fatalbanana/rspamd",
                        "homepage": null,
                        "size": 67606,
                        "stargazers_count": 0,
                        "watchers_count": 0,
                        "language": "C",
                        "has_issues": false,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": true,
                        "has_pages": false,
                        "has_discussions": false,
                        "forks_count": 0,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 0,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [],
                        "visibility": "public",
                        "forks": 0,
                        "open_issues": 0,
                        "watchers": 0,
                        "default_branch": "master"
                    }
                },
                "base": {
                    "label": "rspamd:master",
                    "ref": "master",
                    "sha": "6b81b812a7a34ad7201b7df214bb543d089d7919",
                    "user": {
                        "login": "rspamd",
                        "id": 21975367,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjIxOTc1MzY3",
                        "avatar_url": "https://avatars.githubusercontent.com/u/21975367?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/rspamd",
                        "html_url": "https://github.com/rspamd",
                        "followers_url": "https://api.github.com/users/rspamd/followers",
                        "following_url": "https://api.github.com/users/rspamd/following{/other_user}",
                        "gists_url": "https://api.github.com/users/rspamd/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/rspamd/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/rspamd/subscriptions",
                        "organizations_url": "https://api.github.com/users/rspamd/orgs",
                        "repos_url": "https://api.github.com/users/rspamd/repos",
                        "events_url": "https://api.github.com/users/rspamd/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/rspamd/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 9549081,
                        "node_id": "MDEwOlJlcG9zaXRvcnk5NTQ5MDgx",
                        "name": "rspamd",
                        "full_name": "rspamd/rspamd",
                        "private": false,
                        "owner": {
                            "login": "rspamd",
                            "id": 21975367,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjIxOTc1MzY3",
                            "avatar_url": "https://avatars.githubusercontent.com/u/21975367?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/rspamd",
                            "html_url": "https://github.com/rspamd",
                            "followers_url": "https://api.github.com/users/rspamd/followers",
                            "following_url": "https://api.github.com/users/rspamd/following{/other_user}",
                            "gists_url": "https://api.github.com/users/rspamd/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/rspamd/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/rspamd/subscriptions",
                            "organizations_url": "https://api.github.com/users/rspamd/orgs",
                            "repos_url": "https://api.github.com/users/rspamd/repos",
                            "events_url": "https://api.github.com/users/rspamd/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/rspamd/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/rspamd/rspamd",
                        "description": "Rapid spam filtering system.",
                        "fork": false,
                        "url": "https://api.github.com/repos/rspamd/rspamd",
                        "forks_url": "https://api.github.com/repos/rspamd/rspamd/forks",
                        "keys_url": "https://api.github.com/repos/rspamd/rspamd/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/rspamd/rspamd/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/rspamd/rspamd/teams",
                        "hooks_url": "https://api.github.com/repos/rspamd/rspamd/hooks",
                        "issue_events_url": "https://api.github.com/repos/rspamd/rspamd/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/rspamd/rspamd/events",
                        "assignees_url": "https://api.github.com/repos/rspamd/rspamd/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/rspamd/rspamd/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/rspamd/rspamd/tags",
                        "blobs_url": "https://api.github.com/repos/rspamd/rspamd/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/rspamd/rspamd/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/rspamd/rspamd/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/rspamd/rspamd/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/rspamd/rspamd/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/rspamd/rspamd/languages",
                        "stargazers_url": "https://api.github.com/repos/rspamd/rspamd/stargazers",
                        "contributors_url": "https://api.github.com/repos/rspamd/rspamd/contributors",
                        "subscribers_url": "https://api.github.com/repos/rspamd/rspamd/subscribers",
                        "subscription_url": "https://api.github.com/repos/rspamd/rspamd/subscription",
                        "commits_url": "https://api.github.com/repos/rspamd/rspamd/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/rspamd/rspamd/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/rspamd/rspamd/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/rspamd/rspamd/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/rspamd/rspamd/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/rspamd/rspamd/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/rspamd/rspamd/merges",
                        "archive_url": "https://api.github.com/repos/rspamd/rspamd/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/rspamd/rspamd/downloads",
                        "issues_url": "https://api.github.com/repos/rspamd/rspamd/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/rspamd/rspamd/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/rspamd/rspamd/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/rspamd/rspamd/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/rspamd/rspamd/labels{/name}",
                        "releases_url": "https://api.github.com/repos/rspamd/rspamd/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/rspamd/rspamd/deployments",
                        "created_at": "2013-04-19T16:00:18Z",
                        "updated_at": "2023-10-25T08:03:34Z",
                        "pushed_at": "2023-10-25T17:51:25Z",
                        "git_url": "git://github.com/rspamd/rspamd.git",
                        "ssh_url": "git@github.com:rspamd/rspamd.git",
                        "clone_url": "https://github.com/rspamd/rspamd.git",
                        "svn_url": "https://github.com/rspamd/rspamd",
                        "homepage": null,
                        "size": 67610,
                        "stargazers_count": 1833,
                        "watchers_count": 1833,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": true,
                        "has_downloads": true,
                        "has_wiki": true,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 369,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 144,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "c",
                            "email",
                            "lua",
                            "rspamd",
                            "spam-filter"
                        ],
                        "visibility": "public",
                        "forks": 369,
                        "open_issues": 144,
                        "watchers": 1833,
                        "default_branch": "master"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/rspamd/rspamd/pulls/4657"
                    },
                    "html": {
                        "href": "https://github.com/rspamd/rspamd/pull/4657"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/rspamd/rspamd/issues/4657"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/rspamd/rspamd/issues/4657/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/rspamd/rspamd/pulls/4657/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/rspamd/rspamd/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/rspamd/rspamd/pulls/4657/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/rspamd/rspamd/statuses/5ef8dfff5dcff5e8922e5a2c8e41d7e381dbcd37"
                    }
                },
                "author_association": "MEMBER",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-25T17:55:12Z",
        "org": {
            "id": 21975367,
            "login": "rspamd",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/rspamd",
            "avatar_url": "https://avatars.githubusercontent.com/u/21975367?"
        }
    }
]