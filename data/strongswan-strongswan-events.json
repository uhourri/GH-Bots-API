[
    {
        "id": "32897286831",
        "type": "PushEvent",
        "actor": {
            "id": 457648,
            "login": "tobiasbrunner",
            "display_login": "tobiasbrunner",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tobiasbrunner",
            "avatar_url": "https://avatars.githubusercontent.com/u/457648?"
        },
        "repo": {
            "id": 1031235,
            "name": "strongswan/strongswan",
            "url": "https://api.github.com/repos/strongswan/strongswan"
        },
        "payload": {
            "repository_id": 1031235,
            "push_id": 15591049724,
            "size": 1,
            "distinct_size": 1,
            "ref": "refs/heads/kernel-vpp",
            "head": "b553dc6726dae5b7e30baa12ada182fe3f5181bb",
            "before": "22b34dd1a8ed9e822790b074cb9cd52828168ad9",
            "commits": [
                {
                    "sha": "b553dc6726dae5b7e30baa12ada182fe3f5181bb",
                    "author": {
                        "email": "tobias@strongswan.org",
                        "name": "Tobias Brunner"
                    },
                    "message": "github: Install VPP headers and libraries",
                    "distinct": true,
                    "url": "https://api.github.com/repos/strongswan/strongswan/commits/b553dc6726dae5b7e30baa12ada182fe3f5181bb"
                }
            ]
        },
        "public": true,
        "created_at": "2023-10-27T11:35:48Z",
        "org": {
            "id": 457671,
            "login": "strongswan",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/strongswan",
            "avatar_url": "https://avatars.githubusercontent.com/u/457671?"
        }
    },
    {
        "id": "32896927186",
        "type": "PushEvent",
        "actor": {
            "id": 457648,
            "login": "tobiasbrunner",
            "display_login": "tobiasbrunner",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tobiasbrunner",
            "avatar_url": "https://avatars.githubusercontent.com/u/457648?"
        },
        "repo": {
            "id": 1031235,
            "name": "strongswan/strongswan",
            "url": "https://api.github.com/repos/strongswan/strongswan"
        },
        "payload": {
            "repository_id": 1031235,
            "push_id": 15590874106,
            "size": 1,
            "distinct_size": 1,
            "ref": "refs/heads/kernel-vpp",
            "head": "22b34dd1a8ed9e822790b074cb9cd52828168ad9",
            "before": "a6a3cbebf8ef0e80c74baf2cc0b81f7a9f1e1d08",
            "commits": [
                {
                    "sha": "22b34dd1a8ed9e822790b074cb9cd52828168ad9",
                    "author": {
                        "email": "tobias@strongswan.org",
                        "name": "Tobias Brunner"
                    },
                    "message": "github: Install VPP headers and libraries",
                    "distinct": true,
                    "url": "https://api.github.com/repos/strongswan/strongswan/commits/22b34dd1a8ed9e822790b074cb9cd52828168ad9"
                }
            ]
        },
        "public": true,
        "created_at": "2023-10-27T11:20:39Z",
        "org": {
            "id": 457671,
            "login": "strongswan",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/strongswan",
            "avatar_url": "https://avatars.githubusercontent.com/u/457671?"
        }
    },
    {
        "id": "32896520453",
        "type": "PushEvent",
        "actor": {
            "id": 457648,
            "login": "tobiasbrunner",
            "display_login": "tobiasbrunner",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tobiasbrunner",
            "avatar_url": "https://avatars.githubusercontent.com/u/457648?"
        },
        "repo": {
            "id": 1031235,
            "name": "strongswan/strongswan",
            "url": "https://api.github.com/repos/strongswan/strongswan"
        },
        "payload": {
            "repository_id": 1031235,
            "push_id": 15590670302,
            "size": 1,
            "distinct_size": 1,
            "ref": "refs/heads/kernel-vpp",
            "head": "a6a3cbebf8ef0e80c74baf2cc0b81f7a9f1e1d08",
            "before": "edd772b8ef494b7db4dae59babc05c322f44b339",
            "commits": [
                {
                    "sha": "a6a3cbebf8ef0e80c74baf2cc0b81f7a9f1e1d08",
                    "author": {
                        "email": "tobias@strongswan.org",
                        "name": "Tobias Brunner"
                    },
                    "message": "github: Install VPP headers",
                    "distinct": true,
                    "url": "https://api.github.com/repos/strongswan/strongswan/commits/a6a3cbebf8ef0e80c74baf2cc0b81f7a9f1e1d08"
                }
            ]
        },
        "public": true,
        "created_at": "2023-10-27T11:03:54Z",
        "org": {
            "id": 457671,
            "login": "strongswan",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/strongswan",
            "avatar_url": "https://avatars.githubusercontent.com/u/457671?"
        }
    },
    {
        "id": "32895752775",
        "type": "PushEvent",
        "actor": {
            "id": 457648,
            "login": "tobiasbrunner",
            "display_login": "tobiasbrunner",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tobiasbrunner",
            "avatar_url": "https://avatars.githubusercontent.com/u/457648?"
        },
        "repo": {
            "id": 1031235,
            "name": "strongswan/strongswan",
            "url": "https://api.github.com/repos/strongswan/strongswan"
        },
        "payload": {
            "repository_id": 1031235,
            "push_id": 15590286472,
            "size": 1,
            "distinct_size": 1,
            "ref": "refs/heads/kernel-vpp",
            "head": "edd772b8ef494b7db4dae59babc05c322f44b339",
            "before": "b7b16cf23afc0513ecb3b7f38f1becbb79099470",
            "commits": [
                {
                    "sha": "edd772b8ef494b7db4dae59babc05c322f44b339",
                    "author": {
                        "email": "tobias@strongswan.org",
                        "name": "Tobias Brunner"
                    },
                    "message": "github: Install VPP headers",
                    "distinct": true,
                    "url": "https://api.github.com/repos/strongswan/strongswan/commits/edd772b8ef494b7db4dae59babc05c322f44b339"
                }
            ]
        },
        "public": true,
        "created_at": "2023-10-27T10:31:50Z",
        "org": {
            "id": 457671,
            "login": "strongswan",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/strongswan",
            "avatar_url": "https://avatars.githubusercontent.com/u/457671?"
        }
    },
    {
        "id": "32895079573",
        "type": "CreateEvent",
        "actor": {
            "id": 457648,
            "login": "tobiasbrunner",
            "display_login": "tobiasbrunner",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tobiasbrunner",
            "avatar_url": "https://avatars.githubusercontent.com/u/457648?"
        },
        "repo": {
            "id": 1031235,
            "name": "strongswan/strongswan",
            "url": "https://api.github.com/repos/strongswan/strongswan"
        },
        "payload": {
            "ref": "kernel-vpp",
            "ref_type": "branch",
            "master_branch": "master",
            "description": "strongSwan - IPsec-based VPN",
            "pusher_type": "user"
        },
        "public": true,
        "created_at": "2023-10-27T10:06:22Z",
        "org": {
            "id": 457671,
            "login": "strongswan",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/strongswan",
            "avatar_url": "https://avatars.githubusercontent.com/u/457671?"
        }
    },
    {
        "id": "32889042661",
        "type": "WatchEvent",
        "actor": {
            "id": 86606380,
            "login": "yqmm666",
            "display_login": "yqmm666",
            "gravatar_id": "",
            "url": "https://api.github.com/users/yqmm666",
            "avatar_url": "https://avatars.githubusercontent.com/u/86606380?"
        },
        "repo": {
            "id": 1031235,
            "name": "strongswan/strongswan",
            "url": "https://api.github.com/repos/strongswan/strongswan"
        },
        "payload": {
            "action": "started"
        },
        "public": true,
        "created_at": "2023-10-27T05:46:40Z",
        "org": {
            "id": 457671,
            "login": "strongswan",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/strongswan",
            "avatar_url": "https://avatars.githubusercontent.com/u/457671?"
        }
    },
    {
        "id": "32880704397",
        "type": "WatchEvent",
        "actor": {
            "id": 30548669,
            "login": "saiunes",
            "display_login": "saiunes",
            "gravatar_id": "",
            "url": "https://api.github.com/users/saiunes",
            "avatar_url": "https://avatars.githubusercontent.com/u/30548669?"
        },
        "repo": {
            "id": 1031235,
            "name": "strongswan/strongswan",
            "url": "https://api.github.com/repos/strongswan/strongswan"
        },
        "payload": {
            "action": "started"
        },
        "public": true,
        "created_at": "2023-10-26T20:10:21Z",
        "org": {
            "id": 457671,
            "login": "strongswan",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/strongswan",
            "avatar_url": "https://avatars.githubusercontent.com/u/457671?"
        }
    },
    {
        "id": "32874321814",
        "type": "PullRequestReviewCommentEvent",
        "actor": {
            "id": 457648,
            "login": "tobiasbrunner",
            "display_login": "tobiasbrunner",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tobiasbrunner",
            "avatar_url": "https://avatars.githubusercontent.com/u/457648?"
        },
        "repo": {
            "id": 1031235,
            "name": "strongswan/strongswan",
            "url": "https://api.github.com/repos/strongswan/strongswan"
        },
        "payload": {
            "action": "created",
            "comment": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373324550",
                "pull_request_review_id": 1698865892,
                "id": 1373324550,
                "node_id": "PRRC_kwDOAA-8Q85R20UG",
                "diff_hunk": "@@ -0,0 +1,569 @@\n+/*\n+ * Copyright (C) 2023 Andreas Steffen, strongSec GmbH\n+ *\n+ * Copyright (C) secunet Security Networks AG\n+ *\n+ * This program is free software; you can redistribute it and/or modify it\n+ * under the terms of the GNU General Public License as published by the\n+ * Free Software Foundation; either version 2 of the License, or (at your\n+ * option) any later version.  See <http://www.fsf.org/copyleft/gpl.txt>.\n+ *\n+ * This program is distributed in the hope that it will be useful, but\n+ * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY\n+ * or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * for more details.\n+ */\n+\n+#include <errno.h>\n+#include <time.h>\n+\n+#include \"pki.h\"\n+\n+#include <credentials/sets/mem_cred.h>\n+#include <credentials/certificates/ocsp_request.h>\n+#include <credentials/certificates/ocsp_response.h>\n+#include <credentials/certificates/ocsp_single_response.h>\n+#include <credentials/certificates/ocsp_responder.h>\n+\n+static bool verify_signature(certificate_t *ocsp_req, mem_cred_t *creds)\n+{\n+\tidentification_t *signer;\n+\tcertificate_t *signer_cert, *cert_found;\n+\tocsp_request_t *ocsp_request;\n+\tenumerator_t *certs;\n+\tbool trusted = TRUE;\n+\n+\tocsp_request = (ocsp_request_t*)ocsp_req;\n+\n+\tsigner_cert = ocsp_request->get_signer_cert(ocsp_request);\n+\tif (signer_cert)\n+\t{\n+\t\tsigner = signer_cert->get_subject(signer_cert);\n+\n+\t\t/* establish trust relative to root CA */\n+\t\tcreds->add_cert(creds, FALSE, signer_cert->get_ref(signer_cert));\n+\t\tcerts = lib->credmgr->create_trusted_enumerator(lib->credmgr,\n+\t\t\t\t\t\t\t\t\t\t\tKEY_ANY, signer, FALSE);\n+\t\ttrusted = certs->enumerate(certs, &cert_found, NULL) &&\n+\t\t\t\t\t\t\t\t  (cert_found == signer_cert);\n+\t\tcerts->destroy(certs);\n+\t\ttrusted &= ocsp_req->issued_by(ocsp_req, signer_cert, NULL);\n+\t}\n+\tDBG1(DBG_LIB, \"requestor is %strusted\", trusted ? \"\" : \"not \");\n+\n+\treturn trusted;\n+}\n+\n+static bool find_issuer_cacert(hash_algorithm_t hashAlgorithm,\n+\t\t\t\t\t\t\t   chunk_t issuerKeyHash, chunk_t issuerNameHash,\n+\t\t\t\t\t\t\t   certificate_t **issuer_cacert)\n+{\n+    bool issuerKeyHash_ok = FALSE, issuerNameHash_ok = FALSE;\n+\tcertificate_t *candidate;\n+\tidentification_t *issuer;\n+\tx509_t *x509_ca;\n+\tchunk_t caKeyHash = chunk_empty, caNameHash = chunk_empty;\n+\thasher_t *hasher;\n+\tenumerator_t *certs;\n+\n+\t*issuer_cacert = NULL;\n+\n+\tcerts = lib->credmgr->create_cert_enumerator(lib->credmgr, CERT_X509,\n+\t\t\t\t\t\t\t\t\t\t\t\t KEY_ANY, NULL, TRUE);\n+\twhile (certs->enumerate(certs, &candidate) && hashAlgorithm == HASH_SHA1)\n+\t{\n+\t\tx509_ca = (x509_t*)candidate;\n+\n+\t\tif (!(x509_ca->get_flags(x509_ca) & X509_CA))\n+\t\t{\n+\t\t\tcontinue;\n+\t\t}\n+\n+\t\t/* retrieve the caKeyHash of the candidate issuer */\n+\t\tcaKeyHash = x509_ca->get_subjectKeyIdentifier(x509_ca);\n+\t\tissuerKeyHash_ok = chunk_equals(issuerKeyHash, caKeyHash);\n+\t\tif (!issuerKeyHash_ok)\n+\t\t{\n+\t\t\tcontinue;\n+\t\t}\n+\n+\t\t/* compute the caNameHash of the candidate issuer */\n+\t\tissuer = candidate->get_subject(candidate);\n+\n+\t\thasher = lib->crypto->create_hasher(lib->crypto, HASH_SHA1);\n+\t\tif (!hasher)\n+\t\t{\n+\t\t\tDBG1(DBG_LIB, \"failed to create SHA1 hasher\");\n+\t\t\tbreak;\n+\t\t}\n+\n+\t\tif (!hasher->allocate_hash(hasher, issuer->get_encoding(issuer),\n+\t\t\t\t\t\t\t\t\t\t   &caNameHash))\n+\t\t{\n+\t\t\thasher->destroy(hasher);\n+\t\t\tDBG1(DBG_LIB, \"failed to compute SHA1 caNameHash\");\n+\t\t\tbreak;\n+\t\t}\n+\t\thasher->destroy(hasher);\n+\n+\t\tissuerNameHash_ok = chunk_equals(issuerNameHash, caNameHash);\n+\t\tchunk_free(&caNameHash);\n+\t\tif (!issuerNameHash_ok)\n+\t\t{\n+\t\t\tcontinue;\n+\t\t}\n+\n+\t\t/* we found the issuer */\n+\t\tDBG1(DBG_LIB, \"issuer:             \\\"%Y\\\"\", issuer);\n+\t\t*issuer_cacert = candidate;\n+\n+\t\tbreak;\n+\t}\n+\tcerts->destroy(certs);\n+\n+\tDBG1(DBG_LIB, \"  issuerKeyHash:     %#B (%s)\", &issuerKeyHash,\n+\t\t\t\t\t issuerKeyHash_ok ? \"ok\" : \"no match\");\n+\tDBG1(DBG_LIB, \"  issuerNameHash:    %#B (%s)\", &issuerNameHash,\n+\t\t\t\t\t issuerNameHash_ok ? \"ok\" : \"no match\");\n+\n+\treturn (*issuer_cacert != NULL);\n+}\n+\n+static void find_ocsp_signer(certificate_t *first_issuer, bool *self_signed,\n+\t\t\t\t\t\t\t certificate_t **cert, private_key_t **key)\n+{\n+\tcertificate_t *candidate;\n+\tidentification_t *keyid;\n+\tprivate_key_t *key_candidate;\n+\tchunk_t subKeyId, authKeyId, subKeyId_ca;\n+\tx509_t *x509, *x509_ca;\n+\tx509_flag_t flags;\n+\tenumerator_t *certs;\n+\n+\t/* retrieve the subjectKeyIdentifier of the first issuer certificate */\n+\tx509_ca = (x509_t*)first_issuer;\n+\tsubKeyId_ca = x509_ca->get_subjectKeyIdentifier(x509_ca);\n+\n+\t/* iterate over all certificates */\n+\tcerts = lib->credmgr->create_cert_enumerator(lib->credmgr, CERT_X509,\n+\t\t\t\t\t\t\t\t\t\t\t\t KEY_ANY, NULL, TRUE);\n+\twhile (certs->enumerate(certs, &candidate))\n+\t{\n+\t\t/* get the flags and key identfiers of the candidate certificate */\n+\t\tx509 = (x509_t*)candidate;\n+\t\tflags = x509->get_flags(x509);\n+\t\tsubKeyId  = x509->get_subjectKeyIdentifier(x509);\n+\t\tauthKeyId = x509->get_authKeyIdentifier(x509);\n+\n+\t\t/* get a private key matching the candidate certificate */\n+\t\tkeyid = identification_create_from_encoding(ID_KEY_ID, subKeyId);\n+\t\tkey_candidate = lib->credmgr->get_private(lib->credmgr,\n+\t\t\t\t\t\t\t\t\t\tKEY_ANY, keyid, NULL);\n+\t\tkeyid->destroy(keyid);\n+\n+\t\tif (key_candidate)\n+\t\t{\n+\t\t\tif (((flags & X509_OCSP_SIGNER && chunk_equals(authKeyId, subKeyId_ca)) ||\n+\t\t\t\t (flags & X509_CA && chunk_equals(subKeyId, subKeyId_ca))) && !*key)\n+\t\t\t{\n+\t\t\t\t*cert = candidate;\n+\t\t\t\t*key = key_candidate;\n+\t\t\t\tcontinue;\n+\t\t\t}\n+\t\t\telse if (flags & X509_SELF_SIGNED && !(flags & X509_CA))\n+\t\t\t{\n+\t\t\t\tDESTROY_IF(*key);\n+\t\t\t\t*cert = candidate;\n+\t\t\t\t*key = key_candidate;\n+\t\t\t\t*self_signed = TRUE;\n+\t\t\t\tbreak;\n+\t\t\t}\n+\t\t\tkey_candidate->destroy(key_candidate);\n+\t\t}\n+\t}\n+\tcerts->destroy(certs);\n+}\n+\n+/**\n+ * Show|Respond to OCSP requests\n+ */\n+static int ocsp()\n+{\n+\tchar *arg, *file = NULL, *error = NULL;\n+\tidentification_t *requestor;\n+\tcred_encoding_type_t form = CERT_ASN1_DER;\n+\tprivate_key_t *key = NULL;\n+\tcertificate_t *cert = NULL, *ocsp_req = NULL, *ocsp_resp = NULL;\n+\tcertificate_t *cacert = NULL, *first_issuer = NULL;\n+\tocsp_request_t *ocsp_request;\n+\tocsp_status_t ocsp_status = OCSP_SUCCESSFUL;\n+\tocsp_responder_t *ocsp_responder = NULL;\n+\tlinked_list_t *responses = NULL;\n+\tchunk_t encoding = chunk_empty, nonce = chunk_empty;\n+\tchunk_t issuerNameHash, issuerKeyHash, serialNumber;\n+\thash_algorithm_t hashAlgorithm = HASH_SHA1, digest = HASH_UNKNOWN;\n+\tsignature_params_t *scheme = NULL;\n+\ttime_t lifetime = 0;\n+\tmem_cred_t *creds;\n+\tbool multiple_issuers = FALSE, self_signed = FALSE;\n+\tenumerator_t *enumerator;\n+\tint res = 1;\n+\n+\tenum {\n+\t\tOP_SHOW,\n+\t\tOP_RESPOND,\n+\t} op = OP_SHOW;\n+\n+\tbool pss = lib->settings->get_bool(lib->settings, \"%s.rsa_pss\", FALSE,\n+\t\t\t\t\t\t\t\t\t   lib->ns);\n+\n+\tcreds = mem_cred_create();\n+\n+\twhile (TRUE)\n+\t{\n+\t\tswitch (command_getopt(&arg))\n+\t\t{\n+\t\t\tcase 'h':\n+\t\t\t\tgoto usage;\n+\t\t\tcase 'i':\n+\t\t\t\tfile = arg;\n+\t\t\t\tcontinue;\n+\t\t\tcase 'r':\n+\t\t\t\top = OP_RESPOND;\n+\t\t\t\tcontinue;\n+\t\t\tcase 'k':\n+\t\t\t\tkey = lib->creds->create(lib->creds,\n+\t\t\t\t\t\t\t\t\t\t CRED_PRIVATE_KEY, KEY_ANY,\n+\t\t\t\t\t\t\t\t\t\t BUILD_FROM_FILE, arg, BUILD_END);\n+\t\t\t\tif (!key)\n+\t\t\t\t{\n+\t\t\t\t\terror = \"parsing private key failed\";\n+\t\t\t\t\tgoto usage;\n+\t\t\t\t}\n+\t\t\t\tcreds->add_key(creds, key);\n+\t\t\t\tcontinue;\n+\t\t\tcase 'c':\n+\t\t\t\tcert = lib->creds->create(lib->creds,\n+\t\t\t\t\t\t\t\t\t\t  CRED_CERTIFICATE, CERT_X509,\n+\t\t\t\t\t\t\t\t\t\t  BUILD_FROM_FILE, arg, BUILD_END);\n+\t\t\t\tif (!cert)\n+\t\t\t\t{\n+\t\t\t\t\terror = \"parsing certificate failed\";\n+\t\t\t\t\tgoto usage;\n+\t\t\t\t}\n+\t\t\t\tcreds->add_cert(creds, TRUE, cert);\n+\t\t\t\tcontinue;\n+\t\t\tcase 'C':\n+\t\t\t\tcacert = lib->creds->create(lib->creds,\n+\t\t\t\t\t\t\t\t\t\t\tCRED_CERTIFICATE, CERT_X509,\n+\t\t\t\t\t\t\t\t\t\t\tBUILD_FROM_FILE, arg, BUILD_END);\n+\t\t\t\tif (!cacert)\n+\t\t\t\t{\n+\t\t\t\t\terror = \"parsing CA certificate failed\";\n+\t\t\t\t\tgoto usage;\n+\t\t\t\t}\n+\t\t\t\tcreds->add_cert(creds, TRUE, cacert);\n+\t\t\t\tcontinue;\n+\t\t\tcase 'l':\n+\t\t\t\tlifetime = atoi(arg) * 60;\n+\t\t\t\tif (!lifetime)\n+\t\t\t\t{\n+\t\t\t\t\terror = \"invalid --lifetime value\";\n+\t\t\t\t\tgoto usage;\n+\t\t\t\t}\n+\t\t\t\tcontinue;\n+\t\t\tcase 'g':\n+\t\t\t\tif (!enum_from_name(hash_algorithm_short_names, arg, &digest))\n+\t\t\t\t{\n+\t\t\t\t\terror = \"invalid --digest type\";\n+\t\t\t\t\tgoto usage;\n+\t\t\t\t}\n+\t\t\t\tcontinue;\n+\t\t\tcase 'R':\n+\t\t\t\tif (!parse_rsa_padding(arg, &pss))\n+\t\t\t\t{\n+\t\t\t\t\terror = \"invalid RSA padding\";\n+\t\t\t\t\tgoto usage;\n+\t\t\t\t}\n+\t\t\t\tcontinue;\n+\t\t\tcase EOF:\n+\t\t\t\tbreak;\n+\t\t\tdefault:\n+\t\t\t\terror = \"invalid --ocsp option\";\n+\t\t\t\tgoto usage;\n+\t\t}\n+\t\tbreak;\n+\t}\n+\n+\tlib->credmgr->add_local_set(lib->credmgr, &creds->set, FALSE);\n+\n+\tresponses = linked_list_create();\n+\n+\tif (op == OP_RESPOND && !cacert)\n+\t{\n+\t\terror = \"respond mode requires a ca certificate\";\n+\t\tgoto end;\n+\t}\n+\n+\tif (op == OP_RESPOND && !key)\n+\t{\n+\t\terror = \"respond mode requires a private signer key\";\n+\t\tgoto end;\n+\t}\n+\n+\t/* re-initialize signing certificate and key pointers */\n+\tcert = NULL;\n+\tkey = NULL;\n+\n+\tif (file)\n+\t{\n+\t\tocsp_req = lib->creds->create(lib->creds, CRED_CERTIFICATE,\n+\t\t\t\t\t\t\t\tCERT_X509_OCSP_REQUEST,\n+\t\t\t\t\t\t\t\tBUILD_FROM_FILE, file, BUILD_END);",
                "path": "src/pki/commands/ocsp.c",
                "commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "original_commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "user": {
                    "login": "tobiasbrunner",
                    "id": 457648,
                    "node_id": "MDQ6VXNlcjQ1NzY0OA==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/457648?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/tobiasbrunner",
                    "html_url": "https://github.com/tobiasbrunner",
                    "followers_url": "https://api.github.com/users/tobiasbrunner/followers",
                    "following_url": "https://api.github.com/users/tobiasbrunner/following{/other_user}",
                    "gists_url": "https://api.github.com/users/tobiasbrunner/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/tobiasbrunner/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/tobiasbrunner/subscriptions",
                    "organizations_url": "https://api.github.com/users/tobiasbrunner/orgs",
                    "repos_url": "https://api.github.com/users/tobiasbrunner/repos",
                    "events_url": "https://api.github.com/users/tobiasbrunner/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/tobiasbrunner/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "These two lines could actually be indented properly (i.e. to the opening bracket), same for the `create()` call below.",
                "created_at": "2023-10-26T15:01:24Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373324550",
                "pull_request_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "author_association": "MEMBER",
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373324550"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373324550"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    }
                },
                "reactions": {
                    "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373324550/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "start_line": 321,
                "original_start_line": 321,
                "start_side": "RIGHT",
                "line": 322,
                "original_line": 322,
                "side": "RIGHT",
                "original_position": 322,
                "position": 322,
                "subject_type": "line"
            },
            "pull_request": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "id": 1565360593,
                "node_id": "PR_kwDOAA-8Q85dTYHR",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958",
                "diff_url": "https://github.com/strongswan/strongswan/pull/1958.diff",
                "patch_url": "https://github.com/strongswan/strongswan/pull/1958.patch",
                "issue_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958",
                "number": 1958,
                "state": "open",
                "locked": false,
                "title": "OCSP Responder",
                "user": {
                    "login": "strongX509",
                    "id": 4939775,
                    "node_id": "MDQ6VXNlcjQ5Mzk3NzU=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/4939775?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/strongX509",
                    "html_url": "https://github.com/strongX509",
                    "followers_url": "https://api.github.com/users/strongX509/followers",
                    "following_url": "https://api.github.com/users/strongX509/following{/other_user}",
                    "gists_url": "https://api.github.com/users/strongX509/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/strongX509/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/strongX509/subscriptions",
                    "organizations_url": "https://api.github.com/users/strongX509/orgs",
                    "repos_url": "https://api.github.com/users/strongX509/repos",
                    "events_url": "https://api.github.com/users/strongX509/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/strongX509/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "The new **`pki --ocsp`** command parses an _Online Certificate Status Protocol_ (OCSP) request as defined by  RFC  6960  and\r\n       with  the **`--respond`** option generates an OCSP response based on the OCSP request.  The certificate status is directly\r\n       retrieved from the internal certificate database of an _OpenXPKI_ (https://openxpki.org) server. Therefore the **`--respond`**  option\r\n       requires  the new  **`openxpki`**  and the existing  **`mysql`** libstrongswan plugins in order to access the **`certificate`** database table of the _OpenXPKI_ server running on the same host. The OCSP response can be signed by the CA itself, by a delegated OCSP Signer certificate with corresonding EKU extension or by a self-signed OCSP Signer certificate.\r\n",
                "created_at": "2023-10-19T18:01:27Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "db8b1bc37cb571300caaaa58e8b4614e662c2c45",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [
                    {
                        "id": 5235670731,
                        "node_id": "LA_kwDOAA-8Q88AAAABOBH-yw",
                        "url": "https://api.github.com/repos/strongswan/strongswan/labels/cla-signed",
                        "name": "cla-signed",
                        "color": "ededed",
                        "default": false,
                        "description": null
                    }
                ],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits",
                "review_comments_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments",
                "review_comment_url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments",
                "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "head": {
                    "label": "strongswan:ocsp-responder-new",
                    "ref": "ocsp-responder-new",
                    "sha": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "base": {
                    "label": "strongswan:master",
                    "ref": "master",
                    "sha": "b5760243870d4ab6c5874d765f8b09b3c67b8fc6",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T15:01:24Z",
        "org": {
            "id": 457671,
            "login": "strongswan",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/strongswan",
            "avatar_url": "https://avatars.githubusercontent.com/u/457671?"
        }
    },
    {
        "id": "32874321867",
        "type": "PullRequestReviewCommentEvent",
        "actor": {
            "id": 457648,
            "login": "tobiasbrunner",
            "display_login": "tobiasbrunner",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tobiasbrunner",
            "avatar_url": "https://avatars.githubusercontent.com/u/457648?"
        },
        "repo": {
            "id": 1031235,
            "name": "strongswan/strongswan",
            "url": "https://api.github.com/repos/strongswan/strongswan"
        },
        "payload": {
            "action": "created",
            "comment": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373329238",
                "pull_request_review_id": 1698865892,
                "id": 1373329238,
                "node_id": "PRRC_kwDOAA-8Q85R21dW",
                "diff_hunk": "@@ -0,0 +1,569 @@\n+/*\n+ * Copyright (C) 2023 Andreas Steffen, strongSec GmbH\n+ *\n+ * Copyright (C) secunet Security Networks AG\n+ *\n+ * This program is free software; you can redistribute it and/or modify it\n+ * under the terms of the GNU General Public License as published by the\n+ * Free Software Foundation; either version 2 of the License, or (at your\n+ * option) any later version.  See <http://www.fsf.org/copyleft/gpl.txt>.\n+ *\n+ * This program is distributed in the hope that it will be useful, but\n+ * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY\n+ * or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * for more details.\n+ */\n+\n+#include <errno.h>\n+#include <time.h>\n+\n+#include \"pki.h\"\n+\n+#include <credentials/sets/mem_cred.h>\n+#include <credentials/certificates/ocsp_request.h>\n+#include <credentials/certificates/ocsp_response.h>\n+#include <credentials/certificates/ocsp_single_response.h>\n+#include <credentials/certificates/ocsp_responder.h>\n+\n+static bool verify_signature(certificate_t *ocsp_req, mem_cred_t *creds)\n+{\n+\tidentification_t *signer;\n+\tcertificate_t *signer_cert, *cert_found;\n+\tocsp_request_t *ocsp_request;\n+\tenumerator_t *certs;\n+\tbool trusted = TRUE;\n+\n+\tocsp_request = (ocsp_request_t*)ocsp_req;\n+\n+\tsigner_cert = ocsp_request->get_signer_cert(ocsp_request);\n+\tif (signer_cert)\n+\t{\n+\t\tsigner = signer_cert->get_subject(signer_cert);\n+\n+\t\t/* establish trust relative to root CA */\n+\t\tcreds->add_cert(creds, FALSE, signer_cert->get_ref(signer_cert));\n+\t\tcerts = lib->credmgr->create_trusted_enumerator(lib->credmgr,\n+\t\t\t\t\t\t\t\t\t\t\tKEY_ANY, signer, FALSE);\n+\t\ttrusted = certs->enumerate(certs, &cert_found, NULL) &&\n+\t\t\t\t\t\t\t\t  (cert_found == signer_cert);\n+\t\tcerts->destroy(certs);\n+\t\ttrusted &= ocsp_req->issued_by(ocsp_req, signer_cert, NULL);\n+\t}\n+\tDBG1(DBG_LIB, \"requestor is %strusted\", trusted ? \"\" : \"not \");\n+\n+\treturn trusted;\n+}\n+\n+static bool find_issuer_cacert(hash_algorithm_t hashAlgorithm,\n+\t\t\t\t\t\t\t   chunk_t issuerKeyHash, chunk_t issuerNameHash,\n+\t\t\t\t\t\t\t   certificate_t **issuer_cacert)\n+{\n+    bool issuerKeyHash_ok = FALSE, issuerNameHash_ok = FALSE;\n+\tcertificate_t *candidate;\n+\tidentification_t *issuer;\n+\tx509_t *x509_ca;\n+\tchunk_t caKeyHash = chunk_empty, caNameHash = chunk_empty;\n+\thasher_t *hasher;\n+\tenumerator_t *certs;\n+\n+\t*issuer_cacert = NULL;\n+\n+\tcerts = lib->credmgr->create_cert_enumerator(lib->credmgr, CERT_X509,\n+\t\t\t\t\t\t\t\t\t\t\t\t KEY_ANY, NULL, TRUE);\n+\twhile (certs->enumerate(certs, &candidate) && hashAlgorithm == HASH_SHA1)\n+\t{\n+\t\tx509_ca = (x509_t*)candidate;\n+\n+\t\tif (!(x509_ca->get_flags(x509_ca) & X509_CA))\n+\t\t{\n+\t\t\tcontinue;\n+\t\t}\n+\n+\t\t/* retrieve the caKeyHash of the candidate issuer */\n+\t\tcaKeyHash = x509_ca->get_subjectKeyIdentifier(x509_ca);\n+\t\tissuerKeyHash_ok = chunk_equals(issuerKeyHash, caKeyHash);\n+\t\tif (!issuerKeyHash_ok)\n+\t\t{\n+\t\t\tcontinue;\n+\t\t}\n+\n+\t\t/* compute the caNameHash of the candidate issuer */\n+\t\tissuer = candidate->get_subject(candidate);\n+\n+\t\thasher = lib->crypto->create_hasher(lib->crypto, HASH_SHA1);\n+\t\tif (!hasher)\n+\t\t{\n+\t\t\tDBG1(DBG_LIB, \"failed to create SHA1 hasher\");\n+\t\t\tbreak;\n+\t\t}\n+\n+\t\tif (!hasher->allocate_hash(hasher, issuer->get_encoding(issuer),\n+\t\t\t\t\t\t\t\t\t\t   &caNameHash))\n+\t\t{\n+\t\t\thasher->destroy(hasher);\n+\t\t\tDBG1(DBG_LIB, \"failed to compute SHA1 caNameHash\");\n+\t\t\tbreak;\n+\t\t}\n+\t\thasher->destroy(hasher);\n+\n+\t\tissuerNameHash_ok = chunk_equals(issuerNameHash, caNameHash);\n+\t\tchunk_free(&caNameHash);\n+\t\tif (!issuerNameHash_ok)\n+\t\t{\n+\t\t\tcontinue;\n+\t\t}\n+\n+\t\t/* we found the issuer */\n+\t\tDBG1(DBG_LIB, \"issuer:             \\\"%Y\\\"\", issuer);\n+\t\t*issuer_cacert = candidate;\n+\n+\t\tbreak;\n+\t}\n+\tcerts->destroy(certs);\n+\n+\tDBG1(DBG_LIB, \"  issuerKeyHash:     %#B (%s)\", &issuerKeyHash,\n+\t\t\t\t\t issuerKeyHash_ok ? \"ok\" : \"no match\");\n+\tDBG1(DBG_LIB, \"  issuerNameHash:    %#B (%s)\", &issuerNameHash,\n+\t\t\t\t\t issuerNameHash_ok ? \"ok\" : \"no match\");\n+\n+\treturn (*issuer_cacert != NULL);\n+}\n+\n+static void find_ocsp_signer(certificate_t *first_issuer, bool *self_signed,\n+\t\t\t\t\t\t\t certificate_t **cert, private_key_t **key)\n+{\n+\tcertificate_t *candidate;\n+\tidentification_t *keyid;\n+\tprivate_key_t *key_candidate;\n+\tchunk_t subKeyId, authKeyId, subKeyId_ca;\n+\tx509_t *x509, *x509_ca;\n+\tx509_flag_t flags;\n+\tenumerator_t *certs;\n+\n+\t/* retrieve the subjectKeyIdentifier of the first issuer certificate */\n+\tx509_ca = (x509_t*)first_issuer;\n+\tsubKeyId_ca = x509_ca->get_subjectKeyIdentifier(x509_ca);\n+\n+\t/* iterate over all certificates */\n+\tcerts = lib->credmgr->create_cert_enumerator(lib->credmgr, CERT_X509,\n+\t\t\t\t\t\t\t\t\t\t\t\t KEY_ANY, NULL, TRUE);\n+\twhile (certs->enumerate(certs, &candidate))\n+\t{\n+\t\t/* get the flags and key identfiers of the candidate certificate */\n+\t\tx509 = (x509_t*)candidate;\n+\t\tflags = x509->get_flags(x509);\n+\t\tsubKeyId  = x509->get_subjectKeyIdentifier(x509);\n+\t\tauthKeyId = x509->get_authKeyIdentifier(x509);\n+\n+\t\t/* get a private key matching the candidate certificate */\n+\t\tkeyid = identification_create_from_encoding(ID_KEY_ID, subKeyId);\n+\t\tkey_candidate = lib->credmgr->get_private(lib->credmgr,\n+\t\t\t\t\t\t\t\t\t\tKEY_ANY, keyid, NULL);\n+\t\tkeyid->destroy(keyid);\n+\n+\t\tif (key_candidate)\n+\t\t{\n+\t\t\tif (((flags & X509_OCSP_SIGNER && chunk_equals(authKeyId, subKeyId_ca)) ||\n+\t\t\t\t (flags & X509_CA && chunk_equals(subKeyId, subKeyId_ca))) && !*key)\n+\t\t\t{\n+\t\t\t\t*cert = candidate;\n+\t\t\t\t*key = key_candidate;\n+\t\t\t\tcontinue;\n+\t\t\t}\n+\t\t\telse if (flags & X509_SELF_SIGNED && !(flags & X509_CA))\n+\t\t\t{\n+\t\t\t\tDESTROY_IF(*key);\n+\t\t\t\t*cert = candidate;\n+\t\t\t\t*key = key_candidate;\n+\t\t\t\t*self_signed = TRUE;\n+\t\t\t\tbreak;\n+\t\t\t}\n+\t\t\tkey_candidate->destroy(key_candidate);\n+\t\t}\n+\t}\n+\tcerts->destroy(certs);\n+}\n+\n+/**\n+ * Show|Respond to OCSP requests\n+ */\n+static int ocsp()\n+{\n+\tchar *arg, *file = NULL, *error = NULL;\n+\tidentification_t *requestor;\n+\tcred_encoding_type_t form = CERT_ASN1_DER;\n+\tprivate_key_t *key = NULL;\n+\tcertificate_t *cert = NULL, *ocsp_req = NULL, *ocsp_resp = NULL;\n+\tcertificate_t *cacert = NULL, *first_issuer = NULL;\n+\tocsp_request_t *ocsp_request;\n+\tocsp_status_t ocsp_status = OCSP_SUCCESSFUL;\n+\tocsp_responder_t *ocsp_responder = NULL;\n+\tlinked_list_t *responses = NULL;\n+\tchunk_t encoding = chunk_empty, nonce = chunk_empty;\n+\tchunk_t issuerNameHash, issuerKeyHash, serialNumber;\n+\thash_algorithm_t hashAlgorithm = HASH_SHA1, digest = HASH_UNKNOWN;\n+\tsignature_params_t *scheme = NULL;\n+\ttime_t lifetime = 0;\n+\tmem_cred_t *creds;\n+\tbool multiple_issuers = FALSE, self_signed = FALSE;\n+\tenumerator_t *enumerator;\n+\tint res = 1;\n+\n+\tenum {\n+\t\tOP_SHOW,\n+\t\tOP_RESPOND,\n+\t} op = OP_SHOW;\n+\n+\tbool pss = lib->settings->get_bool(lib->settings, \"%s.rsa_pss\", FALSE,\n+\t\t\t\t\t\t\t\t\t   lib->ns);\n+\n+\tcreds = mem_cred_create();\n+\n+\twhile (TRUE)\n+\t{\n+\t\tswitch (command_getopt(&arg))\n+\t\t{\n+\t\t\tcase 'h':\n+\t\t\t\tgoto usage;\n+\t\t\tcase 'i':\n+\t\t\t\tfile = arg;\n+\t\t\t\tcontinue;\n+\t\t\tcase 'r':\n+\t\t\t\top = OP_RESPOND;\n+\t\t\t\tcontinue;\n+\t\t\tcase 'k':\n+\t\t\t\tkey = lib->creds->create(lib->creds,\n+\t\t\t\t\t\t\t\t\t\t CRED_PRIVATE_KEY, KEY_ANY,\n+\t\t\t\t\t\t\t\t\t\t BUILD_FROM_FILE, arg, BUILD_END);\n+\t\t\t\tif (!key)\n+\t\t\t\t{\n+\t\t\t\t\terror = \"parsing private key failed\";\n+\t\t\t\t\tgoto usage;\n+\t\t\t\t}\n+\t\t\t\tcreds->add_key(creds, key);\n+\t\t\t\tcontinue;\n+\t\t\tcase 'c':\n+\t\t\t\tcert = lib->creds->create(lib->creds,\n+\t\t\t\t\t\t\t\t\t\t  CRED_CERTIFICATE, CERT_X509,\n+\t\t\t\t\t\t\t\t\t\t  BUILD_FROM_FILE, arg, BUILD_END);\n+\t\t\t\tif (!cert)\n+\t\t\t\t{\n+\t\t\t\t\terror = \"parsing certificate failed\";\n+\t\t\t\t\tgoto usage;\n+\t\t\t\t}\n+\t\t\t\tcreds->add_cert(creds, TRUE, cert);\n+\t\t\t\tcontinue;\n+\t\t\tcase 'C':\n+\t\t\t\tcacert = lib->creds->create(lib->creds,\n+\t\t\t\t\t\t\t\t\t\t\tCRED_CERTIFICATE, CERT_X509,\n+\t\t\t\t\t\t\t\t\t\t\tBUILD_FROM_FILE, arg, BUILD_END);\n+\t\t\t\tif (!cacert)\n+\t\t\t\t{\n+\t\t\t\t\terror = \"parsing CA certificate failed\";\n+\t\t\t\t\tgoto usage;\n+\t\t\t\t}\n+\t\t\t\tcreds->add_cert(creds, TRUE, cacert);\n+\t\t\t\tcontinue;\n+\t\t\tcase 'l':\n+\t\t\t\tlifetime = atoi(arg) * 60;\n+\t\t\t\tif (!lifetime)\n+\t\t\t\t{\n+\t\t\t\t\terror = \"invalid --lifetime value\";\n+\t\t\t\t\tgoto usage;\n+\t\t\t\t}\n+\t\t\t\tcontinue;\n+\t\t\tcase 'g':\n+\t\t\t\tif (!enum_from_name(hash_algorithm_short_names, arg, &digest))\n+\t\t\t\t{\n+\t\t\t\t\terror = \"invalid --digest type\";\n+\t\t\t\t\tgoto usage;\n+\t\t\t\t}\n+\t\t\t\tcontinue;\n+\t\t\tcase 'R':\n+\t\t\t\tif (!parse_rsa_padding(arg, &pss))\n+\t\t\t\t{\n+\t\t\t\t\terror = \"invalid RSA padding\";\n+\t\t\t\t\tgoto usage;\n+\t\t\t\t}\n+\t\t\t\tcontinue;\n+\t\t\tcase EOF:\n+\t\t\t\tbreak;\n+\t\t\tdefault:\n+\t\t\t\terror = \"invalid --ocsp option\";\n+\t\t\t\tgoto usage;\n+\t\t}\n+\t\tbreak;\n+\t}\n+\n+\tlib->credmgr->add_local_set(lib->credmgr, &creds->set, FALSE);\n+\n+\tresponses = linked_list_create();\n+\n+\tif (op == OP_RESPOND && !cacert)\n+\t{\n+\t\terror = \"respond mode requires a ca certificate\";\n+\t\tgoto end;\n+\t}\n+\n+\tif (op == OP_RESPOND && !key)\n+\t{\n+\t\terror = \"respond mode requires a private signer key\";\n+\t\tgoto end;\n+\t}\n+\n+\t/* re-initialize signing certificate and key pointers */\n+\tcert = NULL;\n+\tkey = NULL;\n+\n+\tif (file)\n+\t{\n+\t\tocsp_req = lib->creds->create(lib->creds, CRED_CERTIFICATE,\n+\t\t\t\t\t\t\t\tCERT_X509_OCSP_REQUEST,\n+\t\t\t\t\t\t\t\tBUILD_FROM_FILE, file, BUILD_END);\n+\t}\n+\telse\n+\t{\n+\t\tchunk_t chunk;\n+\n+\t\tset_file_mode(stdin, CERT_ASN1_DER);\n+\t\tif (!chunk_from_fd(0, &chunk))\n+\t\t{\n+\t\t\tfprintf(stderr, \"%s: \", strerror(errno));\n+\t\t\terror = \"reading certificate request failed\";\n+\t\t\tgoto end;\n+\t\t}\n+\t\tocsp_req = lib->creds->create(lib->creds, CRED_CERTIFICATE,\n+\t\t\t\t\t\t\t\tCERT_X509_OCSP_REQUEST,\n+\t\t\t\t\t\t\t\tBUILD_BLOB_ASN1_DER, chunk, BUILD_END);\n+\t\tfree(chunk.ptr);\n+\t}\n+\tif (!ocsp_req)\n+\t{\n+\t\tif (op == OP_SHOW)\n+\t\t{\n+\t\t\terror = \"malformed OCSP request\";\n+\t\t\tgoto end;\n+\t\t}\n+\t\telse\n+\t\t{\n+\t\t\tDBG1(DBG_LIB, \"malformed OCSP request\");\n+\t\t\tocsp_status = OCSP_MALFORMEDREQUEST;\n+\t\t\tgoto gen;\n+\t\t}\n+\t}\n+\tocsp_request = (ocsp_request_t*)ocsp_req;\n+\n+\t/* does the requestor identify itself? */\n+\trequestor = ocsp_req->get_subject(ocsp_req);\n+\tif (requestor)\n+\t{\n+\t\tDBG1(DBG_LIB, \"requestor:          \\\"%Y\\\"\", requestor);\n+\n+\t\t/* verify an optional ocsp request signature */\n+\t\tif (!verify_signature(ocsp_req, creds))\n+\t\t{\n+\t\t\tocsp_status = OCSP_UNAUTHORIZED;\n+\t\t\tgoto gen;\n+\t\t}\n+\t}\n+\n+\t/* extract nonce from OCSP request */\n+\tnonce = ocsp_request->get_nonce(ocsp_request);\n+\tif (nonce.len > 0)\n+\t{\n+\t\tDBG1(DBG_LIB, \"nonce:               %#B\", &nonce);\n+\t}\n+\n+\t/* check for an ocsp responder */\n+\tif (op == OP_RESPOND)\n+\t{\n+\t\tocsp_responder = lib->get(lib, \"ocsp-responder\");\n+\t\tif (!ocsp_responder)\n+\t\t{\n+\t\t\tDBG1(DBG_LIB, \" no ocsp-responder found\");\n+\t\t\tocsp_status = OCSP_INTERNALERROR;\n+\t\t\tgoto gen;\n+\t\t}\n+\t}\n+\n+\t/* enumerate over the ocsp requests and try to identify the issuers */\n+\tenumerator = ocsp_request->create_request_enumerator(ocsp_request);\n+\twhile (enumerator->enumerate(enumerator, &hashAlgorithm, &issuerNameHash,\n+\t\t\t\t\t\t\t\t\t\t\t &issuerKeyHash, &serialNumber))\n+\t{\n+\t\tcertificate_t *issuer_cacert = NULL;\n+\t\tcert_validation_t status = VALIDATION_FAILED;\n+\t\tocsp_single_response_t *response = NULL;\n+\t\tcrl_reason_t revocationReason;\n+\t\ttime_t revocationTime;\n+\n+\t\t/* search for the matching issuer cacert */\n+\t\tif (find_issuer_cacert(hashAlgorithm, issuerKeyHash, issuerNameHash,\n+\t\t\t\t\t\t\t   &issuer_cacert))\n+\t\t{\n+\t\t\tif (first_issuer == NULL)",
                "path": "src/pki/commands/ocsp.c",
                "commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "original_commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "user": {
                    "login": "tobiasbrunner",
                    "id": 457648,
                    "node_id": "MDQ6VXNlcjQ1NzY0OA==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/457648?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/tobiasbrunner",
                    "html_url": "https://github.com/tobiasbrunner",
                    "followers_url": "https://api.github.com/users/tobiasbrunner/followers",
                    "following_url": "https://api.github.com/users/tobiasbrunner/following{/other_user}",
                    "gists_url": "https://api.github.com/users/tobiasbrunner/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/tobiasbrunner/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/tobiasbrunner/subscriptions",
                    "organizations_url": "https://api.github.com/users/tobiasbrunner/orgs",
                    "repos_url": "https://api.github.com/users/tobiasbrunner/repos",
                    "events_url": "https://api.github.com/users/tobiasbrunner/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/tobiasbrunner/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "```suggestion\r\n\t\t\tif (!first_issuer)\r\n```",
                "created_at": "2023-10-26T15:04:43Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373329238",
                "pull_request_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "author_association": "MEMBER",
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373329238"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373329238"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    }
                },
                "reactions": {
                    "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373329238/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "start_line": null,
                "original_start_line": null,
                "start_side": null,
                "line": 404,
                "original_line": 404,
                "side": "RIGHT",
                "original_position": 404,
                "position": 404,
                "subject_type": "line"
            },
            "pull_request": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "id": 1565360593,
                "node_id": "PR_kwDOAA-8Q85dTYHR",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958",
                "diff_url": "https://github.com/strongswan/strongswan/pull/1958.diff",
                "patch_url": "https://github.com/strongswan/strongswan/pull/1958.patch",
                "issue_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958",
                "number": 1958,
                "state": "open",
                "locked": false,
                "title": "OCSP Responder",
                "user": {
                    "login": "strongX509",
                    "id": 4939775,
                    "node_id": "MDQ6VXNlcjQ5Mzk3NzU=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/4939775?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/strongX509",
                    "html_url": "https://github.com/strongX509",
                    "followers_url": "https://api.github.com/users/strongX509/followers",
                    "following_url": "https://api.github.com/users/strongX509/following{/other_user}",
                    "gists_url": "https://api.github.com/users/strongX509/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/strongX509/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/strongX509/subscriptions",
                    "organizations_url": "https://api.github.com/users/strongX509/orgs",
                    "repos_url": "https://api.github.com/users/strongX509/repos",
                    "events_url": "https://api.github.com/users/strongX509/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/strongX509/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "The new **`pki --ocsp`** command parses an _Online Certificate Status Protocol_ (OCSP) request as defined by  RFC  6960  and\r\n       with  the **`--respond`** option generates an OCSP response based on the OCSP request.  The certificate status is directly\r\n       retrieved from the internal certificate database of an _OpenXPKI_ (https://openxpki.org) server. Therefore the **`--respond`**  option\r\n       requires  the new  **`openxpki`**  and the existing  **`mysql`** libstrongswan plugins in order to access the **`certificate`** database table of the _OpenXPKI_ server running on the same host. The OCSP response can be signed by the CA itself, by a delegated OCSP Signer certificate with corresonding EKU extension or by a self-signed OCSP Signer certificate.\r\n",
                "created_at": "2023-10-19T18:01:27Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "db8b1bc37cb571300caaaa58e8b4614e662c2c45",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [
                    {
                        "id": 5235670731,
                        "node_id": "LA_kwDOAA-8Q88AAAABOBH-yw",
                        "url": "https://api.github.com/repos/strongswan/strongswan/labels/cla-signed",
                        "name": "cla-signed",
                        "color": "ededed",
                        "default": false,
                        "description": null
                    }
                ],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits",
                "review_comments_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments",
                "review_comment_url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments",
                "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "head": {
                    "label": "strongswan:ocsp-responder-new",
                    "ref": "ocsp-responder-new",
                    "sha": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "base": {
                    "label": "strongswan:master",
                    "ref": "master",
                    "sha": "b5760243870d4ab6c5874d765f8b09b3c67b8fc6",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T15:04:43Z",
        "org": {
            "id": 457671,
            "login": "strongswan",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/strongswan",
            "avatar_url": "https://avatars.githubusercontent.com/u/457671?"
        }
    },
    {
        "id": "32874321870",
        "type": "PullRequestReviewCommentEvent",
        "actor": {
            "id": 457648,
            "login": "tobiasbrunner",
            "display_login": "tobiasbrunner",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tobiasbrunner",
            "avatar_url": "https://avatars.githubusercontent.com/u/457648?"
        },
        "repo": {
            "id": 1031235,
            "name": "strongswan/strongswan",
            "url": "https://api.github.com/repos/strongswan/strongswan"
        },
        "payload": {
            "action": "created",
            "comment": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373352038",
                "pull_request_review_id": 1698865892,
                "id": 1373352038,
                "node_id": "PRRC_kwDOAA-8Q85R27Bm",
                "diff_hunk": "@@ -0,0 +1,569 @@\n+/*\n+ * Copyright (C) 2023 Andreas Steffen, strongSec GmbH\n+ *\n+ * Copyright (C) secunet Security Networks AG\n+ *\n+ * This program is free software; you can redistribute it and/or modify it\n+ * under the terms of the GNU General Public License as published by the\n+ * Free Software Foundation; either version 2 of the License, or (at your\n+ * option) any later version.  See <http://www.fsf.org/copyleft/gpl.txt>.\n+ *\n+ * This program is distributed in the hope that it will be useful, but\n+ * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY\n+ * or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * for more details.\n+ */\n+\n+#include <errno.h>\n+#include <time.h>\n+\n+#include \"pki.h\"\n+\n+#include <credentials/sets/mem_cred.h>\n+#include <credentials/certificates/ocsp_request.h>\n+#include <credentials/certificates/ocsp_response.h>\n+#include <credentials/certificates/ocsp_single_response.h>\n+#include <credentials/certificates/ocsp_responder.h>\n+\n+static bool verify_signature(certificate_t *ocsp_req, mem_cred_t *creds)\n+{\n+\tidentification_t *signer;\n+\tcertificate_t *signer_cert, *cert_found;\n+\tocsp_request_t *ocsp_request;\n+\tenumerator_t *certs;\n+\tbool trusted = TRUE;\n+\n+\tocsp_request = (ocsp_request_t*)ocsp_req;\n+\n+\tsigner_cert = ocsp_request->get_signer_cert(ocsp_request);\n+\tif (signer_cert)\n+\t{\n+\t\tsigner = signer_cert->get_subject(signer_cert);\n+\n+\t\t/* establish trust relative to root CA */\n+\t\tcreds->add_cert(creds, FALSE, signer_cert->get_ref(signer_cert));\n+\t\tcerts = lib->credmgr->create_trusted_enumerator(lib->credmgr,\n+\t\t\t\t\t\t\t\t\t\t\tKEY_ANY, signer, FALSE);\n+\t\ttrusted = certs->enumerate(certs, &cert_found, NULL) &&\n+\t\t\t\t\t\t\t\t  (cert_found == signer_cert);\n+\t\tcerts->destroy(certs);\n+\t\ttrusted &= ocsp_req->issued_by(ocsp_req, signer_cert, NULL);\n+\t}\n+\tDBG1(DBG_LIB, \"requestor is %strusted\", trusted ? \"\" : \"not \");\n+\n+\treturn trusted;\n+}\n+\n+static bool find_issuer_cacert(hash_algorithm_t hashAlgorithm,\n+\t\t\t\t\t\t\t   chunk_t issuerKeyHash, chunk_t issuerNameHash,\n+\t\t\t\t\t\t\t   certificate_t **issuer_cacert)\n+{\n+    bool issuerKeyHash_ok = FALSE, issuerNameHash_ok = FALSE;\n+\tcertificate_t *candidate;\n+\tidentification_t *issuer;\n+\tx509_t *x509_ca;\n+\tchunk_t caKeyHash = chunk_empty, caNameHash = chunk_empty;\n+\thasher_t *hasher;\n+\tenumerator_t *certs;\n+\n+\t*issuer_cacert = NULL;\n+\n+\tcerts = lib->credmgr->create_cert_enumerator(lib->credmgr, CERT_X509,\n+\t\t\t\t\t\t\t\t\t\t\t\t KEY_ANY, NULL, TRUE);\n+\twhile (certs->enumerate(certs, &candidate) && hashAlgorithm == HASH_SHA1)\n+\t{\n+\t\tx509_ca = (x509_t*)candidate;\n+\n+\t\tif (!(x509_ca->get_flags(x509_ca) & X509_CA))\n+\t\t{\n+\t\t\tcontinue;\n+\t\t}\n+\n+\t\t/* retrieve the caKeyHash of the candidate issuer */\n+\t\tcaKeyHash = x509_ca->get_subjectKeyIdentifier(x509_ca);\n+\t\tissuerKeyHash_ok = chunk_equals(issuerKeyHash, caKeyHash);\n+\t\tif (!issuerKeyHash_ok)\n+\t\t{\n+\t\t\tcontinue;\n+\t\t}\n+\n+\t\t/* compute the caNameHash of the candidate issuer */\n+\t\tissuer = candidate->get_subject(candidate);\n+\n+\t\thasher = lib->crypto->create_hasher(lib->crypto, HASH_SHA1);\n+\t\tif (!hasher)\n+\t\t{\n+\t\t\tDBG1(DBG_LIB, \"failed to create SHA1 hasher\");\n+\t\t\tbreak;\n+\t\t}\n+\n+\t\tif (!hasher->allocate_hash(hasher, issuer->get_encoding(issuer),\n+\t\t\t\t\t\t\t\t\t\t   &caNameHash))\n+\t\t{\n+\t\t\thasher->destroy(hasher);\n+\t\t\tDBG1(DBG_LIB, \"failed to compute SHA1 caNameHash\");\n+\t\t\tbreak;\n+\t\t}\n+\t\thasher->destroy(hasher);\n+\n+\t\tissuerNameHash_ok = chunk_equals(issuerNameHash, caNameHash);\n+\t\tchunk_free(&caNameHash);\n+\t\tif (!issuerNameHash_ok)\n+\t\t{\n+\t\t\tcontinue;\n+\t\t}\n+\n+\t\t/* we found the issuer */\n+\t\tDBG1(DBG_LIB, \"issuer:             \\\"%Y\\\"\", issuer);\n+\t\t*issuer_cacert = candidate;\n+\n+\t\tbreak;\n+\t}\n+\tcerts->destroy(certs);\n+\n+\tDBG1(DBG_LIB, \"  issuerKeyHash:     %#B (%s)\", &issuerKeyHash,\n+\t\t\t\t\t issuerKeyHash_ok ? \"ok\" : \"no match\");\n+\tDBG1(DBG_LIB, \"  issuerNameHash:    %#B (%s)\", &issuerNameHash,\n+\t\t\t\t\t issuerNameHash_ok ? \"ok\" : \"no match\");\n+\n+\treturn (*issuer_cacert != NULL);\n+}\n+\n+static void find_ocsp_signer(certificate_t *first_issuer, bool *self_signed,\n+\t\t\t\t\t\t\t certificate_t **cert, private_key_t **key)\n+{\n+\tcertificate_t *candidate;\n+\tidentification_t *keyid;\n+\tprivate_key_t *key_candidate;\n+\tchunk_t subKeyId, authKeyId, subKeyId_ca;\n+\tx509_t *x509, *x509_ca;\n+\tx509_flag_t flags;\n+\tenumerator_t *certs;\n+\n+\t/* retrieve the subjectKeyIdentifier of the first issuer certificate */\n+\tx509_ca = (x509_t*)first_issuer;\n+\tsubKeyId_ca = x509_ca->get_subjectKeyIdentifier(x509_ca);\n+\n+\t/* iterate over all certificates */\n+\tcerts = lib->credmgr->create_cert_enumerator(lib->credmgr, CERT_X509,\n+\t\t\t\t\t\t\t\t\t\t\t\t KEY_ANY, NULL, TRUE);\n+\twhile (certs->enumerate(certs, &candidate))\n+\t{\n+\t\t/* get the flags and key identfiers of the candidate certificate */\n+\t\tx509 = (x509_t*)candidate;\n+\t\tflags = x509->get_flags(x509);\n+\t\tsubKeyId  = x509->get_subjectKeyIdentifier(x509);\n+\t\tauthKeyId = x509->get_authKeyIdentifier(x509);\n+\n+\t\t/* get a private key matching the candidate certificate */\n+\t\tkeyid = identification_create_from_encoding(ID_KEY_ID, subKeyId);\n+\t\tkey_candidate = lib->credmgr->get_private(lib->credmgr,\n+\t\t\t\t\t\t\t\t\t\tKEY_ANY, keyid, NULL);\n+\t\tkeyid->destroy(keyid);\n+\n+\t\tif (key_candidate)\n+\t\t{\n+\t\t\tif (((flags & X509_OCSP_SIGNER && chunk_equals(authKeyId, subKeyId_ca)) ||\n+\t\t\t\t (flags & X509_CA && chunk_equals(subKeyId, subKeyId_ca))) && !*key)\n+\t\t\t{\n+\t\t\t\t*cert = candidate;\n+\t\t\t\t*key = key_candidate;\n+\t\t\t\tcontinue;\n+\t\t\t}\n+\t\t\telse if (flags & X509_SELF_SIGNED && !(flags & X509_CA))\n+\t\t\t{\n+\t\t\t\tDESTROY_IF(*key);\n+\t\t\t\t*cert = candidate;\n+\t\t\t\t*key = key_candidate;\n+\t\t\t\t*self_signed = TRUE;\n+\t\t\t\tbreak;\n+\t\t\t}\n+\t\t\tkey_candidate->destroy(key_candidate);\n+\t\t}\n+\t}\n+\tcerts->destroy(certs);\n+}\n+\n+/**\n+ * Show|Respond to OCSP requests\n+ */\n+static int ocsp()\n+{\n+\tchar *arg, *file = NULL, *error = NULL;\n+\tidentification_t *requestor;\n+\tcred_encoding_type_t form = CERT_ASN1_DER;\n+\tprivate_key_t *key = NULL;\n+\tcertificate_t *cert = NULL, *ocsp_req = NULL, *ocsp_resp = NULL;\n+\tcertificate_t *cacert = NULL, *first_issuer = NULL;\n+\tocsp_request_t *ocsp_request;\n+\tocsp_status_t ocsp_status = OCSP_SUCCESSFUL;\n+\tocsp_responder_t *ocsp_responder = NULL;\n+\tlinked_list_t *responses = NULL;\n+\tchunk_t encoding = chunk_empty, nonce = chunk_empty;\n+\tchunk_t issuerNameHash, issuerKeyHash, serialNumber;\n+\thash_algorithm_t hashAlgorithm = HASH_SHA1, digest = HASH_UNKNOWN;\n+\tsignature_params_t *scheme = NULL;\n+\ttime_t lifetime = 0;\n+\tmem_cred_t *creds;\n+\tbool multiple_issuers = FALSE, self_signed = FALSE;\n+\tenumerator_t *enumerator;\n+\tint res = 1;\n+\n+\tenum {\n+\t\tOP_SHOW,\n+\t\tOP_RESPOND,\n+\t} op = OP_SHOW;\n+\n+\tbool pss = lib->settings->get_bool(lib->settings, \"%s.rsa_pss\", FALSE,\n+\t\t\t\t\t\t\t\t\t   lib->ns);\n+\n+\tcreds = mem_cred_create();\n+\n+\twhile (TRUE)\n+\t{\n+\t\tswitch (command_getopt(&arg))\n+\t\t{\n+\t\t\tcase 'h':\n+\t\t\t\tgoto usage;\n+\t\t\tcase 'i':\n+\t\t\t\tfile = arg;\n+\t\t\t\tcontinue;\n+\t\t\tcase 'r':\n+\t\t\t\top = OP_RESPOND;\n+\t\t\t\tcontinue;\n+\t\t\tcase 'k':\n+\t\t\t\tkey = lib->creds->create(lib->creds,\n+\t\t\t\t\t\t\t\t\t\t CRED_PRIVATE_KEY, KEY_ANY,\n+\t\t\t\t\t\t\t\t\t\t BUILD_FROM_FILE, arg, BUILD_END);\n+\t\t\t\tif (!key)\n+\t\t\t\t{\n+\t\t\t\t\terror = \"parsing private key failed\";\n+\t\t\t\t\tgoto usage;\n+\t\t\t\t}\n+\t\t\t\tcreds->add_key(creds, key);\n+\t\t\t\tcontinue;\n+\t\t\tcase 'c':\n+\t\t\t\tcert = lib->creds->create(lib->creds,\n+\t\t\t\t\t\t\t\t\t\t  CRED_CERTIFICATE, CERT_X509,\n+\t\t\t\t\t\t\t\t\t\t  BUILD_FROM_FILE, arg, BUILD_END);\n+\t\t\t\tif (!cert)\n+\t\t\t\t{\n+\t\t\t\t\terror = \"parsing certificate failed\";\n+\t\t\t\t\tgoto usage;\n+\t\t\t\t}\n+\t\t\t\tcreds->add_cert(creds, TRUE, cert);\n+\t\t\t\tcontinue;\n+\t\t\tcase 'C':\n+\t\t\t\tcacert = lib->creds->create(lib->creds,\n+\t\t\t\t\t\t\t\t\t\t\tCRED_CERTIFICATE, CERT_X509,\n+\t\t\t\t\t\t\t\t\t\t\tBUILD_FROM_FILE, arg, BUILD_END);\n+\t\t\t\tif (!cacert)\n+\t\t\t\t{\n+\t\t\t\t\terror = \"parsing CA certificate failed\";\n+\t\t\t\t\tgoto usage;\n+\t\t\t\t}\n+\t\t\t\tcreds->add_cert(creds, TRUE, cacert);\n+\t\t\t\tcontinue;\n+\t\t\tcase 'l':\n+\t\t\t\tlifetime = atoi(arg) * 60;\n+\t\t\t\tif (!lifetime)\n+\t\t\t\t{\n+\t\t\t\t\terror = \"invalid --lifetime value\";\n+\t\t\t\t\tgoto usage;\n+\t\t\t\t}\n+\t\t\t\tcontinue;\n+\t\t\tcase 'g':\n+\t\t\t\tif (!enum_from_name(hash_algorithm_short_names, arg, &digest))\n+\t\t\t\t{\n+\t\t\t\t\terror = \"invalid --digest type\";\n+\t\t\t\t\tgoto usage;\n+\t\t\t\t}\n+\t\t\t\tcontinue;\n+\t\t\tcase 'R':\n+\t\t\t\tif (!parse_rsa_padding(arg, &pss))\n+\t\t\t\t{\n+\t\t\t\t\terror = \"invalid RSA padding\";\n+\t\t\t\t\tgoto usage;\n+\t\t\t\t}\n+\t\t\t\tcontinue;\n+\t\t\tcase EOF:\n+\t\t\t\tbreak;\n+\t\t\tdefault:\n+\t\t\t\terror = \"invalid --ocsp option\";\n+\t\t\t\tgoto usage;\n+\t\t}\n+\t\tbreak;\n+\t}\n+\n+\tlib->credmgr->add_local_set(lib->credmgr, &creds->set, FALSE);\n+\n+\tresponses = linked_list_create();\n+\n+\tif (op == OP_RESPOND && !cacert)\n+\t{\n+\t\terror = \"respond mode requires a ca certificate\";\n+\t\tgoto end;\n+\t}\n+\n+\tif (op == OP_RESPOND && !key)\n+\t{\n+\t\terror = \"respond mode requires a private signer key\";\n+\t\tgoto end;\n+\t}\n+\n+\t/* re-initialize signing certificate and key pointers */\n+\tcert = NULL;\n+\tkey = NULL;\n+\n+\tif (file)\n+\t{\n+\t\tocsp_req = lib->creds->create(lib->creds, CRED_CERTIFICATE,\n+\t\t\t\t\t\t\t\tCERT_X509_OCSP_REQUEST,\n+\t\t\t\t\t\t\t\tBUILD_FROM_FILE, file, BUILD_END);\n+\t}\n+\telse\n+\t{\n+\t\tchunk_t chunk;\n+\n+\t\tset_file_mode(stdin, CERT_ASN1_DER);\n+\t\tif (!chunk_from_fd(0, &chunk))\n+\t\t{\n+\t\t\tfprintf(stderr, \"%s: \", strerror(errno));\n+\t\t\terror = \"reading certificate request failed\";\n+\t\t\tgoto end;\n+\t\t}\n+\t\tocsp_req = lib->creds->create(lib->creds, CRED_CERTIFICATE,\n+\t\t\t\t\t\t\t\tCERT_X509_OCSP_REQUEST,\n+\t\t\t\t\t\t\t\tBUILD_BLOB_ASN1_DER, chunk, BUILD_END);\n+\t\tfree(chunk.ptr);\n+\t}\n+\tif (!ocsp_req)\n+\t{\n+\t\tif (op == OP_SHOW)\n+\t\t{\n+\t\t\terror = \"malformed OCSP request\";\n+\t\t\tgoto end;\n+\t\t}\n+\t\telse\n+\t\t{\n+\t\t\tDBG1(DBG_LIB, \"malformed OCSP request\");\n+\t\t\tocsp_status = OCSP_MALFORMEDREQUEST;\n+\t\t\tgoto gen;\n+\t\t}\n+\t}\n+\tocsp_request = (ocsp_request_t*)ocsp_req;\n+\n+\t/* does the requestor identify itself? */\n+\trequestor = ocsp_req->get_subject(ocsp_req);\n+\tif (requestor)\n+\t{\n+\t\tDBG1(DBG_LIB, \"requestor:          \\\"%Y\\\"\", requestor);\n+\n+\t\t/* verify an optional ocsp request signature */\n+\t\tif (!verify_signature(ocsp_req, creds))\n+\t\t{\n+\t\t\tocsp_status = OCSP_UNAUTHORIZED;\n+\t\t\tgoto gen;\n+\t\t}\n+\t}\n+\n+\t/* extract nonce from OCSP request */\n+\tnonce = ocsp_request->get_nonce(ocsp_request);\n+\tif (nonce.len > 0)\n+\t{\n+\t\tDBG1(DBG_LIB, \"nonce:               %#B\", &nonce);\n+\t}\n+\n+\t/* check for an ocsp responder */\n+\tif (op == OP_RESPOND)\n+\t{\n+\t\tocsp_responder = lib->get(lib, \"ocsp-responder\");\n+\t\tif (!ocsp_responder)\n+\t\t{\n+\t\t\tDBG1(DBG_LIB, \" no ocsp-responder found\");\n+\t\t\tocsp_status = OCSP_INTERNALERROR;\n+\t\t\tgoto gen;\n+\t\t}\n+\t}\n+\n+\t/* enumerate over the ocsp requests and try to identify the issuers */\n+\tenumerator = ocsp_request->create_request_enumerator(ocsp_request);\n+\twhile (enumerator->enumerate(enumerator, &hashAlgorithm, &issuerNameHash,\n+\t\t\t\t\t\t\t\t\t\t\t &issuerKeyHash, &serialNumber))\n+\t{\n+\t\tcertificate_t *issuer_cacert = NULL;\n+\t\tcert_validation_t status = VALIDATION_FAILED;\n+\t\tocsp_single_response_t *response = NULL;\n+\t\tcrl_reason_t revocationReason;\n+\t\ttime_t revocationTime;\n+\n+\t\t/* search for the matching issuer cacert */\n+\t\tif (find_issuer_cacert(hashAlgorithm, issuerKeyHash, issuerNameHash,\n+\t\t\t\t\t\t\t   &issuer_cacert))\n+\t\t{\n+\t\t\tif (first_issuer == NULL)\n+\t\t\t{\n+\t\t\t\tfirst_issuer = issuer_cacert;\n+\n+\t\t\t\t/* search for a signing certificate plus matching private key */\n+\t\t\t\tif (op == OP_RESPOND)\n+\t\t\t\t{\n+\t\t\t\t\tfind_ocsp_signer(first_issuer, &self_signed, &cert, &key);\n+\t\t\t\t}\n+\t\t\t}\n+\t\t\telse if (first_issuer != issuer_cacert)\n+\t\t\t{\n+\t\t\t\tmultiple_issuers = TRUE;\n+\t\t\t}\n+\t\t}\n+\t\tDBG1(DBG_LIB, \"  serialNumber:      %#B\", &serialNumber);\n+\n+\t\tif (op == OP_SHOW)\n+\t\t{\n+\t\t\tcontinue;\n+\t\t}\n+\n+\t\t/**\n+\t\t *  fill in the OCSP single response\n+\t\t */\n+\t\tresponse = ocsp_single_response_create();\n+\t\tresponse->hashAlgorithm  = hashAlgorithm;\n+\t\tresponse->issuerNameHash = chunk_clone(issuerNameHash);\n+\t\tresponse->issuerKeyHash  = chunk_clone(issuerKeyHash);\n+\t\tresponse->serialNumber   = chunk_clone(serialNumber);\n+\t\tresponse->thisUpdate     = time(NULL);\n+\t\tDBG1(DBG_LIB, \"  thisUpdate:        %#T\", &response->thisUpdate, TRUE);\n+\n+\t\tif (lifetime)\n+\t\t{\n+\t\t\tresponse->nextUpdate = response->thisUpdate + lifetime;\n+\t\t\tDBG1(DBG_LIB, \"  nextUpdate:        %#T\", &response->nextUpdate, TRUE);\n+\t\t}\n+\n+\t\tif (issuer_cacert && (issuer_cacert == first_issuer || self_signed))\n+\t\t{\n+\t\t\tstatus = ocsp_responder->get_status(ocsp_responder,\n+\t\t\t\t\t\t\t\t\tissuer_cacert,\tserialNumber,\n+\t\t\t\t\t\t\t\t\t&revocationTime, &revocationReason);\n+\t\t}\n+\t\tDBG1(DBG_LIB, \"  certValidation:    %N\", cert_validation_names, status);\n+\t\tresponse->status = status;\n+\n+\t\tif (status == VALIDATION_REVOKED || status == VALIDATION_ON_HOLD)\n+\t\t{\n+\t\t\tDBG1(DBG_LIB, \"  revocationTime:    %T\", &revocationTime, TRUE);\n+\t\t\tDBG1(DBG_LIB, \"  revocationReason:  %N\", crl_reason_names,\n+\t\t\t\t\t\t\t\t\t\t\t\t  revocationReason);\n+\t\t\tresponse->revocationTime   = revocationTime;\n+\t\t\tresponse->revocationReason = revocationReason;\n+\t\t}\n+\t\tresponses->insert_last(responses, response);\n+\t}\n+\tenumerator->destroy(enumerator);\n+\n+\tif (multiple_issuers)\n+\t{\n+\t\tDBG1(DBG_LIB, \"there are multiple known issuers\");\n+\t}\n+\n+gen:\n+\tif (op == OP_RESPOND)\n+\t{\n+\t\tif (cert)\n+\t\t{\n+\t\t\tDBG1(DBG_LIB, \"%s \\\"%Y\\\"\",\n+\t\t\t\t self_signed ? \"self-signed signer:\" : \"trusted signer:    \",\n+\t\t\t\t cert->get_subject(cert));\n+\n+\t\t\tscheme = get_signature_scheme(key, digest, pss);\n+\t\t\tif (scheme)\n+\t\t\t{\n+\t\t\t\tif (digest == HASH_UNKNOWN)\n+\t\t\t\t{\n+\t\t\t\t\tdigest = hasher_from_signature_scheme(scheme->scheme,\n+\t\t\t\t\t\t\t\t\t\t\t\t\t\t  scheme->params);\n+\t\t\t\t}\n+\t\t\t}\n+\t\t\telse\n+\t\t\t{\n+\t\t\t\tDBG1(DBG_LIB, \"no signature scheme found\");\n+\t\t\t\tocsp_status = OCSP_INTERNALERROR;\n+\t\t\t}\n+\t\t}\n+\t\tDBG1(DBG_LIB, \"ocspResponseStatus:  %N\", ocsp_status_names, ocsp_status);\n+\n+\t\tenumerator = responses->create_enumerator(responses);\n+\t\tocsp_resp = lib->creds->create(lib->creds, CRED_CERTIFICATE,\n+\t\t\t\t\t\tCERT_X509_OCSP_RESPONSE,\n+\t\t\t\t\t\tBUILD_OCSP_STATUS, ocsp_status,\n+\t\t\t\t\t\tBUILD_OCSP_RESPONSES, enumerator,\n+\t\t\t\t\t\tBUILD_SIGNING_KEY, key,\n+\t\t\t\t\t\tBUILD_SIGNING_CERT, cert,\n+\t\t\t\t\t\tBUILD_SIGNATURE_SCHEME, scheme,\n+\t\t\t\t\t\tBUILD_NONCE, nonce,\n+\t\t\t\t\t\tBUILD_END);\n+\t\tenumerator->destroy(enumerator);\n+\n+\t\tif (!ocsp_resp)\n+\t\t{\n+\t\t\terror = \"generating OCSP response failed\";\n+\t\t\tgoto end;\n+\t\t}\n+\t\tif (!ocsp_resp->get_encoding(ocsp_resp, form, &encoding))\n+\t\t{\n+\t\t\terror = \"encoding OCSP response failed\";\n+\t\t\tgoto end;\n+\t\t}\n+\t\tset_file_mode(stdout, form);\n+\t\tif (fwrite(encoding.ptr, encoding.len, 1, stdout) != 1)\n+\t\t{\n+\t\t\terror = \"writing OCSP response failed\";\n+\t\t\tgoto end;\n+\t\t}\n+\t}\n+\tres = 0;\n+\n+end:\n+\tDESTROY_IF(key);\n+\tlib->credmgr->remove_local_set(lib->credmgr, &creds->set);\n+\tcreds->destroy(creds);\n+\tresponses->destroy_offset(responses,\n+\t\t\t\t\t\t\t  offsetof(ocsp_single_response_t, destroy));\n+\tDESTROY_IF(ocsp_req);\n+\tDESTROY_IF(ocsp_resp);\n+\tsignature_params_destroy(scheme);\n+\tfree(encoding.ptr);\n+\tif (error)\n+\t{\n+\t\tfprintf(stderr, \"%s\\n\", error);",
                "path": "src/pki/commands/ocsp.c",
                "commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "original_commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "user": {
                    "login": "tobiasbrunner",
                    "id": 457648,
                    "node_id": "MDQ6VXNlcjQ1NzY0OA==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/457648?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/tobiasbrunner",
                    "html_url": "https://github.com/tobiasbrunner",
                    "followers_url": "https://api.github.com/users/tobiasbrunner/followers",
                    "following_url": "https://api.github.com/users/tobiasbrunner/following{/other_user}",
                    "gists_url": "https://api.github.com/users/tobiasbrunner/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/tobiasbrunner/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/tobiasbrunner/subscriptions",
                    "organizations_url": "https://api.github.com/users/tobiasbrunner/orgs",
                    "repos_url": "https://api.github.com/users/tobiasbrunner/repos",
                    "events_url": "https://api.github.com/users/tobiasbrunner/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/tobiasbrunner/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "Use `DBG1()` here as well instead of `fprintf()` directly? Or maybe use `DBG1()` explicitly for some of the errors above when generating the response? (I assume you used `DBG1()` so that output could - in theory, as `pki`  currently doesn't support any loggers other than the default to `stderr` -  be redirected when the command is called as a service. If so, some of the errors that could occur during generation wouldn't end up there.)",
                "created_at": "2023-10-26T15:20:41Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373352038",
                "pull_request_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "author_association": "MEMBER",
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373352038"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373352038"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    }
                },
                "reactions": {
                    "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373352038/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "start_line": null,
                "original_start_line": null,
                "start_side": null,
                "line": 538,
                "original_line": 538,
                "side": "RIGHT",
                "original_position": 538,
                "position": 538,
                "subject_type": "line"
            },
            "pull_request": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "id": 1565360593,
                "node_id": "PR_kwDOAA-8Q85dTYHR",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958",
                "diff_url": "https://github.com/strongswan/strongswan/pull/1958.diff",
                "patch_url": "https://github.com/strongswan/strongswan/pull/1958.patch",
                "issue_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958",
                "number": 1958,
                "state": "open",
                "locked": false,
                "title": "OCSP Responder",
                "user": {
                    "login": "strongX509",
                    "id": 4939775,
                    "node_id": "MDQ6VXNlcjQ5Mzk3NzU=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/4939775?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/strongX509",
                    "html_url": "https://github.com/strongX509",
                    "followers_url": "https://api.github.com/users/strongX509/followers",
                    "following_url": "https://api.github.com/users/strongX509/following{/other_user}",
                    "gists_url": "https://api.github.com/users/strongX509/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/strongX509/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/strongX509/subscriptions",
                    "organizations_url": "https://api.github.com/users/strongX509/orgs",
                    "repos_url": "https://api.github.com/users/strongX509/repos",
                    "events_url": "https://api.github.com/users/strongX509/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/strongX509/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "The new **`pki --ocsp`** command parses an _Online Certificate Status Protocol_ (OCSP) request as defined by  RFC  6960  and\r\n       with  the **`--respond`** option generates an OCSP response based on the OCSP request.  The certificate status is directly\r\n       retrieved from the internal certificate database of an _OpenXPKI_ (https://openxpki.org) server. Therefore the **`--respond`**  option\r\n       requires  the new  **`openxpki`**  and the existing  **`mysql`** libstrongswan plugins in order to access the **`certificate`** database table of the _OpenXPKI_ server running on the same host. The OCSP response can be signed by the CA itself, by a delegated OCSP Signer certificate with corresonding EKU extension or by a self-signed OCSP Signer certificate.\r\n",
                "created_at": "2023-10-19T18:01:27Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "db8b1bc37cb571300caaaa58e8b4614e662c2c45",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [
                    {
                        "id": 5235670731,
                        "node_id": "LA_kwDOAA-8Q88AAAABOBH-yw",
                        "url": "https://api.github.com/repos/strongswan/strongswan/labels/cla-signed",
                        "name": "cla-signed",
                        "color": "ededed",
                        "default": false,
                        "description": null
                    }
                ],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits",
                "review_comments_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments",
                "review_comment_url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments",
                "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "head": {
                    "label": "strongswan:ocsp-responder-new",
                    "ref": "ocsp-responder-new",
                    "sha": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "base": {
                    "label": "strongswan:master",
                    "ref": "master",
                    "sha": "b5760243870d4ab6c5874d765f8b09b3c67b8fc6",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T15:20:41Z",
        "org": {
            "id": 457671,
            "login": "strongswan",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/strongswan",
            "avatar_url": "https://avatars.githubusercontent.com/u/457671?"
        }
    },
    {
        "id": "32874321895",
        "type": "PullRequestReviewCommentEvent",
        "actor": {
            "id": 457648,
            "login": "tobiasbrunner",
            "display_login": "tobiasbrunner",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tobiasbrunner",
            "avatar_url": "https://avatars.githubusercontent.com/u/457648?"
        },
        "repo": {
            "id": 1031235,
            "name": "strongswan/strongswan",
            "url": "https://api.github.com/repos/strongswan/strongswan"
        },
        "payload": {
            "action": "created",
            "comment": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373368604",
                "pull_request_review_id": 1698865892,
                "id": 1373368604,
                "node_id": "PRRC_kwDOAA-8Q85R2_Ec",
                "diff_hunk": "@@ -277,6 +269,55 @@ METHOD(ocsp_response_t, get_nonce, chunk_t,\n \treturn this->nonce;\n }\n \n+/**\n+ * Build singleResponse\n+ */\n+static chunk_t build_singleResponse(private_x509_ocsp_response_t *this,\n+\t\t\t\t\t\t\t\t\tocsp_single_response_t *response)\n+{\n+\tchunk_t certID, certStatus, nextUpdate = chunk_empty;\n+\n+\tcertID = asn1_wrap(ASN1_SEQUENCE, \"mmmm\",\n+\t\t\t\tasn1_algorithmIdentifier(\n+\t\t\t\t\thasher_algorithm_to_oid(response->hashAlgorithm)),\n+\t\t\t\tasn1_simple_object(ASN1_OCTET_STRING, response->issuerNameHash),\n+\t\t\t\tasn1_simple_object(ASN1_OCTET_STRING, response->issuerKeyHash),\n+\t\t\t\tasn1_integer(\"c\", response->serialNumber));\n+\n+\tswitch (response->status)\n+\t{\n+\t\tcase VALIDATION_GOOD:\n+\t\t\tcertStatus = asn1_wrap(ASN1_CONTEXT_S_0, \"c\", chunk_empty);\n+\t\t\tbreak;\n+\t\tcase VALIDATION_REVOKED:\n+\t\tcase VALIDATION_ON_HOLD:\n+\t\t\tcertStatus = asn1_wrap(ASN1_CONTEXT_C_1, \"mm\",\n+\t\t\t\t\t\t\tasn1_from_time(&response->revocationTime,\n+\t\t\t\t\t\t\t\t\t\t   ASN1_GENERALIZEDTIME),\n+\t\t\t\t\t\t\tasn1_wrap(ASN1_CONTEXT_C_0, \"m\",\n+\t\t\t\t\t\t\t\tasn1_simple_object(ASN1_ENUMERATED,\n+\t\t\t\t\t\t\t\t chunk_from_chars(response->revocationReason))));\n+\t\t\tbreak;\n+\t\tcase VALIDATION_FAILED:\n+\t\tdefault:\n+\t\t\tcertStatus = asn1_wrap(ASN1_CONTEXT_S_2, \"c\", chunk_empty);\n+\t}\n+\n+\tif (response->nextUpdate != 0)\n+\t{\n+\t\tnextUpdate = asn1_wrap(ASN1_CONTEXT_C_0, \"m\",\n+\t\t\t\t\t\tasn1_from_time(&response->nextUpdate,\n+\t\t\t\t\t\t\t\t\t   ASN1_GENERALIZEDTIME));\n+\t}\n+\n+\n+\treturn asn1_wrap(ASN1_SEQUENCE, \"mmmm\",\n+\t\t\t\tcertID,\n+ \t\t\t\tcertStatus,",
                "path": "src/libstrongswan/plugins/x509/x509_ocsp_response.c",
                "commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "original_commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "user": {
                    "login": "tobiasbrunner",
                    "id": 457648,
                    "node_id": "MDQ6VXNlcjQ1NzY0OA==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/457648?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/tobiasbrunner",
                    "html_url": "https://github.com/tobiasbrunner",
                    "followers_url": "https://api.github.com/users/tobiasbrunner/followers",
                    "following_url": "https://api.github.com/users/tobiasbrunner/following{/other_user}",
                    "gists_url": "https://api.github.com/users/tobiasbrunner/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/tobiasbrunner/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/tobiasbrunner/subscriptions",
                    "organizations_url": "https://api.github.com/users/tobiasbrunner/orgs",
                    "repos_url": "https://api.github.com/users/tobiasbrunner/repos",
                    "events_url": "https://api.github.com/users/tobiasbrunner/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/tobiasbrunner/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "```suggestion\r\n\t\t\t\tcertStatus,\r\n```",
                "created_at": "2023-10-26T15:32:49Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373368604",
                "pull_request_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "author_association": "MEMBER",
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373368604"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373368604"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    }
                },
                "reactions": {
                    "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373368604/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "start_line": null,
                "original_start_line": null,
                "start_side": null,
                "line": 316,
                "original_line": 316,
                "side": "RIGHT",
                "original_position": 142,
                "position": 142,
                "subject_type": "line"
            },
            "pull_request": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "id": 1565360593,
                "node_id": "PR_kwDOAA-8Q85dTYHR",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958",
                "diff_url": "https://github.com/strongswan/strongswan/pull/1958.diff",
                "patch_url": "https://github.com/strongswan/strongswan/pull/1958.patch",
                "issue_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958",
                "number": 1958,
                "state": "open",
                "locked": false,
                "title": "OCSP Responder",
                "user": {
                    "login": "strongX509",
                    "id": 4939775,
                    "node_id": "MDQ6VXNlcjQ5Mzk3NzU=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/4939775?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/strongX509",
                    "html_url": "https://github.com/strongX509",
                    "followers_url": "https://api.github.com/users/strongX509/followers",
                    "following_url": "https://api.github.com/users/strongX509/following{/other_user}",
                    "gists_url": "https://api.github.com/users/strongX509/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/strongX509/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/strongX509/subscriptions",
                    "organizations_url": "https://api.github.com/users/strongX509/orgs",
                    "repos_url": "https://api.github.com/users/strongX509/repos",
                    "events_url": "https://api.github.com/users/strongX509/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/strongX509/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "The new **`pki --ocsp`** command parses an _Online Certificate Status Protocol_ (OCSP) request as defined by  RFC  6960  and\r\n       with  the **`--respond`** option generates an OCSP response based on the OCSP request.  The certificate status is directly\r\n       retrieved from the internal certificate database of an _OpenXPKI_ (https://openxpki.org) server. Therefore the **`--respond`**  option\r\n       requires  the new  **`openxpki`**  and the existing  **`mysql`** libstrongswan plugins in order to access the **`certificate`** database table of the _OpenXPKI_ server running on the same host. The OCSP response can be signed by the CA itself, by a delegated OCSP Signer certificate with corresonding EKU extension or by a self-signed OCSP Signer certificate.\r\n",
                "created_at": "2023-10-19T18:01:27Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "db8b1bc37cb571300caaaa58e8b4614e662c2c45",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [
                    {
                        "id": 5235670731,
                        "node_id": "LA_kwDOAA-8Q88AAAABOBH-yw",
                        "url": "https://api.github.com/repos/strongswan/strongswan/labels/cla-signed",
                        "name": "cla-signed",
                        "color": "ededed",
                        "default": false,
                        "description": null
                    }
                ],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits",
                "review_comments_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments",
                "review_comment_url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments",
                "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "head": {
                    "label": "strongswan:ocsp-responder-new",
                    "ref": "ocsp-responder-new",
                    "sha": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "base": {
                    "label": "strongswan:master",
                    "ref": "master",
                    "sha": "b5760243870d4ab6c5874d765f8b09b3c67b8fc6",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T15:32:49Z",
        "org": {
            "id": 457671,
            "login": "strongswan",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/strongswan",
            "avatar_url": "https://avatars.githubusercontent.com/u/457671?"
        }
    },
    {
        "id": "32874321892",
        "type": "PullRequestReviewCommentEvent",
        "actor": {
            "id": 457648,
            "login": "tobiasbrunner",
            "display_login": "tobiasbrunner",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tobiasbrunner",
            "avatar_url": "https://avatars.githubusercontent.com/u/457648?"
        },
        "repo": {
            "id": 1031235,
            "name": "strongswan/strongswan",
            "url": "https://api.github.com/repos/strongswan/strongswan"
        },
        "payload": {
            "action": "created",
            "comment": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373369166",
                "pull_request_review_id": 1698865892,
                "id": 1373369166,
                "node_id": "PRRC_kwDOAA-8Q85R2_NO",
                "diff_hunk": "@@ -466,6 +521,96 @@ static bool parse_responses(private_x509_ocsp_response_t *this,\n \treturn success;\n }\n \n+/**\n+ * Build tbsResponseData\n+ */\n+static chunk_t build_tbsResponseData(private_x509_ocsp_response_t *this)\n+{\n+\tchunk_t responderIdByName;\n+\tchunk_t responseExtensions = chunk_empty;\n+\n+\tresponderIdByName = asn1_wrap(ASN1_CONTEXT_C_1, \"c\",\n+\t\t\t\t\t\t\tthis->responderId->get_encoding(this->responderId));\n+\n+\tthis->producedAt = time(NULL);\n+\n+\tresponseExtensions = asn1_wrap(ASN1_CONTEXT_C_1, \"m\",\n+\t\t\t\t\t\t\tasn1_wrap(ASN1_SEQUENCE, \"m\",\n+\t\t\t\t\t\t\t\tasn1_wrap(ASN1_SEQUENCE, \"mm\",\n+\t\t\t\t\t\t\t\t\tasn1_build_known_oid(OID_NONCE),\n+\t\t\t\t\t\t\t\t\tasn1_wrap(ASN1_OCTET_STRING, \"m\",\n+\t\t\t\t\t\t\t\t\t\tasn1_simple_object(ASN1_OCTET_STRING,\n+\t\t\t\t\t\t\t\t\t\t\t\t\t\t  this->nonce)))));\n+\n+\treturn asn1_wrap(ASN1_SEQUENCE, \"mmmm\",\n+\t\t\t\tresponderIdByName,\n+\t\t\t\tasn1_from_time(&this->producedAt, ASN1_GENERALIZEDTIME),\n+ \t\t\t\tbuild_responses(this),",
                "path": "src/libstrongswan/plugins/x509/x509_ocsp_response.c",
                "commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "original_commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "user": {
                    "login": "tobiasbrunner",
                    "id": 457648,
                    "node_id": "MDQ6VXNlcjQ1NzY0OA==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/457648?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/tobiasbrunner",
                    "html_url": "https://github.com/tobiasbrunner",
                    "followers_url": "https://api.github.com/users/tobiasbrunner/followers",
                    "following_url": "https://api.github.com/users/tobiasbrunner/following{/other_user}",
                    "gists_url": "https://api.github.com/users/tobiasbrunner/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/tobiasbrunner/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/tobiasbrunner/subscriptions",
                    "organizations_url": "https://api.github.com/users/tobiasbrunner/orgs",
                    "repos_url": "https://api.github.com/users/tobiasbrunner/repos",
                    "events_url": "https://api.github.com/users/tobiasbrunner/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/tobiasbrunner/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "```suggestion\r\n\t\t\t\tbuild_responses(this),\r\n```",
                "created_at": "2023-10-26T15:33:12Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373369166",
                "pull_request_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "author_association": "MEMBER",
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373369166"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373369166"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    }
                },
                "reactions": {
                    "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373369166/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "start_line": null,
                "original_start_line": null,
                "start_side": null,
                "line": 548,
                "original_line": 548,
                "side": "RIGHT",
                "original_position": 252,
                "position": 252,
                "subject_type": "line"
            },
            "pull_request": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "id": 1565360593,
                "node_id": "PR_kwDOAA-8Q85dTYHR",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958",
                "diff_url": "https://github.com/strongswan/strongswan/pull/1958.diff",
                "patch_url": "https://github.com/strongswan/strongswan/pull/1958.patch",
                "issue_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958",
                "number": 1958,
                "state": "open",
                "locked": false,
                "title": "OCSP Responder",
                "user": {
                    "login": "strongX509",
                    "id": 4939775,
                    "node_id": "MDQ6VXNlcjQ5Mzk3NzU=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/4939775?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/strongX509",
                    "html_url": "https://github.com/strongX509",
                    "followers_url": "https://api.github.com/users/strongX509/followers",
                    "following_url": "https://api.github.com/users/strongX509/following{/other_user}",
                    "gists_url": "https://api.github.com/users/strongX509/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/strongX509/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/strongX509/subscriptions",
                    "organizations_url": "https://api.github.com/users/strongX509/orgs",
                    "repos_url": "https://api.github.com/users/strongX509/repos",
                    "events_url": "https://api.github.com/users/strongX509/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/strongX509/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "The new **`pki --ocsp`** command parses an _Online Certificate Status Protocol_ (OCSP) request as defined by  RFC  6960  and\r\n       with  the **`--respond`** option generates an OCSP response based on the OCSP request.  The certificate status is directly\r\n       retrieved from the internal certificate database of an _OpenXPKI_ (https://openxpki.org) server. Therefore the **`--respond`**  option\r\n       requires  the new  **`openxpki`**  and the existing  **`mysql`** libstrongswan plugins in order to access the **`certificate`** database table of the _OpenXPKI_ server running on the same host. The OCSP response can be signed by the CA itself, by a delegated OCSP Signer certificate with corresonding EKU extension or by a self-signed OCSP Signer certificate.\r\n",
                "created_at": "2023-10-19T18:01:27Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "db8b1bc37cb571300caaaa58e8b4614e662c2c45",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [
                    {
                        "id": 5235670731,
                        "node_id": "LA_kwDOAA-8Q88AAAABOBH-yw",
                        "url": "https://api.github.com/repos/strongswan/strongswan/labels/cla-signed",
                        "name": "cla-signed",
                        "color": "ededed",
                        "default": false,
                        "description": null
                    }
                ],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits",
                "review_comments_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments",
                "review_comment_url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments",
                "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "head": {
                    "label": "strongswan:ocsp-responder-new",
                    "ref": "ocsp-responder-new",
                    "sha": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "base": {
                    "label": "strongswan:master",
                    "ref": "master",
                    "sha": "b5760243870d4ab6c5874d765f8b09b3c67b8fc6",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T15:33:12Z",
        "org": {
            "id": 457671,
            "login": "strongswan",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/strongswan",
            "avatar_url": "https://avatars.githubusercontent.com/u/457671?"
        }
    },
    {
        "id": "32874321803",
        "type": "PullRequestReviewCommentEvent",
        "actor": {
            "id": 457648,
            "login": "tobiasbrunner",
            "display_login": "tobiasbrunner",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tobiasbrunner",
            "avatar_url": "https://avatars.githubusercontent.com/u/457648?"
        },
        "repo": {
            "id": 1031235,
            "name": "strongswan/strongswan",
            "url": "https://api.github.com/repos/strongswan/strongswan"
        },
        "payload": {
            "action": "created",
            "comment": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373296176",
                "pull_request_review_id": 1698865892,
                "id": 1373296176,
                "node_id": "PRRC_kwDOAA-8Q85R2tYw",
                "diff_hunk": "@@ -0,0 +1,569 @@\n+/*\n+ * Copyright (C) 2023 Andreas Steffen, strongSec GmbH\n+ *\n+ * Copyright (C) secunet Security Networks AG\n+ *\n+ * This program is free software; you can redistribute it and/or modify it\n+ * under the terms of the GNU General Public License as published by the\n+ * Free Software Foundation; either version 2 of the License, or (at your\n+ * option) any later version.  See <http://www.fsf.org/copyleft/gpl.txt>.\n+ *\n+ * This program is distributed in the hope that it will be useful, but\n+ * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY\n+ * or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * for more details.\n+ */\n+\n+#include <errno.h>\n+#include <time.h>\n+\n+#include \"pki.h\"\n+\n+#include <credentials/sets/mem_cred.h>\n+#include <credentials/certificates/ocsp_request.h>\n+#include <credentials/certificates/ocsp_response.h>\n+#include <credentials/certificates/ocsp_single_response.h>\n+#include <credentials/certificates/ocsp_responder.h>\n+\n+static bool verify_signature(certificate_t *ocsp_req, mem_cred_t *creds)\n+{\n+\tidentification_t *signer;\n+\tcertificate_t *signer_cert, *cert_found;\n+\tocsp_request_t *ocsp_request;\n+\tenumerator_t *certs;\n+\tbool trusted = TRUE;\n+\n+\tocsp_request = (ocsp_request_t*)ocsp_req;\n+\n+\tsigner_cert = ocsp_request->get_signer_cert(ocsp_request);\n+\tif (signer_cert)\n+\t{\n+\t\tsigner = signer_cert->get_subject(signer_cert);\n+\n+\t\t/* establish trust relative to root CA */\n+\t\tcreds->add_cert(creds, FALSE, signer_cert->get_ref(signer_cert));\n+\t\tcerts = lib->credmgr->create_trusted_enumerator(lib->credmgr,\n+\t\t\t\t\t\t\t\t\t\t\tKEY_ANY, signer, FALSE);\n+\t\ttrusted = certs->enumerate(certs, &cert_found, NULL) &&\n+\t\t\t\t\t\t\t\t  (cert_found == signer_cert);\n+\t\tcerts->destroy(certs);\n+\t\ttrusted &= ocsp_req->issued_by(ocsp_req, signer_cert, NULL);\n+\t}\n+\tDBG1(DBG_LIB, \"requestor is %strusted\", trusted ? \"\" : \"not \");\n+\n+\treturn trusted;\n+}\n+\n+static bool find_issuer_cacert(hash_algorithm_t hashAlgorithm,\n+\t\t\t\t\t\t\t   chunk_t issuerKeyHash, chunk_t issuerNameHash,\n+\t\t\t\t\t\t\t   certificate_t **issuer_cacert)\n+{\n+    bool issuerKeyHash_ok = FALSE, issuerNameHash_ok = FALSE;\n+\tcertificate_t *candidate;\n+\tidentification_t *issuer;\n+\tx509_t *x509_ca;\n+\tchunk_t caKeyHash = chunk_empty, caNameHash = chunk_empty;\n+\thasher_t *hasher;\n+\tenumerator_t *certs;\n+\n+\t*issuer_cacert = NULL;\n+\n+\tcerts = lib->credmgr->create_cert_enumerator(lib->credmgr, CERT_X509,\n+\t\t\t\t\t\t\t\t\t\t\t\t KEY_ANY, NULL, TRUE);\n+\twhile (certs->enumerate(certs, &candidate) && hashAlgorithm == HASH_SHA1)\n+\t{\n+\t\tx509_ca = (x509_t*)candidate;\n+\n+\t\tif (!(x509_ca->get_flags(x509_ca) & X509_CA))\n+\t\t{\n+\t\t\tcontinue;\n+\t\t}\n+\n+\t\t/* retrieve the caKeyHash of the candidate issuer */\n+\t\tcaKeyHash = x509_ca->get_subjectKeyIdentifier(x509_ca);\n+\t\tissuerKeyHash_ok = chunk_equals(issuerKeyHash, caKeyHash);\n+\t\tif (!issuerKeyHash_ok)\n+\t\t{\n+\t\t\tcontinue;\n+\t\t}\n+\n+\t\t/* compute the caNameHash of the candidate issuer */\n+\t\tissuer = candidate->get_subject(candidate);\n+\n+\t\thasher = lib->crypto->create_hasher(lib->crypto, HASH_SHA1);\n+\t\tif (!hasher)\n+\t\t{\n+\t\t\tDBG1(DBG_LIB, \"failed to create SHA1 hasher\");\n+\t\t\tbreak;\n+\t\t}\n+\n+\t\tif (!hasher->allocate_hash(hasher, issuer->get_encoding(issuer),\n+\t\t\t\t\t\t\t\t\t\t   &caNameHash))\n+\t\t{\n+\t\t\thasher->destroy(hasher);\n+\t\t\tDBG1(DBG_LIB, \"failed to compute SHA1 caNameHash\");\n+\t\t\tbreak;\n+\t\t}\n+\t\thasher->destroy(hasher);\n+\n+\t\tissuerNameHash_ok = chunk_equals(issuerNameHash, caNameHash);",
                "path": "src/pki/commands/ocsp.c",
                "commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "original_commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "user": {
                    "login": "tobiasbrunner",
                    "id": 457648,
                    "node_id": "MDQ6VXNlcjQ1NzY0OA==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/457648?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/tobiasbrunner",
                    "html_url": "https://github.com/tobiasbrunner",
                    "followers_url": "https://api.github.com/users/tobiasbrunner/followers",
                    "following_url": "https://api.github.com/users/tobiasbrunner/following{/other_user}",
                    "gists_url": "https://api.github.com/users/tobiasbrunner/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/tobiasbrunner/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/tobiasbrunner/subscriptions",
                    "organizations_url": "https://api.github.com/users/tobiasbrunner/orgs",
                    "repos_url": "https://api.github.com/users/tobiasbrunner/repos",
                    "events_url": "https://api.github.com/users/tobiasbrunner/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/tobiasbrunner/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "Same as above, use `chunk_equals_const()`?",
                "created_at": "2023-10-26T14:43:02Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373296176",
                "pull_request_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "author_association": "MEMBER",
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373296176"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373296176"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    }
                },
                "reactions": {
                    "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373296176/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "start_line": null,
                "original_start_line": null,
                "start_side": null,
                "line": 109,
                "original_line": 109,
                "side": "RIGHT",
                "original_position": 109,
                "position": 109,
                "subject_type": "line"
            },
            "pull_request": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "id": 1565360593,
                "node_id": "PR_kwDOAA-8Q85dTYHR",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958",
                "diff_url": "https://github.com/strongswan/strongswan/pull/1958.diff",
                "patch_url": "https://github.com/strongswan/strongswan/pull/1958.patch",
                "issue_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958",
                "number": 1958,
                "state": "open",
                "locked": false,
                "title": "OCSP Responder",
                "user": {
                    "login": "strongX509",
                    "id": 4939775,
                    "node_id": "MDQ6VXNlcjQ5Mzk3NzU=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/4939775?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/strongX509",
                    "html_url": "https://github.com/strongX509",
                    "followers_url": "https://api.github.com/users/strongX509/followers",
                    "following_url": "https://api.github.com/users/strongX509/following{/other_user}",
                    "gists_url": "https://api.github.com/users/strongX509/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/strongX509/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/strongX509/subscriptions",
                    "organizations_url": "https://api.github.com/users/strongX509/orgs",
                    "repos_url": "https://api.github.com/users/strongX509/repos",
                    "events_url": "https://api.github.com/users/strongX509/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/strongX509/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "The new **`pki --ocsp`** command parses an _Online Certificate Status Protocol_ (OCSP) request as defined by  RFC  6960  and\r\n       with  the **`--respond`** option generates an OCSP response based on the OCSP request.  The certificate status is directly\r\n       retrieved from the internal certificate database of an _OpenXPKI_ (https://openxpki.org) server. Therefore the **`--respond`**  option\r\n       requires  the new  **`openxpki`**  and the existing  **`mysql`** libstrongswan plugins in order to access the **`certificate`** database table of the _OpenXPKI_ server running on the same host. The OCSP response can be signed by the CA itself, by a delegated OCSP Signer certificate with corresonding EKU extension or by a self-signed OCSP Signer certificate.\r\n",
                "created_at": "2023-10-19T18:01:27Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "db8b1bc37cb571300caaaa58e8b4614e662c2c45",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [
                    {
                        "id": 5235670731,
                        "node_id": "LA_kwDOAA-8Q88AAAABOBH-yw",
                        "url": "https://api.github.com/repos/strongswan/strongswan/labels/cla-signed",
                        "name": "cla-signed",
                        "color": "ededed",
                        "default": false,
                        "description": null
                    }
                ],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits",
                "review_comments_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments",
                "review_comment_url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments",
                "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "head": {
                    "label": "strongswan:ocsp-responder-new",
                    "ref": "ocsp-responder-new",
                    "sha": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "base": {
                    "label": "strongswan:master",
                    "ref": "master",
                    "sha": "b5760243870d4ab6c5874d765f8b09b3c67b8fc6",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T14:43:02Z",
        "org": {
            "id": 457671,
            "login": "strongswan",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/strongswan",
            "avatar_url": "https://avatars.githubusercontent.com/u/457671?"
        }
    },
    {
        "id": "32874321777",
        "type": "PullRequestReviewCommentEvent",
        "actor": {
            "id": 457648,
            "login": "tobiasbrunner",
            "display_login": "tobiasbrunner",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tobiasbrunner",
            "avatar_url": "https://avatars.githubusercontent.com/u/457648?"
        },
        "repo": {
            "id": 1031235,
            "name": "strongswan/strongswan",
            "url": "https://api.github.com/repos/strongswan/strongswan"
        },
        "payload": {
            "action": "created",
            "comment": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373293275",
                "pull_request_review_id": 1698865892,
                "id": 1373293275,
                "node_id": "PRRC_kwDOAA-8Q85R2srb",
                "diff_hunk": "@@ -0,0 +1,569 @@\n+/*\n+ * Copyright (C) 2023 Andreas Steffen, strongSec GmbH\n+ *\n+ * Copyright (C) secunet Security Networks AG\n+ *\n+ * This program is free software; you can redistribute it and/or modify it\n+ * under the terms of the GNU General Public License as published by the\n+ * Free Software Foundation; either version 2 of the License, or (at your\n+ * option) any later version.  See <http://www.fsf.org/copyleft/gpl.txt>.\n+ *\n+ * This program is distributed in the hope that it will be useful, but\n+ * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY\n+ * or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * for more details.\n+ */\n+\n+#include <errno.h>\n+#include <time.h>\n+\n+#include \"pki.h\"\n+\n+#include <credentials/sets/mem_cred.h>\n+#include <credentials/certificates/ocsp_request.h>\n+#include <credentials/certificates/ocsp_response.h>\n+#include <credentials/certificates/ocsp_single_response.h>\n+#include <credentials/certificates/ocsp_responder.h>\n+\n+static bool verify_signature(certificate_t *ocsp_req, mem_cred_t *creds)\n+{\n+\tidentification_t *signer;\n+\tcertificate_t *signer_cert, *cert_found;\n+\tocsp_request_t *ocsp_request;\n+\tenumerator_t *certs;\n+\tbool trusted = TRUE;\n+\n+\tocsp_request = (ocsp_request_t*)ocsp_req;\n+\n+\tsigner_cert = ocsp_request->get_signer_cert(ocsp_request);\n+\tif (signer_cert)\n+\t{\n+\t\tsigner = signer_cert->get_subject(signer_cert);\n+\n+\t\t/* establish trust relative to root CA */\n+\t\tcreds->add_cert(creds, FALSE, signer_cert->get_ref(signer_cert));\n+\t\tcerts = lib->credmgr->create_trusted_enumerator(lib->credmgr,\n+\t\t\t\t\t\t\t\t\t\t\tKEY_ANY, signer, FALSE);\n+\t\ttrusted = certs->enumerate(certs, &cert_found, NULL) &&\n+\t\t\t\t\t\t\t\t  (cert_found == signer_cert);\n+\t\tcerts->destroy(certs);\n+\t\ttrusted &= ocsp_req->issued_by(ocsp_req, signer_cert, NULL);\n+\t}\n+\tDBG1(DBG_LIB, \"requestor is %strusted\", trusted ? \"\" : \"not \");\n+\n+\treturn trusted;\n+}\n+\n+static bool find_issuer_cacert(hash_algorithm_t hashAlgorithm,\n+\t\t\t\t\t\t\t   chunk_t issuerKeyHash, chunk_t issuerNameHash,\n+\t\t\t\t\t\t\t   certificate_t **issuer_cacert)\n+{\n+    bool issuerKeyHash_ok = FALSE, issuerNameHash_ok = FALSE;\n+\tcertificate_t *candidate;\n+\tidentification_t *issuer;\n+\tx509_t *x509_ca;\n+\tchunk_t caKeyHash = chunk_empty, caNameHash = chunk_empty;\n+\thasher_t *hasher;\n+\tenumerator_t *certs;\n+\n+\t*issuer_cacert = NULL;\n+\n+\tcerts = lib->credmgr->create_cert_enumerator(lib->credmgr, CERT_X509,\n+\t\t\t\t\t\t\t\t\t\t\t\t KEY_ANY, NULL, TRUE);\n+\twhile (certs->enumerate(certs, &candidate) && hashAlgorithm == HASH_SHA1)\n+\t{\n+\t\tx509_ca = (x509_t*)candidate;\n+\n+\t\tif (!(x509_ca->get_flags(x509_ca) & X509_CA))\n+\t\t{\n+\t\t\tcontinue;\n+\t\t}\n+\n+\t\t/* retrieve the caKeyHash of the candidate issuer */\n+\t\tcaKeyHash = x509_ca->get_subjectKeyIdentifier(x509_ca);\n+\t\tissuerKeyHash_ok = chunk_equals(issuerKeyHash, caKeyHash);",
                "path": "src/pki/commands/ocsp.c",
                "commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "original_commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "user": {
                    "login": "tobiasbrunner",
                    "id": 457648,
                    "node_id": "MDQ6VXNlcjQ1NzY0OA==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/457648?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/tobiasbrunner",
                    "html_url": "https://github.com/tobiasbrunner",
                    "followers_url": "https://api.github.com/users/tobiasbrunner/followers",
                    "following_url": "https://api.github.com/users/tobiasbrunner/following{/other_user}",
                    "gists_url": "https://api.github.com/users/tobiasbrunner/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/tobiasbrunner/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/tobiasbrunner/subscriptions",
                    "organizations_url": "https://api.github.com/users/tobiasbrunner/orgs",
                    "repos_url": "https://api.github.com/users/tobiasbrunner/repos",
                    "events_url": "https://api.github.com/users/tobiasbrunner/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/tobiasbrunner/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "Use `chunk_equals_const()` just for good measure?",
                "created_at": "2023-10-26T14:41:05Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373293275",
                "pull_request_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "author_association": "MEMBER",
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373293275"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373293275"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    }
                },
                "reactions": {
                    "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373293275/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "start_line": null,
                "original_start_line": null,
                "start_side": null,
                "line": 84,
                "original_line": 84,
                "side": "RIGHT",
                "original_position": 84,
                "position": 84,
                "subject_type": "line"
            },
            "pull_request": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "id": 1565360593,
                "node_id": "PR_kwDOAA-8Q85dTYHR",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958",
                "diff_url": "https://github.com/strongswan/strongswan/pull/1958.diff",
                "patch_url": "https://github.com/strongswan/strongswan/pull/1958.patch",
                "issue_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958",
                "number": 1958,
                "state": "open",
                "locked": false,
                "title": "OCSP Responder",
                "user": {
                    "login": "strongX509",
                    "id": 4939775,
                    "node_id": "MDQ6VXNlcjQ5Mzk3NzU=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/4939775?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/strongX509",
                    "html_url": "https://github.com/strongX509",
                    "followers_url": "https://api.github.com/users/strongX509/followers",
                    "following_url": "https://api.github.com/users/strongX509/following{/other_user}",
                    "gists_url": "https://api.github.com/users/strongX509/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/strongX509/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/strongX509/subscriptions",
                    "organizations_url": "https://api.github.com/users/strongX509/orgs",
                    "repos_url": "https://api.github.com/users/strongX509/repos",
                    "events_url": "https://api.github.com/users/strongX509/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/strongX509/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "The new **`pki --ocsp`** command parses an _Online Certificate Status Protocol_ (OCSP) request as defined by  RFC  6960  and\r\n       with  the **`--respond`** option generates an OCSP response based on the OCSP request.  The certificate status is directly\r\n       retrieved from the internal certificate database of an _OpenXPKI_ (https://openxpki.org) server. Therefore the **`--respond`**  option\r\n       requires  the new  **`openxpki`**  and the existing  **`mysql`** libstrongswan plugins in order to access the **`certificate`** database table of the _OpenXPKI_ server running on the same host. The OCSP response can be signed by the CA itself, by a delegated OCSP Signer certificate with corresonding EKU extension or by a self-signed OCSP Signer certificate.\r\n",
                "created_at": "2023-10-19T18:01:27Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "db8b1bc37cb571300caaaa58e8b4614e662c2c45",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [
                    {
                        "id": 5235670731,
                        "node_id": "LA_kwDOAA-8Q88AAAABOBH-yw",
                        "url": "https://api.github.com/repos/strongswan/strongswan/labels/cla-signed",
                        "name": "cla-signed",
                        "color": "ededed",
                        "default": false,
                        "description": null
                    }
                ],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits",
                "review_comments_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments",
                "review_comment_url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments",
                "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "head": {
                    "label": "strongswan:ocsp-responder-new",
                    "ref": "ocsp-responder-new",
                    "sha": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "base": {
                    "label": "strongswan:master",
                    "ref": "master",
                    "sha": "b5760243870d4ab6c5874d765f8b09b3c67b8fc6",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T14:41:05Z",
        "org": {
            "id": 457671,
            "login": "strongswan",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/strongswan",
            "avatar_url": "https://avatars.githubusercontent.com/u/457671?"
        }
    },
    {
        "id": "32874321800",
        "type": "PullRequestReviewCommentEvent",
        "actor": {
            "id": 457648,
            "login": "tobiasbrunner",
            "display_login": "tobiasbrunner",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tobiasbrunner",
            "avatar_url": "https://avatars.githubusercontent.com/u/457648?"
        },
        "repo": {
            "id": 1031235,
            "name": "strongswan/strongswan",
            "url": "https://api.github.com/repos/strongswan/strongswan"
        },
        "payload": {
            "action": "created",
            "comment": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373308557",
                "pull_request_review_id": 1698865892,
                "id": 1373308557,
                "node_id": "PRRC_kwDOAA-8Q85R2waN",
                "diff_hunk": "@@ -0,0 +1,569 @@\n+/*\n+ * Copyright (C) 2023 Andreas Steffen, strongSec GmbH\n+ *\n+ * Copyright (C) secunet Security Networks AG\n+ *\n+ * This program is free software; you can redistribute it and/or modify it\n+ * under the terms of the GNU General Public License as published by the\n+ * Free Software Foundation; either version 2 of the License, or (at your\n+ * option) any later version.  See <http://www.fsf.org/copyleft/gpl.txt>.\n+ *\n+ * This program is distributed in the hope that it will be useful, but\n+ * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY\n+ * or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * for more details.\n+ */\n+\n+#include <errno.h>\n+#include <time.h>\n+\n+#include \"pki.h\"\n+\n+#include <credentials/sets/mem_cred.h>\n+#include <credentials/certificates/ocsp_request.h>\n+#include <credentials/certificates/ocsp_response.h>\n+#include <credentials/certificates/ocsp_single_response.h>\n+#include <credentials/certificates/ocsp_responder.h>\n+\n+static bool verify_signature(certificate_t *ocsp_req, mem_cred_t *creds)\n+{\n+\tidentification_t *signer;\n+\tcertificate_t *signer_cert, *cert_found;\n+\tocsp_request_t *ocsp_request;\n+\tenumerator_t *certs;\n+\tbool trusted = TRUE;\n+\n+\tocsp_request = (ocsp_request_t*)ocsp_req;\n+\n+\tsigner_cert = ocsp_request->get_signer_cert(ocsp_request);\n+\tif (signer_cert)\n+\t{\n+\t\tsigner = signer_cert->get_subject(signer_cert);\n+\n+\t\t/* establish trust relative to root CA */\n+\t\tcreds->add_cert(creds, FALSE, signer_cert->get_ref(signer_cert));\n+\t\tcerts = lib->credmgr->create_trusted_enumerator(lib->credmgr,\n+\t\t\t\t\t\t\t\t\t\t\tKEY_ANY, signer, FALSE);\n+\t\ttrusted = certs->enumerate(certs, &cert_found, NULL) &&\n+\t\t\t\t\t\t\t\t  (cert_found == signer_cert);\n+\t\tcerts->destroy(certs);\n+\t\ttrusted &= ocsp_req->issued_by(ocsp_req, signer_cert, NULL);\n+\t}\n+\tDBG1(DBG_LIB, \"requestor is %strusted\", trusted ? \"\" : \"not \");\n+\n+\treturn trusted;\n+}\n+\n+static bool find_issuer_cacert(hash_algorithm_t hashAlgorithm,\n+\t\t\t\t\t\t\t   chunk_t issuerKeyHash, chunk_t issuerNameHash,\n+\t\t\t\t\t\t\t   certificate_t **issuer_cacert)\n+{\n+    bool issuerKeyHash_ok = FALSE, issuerNameHash_ok = FALSE;\n+\tcertificate_t *candidate;\n+\tidentification_t *issuer;\n+\tx509_t *x509_ca;\n+\tchunk_t caKeyHash = chunk_empty, caNameHash = chunk_empty;\n+\thasher_t *hasher;\n+\tenumerator_t *certs;\n+\n+\t*issuer_cacert = NULL;\n+\n+\tcerts = lib->credmgr->create_cert_enumerator(lib->credmgr, CERT_X509,\n+\t\t\t\t\t\t\t\t\t\t\t\t KEY_ANY, NULL, TRUE);\n+\twhile (certs->enumerate(certs, &candidate) && hashAlgorithm == HASH_SHA1)\n+\t{\n+\t\tx509_ca = (x509_t*)candidate;\n+\n+\t\tif (!(x509_ca->get_flags(x509_ca) & X509_CA))\n+\t\t{\n+\t\t\tcontinue;\n+\t\t}\n+\n+\t\t/* retrieve the caKeyHash of the candidate issuer */\n+\t\tcaKeyHash = x509_ca->get_subjectKeyIdentifier(x509_ca);\n+\t\tissuerKeyHash_ok = chunk_equals(issuerKeyHash, caKeyHash);\n+\t\tif (!issuerKeyHash_ok)\n+\t\t{\n+\t\t\tcontinue;\n+\t\t}\n+\n+\t\t/* compute the caNameHash of the candidate issuer */\n+\t\tissuer = candidate->get_subject(candidate);\n+\n+\t\thasher = lib->crypto->create_hasher(lib->crypto, HASH_SHA1);\n+\t\tif (!hasher)\n+\t\t{\n+\t\t\tDBG1(DBG_LIB, \"failed to create SHA1 hasher\");\n+\t\t\tbreak;\n+\t\t}\n+\n+\t\tif (!hasher->allocate_hash(hasher, issuer->get_encoding(issuer),\n+\t\t\t\t\t\t\t\t\t\t   &caNameHash))\n+\t\t{\n+\t\t\thasher->destroy(hasher);\n+\t\t\tDBG1(DBG_LIB, \"failed to compute SHA1 caNameHash\");\n+\t\t\tbreak;\n+\t\t}\n+\t\thasher->destroy(hasher);\n+\n+\t\tissuerNameHash_ok = chunk_equals(issuerNameHash, caNameHash);\n+\t\tchunk_free(&caNameHash);\n+\t\tif (!issuerNameHash_ok)\n+\t\t{\n+\t\t\tcontinue;\n+\t\t}\n+\n+\t\t/* we found the issuer */\n+\t\tDBG1(DBG_LIB, \"issuer:             \\\"%Y\\\"\", issuer);\n+\t\t*issuer_cacert = candidate;\n+\n+\t\tbreak;\n+\t}\n+\tcerts->destroy(certs);\n+\n+\tDBG1(DBG_LIB, \"  issuerKeyHash:     %#B (%s)\", &issuerKeyHash,\n+\t\t\t\t\t issuerKeyHash_ok ? \"ok\" : \"no match\");\n+\tDBG1(DBG_LIB, \"  issuerNameHash:    %#B (%s)\", &issuerNameHash,\n+\t\t\t\t\t issuerNameHash_ok ? \"ok\" : \"no match\");\n+\n+\treturn (*issuer_cacert != NULL);\n+}\n+\n+static void find_ocsp_signer(certificate_t *first_issuer, bool *self_signed,\n+\t\t\t\t\t\t\t certificate_t **cert, private_key_t **key)\n+{\n+\tcertificate_t *candidate;\n+\tidentification_t *keyid;\n+\tprivate_key_t *key_candidate;\n+\tchunk_t subKeyId, authKeyId, subKeyId_ca;\n+\tx509_t *x509, *x509_ca;\n+\tx509_flag_t flags;\n+\tenumerator_t *certs;\n+\n+\t/* retrieve the subjectKeyIdentifier of the first issuer certificate */\n+\tx509_ca = (x509_t*)first_issuer;\n+\tsubKeyId_ca = x509_ca->get_subjectKeyIdentifier(x509_ca);",
                "path": "src/pki/commands/ocsp.c",
                "commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "original_commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "user": {
                    "login": "tobiasbrunner",
                    "id": 457648,
                    "node_id": "MDQ6VXNlcjQ1NzY0OA==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/457648?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/tobiasbrunner",
                    "html_url": "https://github.com/tobiasbrunner",
                    "followers_url": "https://api.github.com/users/tobiasbrunner/followers",
                    "following_url": "https://api.github.com/users/tobiasbrunner/following{/other_user}",
                    "gists_url": "https://api.github.com/users/tobiasbrunner/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/tobiasbrunner/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/tobiasbrunner/subscriptions",
                    "organizations_url": "https://api.github.com/users/tobiasbrunner/orgs",
                    "repos_url": "https://api.github.com/users/tobiasbrunner/repos",
                    "events_url": "https://api.github.com/users/tobiasbrunner/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/tobiasbrunner/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "Compared to the check above in `find_issuer_cacert()`, this should be fine as the comparison below is directly between other values that are potentially encoded in certificates.",
                "created_at": "2023-10-26T14:50:48Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373308557",
                "pull_request_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "author_association": "MEMBER",
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373308557"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373308557"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    }
                },
                "reactions": {
                    "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373308557/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "start_line": null,
                "original_start_line": null,
                "start_side": null,
                "line": 145,
                "original_line": 145,
                "side": "RIGHT",
                "original_position": 145,
                "position": 145,
                "subject_type": "line"
            },
            "pull_request": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "id": 1565360593,
                "node_id": "PR_kwDOAA-8Q85dTYHR",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958",
                "diff_url": "https://github.com/strongswan/strongswan/pull/1958.diff",
                "patch_url": "https://github.com/strongswan/strongswan/pull/1958.patch",
                "issue_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958",
                "number": 1958,
                "state": "open",
                "locked": false,
                "title": "OCSP Responder",
                "user": {
                    "login": "strongX509",
                    "id": 4939775,
                    "node_id": "MDQ6VXNlcjQ5Mzk3NzU=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/4939775?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/strongX509",
                    "html_url": "https://github.com/strongX509",
                    "followers_url": "https://api.github.com/users/strongX509/followers",
                    "following_url": "https://api.github.com/users/strongX509/following{/other_user}",
                    "gists_url": "https://api.github.com/users/strongX509/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/strongX509/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/strongX509/subscriptions",
                    "organizations_url": "https://api.github.com/users/strongX509/orgs",
                    "repos_url": "https://api.github.com/users/strongX509/repos",
                    "events_url": "https://api.github.com/users/strongX509/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/strongX509/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "The new **`pki --ocsp`** command parses an _Online Certificate Status Protocol_ (OCSP) request as defined by  RFC  6960  and\r\n       with  the **`--respond`** option generates an OCSP response based on the OCSP request.  The certificate status is directly\r\n       retrieved from the internal certificate database of an _OpenXPKI_ (https://openxpki.org) server. Therefore the **`--respond`**  option\r\n       requires  the new  **`openxpki`**  and the existing  **`mysql`** libstrongswan plugins in order to access the **`certificate`** database table of the _OpenXPKI_ server running on the same host. The OCSP response can be signed by the CA itself, by a delegated OCSP Signer certificate with corresonding EKU extension or by a self-signed OCSP Signer certificate.\r\n",
                "created_at": "2023-10-19T18:01:27Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "db8b1bc37cb571300caaaa58e8b4614e662c2c45",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [
                    {
                        "id": 5235670731,
                        "node_id": "LA_kwDOAA-8Q88AAAABOBH-yw",
                        "url": "https://api.github.com/repos/strongswan/strongswan/labels/cla-signed",
                        "name": "cla-signed",
                        "color": "ededed",
                        "default": false,
                        "description": null
                    }
                ],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits",
                "review_comments_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments",
                "review_comment_url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments",
                "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "head": {
                    "label": "strongswan:ocsp-responder-new",
                    "ref": "ocsp-responder-new",
                    "sha": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "base": {
                    "label": "strongswan:master",
                    "ref": "master",
                    "sha": "b5760243870d4ab6c5874d765f8b09b3c67b8fc6",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T14:50:48Z",
        "org": {
            "id": 457671,
            "login": "strongswan",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/strongswan",
            "avatar_url": "https://avatars.githubusercontent.com/u/457671?"
        }
    },
    {
        "id": "32874321742",
        "type": "PullRequestReviewCommentEvent",
        "actor": {
            "id": 457648,
            "login": "tobiasbrunner",
            "display_login": "tobiasbrunner",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tobiasbrunner",
            "avatar_url": "https://avatars.githubusercontent.com/u/457648?"
        },
        "repo": {
            "id": 1031235,
            "name": "strongswan/strongswan",
            "url": "https://api.github.com/repos/strongswan/strongswan"
        },
        "payload": {
            "action": "created",
            "comment": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373292511",
                "pull_request_review_id": 1698865892,
                "id": 1373292511,
                "node_id": "PRRC_kwDOAA-8Q85R2sff",
                "diff_hunk": "@@ -0,0 +1,569 @@\n+/*\n+ * Copyright (C) 2023 Andreas Steffen, strongSec GmbH\n+ *\n+ * Copyright (C) secunet Security Networks AG\n+ *\n+ * This program is free software; you can redistribute it and/or modify it\n+ * under the terms of the GNU General Public License as published by the\n+ * Free Software Foundation; either version 2 of the License, or (at your\n+ * option) any later version.  See <http://www.fsf.org/copyleft/gpl.txt>.\n+ *\n+ * This program is distributed in the hope that it will be useful, but\n+ * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY\n+ * or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * for more details.\n+ */\n+\n+#include <errno.h>\n+#include <time.h>\n+\n+#include \"pki.h\"\n+\n+#include <credentials/sets/mem_cred.h>\n+#include <credentials/certificates/ocsp_request.h>\n+#include <credentials/certificates/ocsp_response.h>\n+#include <credentials/certificates/ocsp_single_response.h>\n+#include <credentials/certificates/ocsp_responder.h>\n+\n+static bool verify_signature(certificate_t *ocsp_req, mem_cred_t *creds)\n+{\n+\tidentification_t *signer;\n+\tcertificate_t *signer_cert, *cert_found;\n+\tocsp_request_t *ocsp_request;\n+\tenumerator_t *certs;\n+\tbool trusted = TRUE;\n+\n+\tocsp_request = (ocsp_request_t*)ocsp_req;\n+\n+\tsigner_cert = ocsp_request->get_signer_cert(ocsp_request);\n+\tif (signer_cert)\n+\t{\n+\t\tsigner = signer_cert->get_subject(signer_cert);\n+\n+\t\t/* establish trust relative to root CA */\n+\t\tcreds->add_cert(creds, FALSE, signer_cert->get_ref(signer_cert));\n+\t\tcerts = lib->credmgr->create_trusted_enumerator(lib->credmgr,\n+\t\t\t\t\t\t\t\t\t\t\tKEY_ANY, signer, FALSE);\n+\t\ttrusted = certs->enumerate(certs, &cert_found, NULL) &&\n+\t\t\t\t\t\t\t\t  (cert_found == signer_cert);\n+\t\tcerts->destroy(certs);\n+\t\ttrusted &= ocsp_req->issued_by(ocsp_req, signer_cert, NULL);\n+\t}\n+\tDBG1(DBG_LIB, \"requestor is %strusted\", trusted ? \"\" : \"not \");\n+\n+\treturn trusted;\n+}\n+\n+static bool find_issuer_cacert(hash_algorithm_t hashAlgorithm,\n+\t\t\t\t\t\t\t   chunk_t issuerKeyHash, chunk_t issuerNameHash,\n+\t\t\t\t\t\t\t   certificate_t **issuer_cacert)\n+{\n+    bool issuerKeyHash_ok = FALSE, issuerNameHash_ok = FALSE;\n+\tcertificate_t *candidate;\n+\tidentification_t *issuer;\n+\tx509_t *x509_ca;\n+\tchunk_t caKeyHash = chunk_empty, caNameHash = chunk_empty;\n+\thasher_t *hasher;\n+\tenumerator_t *certs;\n+\n+\t*issuer_cacert = NULL;\n+\n+\tcerts = lib->credmgr->create_cert_enumerator(lib->credmgr, CERT_X509,\n+\t\t\t\t\t\t\t\t\t\t\t\t KEY_ANY, NULL, TRUE);\n+\twhile (certs->enumerate(certs, &candidate) && hashAlgorithm == HASH_SHA1)\n+\t{\n+\t\tx509_ca = (x509_t*)candidate;\n+\n+\t\tif (!(x509_ca->get_flags(x509_ca) & X509_CA))\n+\t\t{\n+\t\t\tcontinue;\n+\t\t}\n+\n+\t\t/* retrieve the caKeyHash of the candidate issuer */\n+\t\tcaKeyHash = x509_ca->get_subjectKeyIdentifier(x509_ca);",
                "path": "src/pki/commands/ocsp.c",
                "commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "original_commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "user": {
                    "login": "tobiasbrunner",
                    "id": 457648,
                    "node_id": "MDQ6VXNlcjQ1NzY0OA==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/457648?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/tobiasbrunner",
                    "html_url": "https://github.com/tobiasbrunner",
                    "followers_url": "https://api.github.com/users/tobiasbrunner/followers",
                    "following_url": "https://api.github.com/users/tobiasbrunner/following{/other_user}",
                    "gists_url": "https://api.github.com/users/tobiasbrunner/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/tobiasbrunner/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/tobiasbrunner/subscriptions",
                    "organizations_url": "https://api.github.com/users/tobiasbrunner/orgs",
                    "repos_url": "https://api.github.com/users/tobiasbrunner/repos",
                    "events_url": "https://api.github.com/users/tobiasbrunner/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/tobiasbrunner/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "Note that this will return the actual subjectKeyIdentifier if one is encoded in the certificate. So that might not be the expected hash value. To make sure you get the correct hash, you'd have to go via public key and fingerprint directly.",
                "created_at": "2023-10-26T14:40:36Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373292511",
                "pull_request_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "author_association": "MEMBER",
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373292511"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373292511"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    }
                },
                "reactions": {
                    "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373292511/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "start_line": null,
                "original_start_line": null,
                "start_side": null,
                "line": 83,
                "original_line": 83,
                "side": "RIGHT",
                "original_position": 83,
                "position": 83,
                "subject_type": "line"
            },
            "pull_request": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "id": 1565360593,
                "node_id": "PR_kwDOAA-8Q85dTYHR",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958",
                "diff_url": "https://github.com/strongswan/strongswan/pull/1958.diff",
                "patch_url": "https://github.com/strongswan/strongswan/pull/1958.patch",
                "issue_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958",
                "number": 1958,
                "state": "open",
                "locked": false,
                "title": "OCSP Responder",
                "user": {
                    "login": "strongX509",
                    "id": 4939775,
                    "node_id": "MDQ6VXNlcjQ5Mzk3NzU=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/4939775?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/strongX509",
                    "html_url": "https://github.com/strongX509",
                    "followers_url": "https://api.github.com/users/strongX509/followers",
                    "following_url": "https://api.github.com/users/strongX509/following{/other_user}",
                    "gists_url": "https://api.github.com/users/strongX509/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/strongX509/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/strongX509/subscriptions",
                    "organizations_url": "https://api.github.com/users/strongX509/orgs",
                    "repos_url": "https://api.github.com/users/strongX509/repos",
                    "events_url": "https://api.github.com/users/strongX509/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/strongX509/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "The new **`pki --ocsp`** command parses an _Online Certificate Status Protocol_ (OCSP) request as defined by  RFC  6960  and\r\n       with  the **`--respond`** option generates an OCSP response based on the OCSP request.  The certificate status is directly\r\n       retrieved from the internal certificate database of an _OpenXPKI_ (https://openxpki.org) server. Therefore the **`--respond`**  option\r\n       requires  the new  **`openxpki`**  and the existing  **`mysql`** libstrongswan plugins in order to access the **`certificate`** database table of the _OpenXPKI_ server running on the same host. The OCSP response can be signed by the CA itself, by a delegated OCSP Signer certificate with corresonding EKU extension or by a self-signed OCSP Signer certificate.\r\n",
                "created_at": "2023-10-19T18:01:27Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "db8b1bc37cb571300caaaa58e8b4614e662c2c45",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [
                    {
                        "id": 5235670731,
                        "node_id": "LA_kwDOAA-8Q88AAAABOBH-yw",
                        "url": "https://api.github.com/repos/strongswan/strongswan/labels/cla-signed",
                        "name": "cla-signed",
                        "color": "ededed",
                        "default": false,
                        "description": null
                    }
                ],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits",
                "review_comments_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments",
                "review_comment_url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments",
                "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "head": {
                    "label": "strongswan:ocsp-responder-new",
                    "ref": "ocsp-responder-new",
                    "sha": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "base": {
                    "label": "strongswan:master",
                    "ref": "master",
                    "sha": "b5760243870d4ab6c5874d765f8b09b3c67b8fc6",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T14:40:36Z",
        "org": {
            "id": 457671,
            "login": "strongswan",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/strongswan",
            "avatar_url": "https://avatars.githubusercontent.com/u/457671?"
        }
    },
    {
        "id": "32874321656",
        "type": "PullRequestReviewCommentEvent",
        "actor": {
            "id": 457648,
            "login": "tobiasbrunner",
            "display_login": "tobiasbrunner",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tobiasbrunner",
            "avatar_url": "https://avatars.githubusercontent.com/u/457648?"
        },
        "repo": {
            "id": 1031235,
            "name": "strongswan/strongswan",
            "url": "https://api.github.com/repos/strongswan/strongswan"
        },
        "payload": {
            "action": "created",
            "comment": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373280582",
                "pull_request_review_id": 1698865892,
                "id": 1373280582,
                "node_id": "PRRC_kwDOAA-8Q85R2plG",
                "diff_hunk": "@@ -0,0 +1,569 @@\n+/*\n+ * Copyright (C) 2023 Andreas Steffen, strongSec GmbH\n+ *\n+ * Copyright (C) secunet Security Networks AG\n+ *\n+ * This program is free software; you can redistribute it and/or modify it\n+ * under the terms of the GNU General Public License as published by the\n+ * Free Software Foundation; either version 2 of the License, or (at your\n+ * option) any later version.  See <http://www.fsf.org/copyleft/gpl.txt>.\n+ *\n+ * This program is distributed in the hope that it will be useful, but\n+ * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY\n+ * or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * for more details.\n+ */\n+\n+#include <errno.h>\n+#include <time.h>\n+\n+#include \"pki.h\"\n+\n+#include <credentials/sets/mem_cred.h>\n+#include <credentials/certificates/ocsp_request.h>\n+#include <credentials/certificates/ocsp_response.h>\n+#include <credentials/certificates/ocsp_single_response.h>\n+#include <credentials/certificates/ocsp_responder.h>\n+\n+static bool verify_signature(certificate_t *ocsp_req, mem_cred_t *creds)\n+{\n+\tidentification_t *signer;\n+\tcertificate_t *signer_cert, *cert_found;\n+\tocsp_request_t *ocsp_request;\n+\tenumerator_t *certs;\n+\tbool trusted = TRUE;\n+\n+\tocsp_request = (ocsp_request_t*)ocsp_req;\n+\n+\tsigner_cert = ocsp_request->get_signer_cert(ocsp_request);\n+\tif (signer_cert)\n+\t{\n+\t\tsigner = signer_cert->get_subject(signer_cert);\n+\n+\t\t/* establish trust relative to root CA */\n+\t\tcreds->add_cert(creds, FALSE, signer_cert->get_ref(signer_cert));\n+\t\tcerts = lib->credmgr->create_trusted_enumerator(lib->credmgr,\n+\t\t\t\t\t\t\t\t\t\t\tKEY_ANY, signer, FALSE);\n+\t\ttrusted = certs->enumerate(certs, &cert_found, NULL) &&\n+\t\t\t\t\t\t\t\t  (cert_found == signer_cert);\n+\t\tcerts->destroy(certs);\n+\t\ttrusted &= ocsp_req->issued_by(ocsp_req, signer_cert, NULL);",
                "path": "src/pki/commands/ocsp.c",
                "commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "original_commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "user": {
                    "login": "tobiasbrunner",
                    "id": 457648,
                    "node_id": "MDQ6VXNlcjQ1NzY0OA==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/457648?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/tobiasbrunner",
                    "html_url": "https://github.com/tobiasbrunner",
                    "followers_url": "https://api.github.com/users/tobiasbrunner/followers",
                    "following_url": "https://api.github.com/users/tobiasbrunner/following{/other_user}",
                    "gists_url": "https://api.github.com/users/tobiasbrunner/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/tobiasbrunner/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/tobiasbrunner/subscriptions",
                    "organizations_url": "https://api.github.com/users/tobiasbrunner/orgs",
                    "repos_url": "https://api.github.com/users/tobiasbrunner/repos",
                    "events_url": "https://api.github.com/users/tobiasbrunner/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/tobiasbrunner/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "Hm, that may not be what you want. If the certificate isn't trusted, `issued_by()` should probably not be called and  be able to set trusted to TRUE. So this should probably be:\r\n```suggestion\r\n\t\ttrusted = trusted && ocsp_req->issued_by(ocsp_req, signer_cert, NULL);\r\n```",
                "created_at": "2023-10-26T14:32:30Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373280582",
                "pull_request_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "author_association": "MEMBER",
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373280582"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373280582"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    }
                },
                "reactions": {
                    "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373280582/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "start_line": null,
                "original_start_line": null,
                "start_side": null,
                "line": 50,
                "original_line": 50,
                "side": "RIGHT",
                "original_position": 50,
                "position": 50,
                "subject_type": "line"
            },
            "pull_request": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "id": 1565360593,
                "node_id": "PR_kwDOAA-8Q85dTYHR",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958",
                "diff_url": "https://github.com/strongswan/strongswan/pull/1958.diff",
                "patch_url": "https://github.com/strongswan/strongswan/pull/1958.patch",
                "issue_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958",
                "number": 1958,
                "state": "open",
                "locked": false,
                "title": "OCSP Responder",
                "user": {
                    "login": "strongX509",
                    "id": 4939775,
                    "node_id": "MDQ6VXNlcjQ5Mzk3NzU=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/4939775?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/strongX509",
                    "html_url": "https://github.com/strongX509",
                    "followers_url": "https://api.github.com/users/strongX509/followers",
                    "following_url": "https://api.github.com/users/strongX509/following{/other_user}",
                    "gists_url": "https://api.github.com/users/strongX509/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/strongX509/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/strongX509/subscriptions",
                    "organizations_url": "https://api.github.com/users/strongX509/orgs",
                    "repos_url": "https://api.github.com/users/strongX509/repos",
                    "events_url": "https://api.github.com/users/strongX509/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/strongX509/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "The new **`pki --ocsp`** command parses an _Online Certificate Status Protocol_ (OCSP) request as defined by  RFC  6960  and\r\n       with  the **`--respond`** option generates an OCSP response based on the OCSP request.  The certificate status is directly\r\n       retrieved from the internal certificate database of an _OpenXPKI_ (https://openxpki.org) server. Therefore the **`--respond`**  option\r\n       requires  the new  **`openxpki`**  and the existing  **`mysql`** libstrongswan plugins in order to access the **`certificate`** database table of the _OpenXPKI_ server running on the same host. The OCSP response can be signed by the CA itself, by a delegated OCSP Signer certificate with corresonding EKU extension or by a self-signed OCSP Signer certificate.\r\n",
                "created_at": "2023-10-19T18:01:27Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "db8b1bc37cb571300caaaa58e8b4614e662c2c45",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [
                    {
                        "id": 5235670731,
                        "node_id": "LA_kwDOAA-8Q88AAAABOBH-yw",
                        "url": "https://api.github.com/repos/strongswan/strongswan/labels/cla-signed",
                        "name": "cla-signed",
                        "color": "ededed",
                        "default": false,
                        "description": null
                    }
                ],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits",
                "review_comments_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments",
                "review_comment_url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments",
                "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "head": {
                    "label": "strongswan:ocsp-responder-new",
                    "ref": "ocsp-responder-new",
                    "sha": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "base": {
                    "label": "strongswan:master",
                    "ref": "master",
                    "sha": "b5760243870d4ab6c5874d765f8b09b3c67b8fc6",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T14:32:30Z",
        "org": {
            "id": 457671,
            "login": "strongswan",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/strongswan",
            "avatar_url": "https://avatars.githubusercontent.com/u/457671?"
        }
    },
    {
        "id": "32874321716",
        "type": "PullRequestReviewCommentEvent",
        "actor": {
            "id": 457648,
            "login": "tobiasbrunner",
            "display_login": "tobiasbrunner",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tobiasbrunner",
            "avatar_url": "https://avatars.githubusercontent.com/u/457648?"
        },
        "repo": {
            "id": 1031235,
            "name": "strongswan/strongswan",
            "url": "https://api.github.com/repos/strongswan/strongswan"
        },
        "payload": {
            "action": "created",
            "comment": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373290813",
                "pull_request_review_id": 1698865892,
                "id": 1373290813,
                "node_id": "PRRC_kwDOAA-8Q85R2sE9",
                "diff_hunk": "@@ -0,0 +1,569 @@\n+/*\n+ * Copyright (C) 2023 Andreas Steffen, strongSec GmbH\n+ *\n+ * Copyright (C) secunet Security Networks AG\n+ *\n+ * This program is free software; you can redistribute it and/or modify it\n+ * under the terms of the GNU General Public License as published by the\n+ * Free Software Foundation; either version 2 of the License, or (at your\n+ * option) any later version.  See <http://www.fsf.org/copyleft/gpl.txt>.\n+ *\n+ * This program is distributed in the hope that it will be useful, but\n+ * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY\n+ * or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * for more details.\n+ */\n+\n+#include <errno.h>\n+#include <time.h>\n+\n+#include \"pki.h\"\n+\n+#include <credentials/sets/mem_cred.h>\n+#include <credentials/certificates/ocsp_request.h>\n+#include <credentials/certificates/ocsp_response.h>\n+#include <credentials/certificates/ocsp_single_response.h>\n+#include <credentials/certificates/ocsp_responder.h>\n+\n+static bool verify_signature(certificate_t *ocsp_req, mem_cred_t *creds)\n+{\n+\tidentification_t *signer;\n+\tcertificate_t *signer_cert, *cert_found;\n+\tocsp_request_t *ocsp_request;\n+\tenumerator_t *certs;\n+\tbool trusted = TRUE;\n+\n+\tocsp_request = (ocsp_request_t*)ocsp_req;\n+\n+\tsigner_cert = ocsp_request->get_signer_cert(ocsp_request);\n+\tif (signer_cert)\n+\t{\n+\t\tsigner = signer_cert->get_subject(signer_cert);\n+\n+\t\t/* establish trust relative to root CA */\n+\t\tcreds->add_cert(creds, FALSE, signer_cert->get_ref(signer_cert));\n+\t\tcerts = lib->credmgr->create_trusted_enumerator(lib->credmgr,\n+\t\t\t\t\t\t\t\t\t\t\tKEY_ANY, signer, FALSE);\n+\t\ttrusted = certs->enumerate(certs, &cert_found, NULL) &&\n+\t\t\t\t\t\t\t\t  (cert_found == signer_cert);\n+\t\tcerts->destroy(certs);\n+\t\ttrusted &= ocsp_req->issued_by(ocsp_req, signer_cert, NULL);\n+\t}\n+\tDBG1(DBG_LIB, \"requestor is %strusted\", trusted ? \"\" : \"not \");\n+\n+\treturn trusted;\n+}\n+\n+static bool find_issuer_cacert(hash_algorithm_t hashAlgorithm,\n+\t\t\t\t\t\t\t   chunk_t issuerKeyHash, chunk_t issuerNameHash,\n+\t\t\t\t\t\t\t   certificate_t **issuer_cacert)\n+{\n+    bool issuerKeyHash_ok = FALSE, issuerNameHash_ok = FALSE;\n+\tcertificate_t *candidate;\n+\tidentification_t *issuer;\n+\tx509_t *x509_ca;\n+\tchunk_t caKeyHash = chunk_empty, caNameHash = chunk_empty;\n+\thasher_t *hasher;\n+\tenumerator_t *certs;\n+\n+\t*issuer_cacert = NULL;\n+\n+\tcerts = lib->credmgr->create_cert_enumerator(lib->credmgr, CERT_X509,\n+\t\t\t\t\t\t\t\t\t\t\t\t KEY_ANY, NULL, TRUE);\n+\twhile (certs->enumerate(certs, &candidate) && hashAlgorithm == HASH_SHA1)",
                "path": "src/pki/commands/ocsp.c",
                "commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "original_commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "user": {
                    "login": "tobiasbrunner",
                    "id": 457648,
                    "node_id": "MDQ6VXNlcjQ1NzY0OA==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/457648?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/tobiasbrunner",
                    "html_url": "https://github.com/tobiasbrunner",
                    "followers_url": "https://api.github.com/users/tobiasbrunner/followers",
                    "following_url": "https://api.github.com/users/tobiasbrunner/following{/other_user}",
                    "gists_url": "https://api.github.com/users/tobiasbrunner/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/tobiasbrunner/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/tobiasbrunner/subscriptions",
                    "organizations_url": "https://api.github.com/users/tobiasbrunner/orgs",
                    "repos_url": "https://api.github.com/users/tobiasbrunner/repos",
                    "events_url": "https://api.github.com/users/tobiasbrunner/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/tobiasbrunner/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "Why even create the enumerator if the hash algorithm is incompatible? Or is that just intended as a temporary measure (in that case the hasher below should perhaps be created with `hashAlgorithm` instead of hard-coding SHA-1)?",
                "created_at": "2023-10-26T14:39:29Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373290813",
                "pull_request_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "author_association": "MEMBER",
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373290813"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373290813"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    }
                },
                "reactions": {
                    "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373290813/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "start_line": null,
                "original_start_line": null,
                "start_side": null,
                "line": 73,
                "original_line": 73,
                "side": "RIGHT",
                "original_position": 73,
                "position": 73,
                "subject_type": "line"
            },
            "pull_request": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "id": 1565360593,
                "node_id": "PR_kwDOAA-8Q85dTYHR",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958",
                "diff_url": "https://github.com/strongswan/strongswan/pull/1958.diff",
                "patch_url": "https://github.com/strongswan/strongswan/pull/1958.patch",
                "issue_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958",
                "number": 1958,
                "state": "open",
                "locked": false,
                "title": "OCSP Responder",
                "user": {
                    "login": "strongX509",
                    "id": 4939775,
                    "node_id": "MDQ6VXNlcjQ5Mzk3NzU=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/4939775?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/strongX509",
                    "html_url": "https://github.com/strongX509",
                    "followers_url": "https://api.github.com/users/strongX509/followers",
                    "following_url": "https://api.github.com/users/strongX509/following{/other_user}",
                    "gists_url": "https://api.github.com/users/strongX509/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/strongX509/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/strongX509/subscriptions",
                    "organizations_url": "https://api.github.com/users/strongX509/orgs",
                    "repos_url": "https://api.github.com/users/strongX509/repos",
                    "events_url": "https://api.github.com/users/strongX509/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/strongX509/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "The new **`pki --ocsp`** command parses an _Online Certificate Status Protocol_ (OCSP) request as defined by  RFC  6960  and\r\n       with  the **`--respond`** option generates an OCSP response based on the OCSP request.  The certificate status is directly\r\n       retrieved from the internal certificate database of an _OpenXPKI_ (https://openxpki.org) server. Therefore the **`--respond`**  option\r\n       requires  the new  **`openxpki`**  and the existing  **`mysql`** libstrongswan plugins in order to access the **`certificate`** database table of the _OpenXPKI_ server running on the same host. The OCSP response can be signed by the CA itself, by a delegated OCSP Signer certificate with corresonding EKU extension or by a self-signed OCSP Signer certificate.\r\n",
                "created_at": "2023-10-19T18:01:27Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "db8b1bc37cb571300caaaa58e8b4614e662c2c45",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [
                    {
                        "id": 5235670731,
                        "node_id": "LA_kwDOAA-8Q88AAAABOBH-yw",
                        "url": "https://api.github.com/repos/strongswan/strongswan/labels/cla-signed",
                        "name": "cla-signed",
                        "color": "ededed",
                        "default": false,
                        "description": null
                    }
                ],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits",
                "review_comments_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments",
                "review_comment_url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments",
                "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "head": {
                    "label": "strongswan:ocsp-responder-new",
                    "ref": "ocsp-responder-new",
                    "sha": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "base": {
                    "label": "strongswan:master",
                    "ref": "master",
                    "sha": "b5760243870d4ab6c5874d765f8b09b3c67b8fc6",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T14:39:29Z",
        "org": {
            "id": 457671,
            "login": "strongswan",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/strongswan",
            "avatar_url": "https://avatars.githubusercontent.com/u/457671?"
        }
    },
    {
        "id": "32874321705",
        "type": "PullRequestReviewCommentEvent",
        "actor": {
            "id": 457648,
            "login": "tobiasbrunner",
            "display_login": "tobiasbrunner",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tobiasbrunner",
            "avatar_url": "https://avatars.githubusercontent.com/u/457648?"
        },
        "repo": {
            "id": 1031235,
            "name": "strongswan/strongswan",
            "url": "https://api.github.com/repos/strongswan/strongswan"
        },
        "payload": {
            "action": "created",
            "comment": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373283145",
                "pull_request_review_id": 1698865892,
                "id": 1373283145,
                "node_id": "PRRC_kwDOAA-8Q85R2qNJ",
                "diff_hunk": "@@ -0,0 +1,569 @@\n+/*\n+ * Copyright (C) 2023 Andreas Steffen, strongSec GmbH\n+ *\n+ * Copyright (C) secunet Security Networks AG\n+ *\n+ * This program is free software; you can redistribute it and/or modify it\n+ * under the terms of the GNU General Public License as published by the\n+ * Free Software Foundation; either version 2 of the License, or (at your\n+ * option) any later version.  See <http://www.fsf.org/copyleft/gpl.txt>.\n+ *\n+ * This program is distributed in the hope that it will be useful, but\n+ * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY\n+ * or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * for more details.\n+ */\n+\n+#include <errno.h>\n+#include <time.h>\n+\n+#include \"pki.h\"\n+\n+#include <credentials/sets/mem_cred.h>\n+#include <credentials/certificates/ocsp_request.h>\n+#include <credentials/certificates/ocsp_response.h>\n+#include <credentials/certificates/ocsp_single_response.h>\n+#include <credentials/certificates/ocsp_responder.h>\n+\n+static bool verify_signature(certificate_t *ocsp_req, mem_cred_t *creds)\n+{\n+\tidentification_t *signer;\n+\tcertificate_t *signer_cert, *cert_found;\n+\tocsp_request_t *ocsp_request;\n+\tenumerator_t *certs;\n+\tbool trusted = TRUE;\n+\n+\tocsp_request = (ocsp_request_t*)ocsp_req;\n+\n+\tsigner_cert = ocsp_request->get_signer_cert(ocsp_request);\n+\tif (signer_cert)\n+\t{\n+\t\tsigner = signer_cert->get_subject(signer_cert);\n+\n+\t\t/* establish trust relative to root CA */\n+\t\tcreds->add_cert(creds, FALSE, signer_cert->get_ref(signer_cert));\n+\t\tcerts = lib->credmgr->create_trusted_enumerator(lib->credmgr,\n+\t\t\t\t\t\t\t\t\t\t\tKEY_ANY, signer, FALSE);\n+\t\ttrusted = certs->enumerate(certs, &cert_found, NULL) &&\n+\t\t\t\t\t\t\t\t  (cert_found == signer_cert);\n+\t\tcerts->destroy(certs);\n+\t\ttrusted &= ocsp_req->issued_by(ocsp_req, signer_cert, NULL);\n+\t}\n+\tDBG1(DBG_LIB, \"requestor is %strusted\", trusted ? \"\" : \"not \");\n+\n+\treturn trusted;\n+}\n+\n+static bool find_issuer_cacert(hash_algorithm_t hashAlgorithm,\n+\t\t\t\t\t\t\t   chunk_t issuerKeyHash, chunk_t issuerNameHash,\n+\t\t\t\t\t\t\t   certificate_t **issuer_cacert)\n+{\n+    bool issuerKeyHash_ok = FALSE, issuerNameHash_ok = FALSE;",
                "path": "src/pki/commands/ocsp.c",
                "commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "original_commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "user": {
                    "login": "tobiasbrunner",
                    "id": 457648,
                    "node_id": "MDQ6VXNlcjQ1NzY0OA==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/457648?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/tobiasbrunner",
                    "html_url": "https://github.com/tobiasbrunner",
                    "followers_url": "https://api.github.com/users/tobiasbrunner/followers",
                    "following_url": "https://api.github.com/users/tobiasbrunner/following{/other_user}",
                    "gists_url": "https://api.github.com/users/tobiasbrunner/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/tobiasbrunner/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/tobiasbrunner/subscriptions",
                    "organizations_url": "https://api.github.com/users/tobiasbrunner/orgs",
                    "repos_url": "https://api.github.com/users/tobiasbrunner/repos",
                    "events_url": "https://api.github.com/users/tobiasbrunner/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/tobiasbrunner/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "```suggestion\r\n\tbool issuerKeyHash_ok = FALSE, issuerNameHash_ok = FALSE;\r\n```",
                "created_at": "2023-10-26T14:34:15Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373283145",
                "pull_request_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "author_association": "MEMBER",
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373283145"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373283145"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    }
                },
                "reactions": {
                    "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373283145/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "start_line": null,
                "original_start_line": null,
                "start_side": null,
                "line": 61,
                "original_line": 61,
                "side": "RIGHT",
                "original_position": 61,
                "position": 61,
                "subject_type": "line"
            },
            "pull_request": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "id": 1565360593,
                "node_id": "PR_kwDOAA-8Q85dTYHR",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958",
                "diff_url": "https://github.com/strongswan/strongswan/pull/1958.diff",
                "patch_url": "https://github.com/strongswan/strongswan/pull/1958.patch",
                "issue_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958",
                "number": 1958,
                "state": "open",
                "locked": false,
                "title": "OCSP Responder",
                "user": {
                    "login": "strongX509",
                    "id": 4939775,
                    "node_id": "MDQ6VXNlcjQ5Mzk3NzU=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/4939775?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/strongX509",
                    "html_url": "https://github.com/strongX509",
                    "followers_url": "https://api.github.com/users/strongX509/followers",
                    "following_url": "https://api.github.com/users/strongX509/following{/other_user}",
                    "gists_url": "https://api.github.com/users/strongX509/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/strongX509/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/strongX509/subscriptions",
                    "organizations_url": "https://api.github.com/users/strongX509/orgs",
                    "repos_url": "https://api.github.com/users/strongX509/repos",
                    "events_url": "https://api.github.com/users/strongX509/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/strongX509/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "The new **`pki --ocsp`** command parses an _Online Certificate Status Protocol_ (OCSP) request as defined by  RFC  6960  and\r\n       with  the **`--respond`** option generates an OCSP response based on the OCSP request.  The certificate status is directly\r\n       retrieved from the internal certificate database of an _OpenXPKI_ (https://openxpki.org) server. Therefore the **`--respond`**  option\r\n       requires  the new  **`openxpki`**  and the existing  **`mysql`** libstrongswan plugins in order to access the **`certificate`** database table of the _OpenXPKI_ server running on the same host. The OCSP response can be signed by the CA itself, by a delegated OCSP Signer certificate with corresonding EKU extension or by a self-signed OCSP Signer certificate.\r\n",
                "created_at": "2023-10-19T18:01:27Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "db8b1bc37cb571300caaaa58e8b4614e662c2c45",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [
                    {
                        "id": 5235670731,
                        "node_id": "LA_kwDOAA-8Q88AAAABOBH-yw",
                        "url": "https://api.github.com/repos/strongswan/strongswan/labels/cla-signed",
                        "name": "cla-signed",
                        "color": "ededed",
                        "default": false,
                        "description": null
                    }
                ],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits",
                "review_comments_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments",
                "review_comment_url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments",
                "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "head": {
                    "label": "strongswan:ocsp-responder-new",
                    "ref": "ocsp-responder-new",
                    "sha": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "base": {
                    "label": "strongswan:master",
                    "ref": "master",
                    "sha": "b5760243870d4ab6c5874d765f8b09b3c67b8fc6",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T14:34:15Z",
        "org": {
            "id": 457671,
            "login": "strongswan",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/strongswan",
            "avatar_url": "https://avatars.githubusercontent.com/u/457671?"
        }
    },
    {
        "id": "32874321662",
        "type": "PullRequestReviewCommentEvent",
        "actor": {
            "id": 457648,
            "login": "tobiasbrunner",
            "display_login": "tobiasbrunner",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tobiasbrunner",
            "avatar_url": "https://avatars.githubusercontent.com/u/457648?"
        },
        "repo": {
            "id": 1031235,
            "name": "strongswan/strongswan",
            "url": "https://api.github.com/repos/strongswan/strongswan"
        },
        "payload": {
            "action": "created",
            "comment": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373274350",
                "pull_request_review_id": 1698865892,
                "id": 1373274350,
                "node_id": "PRRC_kwDOAA-8Q85R2oDu",
                "diff_hunk": "@@ -0,0 +1,569 @@\n+/*\n+ * Copyright (C) 2023 Andreas Steffen, strongSec GmbH\n+ *\n+ * Copyright (C) secunet Security Networks AG\n+ *\n+ * This program is free software; you can redistribute it and/or modify it\n+ * under the terms of the GNU General Public License as published by the\n+ * Free Software Foundation; either version 2 of the License, or (at your\n+ * option) any later version.  See <http://www.fsf.org/copyleft/gpl.txt>.\n+ *\n+ * This program is distributed in the hope that it will be useful, but\n+ * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY\n+ * or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * for more details.\n+ */\n+\n+#include <errno.h>\n+#include <time.h>\n+\n+#include \"pki.h\"\n+\n+#include <credentials/sets/mem_cred.h>\n+#include <credentials/certificates/ocsp_request.h>\n+#include <credentials/certificates/ocsp_response.h>\n+#include <credentials/certificates/ocsp_single_response.h>\n+#include <credentials/certificates/ocsp_responder.h>\n+\n+static bool verify_signature(certificate_t *ocsp_req, mem_cred_t *creds)",
                "path": "src/pki/commands/ocsp.c",
                "commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "original_commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "user": {
                    "login": "tobiasbrunner",
                    "id": 457648,
                    "node_id": "MDQ6VXNlcjQ1NzY0OA==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/457648?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/tobiasbrunner",
                    "html_url": "https://github.com/tobiasbrunner",
                    "followers_url": "https://api.github.com/users/tobiasbrunner/followers",
                    "following_url": "https://api.github.com/users/tobiasbrunner/following{/other_user}",
                    "gists_url": "https://api.github.com/users/tobiasbrunner/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/tobiasbrunner/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/tobiasbrunner/subscriptions",
                    "organizations_url": "https://api.github.com/users/tobiasbrunner/orgs",
                    "repos_url": "https://api.github.com/users/tobiasbrunner/repos",
                    "events_url": "https://api.github.com/users/tobiasbrunner/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/tobiasbrunner/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "Add a short comment to these helper functions.",
                "created_at": "2023-10-26T14:28:29Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373274350",
                "pull_request_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "author_association": "MEMBER",
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373274350"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373274350"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    }
                },
                "reactions": {
                    "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373274350/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "start_line": null,
                "original_start_line": null,
                "start_side": null,
                "line": 28,
                "original_line": 28,
                "side": "RIGHT",
                "original_position": 28,
                "position": 28,
                "subject_type": "line"
            },
            "pull_request": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "id": 1565360593,
                "node_id": "PR_kwDOAA-8Q85dTYHR",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958",
                "diff_url": "https://github.com/strongswan/strongswan/pull/1958.diff",
                "patch_url": "https://github.com/strongswan/strongswan/pull/1958.patch",
                "issue_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958",
                "number": 1958,
                "state": "open",
                "locked": false,
                "title": "OCSP Responder",
                "user": {
                    "login": "strongX509",
                    "id": 4939775,
                    "node_id": "MDQ6VXNlcjQ5Mzk3NzU=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/4939775?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/strongX509",
                    "html_url": "https://github.com/strongX509",
                    "followers_url": "https://api.github.com/users/strongX509/followers",
                    "following_url": "https://api.github.com/users/strongX509/following{/other_user}",
                    "gists_url": "https://api.github.com/users/strongX509/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/strongX509/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/strongX509/subscriptions",
                    "organizations_url": "https://api.github.com/users/strongX509/orgs",
                    "repos_url": "https://api.github.com/users/strongX509/repos",
                    "events_url": "https://api.github.com/users/strongX509/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/strongX509/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "The new **`pki --ocsp`** command parses an _Online Certificate Status Protocol_ (OCSP) request as defined by  RFC  6960  and\r\n       with  the **`--respond`** option generates an OCSP response based on the OCSP request.  The certificate status is directly\r\n       retrieved from the internal certificate database of an _OpenXPKI_ (https://openxpki.org) server. Therefore the **`--respond`**  option\r\n       requires  the new  **`openxpki`**  and the existing  **`mysql`** libstrongswan plugins in order to access the **`certificate`** database table of the _OpenXPKI_ server running on the same host. The OCSP response can be signed by the CA itself, by a delegated OCSP Signer certificate with corresonding EKU extension or by a self-signed OCSP Signer certificate.\r\n",
                "created_at": "2023-10-19T18:01:27Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "db8b1bc37cb571300caaaa58e8b4614e662c2c45",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [
                    {
                        "id": 5235670731,
                        "node_id": "LA_kwDOAA-8Q88AAAABOBH-yw",
                        "url": "https://api.github.com/repos/strongswan/strongswan/labels/cla-signed",
                        "name": "cla-signed",
                        "color": "ededed",
                        "default": false,
                        "description": null
                    }
                ],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits",
                "review_comments_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments",
                "review_comment_url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments",
                "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "head": {
                    "label": "strongswan:ocsp-responder-new",
                    "ref": "ocsp-responder-new",
                    "sha": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "base": {
                    "label": "strongswan:master",
                    "ref": "master",
                    "sha": "b5760243870d4ab6c5874d765f8b09b3c67b8fc6",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T14:28:29Z",
        "org": {
            "id": 457671,
            "login": "strongswan",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/strongswan",
            "avatar_url": "https://avatars.githubusercontent.com/u/457671?"
        }
    },
    {
        "id": "32874321634",
        "type": "PullRequestReviewCommentEvent",
        "actor": {
            "id": 457648,
            "login": "tobiasbrunner",
            "display_login": "tobiasbrunner",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tobiasbrunner",
            "avatar_url": "https://avatars.githubusercontent.com/u/457648?"
        },
        "repo": {
            "id": 1031235,
            "name": "strongswan/strongswan",
            "url": "https://api.github.com/repos/strongswan/strongswan"
        },
        "payload": {
            "action": "created",
            "comment": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373267914",
                "pull_request_review_id": 1698865892,
                "id": 1373267914,
                "node_id": "PRRC_kwDOAA-8Q85R2mfK",
                "diff_hunk": "@@ -0,0 +1,247 @@\n+.TH \"PKI \\-\\-OCSP\" 1 \"2023-10-20\" \"@PACKAGE_VERSION@\" \"strongSwan\"\n+.\n+.SH \"NAME\"\n+.\n+pki \\-\\-ocsp \\- OCSP request parser and OCSP responder.\n+.\n+.SH \"SYNOPSIS\"\n+.\n+.SY pki\\ \\-\\-ocsp\n+.OP \\-\\-in file\n+.OP \\-\\-cacert file\n+.OP \\-\\-debug level\n+.YS\n+\n+.SY pki\\ \\-\\-ocsp\n+.BI \\-\\-respond\n+.OP \\-\\-in file\n+.BI \\-\\-cacert\\~ file\n+.BI \\-\\-key\\~ file\n+.OP \\-\\-cert file\n+.OP \\-\\-lifetime minutes\n+.OP \\-\\-digest digest\n+.OP \\-\\-rsa\\-padding padding\n+.OP \\-\\-debug level\n+.YS\n+.\n+.SY pki\\ \\-\\-ocsp\n+.BI \\-\\-options\\~ file\n+.YS\n+.\n+.SY \"pki \\-\\-ocsp\"\n+.B \\-h\n+|\n+.B \\-\\-help\n+.YS\n+.\n+.SH \"DESCRIPTION\"\n+.\n+This sub-command of\n+.BR pki (1)\n+parses an\n+.B Online Certificate Status Protocol\n+(OCSP) request as defined by RFC 6960 and with the\n+.B --respond\n+option generates an OCSP response based on the OCSP request.\n+The certificate status is directly retrieved from the internal\n+.B certificate\n+database of an\n+.B OpenXPKI\n+(https://openxpki.org) server. The\n+.B --respond\n+option requires the\n+.B openxpki\n+and\n+.B mysql\n+libstrongswan plugins in order to access the\n+.B certificate\n+database of the\n+.B OpenXPKI\n+server running on the same host.\n+.\n+.SH \"OPTIONS\"\n+.\n+.TP\n+.B \"\\-h, \\-\\-help\"\n+Print usage information with a summary of the available options.\n+.TP\n+.BI \"\\-v, \\-\\-debug \" level\n+Set debug level, default: 1.\n+.TP\n+.BI \"\\-+, \\-\\-options \" file\n+Read command line options from \\fIfile\\fR.\n+.TP\n+.BI \"\\-i, \\-\\-in \" file\n+OCSP request. If not given, the OCSP request is read from\n+\\fISTDIN\\fR.\n+.TP\n+.BI \"\\-C, \\-\\-cacert \" file\n+CA certificate corresponding to one of the issuer hashes contained in the OCSP\n+request. If the OCSP request is signed, a CA certificate forming the\n+trust chain. Can be used multiple times.\n+.TP\n+.BI \"\\-k, \\-\\-key \" file\n+OCSP signer key. Can be used multiple times.\n+.TP\n+.BI \"\\-c, \\-\\-cert \" file\n+OCSP signer certificate (if it is not a CA certificate). Can be used\n+multiple times.\n+.TP\n+.BI \"\\-l, \\-\\-lifetime \" minutes\n+Validity in minutes of the OCSP response (if missing, nextUpdate is omitted).\n+.TP\n+.BI \"\\-g, \\-\\-digest \" digest\n+Digest to use for signature creation. One of \\fImd5\\fR, \\fIsha1\\fR,\n+\\fIsha224\\fR, \\fIsha256\\fR, \\fIsha384\\fR, or \\fIsha512\\fR, \\fIsha3_224\\fR,\n+\\fIsha3_256\\fR, \\fIsha3_384\\fR, \\fIsha3_512\\fR.  The default is\n+determined based on the type and size of the ocsp signing key.\n+.TP\n+.BI \"\\-R, \\-\\-rsa\\-padding \" padding\n+Padding to use for RSA signatures. Either \\fIpkcs1\\fR or \\fIpss\\fR, defaults\n+to \\fIpkcs1\\fR.\n+.\n+.SH \"EXAMPLES\"\n+.\n+Show the raw content of an OCSP request:\n+.PP\n+.EX\n+pki \\-\\-ocsp \\-\\-in req_ca.der\n+\n+nonce:               5b:14:e3:cc:d5:b2:65:ec:c4:0d:c3:11:37:6a:9d:71\n+  issuerKeyHash:     b6:76:79:95:b5:58:5f:85:1e:1f:c7:52:4a:fc:06:93:f3:39:79:19 (no match)",
                "path": "src/pki/man/pki---ocsp.1.in",
                "commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "original_commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "user": {
                    "login": "tobiasbrunner",
                    "id": 457648,
                    "node_id": "MDQ6VXNlcjQ1NzY0OA==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/457648?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/tobiasbrunner",
                    "html_url": "https://github.com/tobiasbrunner",
                    "followers_url": "https://api.github.com/users/tobiasbrunner/followers",
                    "following_url": "https://api.github.com/users/tobiasbrunner/following{/other_user}",
                    "gists_url": "https://api.github.com/users/tobiasbrunner/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/tobiasbrunner/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/tobiasbrunner/subscriptions",
                    "organizations_url": "https://api.github.com/users/tobiasbrunner/orgs",
                    "repos_url": "https://api.github.com/users/tobiasbrunner/repos",
                    "events_url": "https://api.github.com/users/tobiasbrunner/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/tobiasbrunner/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "These lines are a bit long for an 80 character terminal. Maybe shorten the hashes a bit? (In the examples the actual values don't really matter.)\r\n\r\n```suggestion\r\n  issuerKeyHash:     b6:76:79:95:b5:58:5f:85:1e:1f:... (no match)\r\n```\r\n",
                "created_at": "2023-10-26T14:24:13Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373267914",
                "pull_request_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "author_association": "MEMBER",
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373267914"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373267914"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    }
                },
                "reactions": {
                    "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373267914/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "start_line": null,
                "original_start_line": null,
                "start_side": null,
                "line": 111,
                "original_line": 111,
                "side": "RIGHT",
                "original_position": 111,
                "position": 111,
                "subject_type": "line"
            },
            "pull_request": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "id": 1565360593,
                "node_id": "PR_kwDOAA-8Q85dTYHR",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958",
                "diff_url": "https://github.com/strongswan/strongswan/pull/1958.diff",
                "patch_url": "https://github.com/strongswan/strongswan/pull/1958.patch",
                "issue_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958",
                "number": 1958,
                "state": "open",
                "locked": false,
                "title": "OCSP Responder",
                "user": {
                    "login": "strongX509",
                    "id": 4939775,
                    "node_id": "MDQ6VXNlcjQ5Mzk3NzU=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/4939775?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/strongX509",
                    "html_url": "https://github.com/strongX509",
                    "followers_url": "https://api.github.com/users/strongX509/followers",
                    "following_url": "https://api.github.com/users/strongX509/following{/other_user}",
                    "gists_url": "https://api.github.com/users/strongX509/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/strongX509/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/strongX509/subscriptions",
                    "organizations_url": "https://api.github.com/users/strongX509/orgs",
                    "repos_url": "https://api.github.com/users/strongX509/repos",
                    "events_url": "https://api.github.com/users/strongX509/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/strongX509/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "The new **`pki --ocsp`** command parses an _Online Certificate Status Protocol_ (OCSP) request as defined by  RFC  6960  and\r\n       with  the **`--respond`** option generates an OCSP response based on the OCSP request.  The certificate status is directly\r\n       retrieved from the internal certificate database of an _OpenXPKI_ (https://openxpki.org) server. Therefore the **`--respond`**  option\r\n       requires  the new  **`openxpki`**  and the existing  **`mysql`** libstrongswan plugins in order to access the **`certificate`** database table of the _OpenXPKI_ server running on the same host. The OCSP response can be signed by the CA itself, by a delegated OCSP Signer certificate with corresonding EKU extension or by a self-signed OCSP Signer certificate.\r\n",
                "created_at": "2023-10-19T18:01:27Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "db8b1bc37cb571300caaaa58e8b4614e662c2c45",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [
                    {
                        "id": 5235670731,
                        "node_id": "LA_kwDOAA-8Q88AAAABOBH-yw",
                        "url": "https://api.github.com/repos/strongswan/strongswan/labels/cla-signed",
                        "name": "cla-signed",
                        "color": "ededed",
                        "default": false,
                        "description": null
                    }
                ],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits",
                "review_comments_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments",
                "review_comment_url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments",
                "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "head": {
                    "label": "strongswan:ocsp-responder-new",
                    "ref": "ocsp-responder-new",
                    "sha": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "base": {
                    "label": "strongswan:master",
                    "ref": "master",
                    "sha": "b5760243870d4ab6c5874d765f8b09b3c67b8fc6",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T14:24:13Z",
        "org": {
            "id": 457671,
            "login": "strongswan",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/strongswan",
            "avatar_url": "https://avatars.githubusercontent.com/u/457671?"
        }
    },
    {
        "id": "32874321596",
        "type": "PullRequestReviewCommentEvent",
        "actor": {
            "id": 457648,
            "login": "tobiasbrunner",
            "display_login": "tobiasbrunner",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tobiasbrunner",
            "avatar_url": "https://avatars.githubusercontent.com/u/457648?"
        },
        "repo": {
            "id": 1031235,
            "name": "strongswan/strongswan",
            "url": "https://api.github.com/repos/strongswan/strongswan"
        },
        "payload": {
            "action": "created",
            "comment": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373251076",
                "pull_request_review_id": 1698865892,
                "id": 1373251076,
                "node_id": "PRRC_kwDOAA-8Q85R2iYE",
                "diff_hunk": "@@ -124,6 +124,11 @@ static int print()\n \t\t\t\t\ttype = CRED_PRIVATE_KEY;\n \t\t\t\t\tsubtype = KEY_BLISS;\n \t\t\t\t}\n+\t\t\t\telse if (streq(arg, \"ocsp-rsp\"))",
                "path": "src/pki/commands/print.c",
                "commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "original_commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "user": {
                    "login": "tobiasbrunner",
                    "id": 457648,
                    "node_id": "MDQ6VXNlcjQ1NzY0OA==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/457648?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/tobiasbrunner",
                    "html_url": "https://github.com/tobiasbrunner",
                    "followers_url": "https://api.github.com/users/tobiasbrunner/followers",
                    "following_url": "https://api.github.com/users/tobiasbrunner/following{/other_user}",
                    "gists_url": "https://api.github.com/users/tobiasbrunner/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/tobiasbrunner/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/tobiasbrunner/subscriptions",
                    "organizations_url": "https://api.github.com/users/tobiasbrunner/orgs",
                    "repos_url": "https://api.github.com/users/tobiasbrunner/repos",
                    "events_url": "https://api.github.com/users/tobiasbrunner/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/tobiasbrunner/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "Why only `ocsp-rsp` and not `ocsp-req` too? Is that because the `--ocsp` command has some printing capabilities for requests?",
                "created_at": "2023-10-26T14:12:57Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373251076",
                "pull_request_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "author_association": "MEMBER",
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373251076"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373251076"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    }
                },
                "reactions": {
                    "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373251076/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "start_line": null,
                "original_start_line": null,
                "start_side": null,
                "line": 127,
                "original_line": 127,
                "side": "RIGHT",
                "original_position": 4,
                "position": 4,
                "subject_type": "line"
            },
            "pull_request": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "id": 1565360593,
                "node_id": "PR_kwDOAA-8Q85dTYHR",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958",
                "diff_url": "https://github.com/strongswan/strongswan/pull/1958.diff",
                "patch_url": "https://github.com/strongswan/strongswan/pull/1958.patch",
                "issue_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958",
                "number": 1958,
                "state": "open",
                "locked": false,
                "title": "OCSP Responder",
                "user": {
                    "login": "strongX509",
                    "id": 4939775,
                    "node_id": "MDQ6VXNlcjQ5Mzk3NzU=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/4939775?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/strongX509",
                    "html_url": "https://github.com/strongX509",
                    "followers_url": "https://api.github.com/users/strongX509/followers",
                    "following_url": "https://api.github.com/users/strongX509/following{/other_user}",
                    "gists_url": "https://api.github.com/users/strongX509/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/strongX509/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/strongX509/subscriptions",
                    "organizations_url": "https://api.github.com/users/strongX509/orgs",
                    "repos_url": "https://api.github.com/users/strongX509/repos",
                    "events_url": "https://api.github.com/users/strongX509/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/strongX509/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "The new **`pki --ocsp`** command parses an _Online Certificate Status Protocol_ (OCSP) request as defined by  RFC  6960  and\r\n       with  the **`--respond`** option generates an OCSP response based on the OCSP request.  The certificate status is directly\r\n       retrieved from the internal certificate database of an _OpenXPKI_ (https://openxpki.org) server. Therefore the **`--respond`**  option\r\n       requires  the new  **`openxpki`**  and the existing  **`mysql`** libstrongswan plugins in order to access the **`certificate`** database table of the _OpenXPKI_ server running on the same host. The OCSP response can be signed by the CA itself, by a delegated OCSP Signer certificate with corresonding EKU extension or by a self-signed OCSP Signer certificate.\r\n",
                "created_at": "2023-10-19T18:01:27Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "db8b1bc37cb571300caaaa58e8b4614e662c2c45",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [
                    {
                        "id": 5235670731,
                        "node_id": "LA_kwDOAA-8Q88AAAABOBH-yw",
                        "url": "https://api.github.com/repos/strongswan/strongswan/labels/cla-signed",
                        "name": "cla-signed",
                        "color": "ededed",
                        "default": false,
                        "description": null
                    }
                ],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits",
                "review_comments_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments",
                "review_comment_url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments",
                "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "head": {
                    "label": "strongswan:ocsp-responder-new",
                    "ref": "ocsp-responder-new",
                    "sha": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "base": {
                    "label": "strongswan:master",
                    "ref": "master",
                    "sha": "b5760243870d4ab6c5874d765f8b09b3c67b8fc6",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T14:12:57Z",
        "org": {
            "id": 457671,
            "login": "strongswan",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/strongswan",
            "avatar_url": "https://avatars.githubusercontent.com/u/457671?"
        }
    },
    {
        "id": "32874321557",
        "type": "PullRequestReviewCommentEvent",
        "actor": {
            "id": 457648,
            "login": "tobiasbrunner",
            "display_login": "tobiasbrunner",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tobiasbrunner",
            "avatar_url": "https://avatars.githubusercontent.com/u/457648?"
        },
        "repo": {
            "id": 1031235,
            "name": "strongswan/strongswan",
            "url": "https://api.github.com/repos/strongswan/strongswan"
        },
        "payload": {
            "action": "created",
            "comment": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373233950",
                "pull_request_review_id": 1698865892,
                "id": 1373233950,
                "node_id": "PRRC_kwDOAA-8Q85R2eMe",
                "diff_hunk": "@@ -38,6 +38,22 @@ struct x509_ocsp_response_t {\n \tocsp_response_t interface;\n };\n \n+/**\n+ * Generate a X.509 OCSP respibse.",
                "path": "src/libstrongswan/plugins/x509/x509_ocsp_response.h",
                "commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "original_commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "user": {
                    "login": "tobiasbrunner",
                    "id": 457648,
                    "node_id": "MDQ6VXNlcjQ1NzY0OA==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/457648?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/tobiasbrunner",
                    "html_url": "https://github.com/tobiasbrunner",
                    "followers_url": "https://api.github.com/users/tobiasbrunner/followers",
                    "following_url": "https://api.github.com/users/tobiasbrunner/following{/other_user}",
                    "gists_url": "https://api.github.com/users/tobiasbrunner/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/tobiasbrunner/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/tobiasbrunner/subscriptions",
                    "organizations_url": "https://api.github.com/users/tobiasbrunner/orgs",
                    "repos_url": "https://api.github.com/users/tobiasbrunner/repos",
                    "events_url": "https://api.github.com/users/tobiasbrunner/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/tobiasbrunner/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "```suggestion\r\n * Generate an X.509 OCSP response.\r\n```",
                "created_at": "2023-10-26T14:01:19Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373233950",
                "pull_request_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "author_association": "MEMBER",
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373233950"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373233950"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    }
                },
                "reactions": {
                    "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373233950/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "start_line": null,
                "original_start_line": null,
                "start_side": null,
                "line": 42,
                "original_line": 42,
                "side": "RIGHT",
                "original_position": 5,
                "position": 5,
                "subject_type": "line"
            },
            "pull_request": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "id": 1565360593,
                "node_id": "PR_kwDOAA-8Q85dTYHR",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958",
                "diff_url": "https://github.com/strongswan/strongswan/pull/1958.diff",
                "patch_url": "https://github.com/strongswan/strongswan/pull/1958.patch",
                "issue_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958",
                "number": 1958,
                "state": "open",
                "locked": false,
                "title": "OCSP Responder",
                "user": {
                    "login": "strongX509",
                    "id": 4939775,
                    "node_id": "MDQ6VXNlcjQ5Mzk3NzU=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/4939775?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/strongX509",
                    "html_url": "https://github.com/strongX509",
                    "followers_url": "https://api.github.com/users/strongX509/followers",
                    "following_url": "https://api.github.com/users/strongX509/following{/other_user}",
                    "gists_url": "https://api.github.com/users/strongX509/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/strongX509/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/strongX509/subscriptions",
                    "organizations_url": "https://api.github.com/users/strongX509/orgs",
                    "repos_url": "https://api.github.com/users/strongX509/repos",
                    "events_url": "https://api.github.com/users/strongX509/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/strongX509/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "The new **`pki --ocsp`** command parses an _Online Certificate Status Protocol_ (OCSP) request as defined by  RFC  6960  and\r\n       with  the **`--respond`** option generates an OCSP response based on the OCSP request.  The certificate status is directly\r\n       retrieved from the internal certificate database of an _OpenXPKI_ (https://openxpki.org) server. Therefore the **`--respond`**  option\r\n       requires  the new  **`openxpki`**  and the existing  **`mysql`** libstrongswan plugins in order to access the **`certificate`** database table of the _OpenXPKI_ server running on the same host. The OCSP response can be signed by the CA itself, by a delegated OCSP Signer certificate with corresonding EKU extension or by a self-signed OCSP Signer certificate.\r\n",
                "created_at": "2023-10-19T18:01:27Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "db8b1bc37cb571300caaaa58e8b4614e662c2c45",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [
                    {
                        "id": 5235670731,
                        "node_id": "LA_kwDOAA-8Q88AAAABOBH-yw",
                        "url": "https://api.github.com/repos/strongswan/strongswan/labels/cla-signed",
                        "name": "cla-signed",
                        "color": "ededed",
                        "default": false,
                        "description": null
                    }
                ],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits",
                "review_comments_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments",
                "review_comment_url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments",
                "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "head": {
                    "label": "strongswan:ocsp-responder-new",
                    "ref": "ocsp-responder-new",
                    "sha": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "base": {
                    "label": "strongswan:master",
                    "ref": "master",
                    "sha": "b5760243870d4ab6c5874d765f8b09b3c67b8fc6",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T14:01:19Z",
        "org": {
            "id": 457671,
            "login": "strongswan",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/strongswan",
            "avatar_url": "https://avatars.githubusercontent.com/u/457671?"
        }
    },
    {
        "id": "32874321581",
        "type": "PullRequestReviewCommentEvent",
        "actor": {
            "id": 457648,
            "login": "tobiasbrunner",
            "display_login": "tobiasbrunner",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tobiasbrunner",
            "avatar_url": "https://avatars.githubusercontent.com/u/457648?"
        },
        "repo": {
            "id": 1031235,
            "name": "strongswan/strongswan",
            "url": "https://api.github.com/repos/strongswan/strongswan"
        },
        "payload": {
            "action": "created",
            "comment": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373236786",
                "pull_request_review_id": 1698865892,
                "id": 1373236786,
                "node_id": "PRRC_kwDOAA-8Q85R2e4y",
                "diff_hunk": "@@ -38,6 +38,22 @@ struct x509_ocsp_response_t {\n \tocsp_response_t interface;\n };\n \n+/**\n+ * Generate a X.509 OCSP respibse.\n+ *\n+ * The resulting builder accepts:\n+ *  BUILD_CA_CERT:      CA of the checked certificates, exactly one\n+ *  BUILD_CERT:         certificates to check with the request, at least one\n+ *  BUILD_SUBJECT:      subject requesting check, optional\n+ *  BUILD_SIGNING_CERT: certificate to create requestor signature, optional\n+ *  BUILD_SIGNING_KEY:  private key to create requestor signature, optional",
                "path": "src/libstrongswan/plugins/x509/x509_ocsp_response.h",
                "commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "original_commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "user": {
                    "login": "tobiasbrunner",
                    "id": 457648,
                    "node_id": "MDQ6VXNlcjQ1NzY0OA==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/457648?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/tobiasbrunner",
                    "html_url": "https://github.com/tobiasbrunner",
                    "followers_url": "https://api.github.com/users/tobiasbrunner/followers",
                    "following_url": "https://api.github.com/users/tobiasbrunner/following{/other_user}",
                    "gists_url": "https://api.github.com/users/tobiasbrunner/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/tobiasbrunner/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/tobiasbrunner/subscriptions",
                    "organizations_url": "https://api.github.com/users/tobiasbrunner/orgs",
                    "repos_url": "https://api.github.com/users/tobiasbrunner/repos",
                    "events_url": "https://api.github.com/users/tobiasbrunner/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/tobiasbrunner/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "This list isn't accurate. The first three are not actually accepted, and many that are are missing.",
                "created_at": "2023-10-26T14:03:16Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373236786",
                "pull_request_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "author_association": "MEMBER",
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373236786"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373236786"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    }
                },
                "reactions": {
                    "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373236786/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "start_line": 45,
                "original_start_line": 45,
                "start_side": "RIGHT",
                "line": 49,
                "original_line": 49,
                "side": "RIGHT",
                "original_position": 12,
                "position": 12,
                "subject_type": "line"
            },
            "pull_request": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "id": 1565360593,
                "node_id": "PR_kwDOAA-8Q85dTYHR",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958",
                "diff_url": "https://github.com/strongswan/strongswan/pull/1958.diff",
                "patch_url": "https://github.com/strongswan/strongswan/pull/1958.patch",
                "issue_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958",
                "number": 1958,
                "state": "open",
                "locked": false,
                "title": "OCSP Responder",
                "user": {
                    "login": "strongX509",
                    "id": 4939775,
                    "node_id": "MDQ6VXNlcjQ5Mzk3NzU=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/4939775?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/strongX509",
                    "html_url": "https://github.com/strongX509",
                    "followers_url": "https://api.github.com/users/strongX509/followers",
                    "following_url": "https://api.github.com/users/strongX509/following{/other_user}",
                    "gists_url": "https://api.github.com/users/strongX509/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/strongX509/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/strongX509/subscriptions",
                    "organizations_url": "https://api.github.com/users/strongX509/orgs",
                    "repos_url": "https://api.github.com/users/strongX509/repos",
                    "events_url": "https://api.github.com/users/strongX509/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/strongX509/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "The new **`pki --ocsp`** command parses an _Online Certificate Status Protocol_ (OCSP) request as defined by  RFC  6960  and\r\n       with  the **`--respond`** option generates an OCSP response based on the OCSP request.  The certificate status is directly\r\n       retrieved from the internal certificate database of an _OpenXPKI_ (https://openxpki.org) server. Therefore the **`--respond`**  option\r\n       requires  the new  **`openxpki`**  and the existing  **`mysql`** libstrongswan plugins in order to access the **`certificate`** database table of the _OpenXPKI_ server running on the same host. The OCSP response can be signed by the CA itself, by a delegated OCSP Signer certificate with corresonding EKU extension or by a self-signed OCSP Signer certificate.\r\n",
                "created_at": "2023-10-19T18:01:27Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "db8b1bc37cb571300caaaa58e8b4614e662c2c45",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [
                    {
                        "id": 5235670731,
                        "node_id": "LA_kwDOAA-8Q88AAAABOBH-yw",
                        "url": "https://api.github.com/repos/strongswan/strongswan/labels/cla-signed",
                        "name": "cla-signed",
                        "color": "ededed",
                        "default": false,
                        "description": null
                    }
                ],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits",
                "review_comments_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments",
                "review_comment_url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments",
                "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "head": {
                    "label": "strongswan:ocsp-responder-new",
                    "ref": "ocsp-responder-new",
                    "sha": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "base": {
                    "label": "strongswan:master",
                    "ref": "master",
                    "sha": "b5760243870d4ab6c5874d765f8b09b3c67b8fc6",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T14:03:16Z",
        "org": {
            "id": 457671,
            "login": "strongswan",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/strongswan",
            "avatar_url": "https://avatars.githubusercontent.com/u/457671?"
        }
    },
    {
        "id": "32874321565",
        "type": "PullRequestReviewCommentEvent",
        "actor": {
            "id": 457648,
            "login": "tobiasbrunner",
            "display_login": "tobiasbrunner",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tobiasbrunner",
            "avatar_url": "https://avatars.githubusercontent.com/u/457648?"
        },
        "repo": {
            "id": 1031235,
            "name": "strongswan/strongswan",
            "url": "https://api.github.com/repos/strongswan/strongswan"
        },
        "payload": {
            "action": "created",
            "comment": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373231940",
                "pull_request_review_id": 1698865892,
                "id": 1373231940,
                "node_id": "PRRC_kwDOAA-8Q85R2dtE",
                "diff_hunk": "@@ -885,13 +1061,119 @@ static x509_ocsp_response_t *load(chunk_t blob)\n \t\t\t},\n \t\t},\n \t\t.ref = 1,\n-\t\t.encoding = chunk_clone(blob),\n \t\t.producedAt = UNDEFINED_TIME,\n \t\t.usableUntil = UNDEFINED_TIME,\n \t\t.responses = linked_list_create(),\n \t\t.certs = linked_list_create(),\n \t);\n \n+\treturn this;\n+}\n+\n+/**\n+ * See header.\n+ */\n+x509_ocsp_response_t *x509_ocsp_response_gen(certificate_type_t type, va_list args)\n+{\n+\tprivate_x509_ocsp_response_t *this;\n+\tprivate_key_t *private;\n+\tcertificate_t *cert;\n+\tchunk_t nonce;\n+\tidentification_t *subject;\n+\tenumerator_t *enumerator;\n+\tocsp_single_response_t *response;\n+\n+\tthis = create_empty();\n+\n+\twhile (TRUE)\n+\t{\n+\t\tswitch (va_arg(args, builder_part_t))\n+\t\t{\n+\t\t\tcase BUILD_OCSP_STATUS:\n+\t\t\t\tthis->ocsp_status = va_arg(args, ocsp_status_t);\n+\t\t\t\tcontinue;\n+\t\t\tcase BUILD_OCSP_RESPONSES:\n+\t\t\t\tenumerator = va_arg(args, enumerator_t*);\n+\t\t\t\twhile (enumerator->enumerate(enumerator, &response))\n+\t\t\t\t{\n+\t\t\t\t\tthis->responses->insert_last(this->responses,\n+\t\t\t\t\t\t\t\t\t\t\t\tresponse->get_ref(response));\n+\t\t\t\t}\n+\t\t\t\tcontinue;\n+\t\t\tcase BUILD_SIGNING_CERT:\n+\t\t\t\tcert = va_arg(args, certificate_t*);\n+\t\t\t\tif (cert)\n+\t\t\t\t{\n+\t\t\t\t\tsubject = cert->get_subject(cert);\n+\t\t\t\t\tthis->cert = cert->get_ref(cert);\n+\t\t\t\t\tthis->responderId = subject->clone(subject);\n+\t\t\t\t}\n+\t\t\t\tcontinue;\n+\t\t\tcase BUILD_SIGNING_KEY:\n+\t\t\t\tprivate = va_arg(args, private_key_t*);\n+\t\t\t\tif (private)\n+\t\t\t\t{\n+\t\t\t\t\tthis->key = private->get_ref(private);\n+\t\t\t\t}\n+\t\t\t\tcontinue;\n+\t\t\tcase BUILD_SIGNATURE_SCHEME:\n+\t\t\t\tthis->scheme = va_arg(args, signature_params_t*);\n+\t\t\t\tthis->scheme = signature_params_clone(this->scheme);\n+\t\t\t\tcontinue;\n+\t\t\tcase BUILD_NONCE:\n+\t\t\t\tnonce = va_arg(args, chunk_t);\n+\t\t\t\tthis->nonce = chunk_clone(nonce);\n+\t\t\t\tcontinue;\n+\t\t\tcase BUILD_END:\n+\t\t\t\tbreak;\n+\t\t\tdefault:\n+\t\t\t\tgoto error;\n+\t\t}\n+\t\tbreak;\n+\t}\n+\n+\tif (this->ocsp_status == OCSP_SUCCESSFUL)\n+\t{\n+",
                "path": "src/libstrongswan/plugins/x509/x509_ocsp_response.c",
                "commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "original_commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "user": {
                    "login": "tobiasbrunner",
                    "id": 457648,
                    "node_id": "MDQ6VXNlcjQ1NzY0OA==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/457648?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/tobiasbrunner",
                    "html_url": "https://github.com/tobiasbrunner",
                    "followers_url": "https://api.github.com/users/tobiasbrunner/followers",
                    "following_url": "https://api.github.com/users/tobiasbrunner/following{/other_user}",
                    "gists_url": "https://api.github.com/users/tobiasbrunner/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/tobiasbrunner/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/tobiasbrunner/subscriptions",
                    "organizations_url": "https://api.github.com/users/tobiasbrunner/orgs",
                    "repos_url": "https://api.github.com/users/tobiasbrunner/repos",
                    "events_url": "https://api.github.com/users/tobiasbrunner/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/tobiasbrunner/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "```suggestion\r\n```",
                "created_at": "2023-10-26T14:00:00Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373231940",
                "pull_request_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "author_association": "MEMBER",
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373231940"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373231940"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    }
                },
                "reactions": {
                    "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373231940/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "start_line": null,
                "original_start_line": null,
                "start_side": null,
                "line": 1137,
                "original_line": 1137,
                "side": "RIGHT",
                "original_position": 507,
                "position": 507,
                "subject_type": "line"
            },
            "pull_request": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "id": 1565360593,
                "node_id": "PR_kwDOAA-8Q85dTYHR",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958",
                "diff_url": "https://github.com/strongswan/strongswan/pull/1958.diff",
                "patch_url": "https://github.com/strongswan/strongswan/pull/1958.patch",
                "issue_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958",
                "number": 1958,
                "state": "open",
                "locked": false,
                "title": "OCSP Responder",
                "user": {
                    "login": "strongX509",
                    "id": 4939775,
                    "node_id": "MDQ6VXNlcjQ5Mzk3NzU=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/4939775?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/strongX509",
                    "html_url": "https://github.com/strongX509",
                    "followers_url": "https://api.github.com/users/strongX509/followers",
                    "following_url": "https://api.github.com/users/strongX509/following{/other_user}",
                    "gists_url": "https://api.github.com/users/strongX509/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/strongX509/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/strongX509/subscriptions",
                    "organizations_url": "https://api.github.com/users/strongX509/orgs",
                    "repos_url": "https://api.github.com/users/strongX509/repos",
                    "events_url": "https://api.github.com/users/strongX509/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/strongX509/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "The new **`pki --ocsp`** command parses an _Online Certificate Status Protocol_ (OCSP) request as defined by  RFC  6960  and\r\n       with  the **`--respond`** option generates an OCSP response based on the OCSP request.  The certificate status is directly\r\n       retrieved from the internal certificate database of an _OpenXPKI_ (https://openxpki.org) server. Therefore the **`--respond`**  option\r\n       requires  the new  **`openxpki`**  and the existing  **`mysql`** libstrongswan plugins in order to access the **`certificate`** database table of the _OpenXPKI_ server running on the same host. The OCSP response can be signed by the CA itself, by a delegated OCSP Signer certificate with corresonding EKU extension or by a self-signed OCSP Signer certificate.\r\n",
                "created_at": "2023-10-19T18:01:27Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "db8b1bc37cb571300caaaa58e8b4614e662c2c45",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [
                    {
                        "id": 5235670731,
                        "node_id": "LA_kwDOAA-8Q88AAAABOBH-yw",
                        "url": "https://api.github.com/repos/strongswan/strongswan/labels/cla-signed",
                        "name": "cla-signed",
                        "color": "ededed",
                        "default": false,
                        "description": null
                    }
                ],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits",
                "review_comments_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments",
                "review_comment_url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments",
                "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "head": {
                    "label": "strongswan:ocsp-responder-new",
                    "ref": "ocsp-responder-new",
                    "sha": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "base": {
                    "label": "strongswan:master",
                    "ref": "master",
                    "sha": "b5760243870d4ab6c5874d765f8b09b3c67b8fc6",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T14:00:00Z",
        "org": {
            "id": 457671,
            "login": "strongswan",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/strongswan",
            "avatar_url": "https://avatars.githubusercontent.com/u/457671?"
        }
    },
    {
        "id": "32874321530",
        "type": "PullRequestReviewCommentEvent",
        "actor": {
            "id": 457648,
            "login": "tobiasbrunner",
            "display_login": "tobiasbrunner",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tobiasbrunner",
            "avatar_url": "https://avatars.githubusercontent.com/u/457648?"
        },
        "repo": {
            "id": 1031235,
            "name": "strongswan/strongswan",
            "url": "https://api.github.com/repos/strongswan/strongswan"
        },
        "payload": {
            "action": "created",
            "comment": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373232576",
                "pull_request_review_id": 1698865892,
                "id": 1373232576,
                "node_id": "PRRC_kwDOAA-8Q85R2d3A",
                "diff_hunk": "@@ -885,13 +1061,119 @@ static x509_ocsp_response_t *load(chunk_t blob)\n \t\t\t},\n \t\t},\n \t\t.ref = 1,\n-\t\t.encoding = chunk_clone(blob),\n \t\t.producedAt = UNDEFINED_TIME,\n \t\t.usableUntil = UNDEFINED_TIME,\n \t\t.responses = linked_list_create(),\n \t\t.certs = linked_list_create(),\n \t);\n \n+\treturn this;\n+}\n+\n+/**\n+ * See header.\n+ */\n+x509_ocsp_response_t *x509_ocsp_response_gen(certificate_type_t type, va_list args)\n+{\n+\tprivate_x509_ocsp_response_t *this;\n+\tprivate_key_t *private;\n+\tcertificate_t *cert;\n+\tchunk_t nonce;\n+\tidentification_t *subject;\n+\tenumerator_t *enumerator;\n+\tocsp_single_response_t *response;\n+\n+\tthis = create_empty();\n+\n+\twhile (TRUE)\n+\t{\n+\t\tswitch (va_arg(args, builder_part_t))\n+\t\t{\n+\t\t\tcase BUILD_OCSP_STATUS:\n+\t\t\t\tthis->ocsp_status = va_arg(args, ocsp_status_t);\n+\t\t\t\tcontinue;\n+\t\t\tcase BUILD_OCSP_RESPONSES:\n+\t\t\t\tenumerator = va_arg(args, enumerator_t*);\n+\t\t\t\twhile (enumerator->enumerate(enumerator, &response))\n+\t\t\t\t{\n+\t\t\t\t\tthis->responses->insert_last(this->responses,\n+\t\t\t\t\t\t\t\t\t\t\t\tresponse->get_ref(response));\n+\t\t\t\t}\n+\t\t\t\tcontinue;\n+\t\t\tcase BUILD_SIGNING_CERT:\n+\t\t\t\tcert = va_arg(args, certificate_t*);\n+\t\t\t\tif (cert)\n+\t\t\t\t{\n+\t\t\t\t\tsubject = cert->get_subject(cert);\n+\t\t\t\t\tthis->cert = cert->get_ref(cert);\n+\t\t\t\t\tthis->responderId = subject->clone(subject);\n+\t\t\t\t}\n+\t\t\t\tcontinue;\n+\t\t\tcase BUILD_SIGNING_KEY:\n+\t\t\t\tprivate = va_arg(args, private_key_t*);\n+\t\t\t\tif (private)\n+\t\t\t\t{\n+\t\t\t\t\tthis->key = private->get_ref(private);\n+\t\t\t\t}\n+\t\t\t\tcontinue;\n+\t\t\tcase BUILD_SIGNATURE_SCHEME:\n+\t\t\t\tthis->scheme = va_arg(args, signature_params_t*);\n+\t\t\t\tthis->scheme = signature_params_clone(this->scheme);\n+\t\t\t\tcontinue;\n+\t\t\tcase BUILD_NONCE:\n+\t\t\t\tnonce = va_arg(args, chunk_t);\n+\t\t\t\tthis->nonce = chunk_clone(nonce);\n+\t\t\t\tcontinue;\n+\t\t\tcase BUILD_END:\n+\t\t\t\tbreak;\n+\t\t\tdefault:\n+\t\t\t\tgoto error;\n+\t\t}\n+\t\tbreak;\n+\t}\n+\n+\tif (this->ocsp_status == OCSP_SUCCESSFUL)\n+\t{\n+\n+\t\tif (!this->key)\n+\t\t{\n+\t\t\tDBG1(DBG_LIB, \"no OCSP signing key defined\");\n+\t\t\tgoto error;\n+\t\t}\n+\n+\t\t/* select signature scheme, if not already specified */\n+\t\tif (!this->scheme)\n+\t\t{\n+\t\t\tINIT(this->scheme,\n+\t\t\t\t.scheme = signature_scheme_from_oid(\n+\t\t\t\t\t\t\thasher_signature_algorithm_to_oid(HASH_SHA256,\n+\t\t\t\t\t\t\t\tthis->key->get_type(this->key))),\n+\t\t\t);\n+\t\t}\n+\t\tif (this->scheme->scheme == SIGN_UNKNOWN)\n+\t\t{\n+\t\t\tgoto error;\n+\t\t}\n+\t}\n+\n+\tthis->encoding = build_OCSPResponse(this);\n+\treturn &this->public;\n+\n+error:\n+\tdestroy(this);\n+\treturn NULL;\n+}\n+\n+/**\n+ * load an OCSP response\n+ */\n+static x509_ocsp_response_t *load(chunk_t blob)\n+{\n+\tprivate_x509_ocsp_response_t *this;\n+\n+\tthis = create_empty();\n+\tthis->encoding =  chunk_clone(blob);",
                "path": "src/libstrongswan/plugins/x509/x509_ocsp_response.c",
                "commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "original_commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "user": {
                    "login": "tobiasbrunner",
                    "id": 457648,
                    "node_id": "MDQ6VXNlcjQ1NzY0OA==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/457648?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/tobiasbrunner",
                    "html_url": "https://github.com/tobiasbrunner",
                    "followers_url": "https://api.github.com/users/tobiasbrunner/followers",
                    "following_url": "https://api.github.com/users/tobiasbrunner/following{/other_user}",
                    "gists_url": "https://api.github.com/users/tobiasbrunner/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/tobiasbrunner/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/tobiasbrunner/subscriptions",
                    "organizations_url": "https://api.github.com/users/tobiasbrunner/orgs",
                    "repos_url": "https://api.github.com/users/tobiasbrunner/repos",
                    "events_url": "https://api.github.com/users/tobiasbrunner/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/tobiasbrunner/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "```suggestion\r\n\tthis->encoding = chunk_clone(blob);\r\n```",
                "created_at": "2023-10-26T14:00:25Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373232576",
                "pull_request_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "author_association": "MEMBER",
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373232576"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373232576"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    }
                },
                "reactions": {
                    "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373232576/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "start_line": null,
                "original_start_line": null,
                "start_side": null,
                "line": 1175,
                "original_line": 1175,
                "side": "RIGHT",
                "original_position": 545,
                "position": 545,
                "subject_type": "line"
            },
            "pull_request": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "id": 1565360593,
                "node_id": "PR_kwDOAA-8Q85dTYHR",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958",
                "diff_url": "https://github.com/strongswan/strongswan/pull/1958.diff",
                "patch_url": "https://github.com/strongswan/strongswan/pull/1958.patch",
                "issue_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958",
                "number": 1958,
                "state": "open",
                "locked": false,
                "title": "OCSP Responder",
                "user": {
                    "login": "strongX509",
                    "id": 4939775,
                    "node_id": "MDQ6VXNlcjQ5Mzk3NzU=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/4939775?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/strongX509",
                    "html_url": "https://github.com/strongX509",
                    "followers_url": "https://api.github.com/users/strongX509/followers",
                    "following_url": "https://api.github.com/users/strongX509/following{/other_user}",
                    "gists_url": "https://api.github.com/users/strongX509/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/strongX509/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/strongX509/subscriptions",
                    "organizations_url": "https://api.github.com/users/strongX509/orgs",
                    "repos_url": "https://api.github.com/users/strongX509/repos",
                    "events_url": "https://api.github.com/users/strongX509/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/strongX509/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "The new **`pki --ocsp`** command parses an _Online Certificate Status Protocol_ (OCSP) request as defined by  RFC  6960  and\r\n       with  the **`--respond`** option generates an OCSP response based on the OCSP request.  The certificate status is directly\r\n       retrieved from the internal certificate database of an _OpenXPKI_ (https://openxpki.org) server. Therefore the **`--respond`**  option\r\n       requires  the new  **`openxpki`**  and the existing  **`mysql`** libstrongswan plugins in order to access the **`certificate`** database table of the _OpenXPKI_ server running on the same host. The OCSP response can be signed by the CA itself, by a delegated OCSP Signer certificate with corresonding EKU extension or by a self-signed OCSP Signer certificate.\r\n",
                "created_at": "2023-10-19T18:01:27Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "db8b1bc37cb571300caaaa58e8b4614e662c2c45",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [
                    {
                        "id": 5235670731,
                        "node_id": "LA_kwDOAA-8Q88AAAABOBH-yw",
                        "url": "https://api.github.com/repos/strongswan/strongswan/labels/cla-signed",
                        "name": "cla-signed",
                        "color": "ededed",
                        "default": false,
                        "description": null
                    }
                ],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits",
                "review_comments_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments",
                "review_comment_url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments",
                "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "head": {
                    "label": "strongswan:ocsp-responder-new",
                    "ref": "ocsp-responder-new",
                    "sha": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "base": {
                    "label": "strongswan:master",
                    "ref": "master",
                    "sha": "b5760243870d4ab6c5874d765f8b09b3c67b8fc6",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T14:00:25Z",
        "org": {
            "id": 457671,
            "login": "strongswan",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/strongswan",
            "avatar_url": "https://avatars.githubusercontent.com/u/457671?"
        }
    },
    {
        "id": "32874321497",
        "type": "PullRequestReviewCommentEvent",
        "actor": {
            "id": 457648,
            "login": "tobiasbrunner",
            "display_login": "tobiasbrunner",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tobiasbrunner",
            "avatar_url": "https://avatars.githubusercontent.com/u/457648?"
        },
        "repo": {
            "id": 1031235,
            "name": "strongswan/strongswan",
            "url": "https://api.github.com/repos/strongswan/strongswan"
        },
        "payload": {
            "action": "created",
            "comment": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373213797",
                "pull_request_review_id": 1698865892,
                "id": 1373213797,
                "node_id": "PRRC_kwDOAA-8Q85R2ZRl",
                "diff_hunk": "@@ -466,6 +521,96 @@ static bool parse_responses(private_x509_ocsp_response_t *this,\n \treturn success;\n }\n \n+/**\n+ * Build tbsResponseData\n+ */\n+static chunk_t build_tbsResponseData(private_x509_ocsp_response_t *this)\n+{\n+\tchunk_t responderIdByName;\n+\tchunk_t responseExtensions = chunk_empty;\n+\n+\tresponderIdByName = asn1_wrap(ASN1_CONTEXT_C_1, \"c\",\n+\t\t\t\t\t\t\tthis->responderId->get_encoding(this->responderId));\n+\n+\tthis->producedAt = time(NULL);\n+\n+\tresponseExtensions = asn1_wrap(ASN1_CONTEXT_C_1, \"m\",\n+\t\t\t\t\t\t\tasn1_wrap(ASN1_SEQUENCE, \"m\",\n+\t\t\t\t\t\t\t\tasn1_wrap(ASN1_SEQUENCE, \"mm\",\n+\t\t\t\t\t\t\t\t\tasn1_build_known_oid(OID_NONCE),\n+\t\t\t\t\t\t\t\t\tasn1_wrap(ASN1_OCTET_STRING, \"m\",\n+\t\t\t\t\t\t\t\t\t\tasn1_simple_object(ASN1_OCTET_STRING,\n+\t\t\t\t\t\t\t\t\t\t\t\t\t\t  this->nonce)))));\n+\n+\treturn asn1_wrap(ASN1_SEQUENCE, \"mmmm\",\n+\t\t\t\tresponderIdByName,\n+\t\t\t\tasn1_from_time(&this->producedAt, ASN1_GENERALIZEDTIME),\n+ \t\t\t\tbuild_responses(this),\n+\t\t\t\tresponseExtensions);\n+}\n+\n+/**\n+ * Build the signature\n+ */\n+static bool build_signature(private_x509_ocsp_response_t *this,\n+\t\t\t\t\t\t\tchunk_t tbsResponseData, chunk_t *signature)\n+{\n+",
                "path": "src/libstrongswan/plugins/x509/x509_ocsp_response.c",
                "commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "original_commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "user": {
                    "login": "tobiasbrunner",
                    "id": 457648,
                    "node_id": "MDQ6VXNlcjQ1NzY0OA==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/457648?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/tobiasbrunner",
                    "html_url": "https://github.com/tobiasbrunner",
                    "followers_url": "https://api.github.com/users/tobiasbrunner/followers",
                    "following_url": "https://api.github.com/users/tobiasbrunner/following{/other_user}",
                    "gists_url": "https://api.github.com/users/tobiasbrunner/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/tobiasbrunner/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/tobiasbrunner/subscriptions",
                    "organizations_url": "https://api.github.com/users/tobiasbrunner/orgs",
                    "repos_url": "https://api.github.com/users/tobiasbrunner/repos",
                    "events_url": "https://api.github.com/users/tobiasbrunner/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/tobiasbrunner/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "```suggestion\r\n```",
                "created_at": "2023-10-26T13:48:16Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373213797",
                "pull_request_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "author_association": "MEMBER",
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373213797"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373213797"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    }
                },
                "reactions": {
                    "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373213797/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "start_line": null,
                "original_start_line": null,
                "start_side": null,
                "line": 558,
                "original_line": 558,
                "side": "RIGHT",
                "original_position": 262,
                "position": 262,
                "subject_type": "line"
            },
            "pull_request": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "id": 1565360593,
                "node_id": "PR_kwDOAA-8Q85dTYHR",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958",
                "diff_url": "https://github.com/strongswan/strongswan/pull/1958.diff",
                "patch_url": "https://github.com/strongswan/strongswan/pull/1958.patch",
                "issue_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958",
                "number": 1958,
                "state": "open",
                "locked": false,
                "title": "OCSP Responder",
                "user": {
                    "login": "strongX509",
                    "id": 4939775,
                    "node_id": "MDQ6VXNlcjQ5Mzk3NzU=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/4939775?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/strongX509",
                    "html_url": "https://github.com/strongX509",
                    "followers_url": "https://api.github.com/users/strongX509/followers",
                    "following_url": "https://api.github.com/users/strongX509/following{/other_user}",
                    "gists_url": "https://api.github.com/users/strongX509/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/strongX509/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/strongX509/subscriptions",
                    "organizations_url": "https://api.github.com/users/strongX509/orgs",
                    "repos_url": "https://api.github.com/users/strongX509/repos",
                    "events_url": "https://api.github.com/users/strongX509/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/strongX509/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "The new **`pki --ocsp`** command parses an _Online Certificate Status Protocol_ (OCSP) request as defined by  RFC  6960  and\r\n       with  the **`--respond`** option generates an OCSP response based on the OCSP request.  The certificate status is directly\r\n       retrieved from the internal certificate database of an _OpenXPKI_ (https://openxpki.org) server. Therefore the **`--respond`**  option\r\n       requires  the new  **`openxpki`**  and the existing  **`mysql`** libstrongswan plugins in order to access the **`certificate`** database table of the _OpenXPKI_ server running on the same host. The OCSP response can be signed by the CA itself, by a delegated OCSP Signer certificate with corresonding EKU extension or by a self-signed OCSP Signer certificate.\r\n",
                "created_at": "2023-10-19T18:01:27Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "db8b1bc37cb571300caaaa58e8b4614e662c2c45",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [
                    {
                        "id": 5235670731,
                        "node_id": "LA_kwDOAA-8Q88AAAABOBH-yw",
                        "url": "https://api.github.com/repos/strongswan/strongswan/labels/cla-signed",
                        "name": "cla-signed",
                        "color": "ededed",
                        "default": false,
                        "description": null
                    }
                ],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits",
                "review_comments_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments",
                "review_comment_url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments",
                "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "head": {
                    "label": "strongswan:ocsp-responder-new",
                    "ref": "ocsp-responder-new",
                    "sha": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "base": {
                    "label": "strongswan:master",
                    "ref": "master",
                    "sha": "b5760243870d4ab6c5874d765f8b09b3c67b8fc6",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T13:48:16Z",
        "org": {
            "id": 457671,
            "login": "strongswan",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/strongswan",
            "avatar_url": "https://avatars.githubusercontent.com/u/457671?"
        }
    },
    {
        "id": "32874321474",
        "type": "PullRequestReviewCommentEvent",
        "actor": {
            "id": 457648,
            "login": "tobiasbrunner",
            "display_login": "tobiasbrunner",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tobiasbrunner",
            "avatar_url": "https://avatars.githubusercontent.com/u/457648?"
        },
        "repo": {
            "id": 1031235,
            "name": "strongswan/strongswan",
            "url": "https://api.github.com/repos/strongswan/strongswan"
        },
        "payload": {
            "action": "created",
            "comment": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373213646",
                "pull_request_review_id": 1698865892,
                "id": 1373213646,
                "node_id": "PRRC_kwDOAA-8Q85R2ZPO",
                "diff_hunk": "@@ -466,6 +521,96 @@ static bool parse_responses(private_x509_ocsp_response_t *this,\n \treturn success;\n }\n \n+/**\n+ * Build tbsResponseData\n+ */\n+static chunk_t build_tbsResponseData(private_x509_ocsp_response_t *this)\n+{\n+\tchunk_t responderIdByName;\n+\tchunk_t responseExtensions = chunk_empty;\n+\n+\tresponderIdByName = asn1_wrap(ASN1_CONTEXT_C_1, \"c\",\n+\t\t\t\t\t\t\tthis->responderId->get_encoding(this->responderId));\n+\n+\tthis->producedAt = time(NULL);\n+\n+\tresponseExtensions = asn1_wrap(ASN1_CONTEXT_C_1, \"m\",\n+\t\t\t\t\t\t\tasn1_wrap(ASN1_SEQUENCE, \"m\",\n+\t\t\t\t\t\t\t\tasn1_wrap(ASN1_SEQUENCE, \"mm\",\n+\t\t\t\t\t\t\t\t\tasn1_build_known_oid(OID_NONCE),\n+\t\t\t\t\t\t\t\t\tasn1_wrap(ASN1_OCTET_STRING, \"m\",\n+\t\t\t\t\t\t\t\t\t\tasn1_simple_object(ASN1_OCTET_STRING,\n+\t\t\t\t\t\t\t\t\t\t\t\t\t\t  this->nonce)))));\n+\n+\treturn asn1_wrap(ASN1_SEQUENCE, \"mmmm\",\n+\t\t\t\tresponderIdByName,\n+\t\t\t\tasn1_from_time(&this->producedAt, ASN1_GENERALIZEDTIME),\n+ \t\t\t\tbuild_responses(this),\n+\t\t\t\tresponseExtensions);\n+}\n+\n+/**\n+ * Build the signature\n+ */\n+static bool build_signature(private_x509_ocsp_response_t *this,\n+\t\t\t\t\t\t\tchunk_t tbsResponseData, chunk_t *signature)\n+{\n+\n+\tif (!this->key->sign(this->key, this->scheme->scheme, this->scheme->params,\n+\t\t\t\t\t\t tbsResponseData, signature))\n+\t{\n+\t\tDBG1(DBG_LIB, \"creating OCSP response signature failed\");\n+\t\treturn FALSE;\n+\t}\n+",
                "path": "src/libstrongswan/plugins/x509/x509_ocsp_response.c",
                "commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "original_commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "user": {
                    "login": "tobiasbrunner",
                    "id": 457648,
                    "node_id": "MDQ6VXNlcjQ1NzY0OA==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/457648?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/tobiasbrunner",
                    "html_url": "https://github.com/tobiasbrunner",
                    "followers_url": "https://api.github.com/users/tobiasbrunner/followers",
                    "following_url": "https://api.github.com/users/tobiasbrunner/following{/other_user}",
                    "gists_url": "https://api.github.com/users/tobiasbrunner/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/tobiasbrunner/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/tobiasbrunner/subscriptions",
                    "organizations_url": "https://api.github.com/users/tobiasbrunner/orgs",
                    "repos_url": "https://api.github.com/users/tobiasbrunner/repos",
                    "events_url": "https://api.github.com/users/tobiasbrunner/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/tobiasbrunner/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "```suggestion\r\n```",
                "created_at": "2023-10-26T13:48:10Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373213646",
                "pull_request_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "author_association": "MEMBER",
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373213646"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373213646"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    }
                },
                "reactions": {
                    "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373213646/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "start_line": null,
                "original_start_line": null,
                "start_side": null,
                "line": 565,
                "original_line": 565,
                "side": "RIGHT",
                "original_position": 269,
                "position": 269,
                "subject_type": "line"
            },
            "pull_request": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "id": 1565360593,
                "node_id": "PR_kwDOAA-8Q85dTYHR",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958",
                "diff_url": "https://github.com/strongswan/strongswan/pull/1958.diff",
                "patch_url": "https://github.com/strongswan/strongswan/pull/1958.patch",
                "issue_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958",
                "number": 1958,
                "state": "open",
                "locked": false,
                "title": "OCSP Responder",
                "user": {
                    "login": "strongX509",
                    "id": 4939775,
                    "node_id": "MDQ6VXNlcjQ5Mzk3NzU=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/4939775?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/strongX509",
                    "html_url": "https://github.com/strongX509",
                    "followers_url": "https://api.github.com/users/strongX509/followers",
                    "following_url": "https://api.github.com/users/strongX509/following{/other_user}",
                    "gists_url": "https://api.github.com/users/strongX509/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/strongX509/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/strongX509/subscriptions",
                    "organizations_url": "https://api.github.com/users/strongX509/orgs",
                    "repos_url": "https://api.github.com/users/strongX509/repos",
                    "events_url": "https://api.github.com/users/strongX509/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/strongX509/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "The new **`pki --ocsp`** command parses an _Online Certificate Status Protocol_ (OCSP) request as defined by  RFC  6960  and\r\n       with  the **`--respond`** option generates an OCSP response based on the OCSP request.  The certificate status is directly\r\n       retrieved from the internal certificate database of an _OpenXPKI_ (https://openxpki.org) server. Therefore the **`--respond`**  option\r\n       requires  the new  **`openxpki`**  and the existing  **`mysql`** libstrongswan plugins in order to access the **`certificate`** database table of the _OpenXPKI_ server running on the same host. The OCSP response can be signed by the CA itself, by a delegated OCSP Signer certificate with corresonding EKU extension or by a self-signed OCSP Signer certificate.\r\n",
                "created_at": "2023-10-19T18:01:27Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "db8b1bc37cb571300caaaa58e8b4614e662c2c45",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [
                    {
                        "id": 5235670731,
                        "node_id": "LA_kwDOAA-8Q88AAAABOBH-yw",
                        "url": "https://api.github.com/repos/strongswan/strongswan/labels/cla-signed",
                        "name": "cla-signed",
                        "color": "ededed",
                        "default": false,
                        "description": null
                    }
                ],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits",
                "review_comments_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments",
                "review_comment_url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments",
                "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "head": {
                    "label": "strongswan:ocsp-responder-new",
                    "ref": "ocsp-responder-new",
                    "sha": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "base": {
                    "label": "strongswan:master",
                    "ref": "master",
                    "sha": "b5760243870d4ab6c5874d765f8b09b3c67b8fc6",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T13:48:10Z",
        "org": {
            "id": 457671,
            "login": "strongswan",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/strongswan",
            "avatar_url": "https://avatars.githubusercontent.com/u/457671?"
        }
    },
    {
        "id": "32874321495",
        "type": "PullRequestReviewCommentEvent",
        "actor": {
            "id": 457648,
            "login": "tobiasbrunner",
            "display_login": "tobiasbrunner",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tobiasbrunner",
            "avatar_url": "https://avatars.githubusercontent.com/u/457648?"
        },
        "repo": {
            "id": 1031235,
            "name": "strongswan/strongswan",
            "url": "https://api.github.com/repos/strongswan/strongswan"
        },
        "payload": {
            "action": "created",
            "comment": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373221659",
                "pull_request_review_id": 1698865892,
                "id": 1373221659,
                "node_id": "PRRC_kwDOAA-8Q85R2bMb",
                "diff_hunk": "@@ -755,6 +925,7 @@ METHOD(certificate_t, issued_by, bool,\n \t\treturn FALSE;\n \t}\n \n+",
                "path": "src/libstrongswan/plugins/x509/x509_ocsp_response.c",
                "commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "original_commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "user": {
                    "login": "tobiasbrunner",
                    "id": 457648,
                    "node_id": "MDQ6VXNlcjQ1NzY0OA==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/457648?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/tobiasbrunner",
                    "html_url": "https://github.com/tobiasbrunner",
                    "followers_url": "https://api.github.com/users/tobiasbrunner/followers",
                    "following_url": "https://api.github.com/users/tobiasbrunner/following{/other_user}",
                    "gists_url": "https://api.github.com/users/tobiasbrunner/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/tobiasbrunner/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/tobiasbrunner/subscriptions",
                    "organizations_url": "https://api.github.com/users/tobiasbrunner/orgs",
                    "repos_url": "https://api.github.com/users/tobiasbrunner/repos",
                    "events_url": "https://api.github.com/users/tobiasbrunner/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/tobiasbrunner/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "```suggestion\r\n```",
                "created_at": "2023-10-26T13:53:19Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373221659",
                "pull_request_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "author_association": "MEMBER",
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373221659"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373221659"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    }
                },
                "reactions": {
                    "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373221659/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "start_line": null,
                "original_start_line": null,
                "start_side": null,
                "line": 928,
                "original_line": 928,
                "side": "RIGHT",
                "original_position": 395,
                "position": 395,
                "subject_type": "line"
            },
            "pull_request": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "id": 1565360593,
                "node_id": "PR_kwDOAA-8Q85dTYHR",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958",
                "diff_url": "https://github.com/strongswan/strongswan/pull/1958.diff",
                "patch_url": "https://github.com/strongswan/strongswan/pull/1958.patch",
                "issue_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958",
                "number": 1958,
                "state": "open",
                "locked": false,
                "title": "OCSP Responder",
                "user": {
                    "login": "strongX509",
                    "id": 4939775,
                    "node_id": "MDQ6VXNlcjQ5Mzk3NzU=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/4939775?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/strongX509",
                    "html_url": "https://github.com/strongX509",
                    "followers_url": "https://api.github.com/users/strongX509/followers",
                    "following_url": "https://api.github.com/users/strongX509/following{/other_user}",
                    "gists_url": "https://api.github.com/users/strongX509/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/strongX509/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/strongX509/subscriptions",
                    "organizations_url": "https://api.github.com/users/strongX509/orgs",
                    "repos_url": "https://api.github.com/users/strongX509/repos",
                    "events_url": "https://api.github.com/users/strongX509/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/strongX509/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "The new **`pki --ocsp`** command parses an _Online Certificate Status Protocol_ (OCSP) request as defined by  RFC  6960  and\r\n       with  the **`--respond`** option generates an OCSP response based on the OCSP request.  The certificate status is directly\r\n       retrieved from the internal certificate database of an _OpenXPKI_ (https://openxpki.org) server. Therefore the **`--respond`**  option\r\n       requires  the new  **`openxpki`**  and the existing  **`mysql`** libstrongswan plugins in order to access the **`certificate`** database table of the _OpenXPKI_ server running on the same host. The OCSP response can be signed by the CA itself, by a delegated OCSP Signer certificate with corresonding EKU extension or by a self-signed OCSP Signer certificate.\r\n",
                "created_at": "2023-10-19T18:01:27Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "db8b1bc37cb571300caaaa58e8b4614e662c2c45",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [
                    {
                        "id": 5235670731,
                        "node_id": "LA_kwDOAA-8Q88AAAABOBH-yw",
                        "url": "https://api.github.com/repos/strongswan/strongswan/labels/cla-signed",
                        "name": "cla-signed",
                        "color": "ededed",
                        "default": false,
                        "description": null
                    }
                ],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits",
                "review_comments_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments",
                "review_comment_url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments",
                "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "head": {
                    "label": "strongswan:ocsp-responder-new",
                    "ref": "ocsp-responder-new",
                    "sha": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "base": {
                    "label": "strongswan:master",
                    "ref": "master",
                    "sha": "b5760243870d4ab6c5874d765f8b09b3c67b8fc6",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T13:53:19Z",
        "org": {
            "id": 457671,
            "login": "strongswan",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/strongswan",
            "avatar_url": "https://avatars.githubusercontent.com/u/457671?"
        }
    },
    {
        "id": "32874321429",
        "type": "PullRequestReviewCommentEvent",
        "actor": {
            "id": 457648,
            "login": "tobiasbrunner",
            "display_login": "tobiasbrunner",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tobiasbrunner",
            "avatar_url": "https://avatars.githubusercontent.com/u/457648?"
        },
        "repo": {
            "id": 1031235,
            "name": "strongswan/strongswan",
            "url": "https://api.github.com/repos/strongswan/strongswan"
        },
        "payload": {
            "action": "created",
            "comment": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373168742",
                "pull_request_review_id": 1698865892,
                "id": 1373168742,
                "node_id": "PRRC_kwDOAA-8Q85R2ORm",
                "diff_hunk": "@@ -277,6 +269,55 @@ METHOD(ocsp_response_t, get_nonce, chunk_t,\n \treturn this->nonce;\n }\n \n+/**\n+ * Build singleResponse\n+ */\n+static chunk_t build_singleResponse(private_x509_ocsp_response_t *this,\n+\t\t\t\t\t\t\t\t\tocsp_single_response_t *response)\n+{\n+\tchunk_t certID, certStatus, nextUpdate = chunk_empty;\n+\n+\tcertID = asn1_wrap(ASN1_SEQUENCE, \"mmmm\",\n+\t\t\t\tasn1_algorithmIdentifier(\n+\t\t\t\t\thasher_algorithm_to_oid(response->hashAlgorithm)),\n+\t\t\t\tasn1_simple_object(ASN1_OCTET_STRING, response->issuerNameHash),\n+\t\t\t\tasn1_simple_object(ASN1_OCTET_STRING, response->issuerKeyHash),\n+\t\t\t\tasn1_integer(\"c\", response->serialNumber));\n+\n+\tswitch (response->status)\n+\t{\n+\t\tcase VALIDATION_GOOD:\n+\t\t\tcertStatus = asn1_wrap(ASN1_CONTEXT_S_0, \"c\", chunk_empty);\n+\t\t\tbreak;\n+\t\tcase VALIDATION_REVOKED:\n+\t\tcase VALIDATION_ON_HOLD:\n+\t\t\tcertStatus = asn1_wrap(ASN1_CONTEXT_C_1, \"mm\",\n+\t\t\t\t\t\t\tasn1_from_time(&response->revocationTime,\n+\t\t\t\t\t\t\t\t\t\t   ASN1_GENERALIZEDTIME),\n+\t\t\t\t\t\t\tasn1_wrap(ASN1_CONTEXT_C_0, \"m\",\n+\t\t\t\t\t\t\t\tasn1_simple_object(ASN1_ENUMERATED,\n+\t\t\t\t\t\t\t\t chunk_from_chars(response->revocationReason))));\n+\t\t\tbreak;\n+\t\tcase VALIDATION_FAILED:\n+\t\tdefault:\n+\t\t\tcertStatus = asn1_wrap(ASN1_CONTEXT_S_2, \"c\", chunk_empty);\n+\t}\n+\n+\tif (response->nextUpdate != 0)\n+\t{\n+\t\tnextUpdate = asn1_wrap(ASN1_CONTEXT_C_0, \"m\",\n+\t\t\t\t\t\tasn1_from_time(&response->nextUpdate,\n+\t\t\t\t\t\t\t\t\t   ASN1_GENERALIZEDTIME));\n+\t}\n+",
                "path": "src/libstrongswan/plugins/x509/x509_ocsp_response.c",
                "commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "original_commit_id": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "user": {
                    "login": "tobiasbrunner",
                    "id": 457648,
                    "node_id": "MDQ6VXNlcjQ1NzY0OA==",
                    "avatar_url": "https://avatars.githubusercontent.com/u/457648?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/tobiasbrunner",
                    "html_url": "https://github.com/tobiasbrunner",
                    "followers_url": "https://api.github.com/users/tobiasbrunner/followers",
                    "following_url": "https://api.github.com/users/tobiasbrunner/following{/other_user}",
                    "gists_url": "https://api.github.com/users/tobiasbrunner/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/tobiasbrunner/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/tobiasbrunner/subscriptions",
                    "organizations_url": "https://api.github.com/users/tobiasbrunner/orgs",
                    "repos_url": "https://api.github.com/users/tobiasbrunner/repos",
                    "events_url": "https://api.github.com/users/tobiasbrunner/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/tobiasbrunner/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "```suggestion\r\n```",
                "created_at": "2023-10-26T13:23:33Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373168742",
                "pull_request_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "author_association": "MEMBER",
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373168742"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958#discussion_r1373168742"
                    },
                    "pull_request": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    }
                },
                "reactions": {
                    "url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments/1373168742/reactions",
                    "total_count": 0,
                    "+1": 0,
                    "-1": 0,
                    "laugh": 0,
                    "hooray": 0,
                    "confused": 0,
                    "heart": 0,
                    "rocket": 0,
                    "eyes": 0
                },
                "start_line": null,
                "original_start_line": null,
                "start_side": null,
                "line": 312,
                "original_line": 312,
                "side": "RIGHT",
                "original_position": 138,
                "position": 138,
                "subject_type": "line"
            },
            "pull_request": {
                "url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958",
                "id": 1565360593,
                "node_id": "PR_kwDOAA-8Q85dTYHR",
                "html_url": "https://github.com/strongswan/strongswan/pull/1958",
                "diff_url": "https://github.com/strongswan/strongswan/pull/1958.diff",
                "patch_url": "https://github.com/strongswan/strongswan/pull/1958.patch",
                "issue_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958",
                "number": 1958,
                "state": "open",
                "locked": false,
                "title": "OCSP Responder",
                "user": {
                    "login": "strongX509",
                    "id": 4939775,
                    "node_id": "MDQ6VXNlcjQ5Mzk3NzU=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/4939775?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/strongX509",
                    "html_url": "https://github.com/strongX509",
                    "followers_url": "https://api.github.com/users/strongX509/followers",
                    "following_url": "https://api.github.com/users/strongX509/following{/other_user}",
                    "gists_url": "https://api.github.com/users/strongX509/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/strongX509/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/strongX509/subscriptions",
                    "organizations_url": "https://api.github.com/users/strongX509/orgs",
                    "repos_url": "https://api.github.com/users/strongX509/repos",
                    "events_url": "https://api.github.com/users/strongX509/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/strongX509/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "body": "The new **`pki --ocsp`** command parses an _Online Certificate Status Protocol_ (OCSP) request as defined by  RFC  6960  and\r\n       with  the **`--respond`** option generates an OCSP response based on the OCSP request.  The certificate status is directly\r\n       retrieved from the internal certificate database of an _OpenXPKI_ (https://openxpki.org) server. Therefore the **`--respond`**  option\r\n       requires  the new  **`openxpki`**  and the existing  **`mysql`** libstrongswan plugins in order to access the **`certificate`** database table of the _OpenXPKI_ server running on the same host. The OCSP response can be signed by the CA itself, by a delegated OCSP Signer certificate with corresonding EKU extension or by a self-signed OCSP Signer certificate.\r\n",
                "created_at": "2023-10-19T18:01:27Z",
                "updated_at": "2023-10-26T15:51:37Z",
                "closed_at": null,
                "merged_at": null,
                "merge_commit_sha": "db8b1bc37cb571300caaaa58e8b4614e662c2c45",
                "assignee": null,
                "assignees": [],
                "requested_reviewers": [],
                "requested_teams": [],
                "labels": [
                    {
                        "id": 5235670731,
                        "node_id": "LA_kwDOAA-8Q88AAAABOBH-yw",
                        "url": "https://api.github.com/repos/strongswan/strongswan/labels/cla-signed",
                        "name": "cla-signed",
                        "color": "ededed",
                        "default": false,
                        "description": null
                    }
                ],
                "milestone": null,
                "draft": false,
                "commits_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits",
                "review_comments_url": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments",
                "review_comment_url": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}",
                "comments_url": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments",
                "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                "head": {
                    "label": "strongswan:ocsp-responder-new",
                    "ref": "ocsp-responder-new",
                    "sha": "2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "base": {
                    "label": "strongswan:master",
                    "ref": "master",
                    "sha": "b5760243870d4ab6c5874d765f8b09b3c67b8fc6",
                    "user": {
                        "login": "strongswan",
                        "id": 457671,
                        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                        "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                        "gravatar_id": "",
                        "url": "https://api.github.com/users/strongswan",
                        "html_url": "https://github.com/strongswan",
                        "followers_url": "https://api.github.com/users/strongswan/followers",
                        "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                        "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                        "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                        "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                        "organizations_url": "https://api.github.com/users/strongswan/orgs",
                        "repos_url": "https://api.github.com/users/strongswan/repos",
                        "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                        "received_events_url": "https://api.github.com/users/strongswan/received_events",
                        "type": "Organization",
                        "site_admin": false
                    },
                    "repo": {
                        "id": 1031235,
                        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMxMjM1",
                        "name": "strongswan",
                        "full_name": "strongswan/strongswan",
                        "private": false,
                        "owner": {
                            "login": "strongswan",
                            "id": 457671,
                            "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ1NzY3MQ==",
                            "avatar_url": "https://avatars.githubusercontent.com/u/457671?v=4",
                            "gravatar_id": "",
                            "url": "https://api.github.com/users/strongswan",
                            "html_url": "https://github.com/strongswan",
                            "followers_url": "https://api.github.com/users/strongswan/followers",
                            "following_url": "https://api.github.com/users/strongswan/following{/other_user}",
                            "gists_url": "https://api.github.com/users/strongswan/gists{/gist_id}",
                            "starred_url": "https://api.github.com/users/strongswan/starred{/owner}{/repo}",
                            "subscriptions_url": "https://api.github.com/users/strongswan/subscriptions",
                            "organizations_url": "https://api.github.com/users/strongswan/orgs",
                            "repos_url": "https://api.github.com/users/strongswan/repos",
                            "events_url": "https://api.github.com/users/strongswan/events{/privacy}",
                            "received_events_url": "https://api.github.com/users/strongswan/received_events",
                            "type": "Organization",
                            "site_admin": false
                        },
                        "html_url": "https://github.com/strongswan/strongswan",
                        "description": "strongSwan - IPsec-based VPN",
                        "fork": false,
                        "url": "https://api.github.com/repos/strongswan/strongswan",
                        "forks_url": "https://api.github.com/repos/strongswan/strongswan/forks",
                        "keys_url": "https://api.github.com/repos/strongswan/strongswan/keys{/key_id}",
                        "collaborators_url": "https://api.github.com/repos/strongswan/strongswan/collaborators{/collaborator}",
                        "teams_url": "https://api.github.com/repos/strongswan/strongswan/teams",
                        "hooks_url": "https://api.github.com/repos/strongswan/strongswan/hooks",
                        "issue_events_url": "https://api.github.com/repos/strongswan/strongswan/issues/events{/number}",
                        "events_url": "https://api.github.com/repos/strongswan/strongswan/events",
                        "assignees_url": "https://api.github.com/repos/strongswan/strongswan/assignees{/user}",
                        "branches_url": "https://api.github.com/repos/strongswan/strongswan/branches{/branch}",
                        "tags_url": "https://api.github.com/repos/strongswan/strongswan/tags",
                        "blobs_url": "https://api.github.com/repos/strongswan/strongswan/git/blobs{/sha}",
                        "git_tags_url": "https://api.github.com/repos/strongswan/strongswan/git/tags{/sha}",
                        "git_refs_url": "https://api.github.com/repos/strongswan/strongswan/git/refs{/sha}",
                        "trees_url": "https://api.github.com/repos/strongswan/strongswan/git/trees{/sha}",
                        "statuses_url": "https://api.github.com/repos/strongswan/strongswan/statuses/{sha}",
                        "languages_url": "https://api.github.com/repos/strongswan/strongswan/languages",
                        "stargazers_url": "https://api.github.com/repos/strongswan/strongswan/stargazers",
                        "contributors_url": "https://api.github.com/repos/strongswan/strongswan/contributors",
                        "subscribers_url": "https://api.github.com/repos/strongswan/strongswan/subscribers",
                        "subscription_url": "https://api.github.com/repos/strongswan/strongswan/subscription",
                        "commits_url": "https://api.github.com/repos/strongswan/strongswan/commits{/sha}",
                        "git_commits_url": "https://api.github.com/repos/strongswan/strongswan/git/commits{/sha}",
                        "comments_url": "https://api.github.com/repos/strongswan/strongswan/comments{/number}",
                        "issue_comment_url": "https://api.github.com/repos/strongswan/strongswan/issues/comments{/number}",
                        "contents_url": "https://api.github.com/repos/strongswan/strongswan/contents/{+path}",
                        "compare_url": "https://api.github.com/repos/strongswan/strongswan/compare/{base}...{head}",
                        "merges_url": "https://api.github.com/repos/strongswan/strongswan/merges",
                        "archive_url": "https://api.github.com/repos/strongswan/strongswan/{archive_format}{/ref}",
                        "downloads_url": "https://api.github.com/repos/strongswan/strongswan/downloads",
                        "issues_url": "https://api.github.com/repos/strongswan/strongswan/issues{/number}",
                        "pulls_url": "https://api.github.com/repos/strongswan/strongswan/pulls{/number}",
                        "milestones_url": "https://api.github.com/repos/strongswan/strongswan/milestones{/number}",
                        "notifications_url": "https://api.github.com/repos/strongswan/strongswan/notifications{?since,all,participating}",
                        "labels_url": "https://api.github.com/repos/strongswan/strongswan/labels{/name}",
                        "releases_url": "https://api.github.com/repos/strongswan/strongswan/releases{/id}",
                        "deployments_url": "https://api.github.com/repos/strongswan/strongswan/deployments",
                        "created_at": "2010-10-28T08:57:10Z",
                        "updated_at": "2023-10-24T14:02:38Z",
                        "pushed_at": "2023-10-26T13:16:07Z",
                        "git_url": "git://github.com/strongswan/strongswan.git",
                        "ssh_url": "git@github.com:strongswan/strongswan.git",
                        "clone_url": "https://github.com/strongswan/strongswan.git",
                        "svn_url": "https://github.com/strongswan/strongswan",
                        "homepage": "https://www.strongswan.org",
                        "size": 98388,
                        "stargazers_count": 1893,
                        "watchers_count": 1893,
                        "language": "C",
                        "has_issues": true,
                        "has_projects": false,
                        "has_downloads": true,
                        "has_wiki": false,
                        "has_pages": false,
                        "has_discussions": true,
                        "forks_count": 710,
                        "mirror_url": null,
                        "archived": false,
                        "disabled": false,
                        "open_issues_count": 72,
                        "license": {
                            "key": "other",
                            "name": "Other",
                            "spdx_id": "NOASSERTION",
                            "url": null,
                            "node_id": "MDc6TGljZW5zZTA="
                        },
                        "allow_forking": true,
                        "is_template": false,
                        "web_commit_signoff_required": false,
                        "topics": [
                            "ikev2",
                            "ipsec",
                            "strongswan",
                            "vpn",
                            "vpn-client",
                            "vpn-server"
                        ],
                        "visibility": "public",
                        "forks": 710,
                        "open_issues": 72,
                        "watchers": 1893,
                        "default_branch": "master"
                    }
                },
                "_links": {
                    "self": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958"
                    },
                    "html": {
                        "href": "https://github.com/strongswan/strongswan/pull/1958"
                    },
                    "issue": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958"
                    },
                    "comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/issues/1958/comments"
                    },
                    "review_comments": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/comments"
                    },
                    "review_comment": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/comments{/number}"
                    },
                    "commits": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/pulls/1958/commits"
                    },
                    "statuses": {
                        "href": "https://api.github.com/repos/strongswan/strongswan/statuses/2de215c1b3da5f6d1f9ee3b99af2b81daf385c9d"
                    }
                },
                "author_association": "CONTRIBUTOR",
                "auto_merge": null,
                "active_lock_reason": null
            }
        },
        "public": true,
        "created_at": "2023-10-26T13:23:33Z",
        "org": {
            "id": 457671,
            "login": "strongswan",
            "gravatar_id": "",
            "url": "https://api.github.com/orgs/strongswan",
            "avatar_url": "https://avatars.githubusercontent.com/u/457671?"
        }
    }
]